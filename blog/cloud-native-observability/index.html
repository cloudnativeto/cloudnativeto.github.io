<!DOCTYPE html><html lang="zh" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="云原生社区" />

  
  
  
    
  
  <meta name="description" content="本文来自云原生社区 meetup 北京站的分享。" />

  
  <link rel="alternate" hreflang="zh" href="https://cloudnative.to/blog/cloud-native-observability/" />

  
  
  
    <meta name="theme-color" content="#0a55a7" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.2f500d272ea4379dca952215a5d02351.css" />

  



  


  


  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f3dc895ea3bd6186cd835841d365c103";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu12a4295615259de83f102fd096a49a31_6281_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu12a4295615259de83f102fd096a49a31_6281_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://cloudnative.to/blog/cloud-native-observability/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
    <meta property="twitter:site" content="@CloudNativeCN" />
    <meta property="twitter:creator" content="@CloudNativeCN" />
  
  <meta property="og:site_name" content="云原生社区（中国）" />
  <meta property="og:url" content="https://cloudnative.to/blog/cloud-native-observability/" />
  <meta property="og:title" content="解读：云原生下的可观测性发展方向 | 云原生社区（中国）" />
  <meta property="og:description" content="本文来自云原生社区 meetup 北京站的分享。" /><meta property="og:image" content="https://cloudnative.to/media/sharing.png" />
    <meta property="twitter:image" content="https://cloudnative.to/media/sharing.png" /><meta property="og:locale" content="zh" />
  
    
      <meta
        property="article:published_time"
        content="2021-01-06T10:47:14&#43;08:00"
      />
    
    <meta property="article:modified_time" content="2023-03-13T19:28:20&#43;08:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://cloudnative.to/blog/cloud-native-observability/"
  },
  "headline": "解读：云原生下的可观测性发展方向",
  
  "datePublished": "2021-01-06T10:47:14+08:00",
  "dateModified": "2023-03-13T19:28:20+08:00",
  
  "author": {
    "@type": "Person",
    "name": "张城"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "云原生社区（中国）",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cloudnative.to/media/logo.svg"
    }
  },
  "description": "本文来自云原生社区 meetup 北京站的分享。"
}
</script>

  

  

  

  





  <title>解读：云原生下的可观测性发展方向 | 云原生社区（中国）</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="7a5fcfb12fead9cc5c32de4573e985de" >
  <button onclick="topFunction()" id="backTopBtn" title="Go to top"><i class="fa-solid fa-circle-up" aria-hidden="true"></i></button>
  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.62d6f8dfe8493f1c68557dde65bec362.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6 search-title">
          <p>搜索</p>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="关闭"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜索...">
        
      </div>

      
      

      
    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

      <div id="search-common-queries">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    











  


<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生社区（中国）"
            
            ></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"><img src="/media/logo.svg" alt="云原生社区（中国）"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/community"><span>社区</span></a>
          </li>

          
          

          

          
          
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/blog"><span>博客</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>资料</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/envoy/"><span>Envoy 中文文档</span></a>
              
                <a class="dropdown-item" href="/kubebuilder/"><span>Kubebuilder 中文文档</span></a>
              
                <a class="dropdown-item" href="https://lib.jimmysong.io/"><span>云原生资料库</span></a>
              
                <a class="dropdown-item" href="https://istio.io/latest/zh/"><span>Istio 中文文档</span></a>
              
            </div>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/event"><span>活动</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#feed"><span>更新</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#tags"><span>标签</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>关于</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        

        
        <li class="nav-item">
            <a class="nav-link" href="/community/join/" data-toggle="tooltip" data-placement="bottom" title="加入社区" aria-label="主站"><i class="fa-brands fa-weixin" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item">
            <a class="nav-link js-search" href="#" data-toggle="tooltip" data-placement="bottom" title="搜索" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="https://github.com/cloudnativeto/cloudnative.to" target="_blank" rel="noopener" data-toggle="tooltip" data-placement="bottom" title="查看源码" aria-label="查看源码" aria-label="GitHub"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item">
          <a href="#" class="nav-link set-theme">
            <i class="fa fa-sun" aria-hidden="true" id="theme-icon"></i>
          </a>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <div class="container-xl">
    <div class="post-container">
        












  

  
  
  
<div class="article-container pt-3">
  <h1>解读：云原生下的可观测性发展方向</h1>

  

  
    


<div class="article-metadata">

  <div>
  
  
  
  
    <i class="fa-solid fa-feather"></i>
    

  <span >
      <a href="/author/%E5%BC%A0%E5%9F%8E%E5%85%83%E4%B9%99/">张城（元乙）</a></span>
    
    <span class="middot-divider"></span>
    
  
  
  
  
  
  
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/" class="text-capitalize">可观测性</a></span>
  
  </div>

  
  <span class="article-date">
    
    
      
          
          发布于
      
    
    2021-01-06
  </span>
  

  

  
  <span class="middot-divider"></span>
  字数 5007
  <span class="middot-divider"></span>
  <span class="article-reading-time">
      阅读时长 23 分钟
  </span>
  

  
  
  
  

</div>

    





  
</div>


    </div>
    <div class="border-bottom mb-2"></div>
    <div class="row flex-xl-nowrap">
        <div class="col-3 d-none d-xl-block docs-toc">
            <!-- toc -->
            
<div class="">
    <ul class="nav toc-top">
        <li>
            <a href="#" id="back_to_top" class="docs-toc-title">目录</a>
        </li>
    </ul>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#可观测性的由来">可观测性的由来</a></li>
    <li><a href="#可观测性的未来">可观测性的未来</a></li>
    <li><a href="#自动驾驶的核心要素">自动驾驶的核心要素</a></li>
    <li><a href="#it-系统的可观测性">IT 系统的可观测性</a></li>
    <li><a href="#云原生下的可观测性">云原生下的可观测性</a></li>
    <li><a href="#拯救者opentelemetry">拯救者：OpenTelemetry</a></li>
    <li><a href="#opentelemetry-限制">OpenTelemetry 限制</a></li>
    <li><a href="#可观测性的未来方向">可观测性的未来方向</a></li>
    <li><a href="#阿里云-sls-在可观测性相关的工作">阿里云 SLS 在可观测性相关的工作</a></li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
</div>

            <!-- /toc -->
            
            <div class="subscribe-module col-12 mt-1">
    <img src="/img/wechat.jpg" alt="image" title="云原生社区的微信公众号"/>
    <p class="text-center pt-1">关注「云原生社区动态」微信公众号，获取本站更新</p>
</div>

            
        </div>
        <main class="article-body col-9 container docs-content" role="main">
            <article class="article">
                <div class="article-style">
                    
                    <details class="toc-inpage d-print-none d-show-block mb-0">
  <summary class="font-weight-bold">点击查看目录</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#可观测性的由来">可观测性的由来</a></li>
    <li><a href="#可观测性的未来">可观测性的未来</a></li>
    <li><a href="#自动驾驶的核心要素">自动驾驶的核心要素</a></li>
    <li><a href="#it-系统的可观测性">IT 系统的可观测性</a></li>
    <li><a href="#云原生下的可观测性">云原生下的可观测性</a></li>
    <li><a href="#拯救者opentelemetry">拯救者：OpenTelemetry</a></li>
    <li><a href="#opentelemetry-限制">OpenTelemetry 限制</a></li>
    <li><a href="#可观测性的未来方向">可观测性的未来方向</a></li>
    <li><a href="#阿里云-sls-在可观测性相关的工作">阿里云 SLS 在可观测性相关的工作</a></li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
</details>

                    
                    <p>非常有幸参加了云原生社区 Meetup 北京站，有机会和众多业内的大牛一起讨论云原生相关的技术和应用，本次 Meetup 上我和大家分享了关于云原生下的可观测性相关的议题，相关的视频可以移步《<a href="https://www.bilibili.com/video/BV1GK411g7dK" target="_blank" rel="noopener">B 站视频回放：云原生下的可观测性</a>》回看，本篇文章主要是视频的文字性总结，欢迎大家留言讨论。</p>
<h2 id="可观测性的由来">可观测性的由来</h2>
<p>可观测性最早来自于电气工程领域，主要原因是随着系统发展的逐步复杂，必须要有一套机制用来了解系统内部的运行状态以便更好的监控和问题修复，为此工程师们设计了很多传感器、仪表盘用于表现系统内部的状态。</p>
<blockquote>
<p>A system is said to be observable if, for any possible evolution of <a href="https://en.wikipedia.org/wiki/State_space_representation" target="_blank" rel="noopener">state and control vectors</a>, the current state can be estimated using only the information from outputs.</p>
</blockquote>
<p>电气工程发展了上百年，其中各个子领域的可观测性都在进行完善和升级，例如交通工具（汽车 / 飞机等）也算的是可观测性上的集大成者。抛开飞机这种超级工程不谈，一辆可正常上路的小型汽车内部也有上百种的传感器用来检测汽车内 / 外部的各种状态，以便让汽车可以稳定、舒适、安全地的行驶。</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsaewyj7j30df07dtdq_hu49764eab54d2209fa6dc29e3fae00093_35462_189148c7db4c5187f6963488b62e4d64.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsaewyj7j30df07dtdq_hu49764eab54d2209fa6dc29e3fae00093_35462_9d31f2d51abff12da036f037fc267cf3.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsaewyj7j30df07dtdq_hu49764eab54d2209fa6dc29e3fae00093_35462_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsaewyj7j30df07dtdq_hu49764eab54d2209fa6dc29e3fae00093_35462_189148c7db4c5187f6963488b62e4d64.webp"
               width="483"
               height="265"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="可观测性的未来">可观测性的未来</h2>
<p>随着上百年的发展，电气工程下的可观测性已经不仅仅用来辅助人们进行问题检查和定位问题，我们以汽车工程来看，整个可观测性的发展经历了几个过程：</p>
<ol>
<li>盲目：1886 年 1 月 29 日德国人卡尔・本茨发明了人类史上第一辆汽车，那个时候的汽车仅仅具备行驶的最基础能力，根本没有任何和可观测性相关的事情。</li>
<li>传感器：随着后来汽车开始正式进入市场，人们需要更好的知道汽车是不是没油了、没水了，因此基础的传感器仪表盘被发明出来。</li>
<li>告警：为了更好的保证汽车的形式安全性，人们开始使用自检和实时告警系统来主动向驾驶员通知一些异常信息，比如电瓶没电、水温过高、胎压低、刹车片磨损等。</li>
<li>辅助：虽然告警能够即时发出，但有时候人还是来不及处理或者不想处理，这时候辅助系统就派上了用场，例如定速巡航、主动安全、自主泊车等。这些辅助系统是把传感器 + 自动控制进行结合，能够部分解决驾驶员可能做不到或者不想做的事情。</li>
<li>自动驾驶：上述这些功能最终还是要人去参与，而自动驾驶可以完全不需要人的参与，直接是可观测性系统 + 控制系统就可以让汽车自动运行起来。</li>
</ol>
<h2 id="自动驾驶的核心要素">自动驾驶的核心要素</h2>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsahom53j315o0lk7uw_hucc7c4fe2c98a0ed305f0c56a1348c4b0_162587_022ae667ca89c9f97cdd4bad6f17cfef.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsahom53j315o0lk7uw_hucc7c4fe2c98a0ed305f0c56a1348c4b0_162587_380bc2c72175f532f0908da45a189d04.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsahom53j315o0lk7uw_hucc7c4fe2c98a0ed305f0c56a1348c4b0_162587_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsahom53j315o0lk7uw_hucc7c4fe2c98a0ed305f0c56a1348c4b0_162587_022ae667ca89c9f97cdd4bad6f17cfef.webp"
               width="760"
               height="393"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>作为电气工程上可观测性的巅峰，自动驾驶将汽车获取到的各类内外部数据发挥到极致，总结起来主要有几下几个核心的要素：</p>
<ol>
<li>丰富的数据源：汽车外围遍布多个激光 / 图像雷达，能够实现高帧率、360° 实时观测周围的物体及其状态；内部则能够实时知道当前的车速、车轮角度、胎压等信息，做到知彼知己。</li>
<li>数据集中化：相对辅助驾驶能力，自动驾驶的一个核心突破是能够将车内外的所有数据集中到一起去处理，真正发挥出数据的价值，而不是每个模块的数据作为孤岛进行独立运作。</li>
<li>强大算力：集中化的数据也意味着数据量的急剧膨胀，无论哪家自动驾驶背后都有强大的芯片支撑，只有足够的算力才能保证在最短的时间内可以进行足够的计算。</li>
<li>软件迭代：算力 + 算法构成了智能化的最终目标，然而算法不可能完美无瑕，我们会根据逐渐积累的自动驾驶数据不断进行算法的升级，使软件系统能够不断的升级以获得更佳的自动驾驶效果。</li>
</ol>
<h2 id="it-系统的可观测性">IT 系统的可观测性</h2>
<p>伴随着几十年的发展，IT 系统中的监控、问题排查也逐渐抽象为可观测性工程。在当时，最主流的方式还是使用 Metrics、Logging、Tracing 的组合。</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsaecgo3j30is0b4jtd_hu3de3616eee524c70e0cc59261020ac1f_37899_dcac109fe575933a747c3ec32183bf51.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsaecgo3j30is0b4jtd_hu3de3616eee524c70e0cc59261020ac1f_37899_bc2585044959d20bd13816d1b8c584ae.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsaecgo3j30is0b4jtd_hu3de3616eee524c70e0cc59261020ac1f_37899_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsaecgo3j30is0b4jtd_hu3de3616eee524c70e0cc59261020ac1f_37899_dcac109fe575933a747c3ec32183bf51.webp"
               width="676"
               height="400"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>上面这幅图详细大家非常熟悉，这是 Peter Bourgon 在参加完 2017 Distributed Tracing Summit 后发表的一篇博文，简洁扼要地介绍了 Metrics、Tracing、Logging 三者的定义和关系。这三种数据在可观测性中都有各自的发挥空间，每种数据都没办法完全被其他数据代替。</p>
<p>以 Grafana Loki 中介绍中的一个典型问题排查过程来看：</p>
<ol>
<li>最开始我们通过各式各样的预设报警发现异常（通常是Metrics/Logging）</li>
<li>发现异常后，打开监控大盘查找异常的曲线，并通过各种查询/统计找到异常的模块（Metrics）</li>
<li>对这个模块以及关联的日志进行查询/统计分析，找到核心的报错信息（Logging）</li>
<li>最后通过详细的调用链数据定位到引起问题的代码（Tracing）</li>
</ol>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsabpa1kj31420m8dss_hu6b939189a956c5da1bf54f4f62f7b1ed_132101_c87daaaae1667518fbfc140fbaa6023a.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsabpa1kj31420m8dss_hu6b939189a956c5da1bf54f4f62f7b1ed_132101_788c905c20ca277a5f2ead0c503ab13f.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsabpa1kj31420m8dss_hu6b939189a956c5da1bf54f4f62f7b1ed_132101_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsabpa1kj31420m8dss_hu6b939189a956c5da1bf54f4f62f7b1ed_132101_c87daaaae1667518fbfc140fbaa6023a.webp"
               width="760"
               height="422"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>上述例子介绍了如何使用 Metric、Tracing、Logging 去联合排查问题，当然根据不同的场景可以有不同的结合方案，例如简单的系统可以直接通过日志的错误信息去告警并直接定位问题，也可以根据调用链提取的基础指标（Latency、ErrorCode）触发告警。但整体而言，一个具有良好可观测性的系统必须具备上述三种数据。</p>
<h2 id="云原生下的可观测性">云原生下的可观测性</h2>
<p>云原生带来的不仅仅是应用部署能够部署云上而已，其整个的定义是一套新的 IT 系统架构升级，包括开发模式、系统架构、部署模式、基础设施全套的演进和迭代。</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsadyme7j315o0kzwp3_hu6ee8d7719a7d5ea1b8b48277752fd1e2_118253_a6c517807fb86850aa4b76f8014bbd1d.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsadyme7j315o0kzwp3_hu6ee8d7719a7d5ea1b8b48277752fd1e2_118253_b9a1acafa6882774a8610a17f522ca8a.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsadyme7j315o0kzwp3_hu6ee8d7719a7d5ea1b8b48277752fd1e2_118253_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsadyme7j315o0kzwp3_hu6ee8d7719a7d5ea1b8b48277752fd1e2_118253_a6c517807fb86850aa4b76f8014bbd1d.webp"
               width="760"
               height="383"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<ol>
<li>效率要求更高：随着 DevOps 模式的普及，规划、开发、测试、交付.. 的效率要求越来越高，而与之带来的问题是需要更加实时的知道此次的发布是否成功，出现了什么问题，问题在哪里，如何快速去解决。</li>
<li>系统更加复杂：架构从最开始的一体化发展到分层模式，到现在的微服务模式，架构的升级带来了开发效率、发布效率、系统灵活性、鲁棒性等优势，但随之而来系统的复杂度将更高，问题的定位将更加难。</li>
<li>环境动态性增强：无论是微服务的架构还是容器化的部署模式，带来的一个特性是环境的动态性会增强，每个实例的生命周期会更短，出现问题后往往现场已经被破坏，登录机器排查问题的方式已经不复存在。</li>
<li>上下游依赖更多：问题的定位最终都会从上下游来排查，在微服务、云、K8s 的环境中，上下游将更加多，包括各类其他业务应用、云上使用的各类产品、各种中间件、K8s 自身、容器运行时、虚拟机等等。</li>
</ol>
<h2 id="拯救者opentelemetry">拯救者：OpenTelemetry</h2>
<p>上述的这些问题相信很多读者都会深有体会，而业界也针对这种情况退出了各类可观测性相关的产品，包括开源、商业化的众多项目。例如：</p>
<ol>
<li>Metrics：Zabbix、Nagios、Prometheus、InfluxDB、OpenFalcon、OpenCensus</li>
<li>Tracing：Jaeger、Zipkin、SkyWalking、OpenTracing、OpenCensus</li>
<li>Logging：ELK、Splunk、SumoLogic、Loki、Loggly</li>
</ol>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsad11dyj30gb08678x_hu912d523760311966775ab52d3447d93c_43244_87c831a3bbc6d456ceabb329c847735a.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsad11dyj30gb08678x_hu912d523760311966775ab52d3447d93c_43244_8bd1b46038e406c6a8bea5576523ca19.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsad11dyj30gb08678x_hu912d523760311966775ab52d3447d93c_43244_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsad11dyj30gb08678x_hu912d523760311966775ab52d3447d93c_43244_87c831a3bbc6d456ceabb329c847735a.webp"
               width="587"
               height="294"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>利用这些项目的组合或多或少可以解决针对性的一类或者几类问题，但真正应用起来你会发现各种问题：</p>
<ol>
<li>多套方案交织：可能要使用至少 Metrics、Logging、Tracing3 种方案，维护代价巨大</li>
<li>数据不互通：虽然是同一个业务组件，同一个系统，产生的数据由于在不同的方案中，数据难以互通，无法充分发挥数据价值</li>
<li>厂商绑定：无论从数据采集、传输、存储、计算、可视化、告警等都可能会被厂商绑定，可观测性系统一旦上线后替换的代价讲巨大无比</li>
<li>云原生不友好：这些方案其中很多都是针对传统系统的，对于云原生的支持相对较弱，而且方案本身部署和使用代价都很高，不符合 “云原生” 这种一键部署、开箱即用的使用方式。</li>
</ol>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsah5yzmj30wc08gae3_hufc7e49c819f1ad75bf33295b9fe76c8e_39730_73ec588c80f89f985196a1cb70252c6b.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsah5yzmj30wc08gae3_hufc7e49c819f1ad75bf33295b9fe76c8e_39730_39b6f4e6706034dda88a0abbdcdcd8d0.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsah5yzmj30wc08gae3_hufc7e49c819f1ad75bf33295b9fe76c8e_39730_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsah5yzmj30wc08gae3_hufc7e49c819f1ad75bf33295b9fe76c8e_39730_73ec588c80f89f985196a1cb70252c6b.webp"
               width="760"
               height="198"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>在此背景下，云原生基金会 CNCF 下诞生了 OpenTelemetry 项目，旨在将 Logging、Tracing、Metrics 三者进行统一，实现数据的互通互操作。</p>
<blockquote>
<p>Create and collect telemetry data from your services and software, then forward them to a variety of analysis tools.</p>
</blockquote>
<p>OpenTelemetry 最核心的功能是产生、收集可观测性数据，并支持传输到各种的分析软件中，整体的架构如下图所属，其中 Library 用于产生统一格式的可观测性数据；Collector 用来接收这些数据，并支持把数据传输到各种类型的后端系统。</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsafamk9j315o0hx46t_hubc211b819bdf7e569d0419eb07aa891b_95955_1a0b46d4d13691fb74a22757880f14d8.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsafamk9j315o0hx46t_hubc211b819bdf7e569d0419eb07aa891b_95955_0a3ee6bd61b1c8565072cc23867fd049.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsafamk9j315o0hx46t_hubc211b819bdf7e569d0419eb07aa891b_95955_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsafamk9j315o0hx46t_hubc211b819bdf7e569d0419eb07aa891b_95955_1a0b46d4d13691fb74a22757880f14d8.webp"
               width="760"
               height="327"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>OpenTelemetry 给云原生下带来的革命性的进步，包括：</p>
<ol>
<li>统一协议：OpenTelemetry 为我们带来了 Metric、Tracing、Logging（正在制定中，LogModel 已经定义完毕）的统一标准，三者都有相同的元数据结构，可以轻松实现互相关联</li>
<li>统一 Agent：使用一个 Agent 即可完成所有可观测性数据的采集和传输，不需要为每个系统都部署各种各样的 Agent，大大降低了系统的资源占用，使整体可观测性系统的架构也变的更加简单</li>
<li>云原生友好：OpenTelemetry 诞生在 CNCF，对于各类的云原生下的系统支持更加友好，此外目前众多云厂商已经宣布支持 OpenTelemetry，未来云上的使用会更加便捷</li>
<li>厂商无关：此项目完全中立，不倾向于任何一家厂商，让大家可以有充分的自由来选择 / 更换适合自己的服务提供商，而不需要收到某些厂商的垄断或者绑定</li>
<li>兼容性：OpenTelemetry 得到了 CNCF 下各种可观测性方案的支持，未来对于 OpenTracing 类、OpenCensus、Prometheus、Fluntd 等都会有非常好的兼容性，可以方便大家无缝迁移到 OpenTelemetry 方案上。</li>
</ol>
<h2 id="opentelemetry-限制">OpenTelemetry 限制</h2>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsafux5gj315o0kv7fz_hu69c0262153efda3a08c2303d7aae4e17_99420_35da7b5bd9d7c07c740537019c92562d.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsafux5gj315o0kv7fz_hu69c0262153efda3a08c2303d7aae4e17_99420_69072590a198a37f5472daa629ddbed8.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsafux5gj315o0kv7fz_hu69c0262153efda3a08c2303d7aae4e17_99420_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsafux5gj315o0kv7fz_hu69c0262153efda3a08c2303d7aae4e17_99420_35da7b5bd9d7c07c740537019c92562d.webp"
               width="760"
               height="381"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>从上面的分析来看，OpenTelemetry 的定位是作为可观测性的基础设施，解决数据规范与获取的问题，后续部分依赖各个 Vendor 来实现。当然最佳的方式是能够有一个统一的引擎去存储所有的 Metrics、Logging、Tracing，有一个统一的平台去分析、展示、关联这些数据。目前的话还没有一个厂商能够非常好的支持 OpenTelemetry 的统一后端，现在还是需要自己去使用各个厂商的产品来实现。而这个带来的另一个问题是各个数据的关联会更加复杂，还需要去解决每个厂商之间的数据关联性问题。当然这个问题相信在 1-2 年肯定会解决掉，现在有众多厂商开始在努力实现 OpenTelemetry 所有类型数据的统一方案。</p>
<h2 id="可观测性的未来方向">可观测性的未来方向</h2>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsacga6sj30jk07t0yd_hub028f0292d0320f48c7dbf6fad3819ed_43494_75686f1ac9a6f33c6ea402d0f849c8dd.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsacga6sj30jk07t0yd_hub028f0292d0320f48c7dbf6fad3819ed_43494_89fd282adabe76d93f737c95cdd65424.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsacga6sj30jk07t0yd_hub028f0292d0320f48c7dbf6fad3819ed_43494_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsacga6sj30jk07t0yd_hub028f0292d0320f48c7dbf6fad3819ed_43494_75686f1ac9a6f33c6ea402d0f849c8dd.webp"
               width="704"
               height="281"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>我们团队从刚开始 09 年做飞天 5K 项目起，就一直在负责监控、日志、分布式链路追踪等可观测性相关的工作，中间经历过小型机到分布式系统再到微服务、云化的一些架构变更，相关的可观测性方案也经历了很多演变。我们觉得整体上可观测性相关的发展和自动驾驶等级的设定非常吻合。</p>
<p>自动驾驶一共分为 6 级，其中 0-2 级主要还是靠人来进行决定，到了等级 3 之后就可以进行无意识驾驶，也就是手眼可以暂时性不用关注驾驶，到了等级 5 的话人就可以完全脱离驾驶这个枯燥的工作，在车上可以自由活动。</p>
<p>在 IT 系统的可观测性上，也可以类似划分 6 级：</p>
<ul>
<li>等级 0：手工分析，依靠基础的 Dashboard、告警、日志查询、分布式链路追踪等方式进行手动告警、分析，也是目前绝大部分公司使用的场景</li>
<li>等级 1：智能告警，能够自动去扫描所有的可观测性数据，利用机器学习的方式去识别一些异常并进行自动告警，免去人工设置 / 调整各种基线告警的工作</li>
<li>等级 2：异常关联 + 统一视图，对于自动识别的异常，能够进行上下文的关联，形成一个统一的业务视图，便于快速的定位问题</li>
<li>等级 3：根因分析 + 问题自愈，自动根据异常以及系统的 CMDB 信息直接定位问题的根因，根因定位准确后那边可以去做问题的自愈。这一阶段相当于是一次质的飞跃，在某些场景下可以在人不用参与的情况下实现问题的自愈。</li>
<li>等级 4：故障预测，故障发生总会有损失，所以最好的情况是避免故障的发生，因此故障预测技术可以更好的来保证系统的可靠性，利用之前积累的一些故障先兆信息做到 “未卜先知”</li>
<li>等级 5：变更影响预测，我们知道绝大部分的故障都是由变更引起的，因此如果能够模拟出每个变更对系统带来的影响以及可能产生的问题，我们就能够提前评估出是否能够允许此次变更。</li>
</ul>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsadf9k4j315o0dewir_hu524aef5f65abbe78f134b23dd9c97629_58934_747d8c1714370f0f5f66c307fa6ed804.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsadf9k4j315o0dewir_hu524aef5f65abbe78f134b23dd9c97629_58934_d47d0860afae8d66b32288e61e35f8b2.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsadf9k4j315o0dewir_hu524aef5f65abbe78f134b23dd9c97629_58934_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsadf9k4j315o0dewir_hu524aef5f65abbe78f134b23dd9c97629_58934_747d8c1714370f0f5f66c307fa6ed804.webp"
               width="760"
               height="244"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="阿里云-sls-在可观测性相关的工作">阿里云 SLS 在可观测性相关的工作</h2>
<p>目前我们 SLS 正在开展云原生可观测性的工作，基于 OpenTelemetry 这个未来云原生下可观测性的标准，实现各类可观测性数据的统一收集，覆盖各个数据源和各类数据类型，做到多语言支持、多设备支持、类型统一；向上我们会提供能够支持各类可观测性数据的统一存储和计算能力，支持 PB 级存储、ETL、流计算、百亿级数据秒级分析，为上层算法提供强大的算力支撑；IT 系统的问题非常复杂，尤其涉及到不同的场景和架构，因此我们把算法和经验结合起来进行异常的分析，算法包括基础的统计学、逻辑性算法，也包括 AIOp 相关的算法，经验中包括人工输入的专家知识、网上上积累的各类问题解决方案以及外部产生的一些事件；最上层我们会提供一些辅助决策的功能，例如告警通知、数据可视化、Webhook 等，此外会提供丰富的外部集成能力，例如对接三方的可视化 / 分析 / 告警系统，提供 OpenAPI 以便不同的应用方集成。</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="" srcset="
               /blog/cloud-native-observability/0081Kckwly1gmdsagsxmij315o0n0dzu_hu82e625f8aee579ea125e68b635919264_180982_adde2dfd6869394e6f4f28a00dae7769.webp 400w,
               /blog/cloud-native-observability/0081Kckwly1gmdsagsxmij315o0n0dzu_hu82e625f8aee579ea125e68b635919264_180982_cdca458ee3bc7a1b789f49db51092b81.webp 760w,
               /blog/cloud-native-observability/0081Kckwly1gmdsagsxmij315o0n0dzu_hu82e625f8aee579ea125e68b635919264_180982_1200x1200_fit_q75_h2_lanczos.webp 1200w"
               src="/blog/cloud-native-observability/0081Kckwly1gmdsagsxmij315o0n0dzu_hu82e625f8aee579ea125e68b635919264_180982_adde2dfd6869394e6f4f28a00dae7769.webp"
               width="760"
               height="419"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="总结">总结</h2>
<p>作为 CNCF 下除了 Kubernetes 外最活跃的项目，OpenTelemetry 受到了各大云厂商以及相关解决方案公司的关注，相信未来一定会成为云原生下可观测性的标准。虽然目前还没有到生产可用的程度，但是目前各个语言的 SDK 和 Collector 也基本上稳定，在 2021 年就能够发布生产可用的版本，值得大家期待。</p>
<p>而 OpenTelemetry 只是定义了可观察的前半部分，后面还有非常多的复杂工作需要我们去实现，任重道远。</p>
<p>重点来了！！！！SLS 团队长期招聘人才，欢迎对大数据、监控、可观测性、前端可视化、移动端开发、机器学习等有兴趣的同学前来联系我:</p>
<ul>
<li>邮箱： <a href="mailto:davidzhang.zc@alibaba-inc.com">davidzhang.zc@alibaba-inc.com</a></li>
<li>微信： davidzhang-zc。</li>
<li>职位： <a href="https://cloudnative.to/job/aliyun-sls-observability/" target="_blank" rel="noopener">https://cloudnative.to/job/aliyun-sls-observability/</a></li>
</ul>
<h2 id="参考">参考</h2>
<ol>
<li><a href="https://opentelemetry.io/" target="_blank" rel="noopener">https://opentelemetry.io/</a></li>
<li><a href="https://developer.aliyun.com/article/766070" target="_blank" rel="noopener">https://developer.aliyun.com/article/766070</a></li>
<li><a href="https://aiopsworkshop.github.io/" target="_blank" rel="noopener">https://aiopsworkshop.github.io/</a></li>
<li><a href="https://landscape.cncf.io/" target="_blank" rel="noopener">https://landscape.cncf.io/</a></li>
<li><a href="https://www.instana.com/blog/observability-vs-monitoring/" target="_blank" rel="noopener">https://www.instana.com/blog/observability-vs-monitoring/</a></li>
</ol>

                </div>
                

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/%E5%8F%AF%E8%A7%82%E6%B5%8B%E6%80%A7/">可观测性</a>
  
</div>











  
  
    



  
  
  
  
  
  <div class="media author-card content-widget-hr mb-4">
    
      
      <a href="/author/%E5%BC%A0%E5%9F%8E%E5%85%83%E4%B9%99/"><img class="avatar mr-3 avatar-circle" src="/author/%E5%BC%A0%E5%9F%8E%E5%85%83%E4%B9%99/avatar_huf88d228543504cc3dec9558c88e976b2_17316_270x270_fill_q75_lanczos_center.jpg" alt="张城（元乙）"></a>
    

    <div class="media-body">
      <p class="card-title"><a href="/author/%E5%BC%A0%E5%9F%8E%E5%85%83%E4%B9%99/">张城（元乙）</a></p>
      
      <p class="card-text">阿里云技术专家，负责阿里巴巴集团、蚂蚁金服、阿里云等日志采集基础设施，服务数万内外部客户，日流量数十PB。同时负责云原生相关的日志/监控解决方案，包括系统组件，负载均衡，审计，安全，Service Mesh，事件，应用等监控方案。目前主要关注可观察性、AIOps、大规模分析引擎等方向。</p>
      
    </div>
  </div>


  





<div class="article-widget">
  
<div class="container-xl row post-nav">
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1" href="/blog/service-mesh-comparison-istio-vs-linkerd/" rel="next">
    <div class="meta-nav">下一页</div>
    <p>服务网格比较：Istio 与 Linkerd</p></a>
  
  
  
  <a class="col-6 post-nav-item btn btn-lg mb-md-1"  href="/blog/envoy-http-connection-management/" rel="prev">
    <div class="meta-nav">上一页</div>
    <p>Envoy HTTP 连接管理</p></a>
  
</div>

</div>










  

<p class="edit-page">
  <a href="https://github.com/cloudnativeto/cloudnative.to/edit/master/content/blog/cloud-native-observability/index.md">
    <i class="fas fa-pen pr-2"></i>编辑本页
  </a>
</p>




  
  
  <div class="article-widget content-widget-hr">
    <p class="related-title">相关推荐</p>
    <ul>
      
      <li><a href="/blog/analysis-of-delay-with-deepflow/">应用响应时延背后深藏的网络时延</a></li>
      
      <li><a href="/blog/troubleshooting-of-the-k8s-application-with-deepflow/">可观测性实战：快速定位 K8s 应用故障</a></li>
      
      <li><a href="/blog/grafana-plugins-on-cloud-observability/">可观测性场景下 Grafana Plugin 开发实战</a></li>
      
      <li><a href="/blog/k8s-service-exception-troubleshooting/">Kubernetes 服务异常排障过程全解密</a></li>
      
      <li><a href="/blog/skywalking-shardingsphere-proxy/">SkyWalking 基于 ShardingSphere-Proxy 的 MySQL-Sharding 分库分表的存储特性介绍</a></li>
      
    </ul>
  </div>
  





  
  
  

  

  
  <section id="comments" class="mb-3 pt-0">
    <script>
  let themeNumber = localStorage.getItem('wcTheme');
  var giscusTheme = "light";
  if (themeNumber == 1){
    giscusTheme = "dark";
  }
  let giscusAttributes = {
    "src": "https://giscus.app/client.js",
    "data-theme": giscusTheme,
    "data-repo":"cloudnativeto\/cloudnative.to",
    "data-repo-id":"MDEwOlJlcG9zaXRvcnkyMzc3NDUxOTA=",
    "data-category":"General",
    "data-category-id":"MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMDU5MzUy",
    "data-mapping":"pathname",
    "data-reactions-enabled":"",
    "data-emit-metadata":"0",
    "data-input-position":"top",
    "data-theme":giscusTheme,
    "data-lang":"zh-CN",
    "data-loading":"lazy",
    "crossorigin":"annoymous",
    "origins":"https://cloudnative.to",
    "originsRegex":"http://localhost:[0-9]+",
    "async": "",
  };

  let giscusScript = document.createElement("script");
  Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
  document.querySelector('#comments').appendChild(giscusScript);
</script>

  </section>
  



            </article>
        </main>
    </div>
</div>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  
  <div class="copyright py-4 bg-footer">
      <div class="row justify-content-center">
        <div class="text-center footer-color">
          <p class="mb-0">© 2020-2023 云原生社区保留所有权利</p>
        </div>
    </div>
  </div>

</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.46271ef31da3f018e9cd1b59300aa265.js"></script>




  

  
  

  

  
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.1/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
    
    
  










  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <div class="article-metadata search-hit-type">{{relpermalink}}</div>
          <a href="{{relpermalink}}">{{title}}</a>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  







<script id="page-data" type="application/json">{"use_headroom":false}</script>










  
  


<script src="/zh/js/wowchemy.min.24983018b0e5661cd5fe1822254286ea.js"></script>







<script>

var mybutton = document.getElementById("backTopBtn");


window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}


function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>






<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>



<script>



(function() {
  'use strict';

  if(!document.queryCommandSupported('copy')) {
    return;
  }

  function flashCopyMessage(el, msg) {
    el.className = "highlight-copy-btn";
    el.textContent = msg;
    setTimeout(function() {
      el.textContent = "";
      el.className = "highlight-copy-btn fa fa-copy";
    }, 1000);
  }

  function selectText(node) {
    var selection = window.getSelection();
    var range = document.createRange();
    range.selectNodeContents(node);
    selection.removeAllRanges();
    selection.addRange(range);
    return selection;
  }

  function addCopyButton(containerEl) {
    var copyBtn = document.createElement("button");
    copyBtn.className = "highlight-copy-btn fa fa-copy";
    copyBtn.textContent = "";

    var codeEl = containerEl.firstElementChild;
    copyBtn.addEventListener('click', function() {
      try {
        var selection = selectText(codeEl);
        document.execCommand('copy');
        selection.removeAllRanges();
        
        flashCopyMessage(copyBtn, '已复制')
        
      } catch(e) {
        console && console.log(e);
        flashCopyMessage(copyBtn, 'Failed :\'(')
      }
    });

    containerEl.appendChild(copyBtn);
  }

  
  var highlightBlocks = document.getElementsByClassName('highlight');
  Array.prototype.forEach.call(highlightBlocks, addCopyButton);
})();
</script>



<script>

function Collapse(e){
  var node = document.getElementById(e);
  if (node.className.indexOf('fa-angle-down') > -1){
    node.setAttribute("class", "fa-solid fa-angle-right");
    }else{
    node.setAttribute("class", "fa-solid fa-angle-down");
    }
}
</script>


</body>
</html>
