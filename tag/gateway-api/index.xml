<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Gateway API | äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰</title>
    <link>https://cloudnativecn.com/tag/gateway-api/</link>
      <atom:link href="https://cloudnativecn.com/tag/gateway-api/index.xml" rel="self" type="application/rss+xml" />
    <description>Gateway API</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Fri, 09 May 2025 10:35:46 +0800</lastBuildDate>
    <image>
      <url>https://cloudnativecn.com/media/sharing.png</url>
      <title>Gateway API</title>
      <link>https://cloudnativecn.com/tag/gateway-api/</link>
    </image>
    
    <item>
      <title>Istio 1.26 å‘å¸ƒï¼šå¢å¼º Gateway API æ”¯æŒï¼Œæ‹¥æŠ± Kubernetes æœªæ¥ â€”â€” åŒæ—¶å‘Šåˆ« 1.23 ç‰ˆæœ¬</title>
      <link>https://cloudnativecn.com/blog/istio-1-26-release-and-1-23-eol/</link>
      <pubDate>Fri, 09 May 2025 10:35:46 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/istio-1-26-release-and-1-23-eol/</guid>
      <description>&lt;p&gt;2025å¹´5æœˆ8æ—¥ï¼ŒIstio ç¤¾åŒºæ­£å¼å‘å¸ƒäº† &lt;strong&gt;Istio 1.26&lt;/strong&gt;ã€‚è¿™æ˜¯ä¸€æ¬¡åœ¨åŠŸèƒ½ã€å¯æ‰©å±•æ€§ã€å®‰å…¨æ€§ä¸å¹³å°é€‚é…æ€§æ–¹é¢å…¨é¢æå‡çš„é‡è¦æ›´æ–°ã€‚ä¸æ­¤åŒæ—¶ï¼ŒIstio 1.23 ä¹Ÿæ­£å¼åœæ­¢ç»´æŠ¤ï¼Œæ ‡å¿—ç€è¿™ä¸€ä¸»æµç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸæ­£å¼ç»“æŸã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸€istio-126-æ–°ç‰¹æ€§é€Ÿè§ˆ&#34;&gt;ä¸€ã€Istio 1.26 æ–°ç‰¹æ€§é€Ÿè§ˆ&lt;/h2&gt;
&lt;h3 id=&#34;1-gateway-api-è‡ªåŠ¨èµ„æºæ”¯æŒå…¨é¢å¯é…ç½®&#34;&gt;1. Gateway API è‡ªåŠ¨èµ„æºæ”¯æŒå…¨é¢å¯é…ç½®&lt;/h3&gt;
&lt;p&gt;åœ¨ Istio 1.26 ä¸­ï¼Œç”¨æˆ·ç»ˆäºå¯ä»¥é€šè¿‡ ConfigMap è‡ªå®šä¹‰ç”± Gateway API è‡ªåŠ¨ç”Ÿæˆçš„èµ„æºï¼Œä¾‹å¦‚ &lt;code&gt;Service&lt;/code&gt;ã€&lt;code&gt;Deployment&lt;/code&gt;ã€&lt;code&gt;HorizontalPodAutoscaler&lt;/code&gt; å’Œ &lt;code&gt;PodDisruptionBudget&lt;/code&gt;ã€‚è¿™ä½¿å¾—è¿ç»´å’Œç½‘å…³éƒ¨ç½²ç­–ç•¥æ›´çµæ´»ï¼Œæ˜¾è‘—æå‡äº†ç”Ÿäº§å¯ç”¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¯¦è§æ–‡æ¡£ï¼š&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/ingress/gateway-api/#automated-deployment&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•è‡ªå®šä¹‰ Gateway è‡ªåŠ¨éƒ¨ç½²çš„èµ„æº&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;2-ambient-æ¨¡å¼ä¸‹æ”¯æŒ-tcproute&#34;&gt;2. Ambient æ¨¡å¼ä¸‹æ”¯æŒ TCPRoute&lt;/h3&gt;
&lt;p&gt;Ambient æ¨¡å¼ä¸‹çš„ Waypoint ä»£ç†ç°åœ¨æ”¯æŒ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/guides/tcp/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API çš„ &lt;code&gt;TCPRoute&lt;/code&gt;&lt;/a&gt;ï¼Œè®© TCP å±‚æµé‡çš„ç²¾ç»†æ§åˆ¶æˆä¸ºå¯èƒ½ï¼Œè¿›ä¸€æ­¥æå‡äº† L4 å±‚é¢çš„å¯è§‚æµ‹ä¸æ§åˆ¶èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼ŒIstio è¿˜å¼•å…¥äº† Gateway API v1.3 çš„å®éªŒæ€§ç‰¹æ€§ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/backendtlspolicy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;BackendTLSPolicy&lt;/code&gt;&lt;/a&gt; ä¸ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/backendtrafficpolicy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;BackendTrafficPolicy&lt;/code&gt;&lt;/a&gt;ï¼Œä¸ºæœªæ¥çš„é‡è¯•ã€åç«¯è®¤è¯æ§åˆ¶é“ºå¹³é“è·¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;3-æ”¯æŒ-kubernetes-æ–°ç‰¹æ€§-clustertrustbundle&#34;&gt;3. æ”¯æŒ Kubernetes æ–°ç‰¹æ€§ ClusterTrustBundle&lt;/h3&gt;
&lt;p&gt;Istio 1.26 å¢åŠ äº†å¯¹ Kubernetes å®éªŒæ€§ç‰¹æ€§ &lt;a href=&#34;https://kubernetes.io/docs/reference/access-authn-authz/certificate-signing-requests/#cluster-trust-bundles&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;ClusterTrustBundle&lt;/code&gt;&lt;/a&gt; çš„æ”¯æŒï¼Œè¿™æ˜¯é›†ç¾¤é—´ä¿¡ä»»ç®¡ç†çš„é‡è¦ä¸€æ­¥ï¼Œæœªæ¥æœ‰æœ›æ›¿ä»£ä¼ ç»Ÿ CA æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;4-istioctl-å·¥å…·å¢å¼º&#34;&gt;4. istioctl å·¥å…·å¢å¼º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;istioctl analyze&lt;/code&gt; ç°åœ¨æ”¯æŒæŒ‡å®šæŸä¸ªæ£€æŸ¥é¡¹ï¼Œä¾¿äºé›†æˆè‡ªåŠ¨åŒ–æ£€æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;å¢åŠ  &lt;code&gt;--tls-server-name&lt;/code&gt; æ”¯æŒï¼Œä¾¿äºç”Ÿæˆå¯ç”¨äºç‰¹å®šç½‘å…³åŸŸåçš„ kubeconfigã€‚&lt;/li&gt;
&lt;li&gt;å¤šé¡¹ CLI å‘½ä»¤ä¿®å¤ä¸å¢å¼ºï¼Œæå‡å®‰è£…ä¸è°ƒè¯•ä½“éªŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;5-å®‰è£…ä¸å¹³å°é€‚é…æ”¹è¿›&#34;&gt;5. å®‰è£…ä¸å¹³å°é€‚é…æ”¹è¿›&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ GKE ä¸­è‡ªåŠ¨é…ç½® &lt;code&gt;ResourceQuota&lt;/code&gt; ä¸ &lt;code&gt;cniBinDir&lt;/code&gt;ï¼Œæå‡å…¼å®¹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;istio-cni&lt;/code&gt; ä¸å†é»˜è®¤ä½¿ç”¨ &lt;code&gt;hostNetwork&lt;/code&gt;ï¼Œé™ä½ç«¯å£å†²çªé£é™©ã€‚&lt;/li&gt;
&lt;li&gt;Helm Chart ä¸­æ–°å¢æ”¯æŒè®¾ç½® &lt;code&gt;loadBalancerClass&lt;/code&gt;ã€&lt;code&gt;updateStrategy&lt;/code&gt;ã€&lt;code&gt;ConfigMap&lt;/code&gt; ç­‰å…³é”®å‚æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;6-envoyfilter-å’Œ-retry-ç­–ç•¥å¢å¼º&#34;&gt;6. EnvoyFilter å’Œ Retry ç­–ç•¥å¢å¼º&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;EnvoyFilter&lt;/code&gt; ç°å¯åŸºäº &lt;code&gt;VirtualHost&lt;/code&gt; çš„åŸŸåè¿›è¡ŒåŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒé…ç½®é‡è¯•çš„ backoff é—´éš”ä¸ host predicateã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¦ç»†æ”¹åŠ¨è¯·å‚è€ƒå®˜æ–¹&lt;a href=&#34;https://istio.io/latest/news/releases/1.26.x/announcing-1.26/change-notes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®Œæ•´å˜æ›´æ—¥å¿—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äºŒistio-123-æ­£å¼åœæ­¢æ”¯æŒ&#34;&gt;äºŒã€Istio 1.23 æ­£å¼åœæ­¢æ”¯æŒ&lt;/h2&gt;
&lt;p&gt;æ ¹æ® &lt;a href=&#34;https://istio.io/latest/news/support/announcing-1.23-eol-final/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®˜æ–¹å…¬å‘Š&lt;/a&gt;ï¼Œè‡ª 2025 å¹´ 4 æœˆ 16 æ—¥èµ·ï¼ŒIstio 1.23 ç‰ˆæœ¬å·²åœæ­¢ç»´æŠ¤ï¼Œä¸å†æ¥æ”¶å®‰å…¨æ¼æ´ä¸å…³é”® Bug ä¿®å¤ã€‚å»ºè®®ä»åœ¨ä½¿ç”¨è¯¥ç‰ˆæœ¬çš„ç”¨æˆ·å°½å¿«å‡çº§è‡³ Istio 1.26 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰æ¨èå…³æ³¨çš„ç¤¾åŒºå†…å®¹&#34;&gt;ä¸‰ã€æ¨èå…³æ³¨çš„ç¤¾åŒºå†…å®¹&lt;/h2&gt;
&lt;p&gt;è‹¥ä½ å¸Œæœ›æ·±å…¥äº†è§£ Ambient æ¨¡å¼åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„è¡¨ç°ã€å®‰å…¨æ€§ä¸æ€§èƒ½æ¯”è¾ƒï¼Œå»ºè®®é˜…è¯»ä»¥ä¸‹ Istio å®˜æ–¹åšå®¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/blog/2025/ztunnel-security-assessment/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ztunnel å®‰å…¨æ€§è¯„ä¼°æŠ¥å‘Š&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/blog/2025/ambient-performance/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambient æ¨¡å¼ vs å†…æ ¸æ—è·¯æ€§èƒ½å¯¹æ¯”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/blog/2025/istio-at-kubecon-eu/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åœ¨ KubeCon EU çš„æŠ€æœ¯åˆ†äº«&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å››å‡çº§å»ºè®®ä¸åé¦ˆé€šé“&#34;&gt;å››ã€å‡çº§å»ºè®®ä¸åé¦ˆé€šé“&lt;/h2&gt;
&lt;p&gt;æœ¬æ¬¡å‘å¸ƒæ”¯æŒ Kubernetes 1.29 è‡³ 1.32ï¼ˆé¢„è®¡å…¼å®¹ 1.33ï¼‰ï¼Œå¦‚è®¡åˆ’å‡çº§è‡³ 1.26ï¼Œè¯·æå‰å‚è€ƒ &lt;a href=&#34;https://istio.io/latest/news/releases/1.26.x/announcing-1.26/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‡çº§æŒ‡å—&lt;/a&gt;ã€‚å¦‚é‡é—®é¢˜æˆ–å¸Œæœ›æä¾›åé¦ˆï¼Œå¯åŠ å…¥ &lt;a href=&#34;https://slack.istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio Slack ç¤¾åŒº&lt;/a&gt;ï¼Œè¿›å…¥ &lt;code&gt;#release-1.26&lt;/code&gt; é¢‘é“å‚ä¸è®¨è®ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº”å†™åœ¨æœ€å&#34;&gt;äº”ã€å†™åœ¨æœ€å&lt;/h2&gt;
&lt;p&gt;Istio 1.26 æ ‡å¿—ç€ Ambient æ¨¡å¼ä»â€œå®éªŒæ€§â€èµ°å‘æ›´æˆç†Ÿé˜¶æ®µï¼Œä¹Ÿæ˜¯ Istio ä¸ Kubernetes æ·±åº¦é›†æˆçš„åˆä¸€é‡Œç¨‹ç¢‘ã€‚ä½œä¸ºäº‘åŸç”Ÿç½‘ç»œçš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼ŒIstio å°†æŒç»­æ¨åŠ¨é¢å‘æœåŠ¡çš„æµé‡æ²»ç†ã€å®‰å…¨ä¸å¯è§‚æµ‹æ€§æ¼”è¿›ã€‚&lt;/p&gt;
&lt;p&gt;æ¬¢è¿å¤§å®¶å‚ä¸æµ‹è¯•ã€åé¦ˆä½“éªŒï¼Œè´¡çŒ®ä»£ç æˆ–æ–‡æ¡£ï¼Œä¸ºå¼€æºä¸–ç•Œæ·»ç –åŠ ç“¦ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ğŸ‘‰ å»¶ä¼¸é˜…è¯»ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/news/releases/1.26.x/announcing-1.26/change-notes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ğŸ“ƒ Istio 1.26 å˜æ›´æ—¥å¿—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/news/releases/1.26.x/announcing-1.26/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;âš™ï¸ Istio 1.26 å‡çº§æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/news/support/announcing-1.23-eol-final/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ğŸ“Œ Istio 1.23 EOL æœ€ç»ˆå…¬å‘Š&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>æ·±å…¥è§£æ Gateway API Inference Extensionï¼ˆæ¨ç†æ‰©å±•ï¼‰</title>
      <link>https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/</link>
      <pubDate>Tue, 22 Apr 2025 15:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/</guid>
      <description>&lt;p&gt;åœ¨ Kubernetes ä¸Šè¿è¡Œ AI æ¨ç†å·¥ä½œè´Ÿè½½å…·æœ‰ä¸€äº›ç‹¬ç‰¹çš„ç‰¹ç‚¹å’ŒæŒ‘æˆ˜ï¼ŒGateway API Inference Extension é¡¹ç›®æ—¨åœ¨è§£å†³å…¶ä¸­çš„ä¸€äº›é—®é¢˜ã€‚æˆ‘æœ€è¿‘åœ¨ &lt;a href=&#34;https://kgateway.dev/blog/smarter-ai-reference-kubernetes-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kgateway é¡¹ç›®&lt;/a&gt; ä¸­å†™è¿‡å…³äºè¿™äº›æ–°èƒ½åŠ›çš„æ–‡ç« ï¼Œè€Œæœ¬æ–‡å°†æ·±å…¥è®²è§£å…¶å·¥ä½œåŸç†ã€‚&lt;/p&gt;
&lt;p&gt;å¤§å¤šæ•°äººå°† Kubernetes ä¸­çš„è¯·æ±‚è·¯ç”±ç†è§£ä¸ºåŸºäº Gateway APIã€Ingress æˆ– Service Meshï¼ˆç»Ÿç§°ä¸º L7 è·¯ç”±å™¨ï¼‰çš„æœºåˆ¶ã€‚è¿™äº›å®ç°çš„åŸç†ç±»ä¼¼ï¼šä½ å®šä¹‰ä¸€äº›æ ¹æ®è¯·æ±‚å±æ€§ï¼ˆå¦‚ headerã€path ç­‰ï¼‰è¿›è¡ŒåŒ¹é…çš„è·¯ç”±è§„åˆ™ï¼ŒL7 è·¯ç”±å™¨ä¼šåŸºäºè¿™äº›è§„åˆ™å†³å®šè¯·æ±‚åº”å‘é€åˆ°å“ªä¸ªåç«¯ï¼Œå¹¶ä½¿ç”¨æŸç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆå¦‚ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/load_balancing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è½®è¯¢ã€æœ€å°‘è¯·æ±‚ã€ç¯å“ˆå¸Œã€åŒºåŸŸæ„ŸçŸ¥ã€ä¼˜å…ˆçº§&lt;/a&gt; ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è´Ÿè½½å‡è¡¡ç®—æ³•&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è´Ÿè½½å‡è¡¡ç®—æ³•&#34; srcset=&#34;
               /blog/gateway-api-inference-extension-deep-dive/f0_hu_23d316aa77a75702.webp 400w,
               /blog/gateway-api-inference-extension-deep-dive/f0_hu_eedd08f6f7565af.webp 760w,
               /blog/gateway-api-inference-extension-deep-dive/f0_hu_e74b667536db7155.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/f0_hu_23d316aa77a75702.webp&#34;
               width=&#34;760&#34;
               height=&#34;517&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è´Ÿè½½å‡è¡¡ç®—æ³•
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä¼ ç»Ÿçš„è´Ÿè½½å‡è¡¡ç®—æ³•å¹¶ä¸é€‚åˆ AI/LLM æ¨¡å‹åç«¯ã€‚ä¸å…¸å‹çš„æ— çŠ¶æ€ Web API ä¸åŒï¼ŒåŸºäº GPU çš„ LLM è¿è¡Œæ–¹å¼ç‰¹æ®Šï¼Œå¤„ç†æ–¹å¼ä¸å½“å°†å¯¼è‡´èµ„æºæµªè´¹ä¸é«˜æˆæœ¬ã€‚å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨æ¨¡å‹å’Œ GPU çš„å®æ—¶æŒ‡æ ‡åšå‡ºæ›´æ™ºèƒ½çš„è·¯ç”±ä¸è´Ÿè½½å‡è¡¡å†³ç­–ï¼Œä¼šæ€æ ·ï¼Ÿä¾‹å¦‚ï¼Œå½“æŸä¸ªåç«¯ LLM å·²åŠ è½½æŸä¸ªç‰¹å®šçš„ LoRA å¾®è°ƒé€‚é…å™¨æ—¶ï¼Œç›¸å…³è¯·æ±‚åº”è¯¥ä¼˜å…ˆè·¯ç”±è‡³è¯¥å®ä¾‹ï¼Œä»¥é¿å…å…¶ä»–å®ä¾‹å› åŠ¨æ€åŠ è½½é€‚é…å™¨è€Œæµªè´¹ GPU æ—¶é—´ã€‚å†å¦‚ï¼Œå½“æŸä¸ªåç«¯è¯·æ±‚é˜Ÿåˆ—å·²ç§¯å‹è¿‡å¤šï¼Œè¯·æ±‚ç»§ç»­å‘é€åªä¼šæ‹–æ…¢å“åº”ã€‚å¦‚æœæ‰€æœ‰åç«¯éƒ½å·²é¥±å’Œï¼Œæ˜¯å¦å¯ä»¥å¯ç”¨â€œè´Ÿè½½ä¸¢å¼ƒâ€æœºåˆ¶ï¼Œä¿éšœç³»ç»Ÿç¨³å®šï¼Ÿ&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å®ç°è´Ÿè½½ä¸¢å¼ƒ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å®ç°è´Ÿè½½ä¸¢å¼ƒ&#34; srcset=&#34;
               /blog/gateway-api-inference-extension-deep-dive/f1_hu_61f7f8878282ae88.webp 400w,
               /blog/gateway-api-inference-extension-deep-dive/f1_hu_7626eca0698c0896.webp 760w,
               /blog/gateway-api-inference-extension-deep-dive/f1_hu_44d7d76e07fcd2ad.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/f1_hu_61f7f8878282ae88.webp&#34;
               width=&#34;760&#34;
               height=&#34;500&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å®ç°è´Ÿè½½ä¸¢å¼ƒ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™æ­£æ˜¯ &lt;a href=&#34;https://gateway-api-inference-extension.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API Inference Extension&lt;/a&gt; é¡¹ç›®æ‰€å®ç°çš„åŠŸèƒ½ã€‚å®ƒå¼•å…¥äº†ä¸¤ä¸ªæ–°çš„ Kubernetes CRDï¼š&lt;a href=&#34;https://gateway-api-inference-extension.sigs.k8s.io/concepts/api-overview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;InferenceModel å’Œ InferencePool&lt;/a&gt;ï¼Œå¹¶æå‡ºäº†â€œendpoint pickerï¼ˆç«¯ç‚¹é€‰æ‹©å™¨ï¼‰â€çš„æ¦‚å¿µï¼Œå¯ä»¥æ‰©å±• L7 è·¯ç”±èƒ½åŠ›ã€‚è¯¥é€‰æ‹©å™¨å¯ä»¥ç»“åˆåº•å±‚ LLM çš„æŒ‡æ ‡åšå‡ºæ›´åˆç†çš„è·¯ç”±å†³ç­–ï¼Œæ”¯æŒé¡¹ç›®å¦‚ &lt;a href=&#34;https://kgateway.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kgateway&lt;/a&gt; å’Œ &lt;a href=&#34;https://istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio&lt;/a&gt; çš„é›†æˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¨ç†æ‰©å±•å¦‚ä½•æ‰©å±•-gateway-api&#34;&gt;æ¨ç†æ‰©å±•å¦‚ä½•æ‰©å±• Gateway API&lt;/h2&gt;
&lt;p&gt;Gateway API Inference Extension å¼•å…¥äº†ä¸¤ä¸ªæ–°çš„è‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼ˆCRDï¼‰ï¼š&lt;code&gt;InferenceModel&lt;/code&gt; å’Œ &lt;code&gt;InferencePool&lt;/code&gt;ã€‚ç»“åˆç«¯ç‚¹é€‰æ‹©å™¨ä½¿ç”¨ï¼Œå¯å°†ç°æœ‰ L7 è·¯ç”±æ¶æ„å‡çº§ä¸ºâ€œæ¨ç†ç½‘å…³â€ï¼Œä»¥æ”¯æŒè‡ªæ‰˜ç®¡çš„å¤§æ¨¡å‹/ç”Ÿæˆå¼ AIï¼ˆGenAIï¼‰æœåŠ¡ï¼Œé‡‡ç”¨â€œæ¨¡å‹å³æœåŠ¡â€çš„æ¶æ„ç†å¿µã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gateway-api-inference-extension.sigs.k8s.io/api-types/inferencemodel/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;InferenceModel CRD&lt;/a&gt; ä¸»è¦é¢å‘ AI å·¥ç¨‹å¸ˆï¼Œç”¨äºå®šä¹‰é€»è¾‘æ¨¡å‹çš„æ¨ç†å…¥å£ã€‚å®ƒæ”¯æŒå°†ç”¨æˆ·å¯è§çš„æ¨¡å‹åæ˜ å°„åˆ°å®é™…åç«¯æ¨¡å‹ï¼Œå¹¶æ”¯æŒåœ¨å¤šä¸ªå¾®è°ƒæ¨¡å‹ä¹‹é—´è¿›è¡Œæµé‡åˆ‡åˆ†ã€‚ä¾‹å¦‚ï¼Œä½ æƒ³å°†æ¨¡å‹ &lt;code&gt;llama2&lt;/code&gt; æä¾›ç»™ç”¨æˆ·ï¼Œè€Œå®é™…åç«¯æ¨¡å‹å¯èƒ½å«åš &lt;code&gt;vllm-llama2-7b-2024-11-20&lt;/code&gt; æˆ– &lt;code&gt;vllm-llama2-7b-2025-03-24&lt;/code&gt;ï¼Œä½¿ç”¨ InferenceModel å³å¯å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;inference.networking.x-k8s.io/v1alpha2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;InferenceModel&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;inferencemodel-llama2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;modelName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;llama2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;criticality&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Critical&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;poolRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b-pool&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;targetModels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b-2024-11-20&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;75&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b-2025-03-24&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å¤–ï¼Œå®ƒè¿˜å…è®¸å·¥ä½œè´Ÿè½½æ‰€æœ‰è€…ä¸ºè¯·æ±‚æŒ‡å®šâ€œé‡è¦æ€§ç­‰çº§â€ï¼Œç¡®ä¿å®æ—¶æœåŠ¡ä¼˜å…ˆäºæ‰¹é‡å¤„ç†ä»»åŠ¡ã€‚åç»­æˆ‘ä»¬ä¼šçœ‹åˆ°è¯¥è®¾ç½®å¦‚ä½•ç»“åˆ LLM å®æ—¶æŒ‡æ ‡è¿›è¡Œè°ƒåº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://gateway-api-inference-extension.sigs.k8s.io/api-types/inferencepool/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;InferencePool CRD&lt;/a&gt; åˆ™é¢å‘å¹³å°è¿ç»´äººå‘˜ï¼Œè¡¨ç¤ºä¸€ç»„æ¨¡å‹æœåŠ¡å®ä¾‹ï¼Œæ˜¯ AI å·¥ä½œè´Ÿè½½çš„åç«¯æœåŠ¡ã€‚å€ŸåŠ©è¯¥ CRï¼Œå¯å°† HTTPRoute è¯·æ±‚è·¯ç”±è‡³ä¸€ä¸ªæ¨ç†å®ä¾‹æ± ï¼Œå¹¶é€šè¿‡å®šä¹‰ &lt;code&gt;endpoint picker&lt;/code&gt; å®ç°æ ¹æ®å®æ—¶æŒ‡æ ‡ï¼ˆå¦‚è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ã€GPU å†…å­˜ä½¿ç”¨ç­‰ï¼‰åšå‡ºæ™ºèƒ½å†³ç­–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;inference.networking.x-k8s.io/v1alpha2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;InferencePool&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b-pool&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;targetPortNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8000&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;extensionRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b-endpoint-picker&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¦å®ç°ä»æ¨ç†ç½‘å…³åˆ° LLM åç«¯çš„æµé‡è½¬å‘ï¼Œéœ€å®šä¹‰ä¸€ä¸ªå°†æµé‡å¼•å¯¼è‡³ InferencePool çš„ HTTPRouteï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;llm-route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;inference-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;inference.networking.x-k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;InferencePool&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;vllm-llama2-7b&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€æ—¦è¯·æ±‚åˆ°è¾¾æ¨ç†ç½‘å…³ï¼ŒåŒ¹é…è§„åˆ™åå°†è½¬å‘è‡³ InferencePoolï¼Œæ­¤æ—¶è¯·æ±‚ä¼šé¦–å…ˆè¿›å…¥ä¸€ä¸ªåä¸º â€œEndpoint Selection Extensionâ€ï¼ˆESEï¼‰çš„ç»„ä»¶ã€‚è¿™ä¸ª ESE æ ¹æ® LLM çš„å®æ—¶æŒ‡æ ‡æ¥é€‰æ‹©å…·ä½“çš„åç«¯ Podã€‚æˆ‘ä»¬æ¥æ·±å…¥äº†è§£å…¶å·¥ä½œæœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç«¯ç‚¹é€‰æ‹©æœºåˆ¶è¯¦è§£&#34;&gt;ç«¯ç‚¹é€‰æ‹©æœºåˆ¶è¯¦è§£&lt;/h2&gt;
&lt;p&gt;å½“è¯·æ±‚åˆ°è¾¾ Endpoint Selection Extensionï¼ˆESEï¼‰æ—¶ï¼Œå®ƒä¼šä»è¯·æ±‚ä½“ä¸­æå– &lt;code&gt;modelName&lt;/code&gt; å­—æ®µï¼Œç›®å‰è¯¥è¯·æ±‚ä½“éœ€ç¬¦åˆ &lt;a href=&#34;https://platform.openai.com/docs/api-reference/chat/create&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenAI API æ ¼å¼&lt;/a&gt;ã€‚è¯†åˆ«å‡ºæ¨¡å‹ååï¼ŒESE ä¼šæ¯”å¯¹ç°æœ‰çš„ InferenceModel èµ„æºï¼Œå®šä½å¯¹åº”çš„åç«¯æ¨¡å‹åæˆ– LoRA å¾®è°ƒé€‚é…å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚è¯·æ±‚ä¸­æŒ‡å®šäº† &lt;code&gt;llama2&lt;/code&gt;ï¼ŒESE ä¼šæŸ¥æ‰¾å¹¶é€‰æ‹©å¯¹åº”çš„åç«¯æ¨¡å‹ï¼Œå¦‚ &lt;code&gt;vllm-llama2-7b-2024-11-20&lt;/code&gt; æˆ– &lt;code&gt;vllm-llama2-7b-2025-03-24&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é€‰æ‹©åç«¯çš„é€»è¾‘ç”±ä¸€ç³»åˆ—â€œè¿‡æ»¤å™¨â€ç»„æˆï¼ŒESE ä¼šä¾æ¬¡è¯„ä¼°ä»¥ä¸‹æŒ‡æ ‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¯·æ±‚çš„å…³é”®æ€§ï¼ˆCritical æˆ– Sheddableï¼‰&lt;/li&gt;
&lt;li&gt;LLM çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦&lt;/li&gt;
&lt;li&gt;LoRA é€‚é…å™¨æ˜¯å¦å·²åŠ è½½&lt;/li&gt;
&lt;li&gt;KV ç¼“å­˜å ç”¨ç‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è¯„ä¼°æµç¨‹å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è¯„ä¼°æµç¨‹å›¾&#34; srcset=&#34;
               /blog/gateway-api-inference-extension-deep-dive/f2_hu_1406b505e34593f0.webp 400w,
               /blog/gateway-api-inference-extension-deep-dive/f2_hu_83a55039c76a99a4.webp 760w,
               /blog/gateway-api-inference-extension-deep-dive/f2_hu_e51d8806c2ee7a9f.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/f2_hu_1406b505e34593f0.webp&#34;
               width=&#34;760&#34;
               height=&#34;362&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è¯„ä¼°æµç¨‹å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¯„ä¼°æµç¨‹ç¤ºæ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸º Criticalã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯ Criticalï¼Œè¯·æ±‚åªä¼šè¿›å…¥é˜Ÿåˆ—é•¿åº¦ &amp;lt; 50 çš„å®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;å†åˆ¤æ–­æ˜¯å¦å·²åŠ è½½å¯¹åº”çš„ LoRAã€‚&lt;/li&gt;
&lt;li&gt;è‹¥æ²¡æœ‰åŠ è½½ï¼Œä¹Ÿä¼šå°è¯•é€‰æ‹©èƒ½åŠ è½½çš„å¤‡é€‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯ Sheddable è¯·æ±‚ï¼Œåˆ™åªé€‰æ‹© KV ç¼“å­˜å ç”¨ç‡ &amp;lt; 80%ã€é˜Ÿåˆ—é•¿åº¦ &amp;lt; 5 çš„å®ä¾‹ï¼›å¦åˆ™è¯·æ±‚ä¼šè¢«ä¸¢å¼ƒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä¸¢å¼ƒä½ä¼˜å…ˆçº§è¯·æ±‚&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä¸¢å¼ƒä½ä¼˜å…ˆçº§è¯·æ±‚&#34; srcset=&#34;
               /blog/gateway-api-inference-extension-deep-dive/f3_hu_e7fe980ddab58af.webp 400w,
               /blog/gateway-api-inference-extension-deep-dive/f3_hu_5bc828615308e30.webp 760w,
               /blog/gateway-api-inference-extension-deep-dive/f3_hu_7e9a6378161623e2.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/gateway-api-inference-extension-deep-dive/f3_hu_e7fe980ddab58af.webp&#34;
               width=&#34;760&#34;
               height=&#34;504&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä¸¢å¼ƒä½ä¼˜å…ˆçº§è¯·æ±‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;ç¤ºä¾‹åˆ†æ&#34;&gt;ç¤ºä¾‹åˆ†æ&lt;/h3&gt;
&lt;h4 id=&#34;ç¤ºä¾‹1critical-è¯·æ±‚--lora-é€‚é…å™¨è¦æ±‚&#34;&gt;ç¤ºä¾‹1ï¼šCritical è¯·æ±‚ + LoRA é€‚é…å™¨è¦æ±‚&lt;/h4&gt;
&lt;p&gt;å‡è®¾æœ‰ä»¥ä¸‹ Podï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pod A: é˜Ÿåˆ—=10ï¼ŒKV ç¼“å­˜=30%ï¼Œå·²åŠ è½½ LoRA-X&lt;/li&gt;
&lt;li&gt;Pod B: é˜Ÿåˆ—=5ï¼ŒKV ç¼“å­˜=70%ï¼ŒæœªåŠ è½½ LoRA-X&lt;/li&gt;
&lt;li&gt;Pod C: é˜Ÿåˆ—=60ï¼ŒKV ç¼“å­˜=20%ï¼Œå·²åŠ è½½ LoRA-X&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ç»ˆé€‰æ‹©ï¼š&lt;strong&gt;Pod A&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç¤ºä¾‹2é-critical-è¯·æ±‚&#34;&gt;ç¤ºä¾‹2ï¼šé Critical è¯·æ±‚&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Pod A: é˜Ÿåˆ—=6ï¼ŒKV=85%&lt;/li&gt;
&lt;li&gt;Pod B: é˜Ÿåˆ—=4ï¼ŒKV=75%&lt;/li&gt;
&lt;li&gt;Pod C: é˜Ÿåˆ—=7ï¼ŒKV=60%&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ç»ˆé€‰æ‹©ï¼š&lt;strong&gt;Pod B&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç¤ºä¾‹3critical-è¯·æ±‚--æ‰€æœ‰é˜Ÿåˆ—éƒ½å¾ˆé«˜&#34;&gt;ç¤ºä¾‹3ï¼šCritical è¯·æ±‚ + æ‰€æœ‰é˜Ÿåˆ—éƒ½å¾ˆé«˜&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Pod A: é˜Ÿåˆ—=70ï¼ŒKV=40%ï¼Œæœ‰ LoRA-Y&lt;/li&gt;
&lt;li&gt;Pod B: é˜Ÿåˆ—=80ï¼ŒKV=60%ï¼Œæœ‰ LoRA-Y&lt;/li&gt;
&lt;li&gt;Pod C: é˜Ÿåˆ—=65ï¼ŒKV=70%ï¼Œæ—  LoRA-Y&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ç»ˆé€‰æ‹©ï¼š&lt;strong&gt;Pod A&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Gateway API Inference Extension é¡¹ç›®ä¸º Kubernetes ä¸Šè¿è¡Œçš„å¤§æ¨¡å‹å’Œ GPU æä¾›äº†æ™ºèƒ½æ¨¡å‹é€‰æ‹©å’Œè´Ÿè½½å‡è¡¡èƒ½åŠ›ã€‚åœ¨ GPU èµ„æºç´§ç¼ºã€æˆæœ¬é«˜æ˜‚çš„èƒŒæ™¯ä¸‹ï¼Œè¯¥é¡¹ç›®å¯ä»¥å¤§å¹…æå‡ååæ€§èƒ½å’Œèµ„æºåˆ©ç”¨ç‡ï¼Œå¹¶èŠ‚çœä¼ä¸šæˆæœ¬ã€‚ä½ å¯ä»¥åœ¨ &lt;a href=&#34;https://gateway-api-inference-extension.sigs.k8s.io/performance/benchmark/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¡¹ç›®ç½‘ç«™&lt;/a&gt; ä¸ŠæŸ¥çœ‹æœ€æ–°æ€§èƒ½åŸºå‡†æµ‹è¯•æ•°æ®ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—</title>
      <link>https://cloudnativecn.com/blog/cilium-gateway-api/</link>
      <pubDate>Thu, 04 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-gateway-api/</guid>
      <description>&lt;p&gt;åœ¨ Kubernetes ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºåï¼Œé€šå¸¸çš„ä¸‹ä¸€æ­¥æ˜¯è®©ç”¨æˆ·å¯ä»¥è®¿é—®å®ƒã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;&lt;/a&gt;ï¼Œä¾‹å¦‚ Nginxã€Haproxyã€Traefik æˆ–æ¥è‡ªäº‘æä¾›å•†çš„æ§åˆ¶å™¨ï¼Œæ¥å¼•å¯¼ä¼ å…¥çš„æµé‡åˆ°åº”ç”¨ç¨‹åºï¼Œç®¡ç†è´Ÿè½½å¹³è¡¡ã€TLS ç»ˆæ­¢ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä»ä¼—å¤š&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯ç”¨çš„é€‰é¡¹&lt;/a&gt; ä¸­è¿›è¡Œé€‰æ‹©ã€‚Cilium æ˜¯å…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„é€‰é¡¹ï¼Œæ—¨åœ¨å¤„ç†æ‰€æœ‰è¿™äº›ç½‘ç»œæ–¹é¢çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Cilium&lt;/strong&gt;&lt;/a&gt; æ˜¯ä¸€ä¸ªåŸºäº eBPF çš„å¼€æºç½‘ç»œå’Œå®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œå…¶é‡‡ç”¨é€Ÿåº¦å¢é•¿è¿…çŒ›ã€‚å®ƒå¯èƒ½æ˜¯æä¾›æœ€å¤šåŠŸèƒ½çš„ç½‘ç»œæ’ä»¶ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ä¼šæ¶µç›–æ‰€æœ‰åŠŸèƒ½ï¼Œä½†å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ¶‰åŠä½¿ç”¨&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Gateway API&lt;/strong&gt;&lt;/a&gt; (&lt;code&gt;GAPI&lt;/code&gt;) ç®¡ç†ä¼ å…¥æµé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬çš„ç›®æ ‡&#34;&gt;æˆ‘ä»¬çš„ç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‡†ç¡®äº†è§£ &lt;strong&gt;Gateway API&lt;/strong&gt; æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•ä»£è¡¨ä» &lt;code&gt;Ingress&lt;/code&gt; API è¿›åŒ–è€Œæ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ¼”ç¤ºä»¥ GitOps æ–¹å¼éƒ¨ç½²çš„çœŸå®åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰çš„é™åˆ¶å’Œå³å°†æ¨å‡ºçš„æ–°åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;æœ¬æ–‡ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤éƒ½æ¥è‡ªè¿™ä¸ª&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;git å­˜å‚¨åº“&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é¼“åŠ±ä½ æ¢ç´¢å®ƒï¼Œå› ä¸ºå®ƒè¿œè¿œè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å¯ç”¨äº† kube-proxy æ›¿ä»£å¹¶å…·æœ‰ä¸“ç”¨ Daemonset ç”¨äº &lt;code&gt;Envoy&lt;/code&gt; çš„ &lt;code&gt;Cilium&lt;/code&gt; é…ç½®çš„ &lt;strong&gt;EKS&lt;/strong&gt; é›†ç¾¤çš„å®‰è£…ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºäº†å…·æœ‰ä¾èµ–å…³ç³»ç®¡ç†å’Œæˆ‘è®¤ä¸ºéå¸¸é«˜æ•ˆçš„ DRY ä»£ç çš„ &lt;code&gt;Flux&lt;/code&gt; ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;ç®€åŒ–äº†ç”¨äºå¹³å°ç»„ä»¶çš„ IAM æƒé™ç®¡ç†çš„ &lt;code&gt;Crossplane&lt;/code&gt; å’Œ &lt;a href=&#34;https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IRSA&lt;/a&gt; ç»„åˆã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;External-DNS&lt;/code&gt; å’Œ &lt;code&gt;Let&#39;s Encrypt&lt;/code&gt; è‡ªåŠ¨ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªæƒ³æ³•æ˜¯åªéœ€å‡ åˆ†é’Ÿå†…è®¾ç½®å¥½ä¸€åˆ‡ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;ä»‹ç»-gateway-api&#34;&gt;ä»‹ç» Gateway API&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæœ‰è®¸å¤š&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;é€‰é¡¹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹å®šæ€§å’Œç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ‰æ—¶ä¼šä½¿å®ƒä»¬çš„ä½¿ç”¨å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼ŒKubernetes ä¸­ä¼ ç»Ÿçš„ &lt;code&gt;Ingress&lt;/code&gt; API å…·æœ‰éå¸¸æœ‰é™çš„å‚æ•°ã€‚ä¸€äº›è§£å†³æ–¹æ¡ˆç”šè‡³åˆ›å»ºäº†è‡ªå·±çš„&lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRDs&lt;/a&gt;ï¼ˆKubernetes è‡ªå®šä¹‰èµ„æºï¼‰ï¼Œè€Œå…¶ä»–è§£å†³æ–¹æ¡ˆåˆ™ä½¿ç”¨ &lt;code&gt;annotations&lt;/code&gt; æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯&lt;strong&gt;Gateway API&lt;/strong&gt;çš„ç”¨æ­¦ä¹‹åœ°ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§&lt;strong&gt;æ ‡å‡†&lt;/strong&gt;ï¼Œå…è®¸å£°æ˜é«˜çº§ç½‘ç»œåŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº•å±‚æ§åˆ¶å™¨è¿›è¡Œç‰¹å®šæ‰©å±•ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰æ§åˆ¶å™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ APIï¼Œå› æ­¤å¯ä»¥åœ¨ä¸æ”¹å˜é…ç½®çš„æƒ…å†µä¸‹ä»ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆKubernetes æ¸…å•æè¿°äº†å¦‚ä½•è·¯ç”±ä¼ å…¥æµé‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å°†è¦æ¢è®¨çš„æ¦‚å¿µä¸­ï¼ŒGAPI å¼•å…¥äº†ä¸€ä¸ªç²¾ç»†çš„æˆæƒæ¨¡å‹ï¼Œå®šä¹‰äº†å…·æœ‰ä¸åŒæƒé™çš„&lt;strong&gt;æ˜¾å¼è§’è‰²&lt;/strong&gt;ï¼ˆæœ‰å…³ GAPI å®‰å…¨æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/security-model/#roles-and-personas&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡¹ç›®ç”±&lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sig-network-kubernetes&lt;/a&gt;å·¥ä½œç»„æ¨åŠ¨ï¼Œè¿˜æœ‰ä¸€ä¸ª Slack &lt;a href=&#34;https://kubernetes.slack.com/archives/CR0H13KGA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢‘é“&lt;/a&gt;ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶è”ç³»ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨ GAPI ä¸ Ciliumï¼&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾å·²éƒ¨ç½²äº†ä¸€ä¸ª EKS é›†ç¾¤ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/tree/main/terraform/eks&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•&lt;/a&gt;ä½œä¸ºæœ¬æ–‡çš„åŸºç¡€ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›&lt;strong&gt;è¦æ£€æŸ¥çš„è¦ç‚¹&lt;/strong&gt;ï¼Œä»¥ä¾¿ä½¿ç”¨ GAPIã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„æè¿°çš„å®‰è£…æ–¹æ³•åŸºäº &lt;code&gt;Helm&lt;/code&gt;ï¼Œæ‰€æœ‰çš„ &lt;code&gt;values&lt;/code&gt; å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/terraform/eks/helm_values/cilium.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/tree/main/config/crd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt;å­˜å‚¨åº“ä¸­&lt;strong&gt;å®‰è£…&lt;/strong&gt;å¯ç”¨çš„ &lt;code&gt;CRDs&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    å¦‚æœ Cilium è®¾ç½®ä¸ºæ”¯æŒ &lt;code&gt;GAPI&lt;/code&gt;ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œå¹¶ä¸”ç¼ºå°‘ CRDsï¼Œåˆ™å®ƒå°†æ— æ³•å¯åŠ¨ã€‚åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;GAPI CRDs&lt;/strong&gt;åœ¨é›†ç¾¤åˆ›å»ºæœŸé—´å®‰è£…ä¸€æ¬¡ï¼Œä»¥ä¾¿ Cilium å¯ä»¥å¯åŠ¨ï¼Œç„¶åç”± Flux ç®¡ç†ã€‚
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ Cilium å’Œ &lt;code&gt;eBPF&lt;/code&gt; çš„ç½‘ç»œè½¬å‘åŠŸèƒ½&lt;strong&gt;æ›¿æ¢&lt;/strong&gt; &lt;code&gt;kube-proxy&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;kubeProxyReplacement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯ç”¨&lt;/strong&gt; Gateway API æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;gatewayAPI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥&lt;/strong&gt;å®‰è£…ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å®‰è£…åä¸º &lt;code&gt;cilium&lt;/code&gt; çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æˆ‘ä¸ªäººä½¿ç”¨ &lt;a href=&#34;https://blog.ogenki.io/post/asdf/asdf/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;asdf&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf plugin-add cilium-cli
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf install cilium-cli 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf global cilium 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å…è®¸ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status --wait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Deployment             cilium-operator    Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium             Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium-envoy       Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Containers:            cilium             Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Cluster Pods:          33/33 managed by Cilium
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Helm chart version:    1.14.2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Image versions         cilium             quay.io/cilium/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    quay.io/cilium/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       quay.io/cilium/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† Gateway API æ”¯æŒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium config view | grep -w &amp;#34;enable-gateway-api&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api                                true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api-secrets-sync                   true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹ç«¯åˆ°ç«¯æµ‹è¯•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium connectivity test
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œæ­¤å‘½ä»¤ï¼ˆ&lt;code&gt;connectivity test&lt;/code&gt;ï¼‰å½“å‰åœ¨å¯ç”¨ Envoy ä½œä¸º DaemonSet æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚(&lt;a href=&#34;https://github.com/cilium/cilium/issues/28057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Envoy ä½œä¸º DaemonSet&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä»£ç†è¿˜åœ¨åŒä¸€ Pod ä¸­è¿è¡Œ &lt;code&gt;Envoy&lt;/code&gt;ï¼Œå¹¶å§”æ‰˜ç»™å®ƒçº§åˆ« 7 çš„ç½‘ç»œæ“ä½œã€‚ä»ç‰ˆæœ¬ &lt;code&gt;v1.14&lt;/code&gt; å¼€å§‹ï¼Œå¯ä»¥å°† Envoy å•ç‹¬éƒ¨ç½²ï¼Œè¿™å¸¦æ¥äº†ä¸€äº›å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¿®æ”¹/é‡æ–°å¯åŠ¨ä¸€ä¸ªç»„ä»¶ï¼ˆæ— è®ºæ˜¯ Cilium è¿˜æ˜¯ Envoyï¼‰ï¼Œéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ›´å¥½åœ°åˆ†é…èµ„æºç»™æ¯ä¸ªç»„ä»¶ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æŸä¸ª Pod è¢«æ”»å‡»çš„æƒ…å†µä¸‹é™åˆ¶æ”»å‡»é¢ã€‚&lt;/li&gt;
&lt;li&gt;Envoy æ—¥å¿—å’Œ Cilium ä»£ç†æ—¥å¿—ä¸ä¼šæ··åˆåœ¨ä¸€èµ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ­¤åŠŸèƒ½æ˜¯å¦å·²å¯ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-release-114/#h-envoy-daemonset&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;å…¥å£ç‚¹gatewayclass-å’Œ-gateway&#34;&gt;å…¥å£ç‚¹ï¼šGatewayClass å’Œ Gateway&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/gateway_hu_89bbc1de24e85397.webp 400w,
               /blog/cilium-gateway-api/gateway_hu_5ae11f4d59bb594a.webp 760w,
               /blog/cilium-gateway-api/gateway_hu_bdfa651ffa42c058.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/gateway_hu_89bbc1de24e85397.webp&#34;
               width=&#34;760&#34;
               height=&#34;557&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æ»¡è¶³å…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¤šä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Gateway API CRDs å®šä¹‰çš„è‡ªå®šä¹‰èµ„æºã€‚è€Œä¸”ï¼Œåœ¨å®‰è£… Cilium åï¼Œä¸€ä¸ª &lt;code&gt;GatewayClass&lt;/code&gt; ç«‹å³å¯ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gatewayclasses.gateway.networking.k8s.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME     CONTROLLER                     ACCEPTED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium   io.cilium/gateway-controller   True       7m59s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ Kubernetes é›†ç¾¤ä¸Šï¼Œä½ å¯ä»¥é…ç½®å¤šä¸ª &lt;code&gt;GatewayClasses&lt;/code&gt;ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;Gateway&lt;/code&gt; é…ç½®ä¸­å¼•ç”¨ GatewayClass æ¥ä½¿ç”¨ &lt;code&gt;Linkerd&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Gateway&lt;/code&gt; æ˜¯å…è®¸è§¦å‘åœ¨äº‘æä¾›å•†ä¸­åˆ›å»ºè´Ÿè½½å‡è¡¡ç»„ä»¶çš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ AWSï¼ˆEKSï¼‰ä¸Šï¼Œé…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ—¶ï¼ŒCilium ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º &lt;code&gt;LoadBalancer&lt;/code&gt; çš„ &lt;code&gt;Service&lt;/code&gt;ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆ&lt;a href=&#34;https://kubernetes-sigs.github.io/aws-load-balancer-controller&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Load Balancer Controller&lt;/a&gt;ï¼‰å¤„ç†äº‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆ&lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NLB&lt;/a&gt;ï¼‰çš„åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get svc -n echo cilium-gateway-echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395/TCP   2m58s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹Ÿä¸ &lt;code&gt;Gateway&lt;/code&gt; ç›¸å…³è”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gateway -n echo echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è·¯ç”±è§„åˆ™httproute&#34;&gt;è·¯ç”±è§„åˆ™ï¼šHTTPRoute&lt;/h2&gt;
&lt;h3 id=&#34;åŸºæœ¬è§„åˆ™&#34;&gt;åŸºæœ¬è§„åˆ™&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-httproute&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;httproute.jpg&#34; alt=&#34;HTTPRoute&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      HTTPRoute
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä¸Šé¢çš„å›¾è¡¨å¯æ€»ç»“ä¸ºå‡ å¥è¯ï¼š&lt;code&gt;HTTPRoute&lt;/code&gt; å…è®¸é€šè¿‡å¼•ç”¨ Gateway å¹¶å®šä¹‰æ‰€éœ€çš„è·¯ç”±å‚æ•°æ¥é…ç½®åˆ°æœåŠ¡çš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Kyverno&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆªæ­¢ç›®å‰ï¼Œæ— æ³•é…ç½®ç”± &lt;code&gt;Gateways&lt;/code&gt; ç”Ÿæˆçš„æœåŠ¡çš„æ³¨é‡Šï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚å·²æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³åœ¨åˆ›å»º &lt;code&gt;Gateway&lt;/code&gt; åç«‹å³ä¿®æ”¹ç”± &lt;code&gt;Gateway&lt;/code&gt; åˆ›å»ºçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Kyverno æ˜¯ä¸€ç§ç¡®ä¿é…ç½®ç¬¦åˆæœ€ä½³å®è·µå’Œå®‰å…¨è¦æ±‚çš„å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»…ä½¿ç”¨å®ƒæ¥è½»æ¾æè¿°&lt;a href=&#34;https://kyverno.io/docs/writing-policies/mutate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çªå˜&lt;/a&gt;è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/mycluster-0/echo-gw-clusterpolicy.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;security/mycluster-0/echo-gw-clusterpolicy.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mutate-svc-annotations&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kinds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium-gateway-echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mutate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patchStrategicMerge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;external-dns.alpha.kubernetes.io/hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo.${domain_name}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;internet-facing&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-backend-protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tcp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;loadBalancerClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service.k8s.aws/nlb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼ŒæœåŠ¡ &lt;code&gt;cilium-gateway-echo&lt;/code&gt; å°†æ·»åŠ  AWS æ§åˆ¶å™¨çš„æ³¨é‡Šï¼Œä»¥åŠä¸€ä¸ªå…è®¸è‡ªåŠ¨ DNS è®°å½•é…ç½®çš„æ³¨é‡Šã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹éå¸¸ç®€å•ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° &lt;code&gt;echo-1-echo-server&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parentRefs&lt;/code&gt; æŒ‡ç¤ºä½¿ç”¨å“ªä¸ª &lt;code&gt;Gateway&lt;/code&gt;ï¼Œç„¶ååœ¨ &lt;code&gt;rules&lt;/code&gt; éƒ¨åˆ†å®šä¹‰äº†è·¯ç”±è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;è·¯ç”±è§„åˆ™è¿˜å¯ä»¥åŸºäº &lt;code&gt;path&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;foo.bar.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/login&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…åŸºäº HTTP æ ‡å¤´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯è®¿é—®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s http://echo.cloud.ogenki.io | jq -rc &amp;#39;.environment.HOSTNAME&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1-echo-server-fd88497d-w6sgn
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¯¥æœåŠ¡ä»¥ HTTP æ–¹å¼æš´éœ²ï¼Œæ²¡æœ‰è¯ä¹¦ã€‚è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®-tls-è¯ä¹¦&#34;&gt;é…ç½® TLS è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;æœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ GAPI é…ç½® TLSã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¸¸è§çš„æƒ…å†µï¼šHTTPS åè®®å’Œåœ¨ Gateway ä¸Šç»ˆæ­¢ TLSã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³è¦é…ç½®ä¹‹å‰ä½¿ç”¨çš„åŸŸå &lt;code&gt;echo.cloud.ogenki.io&lt;/code&gt;ã€‚é…ç½®ä¸»è¦é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/tls-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/tls-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cert-manager.io/cluster-issuer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;letsencrypt-prod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯å¼•ç”¨ä¸€ä¸ªåŒ…å«åç§°ä¸º &lt;code&gt;echo-tls&lt;/code&gt; çš„è¯ä¹¦çš„å¯†é’¥ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ &lt;strong&gt;Let&amp;rsquo;s Encrypt&lt;/strong&gt; å’Œ &lt;code&gt;cert-manager&lt;/code&gt; æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;}
&lt;strong&gt;cert-manager&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;cert-manager&lt;/code&gt;ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°ç”± &lt;code&gt;Gateway&lt;/code&gt; æš´éœ²çš„è¯ä¹¦éå¸¸ç®€å•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å…è®¸æ§åˆ¶å™¨è®¿é—® &lt;a href=&#34;https://aws.amazon.com/route53/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;route53&lt;/a&gt;ï¼Œä»¥è§£å†³ DNS01 æŒ‘æˆ˜ï¼ˆè¿™æ˜¯ä¸€ç§ç¡®ä¿å®¢æˆ·ç«¯åªèƒ½ä¸ºè‡ªå·±æ‹¥æœ‰çš„åŸŸè¯·æ±‚è¯ä¹¦çš„æœºåˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/base/cert-manager/cluster-issuer-staging.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ClusterIssuer&lt;/a&gt; èµ„æºæè¿°äº†ä½¿ç”¨ cert-manager ç”Ÿæˆè¯ä¹¦æ‰€éœ€çš„é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨é‡Š &lt;code&gt;cert-manager.io/cluster-issuer&lt;/code&gt; å¹¶è®¾ç½®å­˜å‚¨è¯ä¹¦çš„ Kubernetes å¯†é’¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cert-manager.io/docs/usage/gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¼”ç¤ºå­˜å‚¨åº“ä¸­ï¼Œæƒé™æ˜¯ä½¿ç”¨ &lt;code&gt;Crossplane&lt;/code&gt; åˆ†é…çš„ï¼Œå®ƒè´Ÿè´£åœ¨ AWS ä¸­é…ç½®è¿™äº› IAM æƒé™ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä½¿è·¯ç”±æ­£å¸¸å·¥ä½œï¼Œä½ è¿˜éœ€è¦å°† &lt;code&gt;HTTPRoute&lt;/code&gt; é™„åŠ åˆ°æ­£ç¡®çš„ &lt;code&gt;Gateway&lt;/code&gt; å¹¶æŒ‡å®šåŸŸåã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡ ç§’é’Ÿåï¼Œè¯ä¹¦å°†è¢«åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get cert -n echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME       READY   SECRET     AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-tls   True    echo-tls   43m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯ä¹¦ç¡®å®æ¥è‡ª Let&amp;rsquo;s Encryptï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl https://echo.cloud.ogenki.io -v 2&amp;gt;&amp;amp;1 | grep -A 6 &amp;#39;Server certificate&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;* Server certificate:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subject: CN=echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  start date: Sep 15 14:43:00 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  expire date: Dec 14 14:42:59 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subjectAltName: host &amp;#34;echo.cloud.ogenki.io&amp;#34; matched cert&amp;#39;s &amp;#34;echo.cloud.ogenki.io&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  issuer: C=US; O=Let&amp;#39;s Encrypt; CN=R3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  SSL certificate verify ok.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    GAPI è¿˜å…è®¸ä½ é…ç½® &lt;strong&gt;ç«¯åˆ°ç«¯çš„ TLS&lt;/strong&gt;ï¼Œä¸€ç›´åˆ°å®¹å™¨ã€‚è¿™æ˜¯é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; ä¸º &lt;code&gt;Passthrough&lt;/code&gt; æ¨¡å¼å¹¶ä½¿ç”¨ &lt;code&gt;TLSRoute&lt;/code&gt; èµ„æºæ¥å®Œæˆçš„ã€‚è¯ä¹¦ä¹Ÿå¿…é¡»ç”±æ‰§è¡Œ TLS ç»ˆæ­¢çš„ pod æºå¸¦ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº«-gateway&#34;&gt;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº« Gateway&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å…±äº«ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å…±äº«ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/shared-gateway_hu_363b3eeb35c87eae.webp 400w,
               /blog/cilium-gateway-api/shared-gateway_hu_4bdb66bfa0d9adb4.webp 760w,
               /blog/cilium-gateway-api/shared-gateway_hu_aeff7db091c5cc6.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/shared-gateway_hu_363b3eeb35c87eae.webp&#34;
               width=&#34;760&#34;
               height=&#34;507&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å…±äº«ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;GAPI&lt;/code&gt;ï¼Œä½ å¯ä»¥åœ¨ &lt;code&gt;å‘½åç©ºé—´&lt;/code&gt; ä¹‹é—´è·¯ç”±æµé‡ã€‚è¿™å¾—ç›Šäºæ¯ä¸ªåŠŸèƒ½çš„ä¸åŒèµ„æºï¼šä¸€ä¸ª &lt;code&gt;Gateway&lt;/code&gt; å…è®¸é…ç½®åŸºç¡€è®¾æ–½ï¼Œä»¥åŠ &lt;code&gt;*Routes&lt;/code&gt;ã€‚è¿™äº›è·¯ç”±å¯ä»¥é™„åŠ åˆ°ä½äºå¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ Gatewayã€‚å› æ­¤ï¼Œä¸åŒçš„å›¢é˜Ÿ/é¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™éœ€è¦æŒ‡å®šå“ªä¸ªè·¯ç”±å…è®¸å¼•ç”¨è¯¥ Gatewayã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºå†…éƒ¨å·¥å…·çš„ Gatewayï¼Œåä¸º &lt;code&gt;platform&lt;/code&gt;ã€‚é€šè¿‡ä½¿ç”¨ &lt;code&gt;allowedRoutes&lt;/code&gt; å‚æ•°ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†å“ªäº›å‘½åç©ºé—´å…è®¸é™„åŠ åˆ°æ­¤ Gatewayã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/infrastructure/base/gapi/platform-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;infrastructure/base/gapi/platform-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Selector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchExpressions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/metadata.name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;In&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;observability&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;flux-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å‘½åç©ºé—´ &lt;code&gt;observability&lt;/code&gt; å’Œ &lt;code&gt;flux-system&lt;/code&gt; ä¸­é…ç½®çš„ &lt;code&gt;HTTPRoutes&lt;/code&gt; é™„åŠ åˆ°æ­¤å”¯ä¸€çš„ &lt;code&gt;Gateway&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;infrastructure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼Œä½¿ç”¨æ¥è‡ªäº‘æä¾›å•†çš„ç›¸åŒè´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short ${NLB_DOMAIN}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short grafana-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short gitops-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    è¿™äº›å†…éƒ¨å·¥å…·ä¸åº”è¯¥æš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œä½†æ˜¯ä½ çŸ¥é“ï¼šè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…éƒ¨ Gatewayï¼ˆç§æœ‰ IPï¼‰é€šè¿‡è°ƒæ•´æ³¨é‡Šå¹¶ä½¿ç”¨ç§æœ‰è¿æ¥ç³»ç»Ÿï¼ˆVPNã€éš§é“ç­‰ï¼‰æ¥å®ç°ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;æµé‡åˆ†æµ&#34;&gt;æµé‡åˆ†æµ&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åˆ†æµ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åˆ†æµ&#34; srcset=&#34;
               /blog/cilium-gateway-api/split_hu_c72555df10293567.webp 400w,
               /blog/cilium-gateway-api/split_hu_1167691e9056a216.webp 760w,
               /blog/cilium-gateway-api/split_hu_eccf79dd9d17e74.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/split_hu_c72555df10293567.webp&#34;
               width=&#34;760&#34;
               height=&#34;517&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åˆ†æµ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç”±æœåŠ¡ç½‘æ ¼å¸¸å¸¸æä¾›çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨æ—¶ï¼ˆA/B æµ‹è¯•æˆ–é‡‘ä¸é›€éƒ¨ç½²ï¼‰å¯¹éƒ¨åˆ†æµé‡æµ‹è¯•åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ã€‚&lt;code&gt;GAPI&lt;/code&gt;é€šè¿‡ä½¿ç”¨æƒé‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿å…¶å˜å¾—éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°† 5% çš„æµé‡è½¬å‘åˆ°æœåŠ¡ &lt;code&gt;echo-2-echo-server&lt;/code&gt; çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute-split.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute-split.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;split-echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-2-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥åˆ†å‘æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/scripts/check-split.sh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scripts/check-split.sh&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;./scripts/check-split.sh https://split-echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1 çš„è¯·æ±‚æ¬¡æ•°ï¼š95
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-2 çš„è¯·æ±‚æ¬¡æ•°ï¼š5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¿®æ”¹æ ‡å¤´&#34;&gt;ä¿®æ”¹æ ‡å¤´&lt;/h3&gt;
&lt;p&gt;è¿˜å¯ä»¥æ›´æ”¹ HTTP &lt;strong&gt;æ ‡å¤´&lt;/strong&gt;ï¼šæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚è¿™äº›ä¿®æ”¹å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;HTTPRoute&lt;/code&gt; æ¸…å•ä¸­ä½¿ç”¨ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/httproute#filters-optional&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;filters&lt;/a&gt; åº”ç”¨äºè¯·æ±‚æ ‡å¤´æˆ–å“åº”æ ‡å¤´ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;strong&gt;è¯·æ±‚&lt;/strong&gt; ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/req-header-add&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RequestHeaderModifier&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requestHeaderModifier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤å…è®¸æŸ¥çœ‹æ ‡å¤´æ˜¯å¦ç¡®å®å·²æ·»åŠ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s https://echo.cloud.ogenki.io/req-header-add | jq &amp;#39;.request.headers&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;host&amp;#34;: &amp;#34;echo.cloud.ogenki.io&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;user-agent&amp;#34;: &amp;#34;curl/8.2.1&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;accept&amp;#34;: &amp;#34;*/*&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-for&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-proto&amp;#34;: &amp;#34;https&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-envoy-external-address&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-request-id&amp;#34;: &amp;#34;320ba4d2-3bd6-4c2f-8a97-74296a9f3f26&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;foo&amp;#34;: &amp;#34;bar&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ†é…é€‚å½“çš„æƒé™&#34;&gt;åˆ†é…é€‚å½“çš„æƒé™&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;GAPI&lt;/code&gt; æä¾›äº†ä¸€ç§æ¸…æ™°çš„æƒé™å…±äº«æ¨¡å‹ï¼Œç”¨äºç®¡ç†æµé‡è·¯ç”±åŸºç¡€è®¾æ–½ï¼ˆç”±é›†ç¾¤ç®¡ç†å‘˜ç®¡ç†ï¼‰å’Œåº”ç”¨ç¨‹åºï¼ˆç”±å¼€å‘äººå‘˜ç®¡ç†ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¤šä¸ªè‡ªå®šä¹‰èµ„æºçš„å¯ç”¨æ€§å…è®¸ä½¿ç”¨ Kubernetes çš„ &lt;strong&gt;RBAC&lt;/strong&gt; é…ç½®ä»¥å£°æ˜æ€§æ–¹å¼åˆ†é…æƒé™ã€‚æˆ‘å·²ç»æ·»åŠ äº†ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„æ¼”ç¤ºé›†ç¾¤ä¸­æ²¡æœ‰æ•ˆæœï¼Œä½†å¯èƒ½ä¼šç»™ä½ ä¸€ä¸ªæƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„é…ç½®æˆäºˆ &lt;code&gt;developers&lt;/code&gt; ç»„çš„æˆå‘˜åœ¨ echo å‘½åç©ºé—´å†…ç®¡ç† &lt;code&gt;HTTPRoutes&lt;/code&gt; çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä»…æä¾›å¯¹ &lt;code&gt;Gateways&lt;/code&gt; çš„è¯»å–æƒé™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;httproutes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateways&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;list&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;developers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&#34;&gt;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&lt;/h2&gt;
&lt;p&gt;äººä»¬å¯èƒ½ä¼šå¯¹é€šå¸¸ç§°ä¸º &lt;code&gt;API ç½‘å…³&lt;/code&gt; çš„ä¸œè¥¿æ„Ÿåˆ°å›°æƒ‘ã€‚å·²ç»åˆ›å»ºäº† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/faq/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAQ&lt;/a&gt; çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä»¥æ¾„æ¸…å®ƒä¸ &lt;code&gt;Gateway API&lt;/code&gt; çš„ä¸åŒä¹‹å¤„ã€‚å°½ç®¡ GAPI æä¾›äº†é€šå¸¸åœ¨ API ç½‘å…³ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ï¼Œä½†å®ƒä¸»è¦æ˜¯ Kubernetes çš„ä¸€ä¸ªç‰¹å®šå®ç°ã€‚ç„¶è€Œï¼Œé€‰æ‹©è¿™ä¸ªåç§°ç¡®å®å¯èƒ½å¼•èµ· &lt;strong&gt;æ··æ·†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡ä»…å…³æ³¨å…¥ç«™æµé‡ï¼Œé€šå¸¸ç”± &lt;em&gt;Ingress Controllers&lt;/em&gt; ç®¡ç†ï¼Œç§°ä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#northsouth-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å—åŒ—&lt;/a&gt;ï¼Œè¿™å®é™…ä¸Šæ˜¯ GAPI çš„åˆå§‹èŒƒå›´ã€‚æœ€è¿‘çš„ä¸€ä¸ªåä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/gamma/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;GAMMA&lt;/strong&gt;&lt;/a&gt; çš„å€¡è®®æ—¨åœ¨å¤„ç† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#eastwest-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸œè¥¿æµé‡&lt;/a&gt; è·¯ç”±ï¼Œè¿™å°†åœ¨å°†æ¥æ ‡å‡†åŒ–æŸäº›å¸¸è§çš„åŠŸèƒ½ï¼Œé€šå¸¸ç”± &lt;code&gt;Service Meshes&lt;/code&gt; è§£å†³æ–¹æ¡ˆæä¾›ã€‚ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://kubernetes.io/blog/2023/08/29/gateway-api-v0-8/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤æ–‡ç« &lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„æƒ³æ³•&#34;&gt;æœ€åçš„æƒ³æ³•&lt;/h2&gt;
&lt;p&gt;è€å®è¯´ï¼Œæˆ‘å·²ç»çŸ¥é“ &lt;strong&gt;Gateway API&lt;/strong&gt; æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚å°½ç®¡æˆ‘è¯»äº†ä¸€äº›æ–‡ç« ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰çœŸæ­£æ·±å…¥ç ”ç©¶è¿‡ã€‚æˆ‘ä¼šæƒ³ï¼šâ€œä¸ºä»€ä¹ˆè¦éº»çƒ¦å‘¢ï¼Ÿæˆ‘çš„ &lt;em&gt;Ingress Controller&lt;/em&gt; å¯ä»¥å·¥ä½œï¼Œè€Œä¸”è¿™éœ€è¦å­¦ä¹ æ›²çº¿ã€‚â€&lt;/p&gt;
&lt;p&gt;GAPI æ­£åœ¨å´­éœ²å¤´è§’ï¼Œå³å°†å‘å¸ƒ GA ç‰ˆæœ¬ã€‚å¤šä¸ª &lt;a href=&#34;https://gateway-api.sigs.k8s.io/implementations/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¡¹ç›®&lt;/a&gt; å·²ç»æ‹¥æŠ±å®ƒï¼Œè¿™ä¸ªç”¨äºç®¡ç† Kubernetes å†…æµé‡çš„ API å°†è¿…é€Ÿæˆä¸ºæ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¿…é¡»è¯´ï¼Œé…ç½® GAPI æ„Ÿè§‰ç›´è§‚è€Œæ˜ç¡®ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹å–å¾—äº†å¹³è¡¡ï¼Œèµ‹äºˆå¼€å‘äººå‘˜æƒåŠ›è€Œä¸ä¼šæŸå®³å®‰å…¨æ€§ã€‚è€Œä¸”æ— ç¼çš„åŸºç¡€è®¾æ–½ç®¡ç†ï¼Ÿä½ å¯ä»¥åœ¨ä¸è§¦åŠ &lt;code&gt;*Routes&lt;/code&gt; çš„æƒ…å†µä¸‹åœ¨ä¸åŒçš„å®ç°ä¹‹é—´åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±ç”¨ &lt;code&gt;Cilium&lt;/code&gt; äº¤æ¢æˆ‘çš„ Ingress Controller å—ï¼Ÿ&lt;strong&gt;è¿˜æ²¡æœ‰ï¼Œä½†å®ƒå³å°†åˆ°æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼ŒCilium çš„åŠŸèƒ½éå¸¸å¹¿æ³›ï¼šåœ¨ Kubernetes å‘¨å›´æœ‰å¤§é‡çš„å·¥å…·ï¼ŒCilium è„±é¢–è€Œå‡ºï¼Œæ‰¿è¯ºæä¾›æŒ‡æ ‡ã€è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ã€å®‰å…¨æ€§ï¼Œä»¥åŠ &lt;em&gt;Ingress Controller&lt;/em&gt; ä¸ GAPIã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21929&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP å’Œ UDP æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21928&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GRPC æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦ä½¿ç”¨å˜å¼‚è§„åˆ™æ¥é…ç½®äº‘ç»„ä»¶ï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ–‡è®¨è®ºçš„è®¸å¤šåŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µã€‚ä¾‹å¦‚ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ‘å†™ä½œæ—¶çš„ &lt;code&gt;v1.14.2&lt;/code&gt;ï¼‰æ”¯æŒçš„ &lt;a href=&#34;https://github.com/cilium/cilium/pull/27472&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‰©å±•åŠŸèƒ½&lt;/a&gt;ã€‚æˆ‘å°è¯•è®¾ç½®ä¸€ä¸ªç®€å•çš„ HTTP&amp;gt;HTTPS é‡å®šå‘ï¼Œä½†é‡åˆ°äº† &lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/issues/1185&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ªé—®é¢˜&lt;/a&gt;ã€‚å› æ­¤ï¼Œæˆ‘é¢„è®¡ API å°†æ¥ä¼šæœ‰ä¸€äº›ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æˆ‘åªæ˜¯æ¶‰åŠäº† Cilium çš„ GAPI èƒ½å¤Ÿæä¾›çš„ä¸€å°éƒ¨åˆ†å†…å®¹ï¼ˆè€å®è¯´ï¼Œè¿™ç¯‡æ–‡ç« å·²ç»ç›¸å½“é•¿äº†ï¼‰ï¼Œä½†æˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥å¾ˆå¿«åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒã€‚ä½†è€ƒè™‘åˆ°å‰é¢æåˆ°çš„å‡ ç‚¹ï¼Œæˆ‘å»ºè®®ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³ä¸ºæœªæ¥åšå‡†å¤‡ï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™äº†ï¼&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://gateway-api.sigs.k8s.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Isovalent çš„ &lt;a href=&#34;https://isovalent.com/resource-library/labs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;labs&lt;/a&gt; æ˜¯å¼€å§‹ä½¿ç”¨ Gateway API å¹¶ä¸”ä½ å°†è·å¾—æ–°çš„å¾½ç« ä»¥æ·»åŠ åˆ°ä½ çš„æ”¶è—ä¸­çš„å¥½æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes å®‰å…¨å¼€å‘æœ€ä½³å®è·µçš„å®é™…åº”ç”¨</title>
      <link>https://cloudnativecn.com/blog/kubernetes-secure-development-best-practices-in-action/</link>
      <pubDate>Wed, 08 Nov 2023 15:33:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/kubernetes-secure-development-best-practices-in-action/</guid>
      <description>&lt;p&gt;è¯‘è€…æ³¨ï¼š
æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://www.cncf.io/blog/2023/10/11/kubernetes-secure-development-best-practices-in-action/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.cncf.io/blog/2023/10/11/kubernetes-secure-development-best-practices-in-action/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä½œè€…åŸºäº &lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt; é¡¹ç›®ï¼ˆä¸€ä¸ªåŸºäº Kubernetes Gateway API çš„å®ç°ï¼‰çš„å¼€å‘å®ä¾‹æ¥å±•ç° Kubernetes ä¸‹çš„æœ€ä½³å®‰å…¨å¼€å‘å®è·µã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æœ¬æ–‡ä½œè€…æ¥è‡ªï¼šF5 NGINX é«˜çº§è½¯ä»¶å·¥ç¨‹å¸ˆ Saylor Berman å’Œ F5 NGINX é«˜çº§è½¯ä»¶å·¥ç¨‹å¸ˆ Ciara Stackeã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æœ€å° Docker å®¹å™¨æ˜¯å®¹å™¨åŒ–é¢†åŸŸçš„ä¸€ç§æµè¡Œç­–ç•¥ï¼Œå› ä¸ºå®ƒå…·æœ‰å®‰å…¨æ€§å’Œèµ„æºæ•ˆç‡çš„ä¼˜åŠ¿ã€‚è¿™äº›å®¹å™¨æ˜¯ä¼ ç»Ÿå®¹å™¨çš„ç²¾ç®€ç‰ˆæœ¬ï¼Œæ—¨åœ¨ä»…åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„åŸºæœ¬ç»„ä»¶ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œbase å®¹å™¨å¯èƒ½æ ¹æœ¬ä¸åŒ…å«ä»»ä½•å†…å®¹ï¼ˆè¿™å°†æ˜¯â€œscratchâ€å®¹å™¨ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è®¸å¤šäººå°½å¯èƒ½ç®€å•åœ°åˆ›å»º Docker æ˜ åƒæ¥è®©ä»–ä»¬çš„åº”ç”¨ç¨‹åºæ­£å¸¸å·¥ä½œã€‚è¿™æ¶‰åŠé€‰æ‹©ä¸€ä¸ªåŸºç¡€æ˜ åƒï¼Œä¾‹å¦‚â€œubuntuâ€æˆ–â€œpythonâ€ï¼Œå…¶ä¸­åŒ…å«å¯åŠ¨å’Œè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰åº“å’Œå·¥å…·ã€‚è™½ç„¶ç®€å•ï¼Œä½†ç”±äºå†…éƒ¨æ‰€æœ‰é¢å¤–çš„â€œä¸œè¥¿â€ï¼Œå¯¼è‡´è¿™äº›é•œåƒçš„æ”»å‡»é¢å’Œå†…å­˜å ç”¨é‡å¢åŠ äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬å¼€å‘ &lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt;ï¼ˆæˆ‘ä»¬å®ç°æ–°çš„ Kubernetes Gateway APIï¼‰æ—¶ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†å¤šç§å·¥å…·å’Œç­–ç•¥æ¥ç¡®ä¿å®‰å…¨æ€§å’Œä¼˜åŒ–ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æˆ‘ä»¬çš„è®¾è®¡å†³ç­–ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡å°‘æ”»å‡»é¢&lt;/li&gt;
&lt;li&gt;é•œåƒå®‰å…¨æ‰«æ&lt;/li&gt;
&lt;li&gt;ä»£ç è´¨é‡å’Œå®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²å®‰å…¨æœ€ä½³å®è·µ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‡å°‘æ”»å‡»é¢&#34;&gt;å‡å°‘æ”»å‡»é¢&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬é€‰æ‹©ä»å°½å¯èƒ½å°çš„å®¹å™¨å¼€å§‹ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½å†å°äº†ã€‚åŸºäº &amp;lsquo;scratch&amp;rsquo;ï¼Œæˆ‘ä»¬çš„ &amp;rsquo;nginx- gateway-fabric&amp;rsquo; é•œåƒåªåŒ…å« Golang äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ²¡æœ‰å…¶ä»–å†…å®¹ã€‚åœ¨ç”Ÿæˆæœ€ç»ˆç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬é‡‡å–äº†å‡ ä¸ªæ­¥éª¤ï¼Œä½†æˆ‘ä»¬ç¡®ä¿æœ€ç»ˆç‰ˆæœ¬ä»…åŒ…å«å¿…è¦çš„å†…å®¹ï¼Œå³äºŒè¿›åˆ¶æ–‡ä»¶ã€‚Dockerfile å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Dockerfile&#34; data-lang=&#34;Dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; alpine:3.18 &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;RUN&lt;/span&gt; apk add --no-cache libcap &lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; ./build/out/gateway /usr/bin/ &lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;RUN&lt;/span&gt; setcap &lt;span class=&#34;s1&#34;&gt;&amp;#39;cap_kill=+ep&amp;#39;&lt;/span&gt; /usr/bin/gateway &lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;USER&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; 102:1001 &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/usr/bin/gateway&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªå¤šæ­¥éª¤çš„ Dockerfile å…è®¸æˆ‘ä»¬å°†â€œalpineâ€ä¸æœ€æ–°ç‰ˆæœ¬çš„ libcap ä¸€èµ·ä½¿ç”¨ï¼Œå°†æˆ‘ä»¬é¢„å…ˆæ„å»ºçš„äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œå¹¶ä¸ºæˆ‘ä»¬ç®¡ç† nginx è®¾ç½®å¿…è¦çš„æƒé™ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨â€œscratchâ€ä½œä¸ºç”Ÿäº§æ˜ åƒçš„åŸºç¡€ï¼Œå¹¶è®¾ç½®ç”¨æˆ·å’Œç»„ IDï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ§åˆ¶å’Œé™åˆ¶å®¹å™¨æœ‰æƒè®¿é—®çš„æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œâ€œnginx-gateway-fabricâ€æ˜ åƒçš„å¤§å°å¤§è‡´ä¸äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«çš„å¤§å°ç›¸åŒï¼Œæ²¡æœ‰ä»»ä½•é¢å¤–çš„è†¨èƒ€ã€‚äºŒè¿›åˆ¶æ–‡ä»¶ä¸éœ€è¦ä»»ä½•é¢å¤–çš„ä¾èµ–é¡¹å³å¯è¿è¡Œï¼Œå¹¶ä¸”æˆ‘ä»¬ä¿æŒäº†å°½å¯èƒ½å°çš„å¤§å°å’Œæ”»å‡»é¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é•œåƒå®‰å…¨æ‰«æ&#34;&gt;é•œåƒå®‰å…¨æ‰«æ&lt;/h2&gt;
&lt;p&gt;ç¡®ä¿äº§å“å®‰å…¨çš„æœ€æœ‰æ•ˆæ–¹æ³•ä¹‹ä¸€æ˜¯å®šæœŸè¿›è¡Œå®‰å…¨æ‰«æã€‚åœ¨ &lt;a href=&#34;https://trivy.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Trivy&lt;/a&gt; çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å®šæœŸè¿è¡Œé•œåƒå®‰å…¨æ‰«æï¼Œä½œä¸º Github CI/CD ç®¡é“çš„ä¸€éƒ¨åˆ†ã€‚Trivy æ‰«æå®¹å™¨é•œåƒæŸ¥æ‰¾åº“æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å­˜åœ¨çš„ä»»ä½•å·²çŸ¥æ¼æ´ï¼ˆCVEï¼‰ã€‚ä½¿ç”¨â€œscratchâ€é•œåƒå¯ä»¥ä¿æŠ¤æˆ‘ä»¬å…å—åŸºç¡€æ˜ åƒä¸­çš„ä»»ä½•æ¼æ´çš„å½±å“ï¼Œä½† Trivy ä»ç„¶å¯ä»¥æ•è·åœ¨æˆ‘ä»¬çš„ Golang äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ç¼–è¯‘çš„åº“ä¸­çš„ä»»ä½•æ¼æ´ã€‚æ‰«æç»“æœå°†ä¸Šä¼ åˆ°å­˜å‚¨åº“çš„ Github å®‰å…¨é€‰é¡¹å¡ï¼Œä½¿æˆ‘ä»¬çš„å›¢é˜Ÿå¯ä»¥è½»æ¾æŸ¥çœ‹å‘ç°çš„ä»»ä½•é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç è´¨é‡å’Œå®‰å…¨æ€§&#34;&gt;ä»£ç è´¨é‡å’Œå®‰å…¨æ€§&lt;/h2&gt;
&lt;p&gt;é™¤äº†æœ€å°åŒ–å®¹å™¨é•œåƒå¤–ï¼Œæˆ‘ä»¬è¿˜ä¼˜å…ˆè€ƒè™‘åº”ç”¨ç¨‹åºä¸­çš„ä»£ç è´¨é‡å’Œå®‰å…¨æ€§ï¼Œé‡‡ç”¨å®‰å…¨ç¬¬ä¸€çš„æ€ç»´æ–¹å¼ã€‚æˆ‘ä»¬ä»ä¸€å¼€å§‹å°±å°†å®‰å…¨æ€§æ”¾åœ¨é¦–ä½ï¼Œä»¥å®‰å…¨æ€§ä¸ºé‡ç‚¹ï¼Œå…¨é¢è¯„ä¼°æ¯ä¸ªè®¾è®¡å’ŒåŠŸèƒ½ã€‚æˆ‘ä»¬åœ¨æµç¨‹çš„æ—©æœŸé˜¶æ®µä¸»åŠ¨è¯†åˆ«å’Œä¿æŠ¤èµ„äº§ï¼Œç¡®ä¿åœ¨æ•´ä¸ªå¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­å¯¹å…¶è¿›è¡Œä¿æŠ¤ï¼Œå¹¶éµå®ˆå®‰å…¨è®¾è®¡çš„æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬é€‚å½“çš„èº«ä»½éªŒè¯ã€æˆæƒå’ŒåŠ å¯†æœºåˆ¶ã€‚ç»´æŠ¤è¿™äº›æ ‡å‡†çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯æˆ‘ä»¬ä½¿ç”¨å¼ºå¤§çš„ä»£ç å®¡æŸ¥æµç¨‹ã€‚é¡¹ç›®çš„æ¯ä¸ªè´¡çŒ®è€…ä¸ºä»»ä½•å˜åŒ–éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ª PRï¼Œå¹¶ä¸”æ¯ä¸ª PR å¿…é¡»å¾—åˆ°è‡³å°‘ä¸¤ä¸ªé¡¹ç›®ç»´æŠ¤è€…çš„æ‰¹å‡†ã€‚é™¤äº†è¿™ä¸ªè¿‡ç¨‹ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ç»“åˆäº† linter å’Œå·¥å…·çš„ä½¿ç”¨ï¼Œä»¥ä¿æŒæˆ‘ä»¬å¯¹ä»£ç å®‰å…¨æ€§å’Œè´¨é‡çš„é«˜æ ‡å‡†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é™æ€ä»£ç åˆ†æ&#34;&gt;é™æ€ä»£ç åˆ†æ&lt;/h3&gt;
&lt;p&gt;æé«˜ä»£ç è´¨é‡çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨é™æ€ä»£ç åˆ†æå·¥å…·ï¼ˆé€šå¸¸ç¼©å†™ä¸º SASTï¼‰ã€‚ä½¿ç”¨ SAST çš„ä¸»è¦ä¼˜åŠ¿ä¹‹ä¸€æ˜¯èƒ½å¤Ÿåœ¨å¼€å‘è¿‡ç¨‹çš„æ—©æœŸæ£€æµ‹æ¼æ´ã€‚æˆ‘ä»¬å°† &lt;a href=&#34;https://codeql.github.com/docs/codeql-overview/about-codeql/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CodeQL&lt;/a&gt;ï¼ˆGitHub å¼€å‘çš„é™æ€ä»£ç åˆ†æå·¥å…·ï¼‰é›†æˆåˆ°æˆ‘ä»¬çš„ CI/CD ç®¡é“ä¸­ï¼Œè¯¥ç®¡é“æ‰«æå¹¶è¯†åˆ«æ‹‰å–è¯·æ±‚ä»¥åŠä¸»åˆ†æ”¯ä¸­çš„ä»»ä½•æ½œåœ¨é—®é¢˜ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨å°†æ›´æ”¹åˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¹‹å‰ä¿®æ­£ä»»ä½•æ½œåœ¨çš„ä»£ç è´¨é‡æˆ–å®‰å…¨é—®é¢˜ã€‚ä¸ Trivy æ‰«æç±»ä¼¼ï¼Œä»»ä½•æ½œåœ¨é—®é¢˜éƒ½ä¼šä¸Šä¼ åˆ°æˆ‘ä»¬å­˜å‚¨åº“çš„ GitHub Security é€‰é¡¹å¡ï¼Œä»¥ä¾¿æˆ‘ä»¬çš„å›¢é˜Ÿè½»æ¾æŸ¥çœ‹å‘ç°çš„ä»»ä½•é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ä¾èµ–é¡¹ä¿æŒæœ€æ–°&#34;&gt;ä½¿ä¾èµ–é¡¹ä¿æŒæœ€æ–°&lt;/h3&gt;
&lt;p&gt;ä½¿é¡¹ç›®çš„ä¾èµ–é¡¹ä¿æŒæœ€æ–°å¯¹äºå®‰å…¨æ€§å’Œæ€§èƒ½è‡³å…³é‡è¦ã€‚åœ¨ NGINX Gateway Fabric é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ &lt;a href=&#34;https://docs.github.com/en/code-security/dependabot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Dependabot&lt;/a&gt; é€šè¿‡æŒç»­ç›‘æ§é¡¹ç›®çš„ä¾èµ–é¡¹ï¼Œå¹¶åœ¨æ›´æ–°å¯ç”¨æ—¶è‡ªåŠ¨åˆ›å»º PR æ¥è‡ªåŠ¨åŒ–æ­¤è¿‡ç¨‹ã€‚è¿™å¯ç¡®ä¿æˆ‘ä»¬å§‹ç»ˆä½¿ç”¨æœ€æ–°ã€æœ€å®‰å…¨çš„ä¾èµ–é¡¹ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;Dependabot è¿˜é€šè¿‡ç›‘æ§å¸¸è§æ¼æ´å’ŒæŠ«éœ²ï¼ˆCVEï¼‰æ•°æ®åº“æ¥æä¾›å®‰å…¨è­¦æŠ¥ã€‚å½“æˆ‘ä»¬é¡¹ç›®çš„æŸä¸ªä¾èµ–é¡¹ä¸­å‘ç°å®‰å…¨æ¼æ´æ—¶ï¼ŒDependabot ä¼šç«‹å³é€šçŸ¥æˆ‘ä»¬å¹¶è‡ªåŠ¨æ‰“å¼€åŒ…å«å¿…è¦æ›´æ–°çš„ PRã€‚è¿™ä¸æ‰«ææˆ‘ä»¬çš„ Docker é•œåƒä¸€èµ·ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿä¿®è¡¥æ¼æ´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éƒ¨ç½²å®‰å…¨æœ€ä½³å®è·µ&#34;&gt;éƒ¨ç½²å®‰å…¨æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;p&gt;ä½œä¸º Kubernetes ç¯å¢ƒä¸­çš„å…³é”®ç»„ä»¶ï¼Œæˆ‘ä»¬åŠªåŠ›å°½å¯èƒ½éµå¾ª Kubernetes å®‰å…¨æœ€ä½³å®è·µã€‚è¿™åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½æƒé™ â€”&lt;/strong&gt; æˆ‘ä»¬è®¾è®¡äº† RBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰è§„èŒƒï¼Œä»¥ä¾¿å¯¹ NGINX Gateway Fabric éœ€è¦è®¿é—®çš„èµ„æºå…·æœ‰æ‰€éœ€çš„æœ€ä½æƒé™ã€‚ä»…å®šä¹‰æ­£å¸¸æ“ä½œæ˜ç¡®æ‰€éœ€çš„æƒé™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å•ä¸€è´£ä»»åŸåˆ™ â€”&lt;/strong&gt; æ¯ä¸ªå®¹å™¨åŒ–åº”ç”¨ç¨‹åºéƒ½åº”å…·æœ‰å•ä¸€èŒè´£ï¼Œè¿™æ„å‘³ç€å®ƒåº”ä»…æ‰§è¡Œä¸€é¡¹ä»»åŠ¡æˆ–åŠŸèƒ½ã€‚éµå¾ªè¿™ä¸€åŸåˆ™ï¼Œæˆ‘ä»¬å°† NGINX Gateway Fabric è®¾è®¡ä¸ºå¤šå®¹å™¨åº”ç”¨ç¨‹åºï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶åœ¨ä¸ NGINX äºŒè¿›åˆ¶æ–‡ä»¶ä¸åŒçš„å®¹å™¨ä¸­è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼ºåŒ–å®¹å™¨å®‰å…¨ä¸Šä¸‹æ–‡ â€”&lt;/strong&gt; æˆ‘ä»¬å·²åœ¨æ¯ä¸ªå®¹å™¨ä¸Šé…ç½®äº†å®‰å…¨ä¸Šä¸‹æ–‡ï¼Œä»¥åŒ…å«ä»¥ä¸‹å†…å®¹
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬éµå¾ªâ€œæœ€å° Linux åŠŸèƒ½â€æ¨¡å‹ï¼Œä» NGINX Gateway Fabric Pod ä¸­è¿è¡Œçš„å®¹å™¨ä¸­åˆ é™¤æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶æ˜¾å¼ä»…æ·»åŠ é¡¹ç›®è¿è¡Œæ‰€éœ€çš„åŠŸèƒ½ã€‚è¿™æœ‰åŠ©äºé™ä½å®¹å™¨é­å—æ½œåœ¨æƒé™å‡çº§æ”»å‡»çš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ç¡®ä¿åœ¨å®¹å™¨ä¸­è¿è¡Œçš„ä»»ä½•è¿›ç¨‹éƒ½ä¸èƒ½è·å¾—æ¯”å…¶çˆ¶è¿›ç¨‹æ›´å¤šçš„æƒé™ã€‚è¿™æ˜¯é€šè¿‡åœ¨å®¹å™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­å°†â€œAllowPrivilegeEscalationâ€æ ‡å¿—è®¾ç½®ä¸º false æ¥å®ç°çš„ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬çš„å®¹å™¨é…ç½®äº†åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿæœ‰åŠ©äºå®æ–½ä¸å¯å˜çš„åŸºç¡€æ¶æ„ç­–ç•¥ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å®¹å™¨é…ç½®ä¸ºå†™å…¥å·²è£…è½½çš„å·ï¼Œå¹¶åœ¨å®¹å™¨çš„å®‰å…¨ä¸Šä¸‹æ–‡ä¸­å°†â€œreadOnlyRootFilesystemâ€æ ‡å¿—è®¾ç½®ä¸º trueã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†â€œrunAsUserâ€å’Œâ€œrunAsGroupâ€æ ‡å¿—è®¾ç½®ä¸ºéæ ¹å€¼ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨ Pod å®‰å…¨ä¸Šä¸‹æ–‡ä¸­å°† &amp;lsquo;runAsNonRoot&amp;rsquo; æ ‡å¿—è®¾ç½®ä¸º trueï¼Œä»¥å¼ºåˆ¶å®¹å™¨å¿…é¡»ä»¥é root ç”¨æˆ·èº«ä»½è¿è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆ&#34;&gt;ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¸Œæœ›è¿™äº›å®‰å…¨å¼€å‘å®è·µèƒ½ä¸ºä½ æä¾›ä¸€äº›æƒ³æ³•ï¼Œäº†è§£å¦‚ä½•åœ¨å¼€å‘å¼¹æ€§åº”ç”¨å’Œé€‰æ‹©å¹³å°å·¥å…·çš„åŒæ—¶ï¼Œæœ€å¤§é™åº¦åœ°é™ä½æš´éœ²é£é™©ã€‚æˆ‘ä»¬å¾ˆæƒ³å¬å¬ä½ æ˜¯å¦æœ‰å…´è¶£ä½¿ç”¨ &lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt; æ¥æ”¹å–„ Kubernetes å¹³å°çš„å®‰å…¨çŠ¶å†µã€‚æˆ‘ä»¬é¼“åŠ±æ‚¨ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥è´¡çŒ®è€…èº«ä»½åŠ å…¥é¡¹ç›®&lt;/li&gt;
&lt;li&gt;åœ¨å®éªŒå®¤ä¸­å°è¯•å®ç°&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å¹¶æä¾›åé¦ˆ&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä¸ºä»€ä¹ˆæˆ‘ä»¬å†³å®šä»æ–°å¼€å§‹æˆ‘ä»¬çš„ NGINX Gateway Fabric</title>
      <link>https://cloudnativecn.com/blog/why-we-decided-to-start-fresh-with-our-nginx-gateway-fabric/</link>
      <pubDate>Wed, 08 Nov 2023 15:33:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/why-we-decided-to-start-fresh-with-our-nginx-gateway-fabric/</guid>
      <description>&lt;p&gt;è¯‘è€…æ³¨ï¼š
æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://www.nginx.com/blog/why-we-decided-to-start-fresh-with-our-nginx-gateway-fabric/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.nginx.com/blog/why-we-decided-to-start-fresh-with-our-nginx-gateway-fabric/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Gateway API å·²ç»æ­£å¼ GAï¼Œæ‚¨å¯èƒ½å¥½å¥‡ä½œä¸ºç¤¾åŒºçš„ä¸€ä¸ªé‡è¦å®ç°ï¼ŒF5 NGINX æ˜¯å¦‚ä½•å†³ç­–å’Œå‘å±•è¯¥é¡¹ç›®çš„ã€‚F5 çš„äº§å“ç®¡ç†æ€»ç›‘ Brian Ehlert ä»¥åŠé¦–å¸­è½¯ä»¶å·¥ç¨‹å¸ˆ Matthew Yacobucci å°†åœ¨æœ¬æ–‡ä¸­ä¸ºæ‚¨é˜è¿°&lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt;é¡¹ç›®çŠ¶æ€ï¼Œä»¥åŠæœªæ¥çš„ç›®æ ‡ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨ Kubernetes Ingress æ§åˆ¶å™¨çš„ä¸–ç•Œé‡Œï¼ŒNGINX å·²ç»éå¸¸æˆåŠŸåœ°è¿è¡Œäº†ã€‚NGINX Ingress Controller è¢«å¹¿æ³›éƒ¨ç½²ç”¨äºå•†ä¸š Kubernetes ç”Ÿäº§ç”¨ä¾‹ï¼ŒåŒæ—¶ä¹Ÿä½œä¸ºå¼€æºç‰ˆæœ¬è¿›è¡Œå¼€å‘å’Œç»´æŠ¤ã€‚å› æ­¤ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºï¼Œå½“ Kubernetes ç½‘ç»œï¼ˆGateway APIï¼‰å‡ºç°é‡å¤§æ”¹è¿›æ—¶ï¼Œæˆ‘ä»¬ä¼šç»§ç»­åšä¸€ä»¶å¥½äº‹ï¼Œå¹¶åœ¨æˆ‘ä»¬ç°æœ‰çš„ Ingress äº§å“ä¸­å®ç°å®ƒã€‚&lt;/p&gt;
&lt;p&gt;ç›¸åï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€æ¡ä¸åŒçš„é“è·¯ã€‚çœ‹åˆ°æ–°çš„ Gateway API çš„æƒŠäººå¯èƒ½æ€§ï¼Œä»¥åŠæˆ‘ä»¬å®Œå…¨é‡æ–°æ„æƒ³å¦‚ä½•åœ¨ Kubernetes ä¸­å¤„ç†è¿æ¥çš„æœºä¼šï¼Œæˆ‘ä»¬æ„è¯†åˆ°å°† Gateway API å®ç°ç¡¬å¡åˆ°æˆ‘ä»¬ç°æœ‰çš„ Ingress äº§å“ä¸­å°†é™åˆ¶è¿™ç§æ— é™çš„æœªæ¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å†³å®šæ¨å‡ºæˆ‘ä»¬è‡ªå·±çš„ç½‘å…³ API é¡¹ç›®â€”â€”&lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt;ã€‚è¯¥é¡¹ç›®æ˜¯å¼€æºçš„ï¼Œå°†é€æ˜å’Œåä½œåœ°è¿ä½œã€‚æˆ‘ä»¬å¾ˆé«˜å…´èƒ½ä¸å¤–éƒ¨è´¡çŒ®è€…åˆä½œï¼Œå¹¶ä¸ä»–äººåˆ†äº«è¿™æ®µæ—…ç¨‹ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›åˆ›é€ ä¸€äº›ç‰¹åˆ«è€Œç‹¬ç‰¹çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬å¦‚ä½•åšå‡ºç½‘å…³-api-å†³ç­–&#34;&gt;æˆ‘ä»¬å¦‚ä½•åšå‡ºç½‘å…³ API å†³ç­–&lt;/h2&gt;
&lt;p&gt;è™½ç„¶å›´ç»• Gateway API åˆ›å»ºä¸€ä¸ªå…¨æ–°é¡¹ç›®çš„å†³å®šæ¥è‡ªä¹è§‚å’Œå…´å¥‹ï¼Œä½†æœ¬è´¨ä¸Šå®ƒæ˜¯åŸºäºå¥å…¨çš„ä¸šåŠ¡å’Œäº§å“æˆ˜ç•¥é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;Kubernetes çš„é•¿æœŸè¿½éšè€…å¯èƒ½å·²ç»çŸ¥é“ NGINX Ingress Controller çš„å¼€æºå’Œå•†ä¸šç‰ˆæœ¬ã€‚ä¸¤è€…åˆ†åˆ«åœ¨æ•°æ®å¹³é¢éƒ¨ç½²äº† NGINX å¼€æºå’Œ NGINX  Plus å•†ä¸šåå‘ä»£ç†ï¼Œä»–ä»¬éƒ½æ˜¯ç»è¿‡å®æˆ˜è€ƒéªŒçš„ NGINX æ•°æ®å¹³é¢ã€‚åœ¨ Kubernetes ä¹‹å‰ï¼ŒNGINX çš„æ•°æ®å¹³é¢å·²ç»éå¸¸é€‚åˆè´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†ã€‚åœ¨ Kubernetes ä¸­ï¼Œæˆ‘ä»¬çš„ Ingress æ§åˆ¶å™¨å¯å®ç°ç›¸åŒç±»å‹çš„å…³é”®è¯·æ±‚è·¯ç”±å’Œåº”ç”¨ç¨‹åºäº¤ä»˜ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;NGINX ä»¥æ„å»ºè½»é‡çº§ã€é«˜æ€§èƒ½ã€ç»è¿‡è‰¯å¥½æµ‹è¯•å¹¶å‡†å¤‡å¥½åº”å¯¹è‹›åˆ»ç¯å¢ƒçš„å•†ä¸šäº§å“è€Œè‡ªè±ªã€‚å› æ­¤ï¼ŒKubernetes Ingress Controller çš„äº§å“ç­–ç•¥åæ˜ äº†æˆ‘ä»¬çš„åå‘ä»£ç†äº§å“ç­–ç•¥â€”â€”ä¸ºæ›´ç®€å•çš„ç”¨ä¾‹åˆ¶ä½œä¸€ä¸ªå¼ºå¤§çš„å¼€æºäº§å“ï¼Œå¹¶ä¸ºå…³é”®ä¸šåŠ¡åº”ç”¨ç¨‹åºç¯å¢ƒä¸­çš„ç”Ÿäº§ Ingress Controller åˆ¶ä½œä¸€ä¸ªå…·æœ‰é™„åŠ ç‰¹æ€§å’ŒåŠŸèƒ½çš„å•†ä¸šäº§å“ã€‚è¯¥ç­–ç•¥åœ¨ Ingress Controller é¢†åŸŸå¥æ•ˆï¼Œéƒ¨åˆ†åŸå› æ˜¯ Ingress Controller ç¼ºä¹æ ‡å‡†åŒ–ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„è‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼ˆCRDï¼‰æ¥æä¾›è´Ÿè½½å‡è¡¡å’Œåå‘ä»£ç†ç­‰é«˜çº§åŠŸèƒ½ï¼Œå¼€å‘äººå‘˜å’Œæ¶æ„å¸ˆåœ¨ Kubernetes ä¹‹å¤–çš„ç½‘ç»œäº§å“ä¸­äº«å—è¿™äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„å®¢æˆ·ä¾èµ–å¹¶ä¿¡ä»» NGINX Ingress Controllerï¼Œå•†ä¸šç‰ˆæœ¬å·²ç»å…·æœ‰ Gateway API æ—¨åœ¨è§£å†³çš„è®¸å¤šå…³é”®é«˜çº§åŠŸèƒ½ã€‚æ­¤å¤–ï¼ŒNGINX å¾ˆæ—©å°±å‚ä¸äº† Gateway API é¡¹ç›®ï¼Œæˆ‘ä»¬è®¤è¯†åˆ° Gateway API ç”Ÿæ€ç³»ç»Ÿéœ€è¦å‡ å¹´æ—¶é—´æ‰èƒ½å®Œå…¨æˆç†Ÿã€‚ï¼ˆäº‹å®ä¸Šï¼ŒGateway API çš„è®¸å¤šè§„èŒƒéƒ½åœ¨ä¸æ–­å‘å±•ï¼Œä¾‹å¦‚ GAMMA è§„èŒƒï¼Œä»¥ä½¿å…¶èƒ½å¤Ÿæ›´å¥½åœ°ä¸æœåŠ¡ç½‘æ ¼é›†æˆ)ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æˆ‘ä»¬è®¤ä¸ºï¼Œå°† beta çº§ Gateway API è§„èŒƒç¡¬å¡ç»™ NGINX Ingress Controller ä¼šç»™æˆç†Ÿçš„ä¼ä¸šçº§ Ingress æ§åˆ¶å™¨å¸¦æ¥ä¸å¿…è¦çš„ä¸ç¡®å®šæ€§å’Œå¤æ‚æ€§ã€‚æˆ‘ä»¬åœ¨å•†ä¸šä¸Šé”€å”®çš„ä»»ä½•ä¸œè¥¿éƒ½å¿…é¡»ç¨³å®šã€å¯é ï¼Œå¹¶ä¸” 100% å‡†å¤‡å¥½ç”Ÿäº§ã€‚Gateway API è§£å†³æ–¹æ¡ˆä¹Ÿå°†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œä½†è¿™ä¸ªè¿‡ç¨‹ä»ç„¶åªæ˜¯å¼€å§‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬å¯¹-nginx-gateway-fabric-çš„ç›®æ ‡&#34;&gt;æˆ‘ä»¬å¯¹ NGINX Gateway Fabric çš„ç›®æ ‡&lt;/h2&gt;
&lt;p&gt;å€ŸåŠ© NGINX Gateway Fabricï¼Œæˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªç»å¾—èµ·æ—¶é—´è€ƒéªŒçš„äº§å“ï¼Œå°±åƒ NGINX Plus å’Œ NGINX å¼€æºä¸€æ ·ã€‚ä¸ºäº†è¾¾åˆ°æˆ‘ä»¬æ„¿æ„å°† Gateway API é¡¹ç›®æ ‡è®°ä¸ºâ€œé¢å‘æœªæ¥â€çš„åœ°æ­¥ï¼Œæˆ‘ä»¬æ„è¯†åˆ°æˆ‘ä»¬éœ€è¦å°è¯•å…¶æ•°æ®å’Œæ§åˆ¶å¹³é¢çš„æ¶æ„é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ç ”ç©¶ä¸åŒçš„æ–¹æ³•æ¥ç®¡ç†ç¬¬ 4 å±‚å’Œç¬¬ 7 å±‚è¿æ¥æˆ–æœ€å°åŒ–å¤–éƒ¨ä¾èµ–å…³ç³»ã€‚è¿™ç§å®éªŒæœ€å¥½åœ¨ä¸€å¼ ç™½çº¸ä¸Šè¿›è¡Œï¼Œæ²¡æœ‰å†å²å…ˆä¾‹å’Œè¦æ±‚ã€‚è™½ç„¶æˆ‘ä»¬ä½¿ç”¨ä¹…ç»è€ƒéªŒçš„ NGINX æ•°æ®å¹³é¢ä½œä¸º NGINX ç½‘å…³ç»“æ„çš„åŸºç¡€ç»„ä»¶ï¼Œä½†æˆ‘ä»¬å¯¹é™¤æ­¤ä¹‹å¤–çš„æ–°æƒ³æ³•æŒå¼€æ”¾æ€åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¸Œæœ›ä¸º Gateway API èµ„æºæä¾›å…¨é¢çš„ã€ä¸ä¾›åº”å•†æ— å…³çš„é…ç½®äº’æ“ä½œæ€§ã€‚ä¸ç°æœ‰çš„ Kubernetes Ingress èŒƒå¼ç›¸æ¯”ï¼ŒGateway API æœ€å¤§çš„æ”¹è¿›ä¹‹ä¸€æ˜¯å®ƒæ ‡å‡†åŒ–äº†æœåŠ¡ç½‘ç»œçš„è®¸å¤šå…ƒç´ ã€‚ä»ç†è®ºä¸Šè®²ï¼Œè¿™ç§æ ‡å‡†åŒ–åº”è¯¥ä¼šå¸¦æ¥ä¸€ä¸ªæ›´ç¾å¥½çš„æœªæ¥ï¼Œè®¸å¤š Gateway API èµ„æºå¯ä»¥è½»æ¾äº¤äº’å’Œè¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œæ„å»ºè¿™ä¸€æœªæ¥çš„å…³é”®æ˜¯æŠ›å¼ƒç‰¹å®šäºä¾›åº”å•†çš„ CRDï¼ˆè¿™å¯èƒ½å¯¼è‡´ä¾›åº”å•†é”å®šï¼‰ã€‚åœ¨å¿…é¡»æ”¯æŒä¸“ä¸ºå…¥å£æ§åˆ¶é¢†åŸŸè®¾è®¡çš„ CRD çš„æ··åˆäº§å“ä¸­ï¼Œè¿™å¯èƒ½ä¼šå˜å¾—éå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ã€‚åœ¨å°†äº’æ“ä½œæ€§ä½œä¸ºé¦–è¦å…³æ³¨ç‚¹çš„å¼€æºé¡¹ç›®ä¸­ï¼Œè¿™æ›´å®¹æ˜“ã€‚ä¸ºäº†æ‘’å¼ƒç´§å¯†é“¾æ¥çš„ CRDï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºä¸€äº›åªå…³æ³¨ Gateway API åŠå…¶ç»„æˆ API çš„æ–°è¡¨é¢ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŠ å…¥æˆ‘ä»¬çš„-gateway-api-ä¹‹æ—…&#34;&gt;åŠ å…¥æˆ‘ä»¬çš„ Gateway API ä¹‹æ—…&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»å¤„äºéå¸¸æ—©æœŸçš„é˜¶æ®µã€‚åªæœ‰å°‘æ•°é¡¹ç›®å’Œäº§å“å®ç°äº† Gateway API è§„èŒƒï¼Œå¹¶ä¸”å¤§å¤šæ•°é¡¹ç›®å’Œäº§å“é€‰æ‹©å°†å…¶åµŒå…¥åˆ°ç°æœ‰é¡¹ç›®å’Œäº§å“ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€è¿™æ˜¯ä¸€ä¸ªå……æ»¡æœºé‡çš„æ—¶æœŸâ€”â€”å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æœ€ä½³æ—¶æœºã€‚æˆ‘ä»¬å®Œå…¨ä»¥å¼€æ”¾æ–¹å¼è¿è¡Œ NGINX Gateway Fabric é¡¹ç›®ï¼Œå…·æœ‰é€æ˜çš„å†³ç­–å’Œé¡¹ç›®æ²»ç†ã€‚ç”±äºè¯¥é¡¹ç›®æ˜¯ç”¨ Go ç¼–å†™çš„ï¼Œå› æ­¤æˆ‘ä»¬é‚€è¯·åºå¤§çš„ Gopher ç¤¾åŒºæå‡ºå»ºè®®ã€å¼€å§‹æäº¤ PR å’Œ/æˆ–å‘æˆ‘ä»¬æå‡ºæƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;Gateway API å¯èƒ½ä¼šæ”¹å˜æ•´ä¸ª Kubernetes æ ¼å±€ã€‚å¯èƒ½ä¸å†éœ€è¦æ•´ç±»äº§å“ï¼Œä¸”æ–°äº§å“å¯èƒ½ä¹Ÿä¼šå‡ºç°ã€‚Gateway API æä¾›äº†å¦‚æ­¤ä¸°å¯Œçš„å¯èƒ½æ€§ï¼Œè€å®è¯´ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æœ€ç»ˆä¼šèµ°å‘ä½•æ–¹â€”â€”ä½†æˆ‘ä»¬çœŸçš„å¾ˆæœŸå¾…å®ƒçš„æ—…ç¨‹ã€‚ä¸€èµ·æ¥æ—…è¡Œå§ï¼Œä¼šå¾ˆæœ‰è¶£ï¼&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥ä»ä»¥ä¸‹æ–¹é¢å¼€å§‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¥è´¡çŒ®è€…èº«ä»½åŠ å…¥é¡¹ç›®&lt;/li&gt;
&lt;li&gt;åœ¨å®éªŒå®¤ä¸­å°è¯•å®æ–½&lt;/li&gt;
&lt;li&gt;æµ‹è¯•å’Œæä¾›åé¦ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦åŠ å…¥è¯¥é¡¹ç›®ï¼Œè¯·è®¿é—® GitHub ä¸Šçš„ &lt;a href=&#34;https://github.com/nginxinc/nginx-gateway-fabric&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Gateway Fabric&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³ä¸æˆ‘ä»¬çš„ä¸“å®¶å°±æ­¤é¡¹ç›®å’Œå…¶ä»– NGINX é¡¹ç›®è¿›è¡Œå®æ—¶èŠå¤©ï¼Œè¯·å‰å¾€ &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;KubeCon North America 2023 &lt;/a&gt;çš„ NGINX å±•å°ï¼NGINX æ˜¯ F5 çš„ä¸€éƒ¨åˆ†ï¼Œå¾ˆè£å¹¸æˆä¸ºä»Šå¹´ KubeCon NA çš„ç™½é‡‘èµåŠ©å•†ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨é‚£é‡Œè§åˆ°ä½ ï¼&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
