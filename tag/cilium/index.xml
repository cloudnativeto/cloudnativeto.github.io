<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cilium | äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰</title>
    <link>https://cloudnativecn.com/tag/cilium/</link>
      <atom:link href="https://cloudnativecn.com/tag/cilium/index.xml" rel="self" type="application/rss+xml" />
    <description>Cilium</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Wed, 05 Feb 2025 15:22:42 +0800</lastBuildDate>
    <image>
      <url>https://cloudnativecn.com/media/sharing.png</url>
      <title>Cilium</title>
      <link>https://cloudnativecn.com/tag/cilium/</link>
    </image>
    
    <item>
      <title>Cilium v1.17.0 å‘å¸ƒï¼Œæ–°ç‰¹æ€§ä¸€è§ˆ</title>
      <link>https://cloudnativecn.com/blog/cilium-1-17-0-release-highlights/</link>
      <pubDate>Wed, 05 Feb 2025 15:22:42 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-1-17-0-release-highlights/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/cilium/cilium/releases/tag/v1.17.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium v1.17.0&lt;/a&gt; å¸¦æ¥äº†è®¸å¤šæ–°çš„å¢å¼ºå’Œæ”¹è¿›ï¼Œä»¥ä¸‹æ˜¯æœ¬æ¬¡æ›´æ–°çš„ä¸»è¦äº®ç‚¹ï¼š&lt;/p&gt;
&lt;h2 id=&#34;-ç½‘ç»œnetworking&#34;&gt;ğŸš  ç½‘ç»œï¼ˆNetworkingï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸš¦ æœåŠ¡è´¨é‡ï¼ˆQuality of Serviceï¼‰&lt;/strong&gt;ï¼šå¯ä¸º Pod æ ‡æ³¨ &lt;code&gt;Guaranteed&lt;/code&gt;ã€&lt;code&gt;Burstable&lt;/code&gt; æˆ– &lt;code&gt;BestEffort&lt;/code&gt; å‡ºç«™æµé‡ä¼˜å…ˆçº§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŒ å¤šé›†ç¾¤æœåŠ¡ APIï¼ˆMulti-Cluster Service APIï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨ Kubernetes MCS åœ¨ Cilium Cluster Mesh ä¸­ç®¡ç†å…¨å±€æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ”€ åŸºäº L4 åè®®çš„è´Ÿè½½å‡è¡¡ï¼ˆLoad Balance based on L4 Protocolï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåŒºåˆ† TCP å’Œ UDP è´Ÿè½½å‡è¡¡ï¼Œä½¿ç›¸åŒç«¯å£çš„å¤šä¸ªæœåŠ¡èƒ½å¤Ÿåˆ†å‘åˆ°ä¸åŒçš„åç«¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ¥² æ¯ä¸ªæœåŠ¡çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆPer-Service LB Algorithmsï¼‰&lt;/strong&gt;ï¼šå¯ä¸ºå•ä¸ªæœåŠ¡é€‰æ‹© &lt;code&gt;maglev&lt;/code&gt; æˆ– &lt;code&gt;random&lt;/code&gt; è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â›” æœåŠ¡æ¥æºèŒƒå›´çš„æ‹’ç»åˆ—è¡¨ï¼ˆDeny lists for Service source rangesï¼‰&lt;/strong&gt;ï¼šæ§åˆ¶ Kubernetes &lt;code&gt;loadBalancerSourceRanges&lt;/code&gt; æ˜¯å¦ä½œä¸ºå…è®¸æˆ–æ‹’ç»åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŠ æ›´å¥½çš„ IPAM æ§åˆ¶ï¼ˆBetter control over IPAMï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåŸºäº AWS æ ‡ç­¾çš„é™æ€ IP åˆ†é…ï¼Œå¤šæ± æ¨¡å¼å¯æ”¯æŒå•ä¸ª IP èŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ› ï¸ åŠ¨æ€ MTU æ£€æµ‹ï¼ˆDynamic MTU detectionï¼‰&lt;/strong&gt;ï¼šCilium ç°åœ¨å¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æµ‹å¹¶è°ƒæ•´ MTUï¼Œæ— éœ€é‡å¯ä»£ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-å®‰å…¨security&#34;&gt;ğŸ’‚ï¸ å®‰å…¨ï¼ˆSecurityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸš€ æ”¹è¿›ç½‘ç»œç­–ç•¥æ€§èƒ½ï¼ˆImproved network policy performanceï¼‰&lt;/strong&gt;ï¼šé™ä½è®¡ç®—å¤æ‚ç½‘ç»œç­–ç•¥ç»„åˆçš„æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ—‚ï¸ ä¼˜å…ˆå¤„ç†å…³é”®ç½‘ç»œç­–ç•¥ï¼ˆPrioritize critical network policiesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒ Kubernetes &lt;code&gt;priorityNamespaces&lt;/code&gt;ï¼Œåœ¨ä½¿ç”¨ CiliumEndpointSlices æ—¶ä¼˜å…ˆä¼ æ’­å…³é”®å‘½åç©ºé—´çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“‹ ç½‘ç»œç­–ç•¥éªŒè¯ï¼ˆValidate Network Policiesï¼‰&lt;/strong&gt;ï¼šåœ¨åˆ›å»ºç½‘ç»œç­–ç•¥æ—¶å¯è·å¾—æ›´å¥½çš„åé¦ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ·ï¸ é€šè¿‡æ ‡ç­¾é€‰æ‹© CIDRGroupsï¼ˆSelect CIDRGroups by Labelï¼‰&lt;/strong&gt;ï¼šå¯ä¸º CIDRGroups æ·»åŠ æ ‡ç­¾ï¼Œå¹¶ç”¨äºç½‘ç»œç­–ç•¥é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ›ï¸ æ‰©å±• ToServices ç”¨äºé›†ç¾¤å†…æœåŠ¡ï¼ˆExtend ToServices for in-cluster servicesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒå¸¦é€‰æ‹©å™¨çš„æœåŠ¡é€šè¿‡ &lt;code&gt;ToServices&lt;/code&gt; ç½‘ç»œç­–ç•¥è¿›è¡Œé€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸš§ æ”¯æŒ hostNetwork çš„ FQDN è¿‡æ»¤ï¼ˆFQDN Filtering for hostNetworkï¼‰&lt;/strong&gt;ï¼šå¯ä½¿ç”¨ &lt;code&gt;CiliumClusterwideNetworkPolicy&lt;/code&gt; é…ç½®é›†ç¾¤èŠ‚ç‚¹çš„ DNS è¯·æ±‚çš„ L7 è¿‡æ»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“¶ ç«¯å£èŒƒå›´ä¸Šçš„ HTTP ç­–ç•¥ï¼ˆHTTP policies on port rangesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåœ¨å•ä¸ªç­–ç•¥ä¸­é‡å®šå‘å¤šä¸ªç«¯å£åˆ° Envoy è¿›è¡Œ L7 è¿‡æ»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-æœåŠ¡ç½‘æ ¼--gateway-apiservice-mesh--gateway-api&#34;&gt;ğŸ•¸ï¸ æœåŠ¡ç½‘æ ¼ &amp;amp; Gateway APIï¼ˆService Mesh &amp;amp; Gateway APIï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â›©ï¸ Gateway API 1.2.1&lt;/strong&gt;ï¼šæ”¯æŒæœ€æ–°çš„ Gateway API v1.2.1ï¼ŒåŒ…æ‹¬ HTTP é‡è¯•å’Œé•œåƒæµé‡æ¯”ä¾‹æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“ é™æ€ç½‘å…³åœ°å€ï¼ˆStatic Gateway Addressingï¼‰&lt;/strong&gt;ï¼šæ”¯æŒé™æ€æŒ‡å®šç½‘å…³åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ” æ”¹è¿› Envoy TLS å¤„ç†ï¼ˆImproved Envoy TLS handlingï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨ SDS ç®¡ç† Envoy çš„ TLS å¯è§æ€§å¯†é’¥ï¼Œæé«˜ç­–ç•¥è®¡ç®—é€Ÿåº¦å’Œå¯†é’¥è®¿é—®æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-å¯è§‚æµ‹æ€§observability&#34;&gt;ğŸ‘ï¸ å¯è§‚æµ‹æ€§ï¼ˆObservabilityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸ” åŠ¨æ€ Hubble æŒ‡æ ‡ï¼ˆDynamic Hubble Metricsï¼‰&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;hubble-metrics-config&lt;/code&gt; ConfigMap é…ç½® Hubble æŒ‡æ ‡ï¼Œä¼˜åŒ–ç½‘ç»œå¯è§‚æµ‹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ›¤ï¸ é€šè¿‡ Prometheus ç›‘æ§å¯ç”¨çš„åŠŸèƒ½ï¼ˆTrack enabled features using Prometheusï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;cilium-agent&lt;/code&gt; å’Œ &lt;code&gt;cilium-operator&lt;/code&gt; ç»„ä»¶ç°å¯æš´éœ² Prometheus æŒ‡æ ‡ï¼Œæ˜¾ç¤ºå·²å¯ç”¨çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“Š æ›´å¤šæ–°æŒ‡æ ‡ï¼ˆMany new metricsï¼‰&lt;/strong&gt;ï¼šå¢å¼º BGPã€ç½‘ç»œè¿æ¥ã€ç½‘ç»œç­–ç•¥ã€Pod ç®¡ç†å’Œ Cilium ç»„ä»¶çŠ¶æ€çš„ç›‘æ§æŒ‡æ ‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-è§„æ¨¡scale&#34;&gt;ğŸŒ… è§„æ¨¡ï¼ˆScaleï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“ˆ æ”¹è¿›é›†ç¾¤è¿æ¥æ€§æ£€æŸ¥ï¼ˆBetter cluster connectivity checkingï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;cilium-health&lt;/code&gt; ç»„ä»¶é’ˆå¯¹å¤§è§„æ¨¡é›†ç¾¤è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä»¥æé«˜ç½‘ç»œå¥åº·æ£€æŸ¥çš„å¯é æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â³ é€Ÿç‡é™åˆ¶ç›‘æ§äº‹ä»¶ï¼ˆRate-limit monitor eventsï¼‰&lt;/strong&gt;ï¼šä¼˜åŒ– eBPF äº‹ä»¶å¤„ç†ï¼Œé™ä½ CPU è´Ÿè½½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ‘¥ åŒå†™èº«ä»½æ¨¡å¼ï¼ˆDouble-Write Identity modeï¼‰&lt;/strong&gt;ï¼šæ–°å¢å®‰å…¨èº«ä»½åˆ†é…æ¨¡å¼ï¼Œç®€åŒ– CRD å’Œ KVStore ä¹‹é—´çš„è¿ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âš–ï¸ æ›´å¥½çš„è§„æ¨¡æµ‹è¯•ï¼ˆBetter scale testingï¼‰&lt;/strong&gt;ï¼šæœ¬æ¬¡å‘å¸ƒåŒ…å«å®šæœŸè‡ªåŠ¨åŒ–å¤§è§„æ¨¡æµ‹è¯•ï¼Œå¢å¼ºç½‘ç»œç­–ç•¥çš„ç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-ç¤¾åŒºcommunity&#34;&gt;ğŸ¡ ç¤¾åŒºï¼ˆCommunityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â¤ï¸ Cilium åœ¨ç”Ÿäº§ç¯å¢ƒçš„ç”¨æˆ·æ¡ˆä¾‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cncf.io/case-studies/seznam/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Seznam&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/alibaba/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Alibaba Cloud&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/syseleven/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SysEleven&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/qingcloud/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;QingCloud&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=Ennjmo9TFaM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ECCO&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=YNDp7Id7Bbs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Reddit&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=vOSiVeBXYpM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Confluent&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=2KlVTx611bk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SamsungAds&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=M0PincxlHpI&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sony&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium_Annual_Report_2024.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å¹´åº¦æŠ¥å‘Š 2024&lt;/a&gt;&lt;/strong&gt;ï¼šæ€»ç»“äº†ç¤¾åŒºçš„å¹´åº¦äº®ç‚¹ï¼Œå¹¶å¼ºè°ƒäº† Kubernetes ç½‘ç»œçš„å…³é”®å‘å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤¾åŒºæ´»åŠ¨&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Cilium ç¤¾åŒºåœ¨ &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/co-located-events/cilium-ebpf-day/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium + eBPF Day&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/cilium/dev-summits/tree/main/2024-NA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium Developer Summit&lt;/a&gt; è¿›è¡Œçº¿ä¸‹èšä¼šã€‚&lt;/li&gt;
&lt;li&gt;æ¬¢è¿å‚åŠ å³å°†åˆ°æ¥çš„ &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-europe/co-located-events/ciliumcon/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CiliumCon&lt;/a&gt; å’Œ &lt;a href=&#34;https://docs.google.com/forms/d/e/1FAIpQLSd8E1dtCYiwqcw1MemQU3RDKlIQNBi2dRVMVGqDPgSow9mKjA/viewform?usp=header&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium Developer Summit&lt;/a&gt;ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 2024 å¹´åº¦æŠ¥å‘Šè§£è¯»</title>
      <link>https://cloudnativecn.com/blog/cilium-annual-report-2024/</link>
      <pubDate>Tue, 07 Jan 2025 17:02:28 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-annual-report-2024/</guid>
      <description>&lt;p&gt;è¿‘æ—¥ Cilium é¡¹ç›®å‘å¸ƒäº† 2024 å¹´åº¦æŠ¥å‘Šï¼Œè§ &lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium_Annual_Report_2024.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github&lt;/a&gt;ã€‚è¿™ä»½æŠ¥å‘Šè¯¦ç»†å›é¡¾äº† Cilium åœ¨è¿‡å»ä¸€å¹´ä¸­æ‰€å–å¾—çš„é‡å¤§æˆå°±ï¼Œå¹¶å±•æœ›äº†å…¶åœ¨äº‘åŸç”Ÿç½‘ç»œå’Œå®‰å…¨é¢†åŸŸçš„æœªæ¥å‘å±•æ–¹å‘ã€‚Cilium é¡¹ç›®è‡ªé¦–æ¬¡æäº¤ä»¥æ¥ï¼Œå†ç»è¿‘åå¹´å‘å±•ï¼Œå…¶åŠ¿å¤´æŒç»­å¼ºåŠ²ï¼Œæ­£å¼•é¢†äº‘åŸç”Ÿç½‘ç»œå’Œå®‰å…¨é¢†åŸŸçš„æ–°å˜é©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-çš„å“è¶Šå‘å±•&#34;&gt;Cilium çš„å“è¶Šå‘å±•&lt;/h2&gt;
&lt;p&gt;2024 å¹´æ˜¯ Cilium å‘å±•å†ç¨‹ä¸­è‡³å…³é‡è¦çš„ä¸€å¹´ï¼Œå®ƒä¸ä»…å·©å›ºäº†å…¶ä½œä¸º Kubernetes äº‹å®æ ‡å‡† CNI çš„åœ°ä½ï¼Œæ›´å‘å±•æˆä¸º Kubernetes ç¯å¢ƒä¸‹çš„ç»¼åˆç½‘ç»œå †æ ˆã€‚Cilium çš„æ¼”è¿›å±•ç¤ºäº†å…¶åº”å¯¹ç°ä»£äº‘åŸç”Ÿç¯å¢ƒæŒ‘æˆ˜çš„å“è¶Šèƒ½åŠ›ï¼Œä»æœ€åˆçš„ pod åˆ° pod è¿æ¥æ–¹æ¡ˆï¼Œæ‰©å±•åˆ°ä¸€ä¸ªç»Ÿä¸€ç½‘ç»œã€å¯è§‚å¯Ÿæ€§å’Œå®‰å…¨æ€§çš„é¡¹ç›®ï¼Œè¿™ä¸€åˆ‡éƒ½ç”± eBPF æŠ€æœ¯é©±åŠ¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&#34;&gt;å…³é”®é‡Œç¨‹ç¢‘ä¸é‡å¤§æˆå°±&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç¤¾åŒºè“¬å‹ƒå‘å±•&lt;/strong&gt;ï¼šCilium ç¤¾åŒºæŒç»­å£®å¤§ï¼Œè´¡çŒ®è€…å’Œè´¡çŒ®å…¬å¸æ•°é‡ä¸æ–­å¢åŠ ï¼Œç”¨æˆ·éå¸ƒé‡‘èã€ç‰©æµã€åª’ä½“ã€ç”µä¿¡ç­‰ä¼—å¤šè¡Œä¸šã€‚è‡ªåŠ å…¥ CNCF ä»¥æ¥ï¼Œè´¡çŒ®å…¬å¸æ•°é‡å¢é•¿äº† 90%ï¼Œè¾¾åˆ° 1,011 å®¶ï¼Œä¸ªäººè´¡çŒ®è€…å¢é•¿äº† 252%ï¼Œè¾¾åˆ° 4,464 äººã€‚Cilium è¿˜æ˜¯ CNCF ç”Ÿæ€ç³»ç»Ÿä¸­ç¬¬ä¸‰å¤§å‘å±•æœ€å¿«çš„é¡¹ç›®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æŠ€æœ¯åˆ›æ–°&lt;/strong&gt;ï¼šCilium åœ¨ 2024 å¹´å‘å¸ƒäº† 1.15 å’Œ 1.16 ä¸¤ä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œå¸¦æ¥äº†è¯¸å¤šåˆ›æ–°åŠŸèƒ½ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cilium 1.15&lt;/strong&gt;: å¼•å…¥äº†å¯¹ Gateway API 1.0 çš„å…¨é¢æ”¯æŒï¼Œä½¿ Cluster Mesh çš„å¯æ‰©å±•æ€§ç¿»å€ï¼Œå¢å¼ºäº†å¯è§‚æµ‹æ€§ï¼Œå°†æµé‡ä¸ç½‘ç»œç­–ç•¥å…³è”ï¼Œå¹¶æ‰©å±•äº† BGP çš„åŠŸèƒ½ï¼Œä»¥æ›´å¥½åœ°é›†æˆå¤–éƒ¨ä¸–ç•Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cilium 1.16&lt;/strong&gt;: ä»¥â€œæ›´å¿«ã€æ›´å¼ºã€æ›´æ™ºèƒ½â€ä¸ºä¸»é¢˜ï¼Œé€šè¿‡ netkit æ¶ˆé™¤äº†è™šæ‹Ÿç½‘ç»œå¼€é”€ï¼Œå®ç°äº†ä¸»æœºå’Œå®¹å™¨ä¹‹é—´çš„æ€§èƒ½å¯¹ç­‰ï¼›å¼•å…¥äº† BGPv2 APIï¼Œæ”¯æŒç”¨æˆ·å®šä¹‰å¤æ‚çš„ç½‘ç»œç­–ç•¥ï¼›æ”¯æŒå¤šæ’­æ•°æ®è·¯å¾„ï¼›å¹¶æ˜¾è‘—ä¼˜åŒ–äº† CPU å’Œå†…å­˜ä½¿ç”¨ï¼ŒåŒæ—¶å°†å°¾éƒ¨å»¶è¿Ÿé™ä½äº†é«˜è¾¾ 5 å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹¿æ³›åº”ç”¨&lt;/strong&gt;ï¼šç”¨æˆ·è°ƒæŸ¥æ˜¾ç¤ºï¼ŒCilium æ­£åœ¨é€æ­¥æ¥ç®¡ Kubernetes ç½‘ç»œå †æ ˆï¼ŒCluster Meshã€BGP å’Œ Gateway API ç­‰åŠŸèƒ½å·²å¹¿æ³›åº”ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚95% çš„å—è®¿è€…è¿è¡Œå¤šä¸ª Kubernetes é›†ç¾¤ï¼Œè€Œ Cilium è¢« CNCF æŠ€æœ¯é›·è¾¾è¯„ä¸ºé¡¶çº§å¤šé›†ç¾¤ç®¡ç†å·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¡Œä¸šè®¤å¯&lt;/strong&gt;ï¼šCilium è£è· OpenUK 2024 å¹´åº¦å¼€æºè½¯ä»¶å¥–ã€‚åŒæ—¶ï¼Œåœ¨ CNCF çš„å¤šé›†ç¾¤ç®¡ç†æŠ€æœ¯é›·è¾¾ä¸­ï¼ŒCilium è¢«è¯„ä¸ºæœ€å€¼å¾—é‡‡ç”¨çš„æŠ€æœ¯ï¼Œå¹¶åœ¨å®ç”¨æ€§å’Œæˆç†Ÿåº¦æ–¹é¢å‡è·å¾—æœ€é«˜åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;eBPF å®‰å…¨&lt;/strong&gt;ï¼šeBPF åŸºé‡‘ä¼šå‘å¸ƒäº†ä¸¤ä»½é‡è¦ç ”ç©¶æŠ¥å‘Šï¼Œæå‡äº†åŸºäº eBPF éƒ¨ç½²çš„å®‰å…¨æ€§ä¸æ“ä½œæŒ‡å¯¼ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;eBPF å®‰å…¨å¨èƒæ¨¡å‹&lt;/strong&gt;ï¼šè¯¦ç»†é˜è¿°äº† eBPF çš„æ½œåœ¨é£é™©ï¼Œå¹¶æä¾›äº†ç›¸åº”çš„ç¼“è§£ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;eBPF éªŒè¯å™¨ä»£ç å®¡è®¡&lt;/strong&gt;ï¼šå¼ºè°ƒäº†éªŒè¯å™¨åœ¨ä¿éšœ eBPF éƒ¨ç½²å®‰å…¨æ–¹é¢çš„ä½œç”¨ï¼Œå¹¶æå‡ºäº†æ”¹è¿›å»ºè®®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ç”¨æˆ·åé¦ˆä¸åº”ç”¨æ¡ˆä¾‹&#34;&gt;ç”¨æˆ·åé¦ˆä¸åº”ç”¨æ¡ˆä¾‹&lt;/h2&gt;
&lt;p&gt;æ¥è‡ªç”¨æˆ·çš„åé¦ˆå’Œæ¡ˆä¾‹è¿›ä¸€æ­¥å°è¯äº† Cilium åœ¨æ€§èƒ½ã€æˆæœ¬æ•ˆç›Šä»¥åŠåŠŸèƒ½æ–¹é¢çš„ä¼˜åŠ¿ã€‚ç”¨æˆ·æ™®éè®¤ä¸ºï¼ŒCilium æœ‰æ•ˆé™ä½äº†ç½‘ç»œæˆæœ¬å’Œ CPU æ¶ˆè€—ï¼ŒåŒæ—¶æä¾›äº†å“è¶Šçš„æ€§èƒ½å’Œä½å»¶è¿Ÿã€‚æ­¤å¤–ï¼ŒCilium çš„å¯è§‚å¯Ÿæ€§å·¥å…·ï¼ˆå¦‚ Hubbleï¼‰ä»¥åŠç½‘ç»œç­–ç•¥åŠŸèƒ½ä¹Ÿå—åˆ°äº†ç”¨æˆ·çš„å¹¿æ³›å¥½è¯„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœªæ¥å±•æœ›&#34;&gt;æœªæ¥å±•æœ›&lt;/h2&gt;
&lt;p&gt;å±•æœ› 2025 å¹´ï¼ŒCilium çš„å‘å±•åŠ¿å¤´å°†æŒç»­å¢å¼ºã€‚å¹³å°å·¥ç¨‹å’Œæ•´åˆè¶‹åŠ¿æ­£åœ¨é‡å¡‘ç»„ç»‡ç®¡ç† Kubernetes ç½‘ç»œçš„æ–¹å¼ï¼Œè€Œ Cilium æ­£å¤„äºè¿™åœºå˜é©çš„æ ¸å¿ƒã€‚æˆ‘ä»¬é¢„è®¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å †æ ˆå°†è¿›ä¸€æ­¥æ•´åˆç½‘ç»œåŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;Tetragon åœ¨é«˜çº§å®‰å…¨å¯è§‚å¯Ÿæ€§æ–¹é¢çš„åº”ç”¨å°†æ›´åŠ æ™®åŠã€‚&lt;/li&gt;
&lt;li&gt;Cilium å°†æ›´æ·±å…¥åœ°é›†æˆå¤–éƒ¨å’Œä¼ ç»Ÿå·¥ä½œè´Ÿè½½è‡³ Kubernetes ç¯å¢ƒã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä¸ä»…ä¼šè¢«å¹¿æ³›ç”¨ä½œ CNIï¼Œæ›´å°†ä½œä¸ºå…¨é¢çš„ Kubernetes ç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;Tetragon å°†ä¸æ–­è¿›åŒ–ï¼Œæä¾›æ›´å¼ºå¤§çš„æ£€æµ‹èƒ½åŠ›å’Œæ›´å…·è¡ŒåŠ¨åŠ›çš„å¨èƒå“åº”æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;Cilium çš„æ··åˆäº‘å’Œå¤šäº‘é›†æˆå°†åœ¨ 2025 å¹´å‘æŒ¥æ›´å¤§çš„ä½œç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Cilium å¯¹å¤–éƒ¨å·¥ä½œè´Ÿè½½ã€4 å±‚è´Ÿè½½å‡è¡¡ä»¥åŠ BGP å¢å¼ºåŠŸèƒ½çš„æ”¯æŒå°†å¼¥åˆ Kubernetes åŸç”Ÿç³»ç»Ÿä¸ä¼ ç»Ÿç³»ç»Ÿä¹‹é—´çš„é¸¿æ²Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Cilium é¡¹ç›®åœ¨ 2024 å¹´å–å¾—äº†å·¨å¤§æˆåŠŸï¼Œç¡®ç«‹äº†å…¶åœ¨ Kubernetes ç½‘ç»œé¢†åŸŸçš„é¢†å¯¼åœ°ä½ã€‚Cilium ä¸ä»…ä»…æ˜¯ä¸€ä¸ª CNIï¼Œæ›´æ˜¯ä¸€ä¸ªæ¶µç›–ç½‘ç»œã€å¯è§‚å¯Ÿæ€§å’Œå®‰å…¨æ€§çš„ç»¼åˆ Kubernetes ç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚éšç€äº‘åŸç”ŸæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼ŒCilium å°†ç»§ç»­å¼•é¢†è¡Œä¸šåˆ›æ–°ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¼ºå¤§ã€æ›´å¯é çš„äº‘åŸç”Ÿç½‘ç»œè§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿå¯¹æ¯”ï¼šIstio Ambient æ¨¡å¼ä¸ Cilium çš„æ‰©å±•æ€§èƒ½åˆ†æ</title>
      <link>https://cloudnativecn.com/blog/ambient-vs-cilium/</link>
      <pubDate>Tue, 22 Oct 2024 10:49:22 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/ambient-vs-cilium/</guid>
      <description>&lt;p&gt;æ½œåœ¨çš„ Istio ç”¨æˆ·ç»å¸¸ä¼šé—®ï¼šâ€œIstio ä¸ Cilium ç›¸æ¯”å¦‚ä½•ï¼Ÿâ€è™½ç„¶ Cilium æœ€åˆä»…æä¾› L3/L4 åŠŸèƒ½ï¼ˆå¦‚ç½‘ç»œç­–ç•¥ï¼‰ï¼Œä½†è¿‘æ¥çš„ç‰ˆæœ¬å¢åŠ äº†åŸºäº Envoy çš„æœåŠ¡ç½‘æ ¼åŠŸèƒ½ä»¥åŠ WireGuard åŠ å¯†ã€‚ä¸ Istio ä¸€æ ·ï¼ŒCilium ä¹Ÿæ˜¯ CNCF è®¤è¯çš„æ¯•ä¸šé¡¹ç›®ï¼Œå¹¶åœ¨ç¤¾åŒºä¸­å­˜åœ¨å¤šå¹´ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡è¡¨é¢ä¸Šçœ‹è¿™ä¸¤ä¸ªé¡¹ç›®æä¾›çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œä½†å®ƒä»¬çš„æ¶æ„å´æœ‰ç€æ˜¾è‘—ä¸åŒï¼Œå°¤å…¶æ˜¯ Cilium ä½¿ç”¨ eBPF å’Œ WireGuard åœ¨å†…æ ¸ä¸­å¤„ç†å’ŒåŠ å¯† L4 æµé‡ï¼Œè€Œ Istio åœ¨ç”¨æˆ·ç©ºé—´é€šè¿‡å…¶ ztunnel ç»„ä»¶å¤„ç† L4 æµé‡ã€‚è¿™äº›å·®å¼‚å¯¼è‡´äº†å…³äº Istio ä¸ Cilium åœ¨å¤§è§„æ¨¡ä¸‹æ€§èƒ½çš„å¹¿æ³›è®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡å·²æœ‰å…³äºç§Ÿæˆ·æ¨¡å‹ã€å®‰å…¨åè®®å’ŒåŸºæœ¬æ€§èƒ½çš„æ¯”è¾ƒï¼Œä½†å°šæœªæœ‰å…¨é¢çš„ä¼ä¸šçº§è¯„ä¼°æŠ¥å‘Šã€‚ä¸å…¶å¼ºè°ƒç†è®ºæ€§èƒ½ï¼Œæˆ‘ä»¬å¯¹ Istio çš„ Ambient æ¨¡å¼å’Œ Cilium è¿›è¡Œäº†æµ‹è¯•ï¼Œèšç„¦äºå»¶è¿Ÿã€ååé‡å’Œèµ„æºæ¶ˆè€—ç­‰å…³é”®æŒ‡æ ‡ã€‚é€šè¿‡æ¨¡æ‹Ÿä¸€ä¸ªç¹å¿™çš„ Kubernetes ç¯å¢ƒï¼Œæˆ‘ä»¬æ–½åŠ äº†é«˜è´Ÿè½½åœºæ™¯ï¼Œæœ€åå°† AKS é›†ç¾¤çš„è§„æ¨¡æ‰©å±•åˆ° 1000 ä¸ªèŠ‚ç‚¹ã€11000 ä¸ªæ ¸å¿ƒï¼Œä»¥äº†è§£è¿™äº›é¡¹ç›®åœ¨å¤§è§„æ¨¡ä¸‹çš„è¡¨ç°ã€‚ç»“æœæ˜¾ç¤ºï¼Œä¸¤è€…å„æœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œä½† Istio æ˜æ˜¾è¡¨ç°æ›´ä½³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æµ‹è¯•åœºæ™¯&#34;&gt;æµ‹è¯•åœºæ™¯&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å°† Istio å’Œ Cilium æ¨å‘æé™ï¼Œæˆ‘ä»¬åˆ›å»ºäº† 500 ä¸ªä¸åŒçš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡æ”¯æŒ 100 ä¸ª Podã€‚æ¯ä¸ªæœåŠ¡ä½äºå•ç‹¬çš„å‘½åç©ºé—´ä¸­ï¼Œä¸”åŒ…å«ä¸€ä¸ª&lt;a href=&#34;https://fortio.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fortio&lt;/a&gt;è´Ÿè½½ç”Ÿæˆå®¢æˆ·ç«¯ã€‚æˆ‘ä»¬å°†å®¢æˆ·ç«¯é™åˆ¶åœ¨ä¸€ä¸ªç”± 100 å° 32 æ ¸æœºå™¨ç»„æˆçš„èŠ‚ç‚¹æ± ä¸­ï¼Œä»¥æ¶ˆé™¤å…±åŒå®šä½çš„å®¢æˆ·ç«¯çš„å¹²æ‰°ï¼Œå¹¶ä¸ºæœåŠ¡åˆ†é…äº†å‰©ä½™çš„ 900 å° 8 æ ¸å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æµ‹è¯•åœºæ™¯&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æµ‹è¯•åœºæ™¯&#34; srcset=&#34;
               /blog/ambient-vs-cilium/scale-scenario_hu_6c696a9d03a74239.webp 400w,
               /blog/ambient-vs-cilium/scale-scenario_hu_b4833e715bfc3df3.webp 760w,
               /blog/ambient-vs-cilium/scale-scenario_hu_953ffb62d23288d4.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/ambient-vs-cilium/scale-scenario_hu_6c696a9d03a74239.webp&#34;
               width=&#34;760&#34;
               height=&#34;598&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æµ‹è¯•åœºæ™¯
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ Istio æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Ambient æ¨¡å¼ï¼Œåœ¨æ¯ä¸ªæœåŠ¡å‘½åç©ºé—´ä¸­éƒ¨ç½²äº†&lt;a href=&#34;https://istio.io/latest/docs/ambient/usage/waypoint/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;waypoint ä»£ç†&lt;/a&gt;ï¼Œå¹¶ä½¿ç”¨é»˜è®¤çš„å®‰è£…å‚æ•°ã€‚ä¸ºäº†ä½¿æµ‹è¯•åœºæ™¯å°½å¯èƒ½ç›¸ä¼¼ï¼Œæˆ‘ä»¬åœ¨ Cilium ä¸­å¯ç”¨äº†å‡ ä¸ªéé»˜è®¤åŠŸèƒ½ï¼ŒåŒ…æ‹¬ WireGuard åŠ å¯†ã€L7 ä»£ç†å’ŒèŠ‚ç‚¹åˆå§‹åŒ–ã€‚æˆ‘ä»¬è¿˜åœ¨æ¯ä¸ªå‘½åç©ºé—´ä¸­åˆ›å»ºäº†ä¸€ä¸ª Cilium ç½‘ç»œç­–ç•¥ï¼Œå¸¦æœ‰åŸºäº HTTP è·¯å¾„çš„è§„åˆ™ã€‚åœ¨ä¸¤ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡éšæœºåœ°å°†ä¸€ä¸ªæœåŠ¡æ‰©å±•åˆ° 85 è‡³ 115 ä¸ªå®ä¾‹å¹¶æ¯åˆ†é’Ÿé‡æ–°æ ‡è®°ä¸€ä¸ªå‘½åç©ºé—´ï¼Œç”Ÿæˆäº†å˜åŒ–ã€‚è¦æŸ¥çœ‹æˆ‘ä»¬ä½¿ç”¨çš„ç²¾ç¡®è®¾ç½®å¹¶é‡ç°ç»“æœï¼Œè¯·å‚é˜…&lt;a href=&#34;https://github.com/therealmitchconnors/tools/blob/2384dc26f114300687b21f921581a158f27dc9e1/perf/load/many-svc-scenario/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆ‘çš„ç¬”è®°&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯æ‰©å±•æ€§è¯„åˆ†&#34;&gt;å¯æ‰©å±•æ€§è¯„åˆ†&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¯æ‰©å±•æ€§è¯„åˆ†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¯æ‰©å±•æ€§è¯„åˆ†&#34; srcset=&#34;
               /blog/ambient-vs-cilium/scale-scorecard_hu_e47ea34005b0f0b8.webp 400w,
               /blog/ambient-vs-cilium/scale-scorecard_hu_cfc88e69e45db0b7.webp 760w,
               /blog/ambient-vs-cilium/scale-scorecard_hu_ac79307207b1a796.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/ambient-vs-cilium/scale-scorecard_hu_e47ea34005b0f0b8.webp&#34;
               width=&#34;760&#34;
               height=&#34;426&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¯æ‰©å±•æ€§è¯„åˆ†
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Istio èƒ½å¤Ÿä»¥ 20% çš„è¾ƒä½å°¾å»¶è¿Ÿæä¾› 56% æ›´å¤šçš„æŸ¥è¯¢ã€‚Cilium çš„ CPU ä½¿ç”¨ç‡ä½ 30%ï¼Œä½†æˆ‘ä»¬çš„æµ‹é‡å¹¶ä¸åŒ…æ‹¬ Cilium ç”¨äºåŠ å¯†çš„å†…æ ¸æ ¸å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°èµ„æºä½¿ç”¨æƒ…å†µï¼ŒIstio æ¯æ ¸å¿ƒå¤„ç† 2178 ä¸ªæŸ¥è¯¢ï¼Œè€Œ Cilium åˆ™æ˜¯ 1815 ä¸ªï¼Œæå‡äº† 20%ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cilium å‡é€Ÿï¼š&lt;/strong&gt; Cilium åœ¨é»˜è®¤å®‰è£…å‚æ•°ä¸‹å±•ç¤ºäº†ä»¤äººå°è±¡æ·±åˆ»çš„ä½å»¶è¿Ÿï¼Œä½†å½“å¯ç”¨ Istio çš„åŸºå‡†åŠŸèƒ½ï¼ˆå¦‚ L7 ç­–ç•¥å’ŒåŠ å¯†ï¼‰æ—¶ï¼Œå…¶é€Ÿåº¦å¤§å¹…ä¸‹é™ã€‚æ­¤å¤–ï¼Œå³ä½¿ç½‘æ ¼ä¸­æ²¡æœ‰æµé‡æµåŠ¨ï¼ŒCilium çš„å†…å­˜å’Œ CPU åˆ©ç”¨ç‡ä»ç„¶è¾ƒé«˜ï¼Œè¿™å¯èƒ½ä¼šå½±å“é›†ç¾¤çš„æ•´ä½“ç¨³å®šæ€§å’Œå¯é æ€§ï¼Œå°¤å…¶æ˜¯åœ¨æ‰©å±•æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Istio ç¨³å¥è¡¨ç°ï¼š&lt;/strong&gt; ç›¸æ¯”ä¹‹ä¸‹ï¼ŒIstio çš„ Ambient æ¨¡å¼åœ¨ç¨³å®šæ€§æ–¹é¢å±•ç¤ºäº†å…¶ä¼˜åŠ¿ï¼Œå³ä½¿å¢åŠ äº†åŠ å¯†çš„å¼€é”€ï¼Œä¹Ÿèƒ½ä¿æŒä¸é”™çš„ååé‡ã€‚åœ¨æµ‹è¯•ä¸­ï¼ŒIstio ç¡®å®æ¯” Cilium æ¶ˆè€—äº†æ›´å¤šçš„å†…å­˜å’Œ CPUï¼Œä½†åœ¨æ²¡æœ‰è´Ÿè½½æ—¶å…¶ CPU åˆ©ç”¨ç‡ä¸‹é™åˆ° Cilium çš„ä¸€å°éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¹•ååŸå› ä¸ºä½•è¡¨ç°å·®å¼‚&#34;&gt;å¹•ååŸå› ï¼šä¸ºä½•è¡¨ç°å·®å¼‚ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¦ç†è§£è¿™äº›æ€§èƒ½å·®å¼‚çš„å…³é”®åœ¨äºå„å·¥å…·çš„æ¶æ„å’Œè®¾è®¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cilium çš„æ§åˆ¶å¹³é¢éš¾é¢˜ï¼š&lt;/strong&gt; Cilium åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œä¸€ä¸ªæ§åˆ¶å¹³é¢å®ä¾‹ï¼Œéšç€é›†ç¾¤æ‰©å±•ï¼Œè¿™å¯¼è‡´ API æœåŠ¡å™¨å‹åŠ›å¢åŠ å’Œé…ç½®å¼€é”€å¢åŠ ã€‚è¿™ç»å¸¸å¯¼è‡´æˆ‘ä»¬çš„ API æœåŠ¡å™¨å´©æºƒï¼Œæ¥ç€ Cilium å˜å¾—ä¸å¯ç”¨ï¼Œæ•´ä¸ªé›†ç¾¤é™·å…¥ä¸å“åº”çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Istio çš„æ•ˆç‡ä¼˜åŠ¿ï¼š&lt;/strong&gt; Istio é€šè¿‡é›†ä¸­æ§åˆ¶å¹³é¢å’ŒåŸºäºèº«ä»½çš„æ–¹å¼ç®€åŒ–äº†é…ç½®ï¼Œå‡å°‘äº† API æœåŠ¡å™¨å’ŒèŠ‚ç‚¹çš„è´Ÿæ‹…ï¼Œå°†å…³é”®èµ„æºç”¨äºå¤„ç†å’Œä¿æŠ¤æµé‡ï¼Œè€Œä¸æ˜¯å¤„ç†é…ç½®ã€‚Istio é€šè¿‡è¿è¡Œå°½å¯èƒ½å¤šçš„ Envoy å®ä¾‹æ¥è¿›ä¸€æ­¥åˆ©ç”¨æœªåœ¨æ§åˆ¶å¹³é¢ä¸­ä½¿ç”¨çš„èµ„æºï¼Œè€Œ Cilium åˆ™é™åˆ¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹å…±äº«ä¸€ä¸ª Envoy å®ä¾‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ›´æ·±å…¥æ¢è®¨&#34;&gt;æ›´æ·±å…¥æ¢è®¨&lt;/h3&gt;
&lt;p&gt;è™½ç„¶è¿™ä¸ªé¡¹ç›®çš„ç›®æ ‡æ˜¯æ¯”è¾ƒ Istio å’Œ Cilium çš„å¯æ‰©å±•æ€§ï¼Œä½†ä¸€äº›é™åˆ¶ä½¿å¾—ç›´æ¥æ¯”è¾ƒå˜å¾—å›°éš¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;l4-ä¸æ€»æ˜¯-l4&#34;&gt;L4 ä¸æ€»æ˜¯ L4&lt;/h3&gt;
&lt;p&gt;å°½ç®¡ Istio å’Œ Cilium éƒ½æä¾› L4 ç­–ç•¥å¼ºåˆ¶ï¼Œä½†å®ƒä»¬çš„ API å’Œå®ç°å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚Cilium å®ç°äº† Kubernetes NetworkPolicyï¼Œå®ƒä½¿ç”¨æ ‡ç­¾å’Œå‘½åç©ºé—´æ¥é˜»æ­¢æˆ–å…è®¸ IP åœ°å€çš„è®¿é—®ã€‚Istio æä¾›äº†ä¸€ä¸ª AuthorizationPolicy APIï¼Œå¹¶æ ¹æ®ç­¾ç½²æ¯ä¸ªè¯·æ±‚çš„ TLS èº«ä»½åšå‡ºå…è®¸å’Œæ‹’ç»å†³å®šã€‚å¤§å¤šæ•°æ·±åº¦é˜²å¾¡ç­–ç•¥éœ€è¦åŒæ—¶ä½¿ç”¨ NetworkPolicy å’ŒåŸºäº TLS çš„ç­–ç•¥æ¥å®ç°å…¨é¢çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŠ å¯†çš„å·®å¼‚&#34;&gt;åŠ å¯†çš„å·®å¼‚&lt;/h3&gt;
&lt;p&gt;Cilium æä¾›äº†ç”¨äº FIPS å…¼å®¹åŠ å¯†çš„ IPsecï¼Œä½†å¤§å¤šæ•° Cilium åŠŸèƒ½ï¼ˆå¦‚ L7 ç­–ç•¥å’Œè´Ÿè½½å‡è¡¡ï¼‰ä¸ IPsec ä¸å…¼å®¹ã€‚Cilium åœ¨ä½¿ç”¨ WireGuard åŠ å¯†æ—¶å…·æœ‰æ›´å¥½çš„åŠŸèƒ½å…¼å®¹æ€§ï¼Œä½† WireGuard æ— æ³•åœ¨ FIPS åˆè§„çš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚å¦ä¸€æ–¹é¢ï¼ŒIstio ä¸¥æ ¼éµå®ˆ TLS åè®®æ ‡å‡†ï¼Œé»˜è®¤æƒ…å†µä¸‹å§‹ç»ˆä½¿ç”¨ FIPS å…¼å®¹çš„ mTLSã€‚&lt;/p&gt;
&lt;h3 id=&#34;éšè—çš„æˆæœ¬&#34;&gt;éšè—çš„æˆæœ¬&lt;/h3&gt;
&lt;p&gt;è™½ç„¶ Istio å®Œå…¨åœ¨ç”¨æˆ·ç©ºé—´ä¸­è¿è¡Œï¼Œä½† Cilium çš„ L4 æ•°æ®å¹³é¢åœ¨ Linux å†…æ ¸ä¸­ä½¿ç”¨ eBPFã€‚Prometheus çš„èµ„æºæ¶ˆè€—æŒ‡æ ‡ä»…æµ‹é‡ç”¨æˆ·ç©ºé—´èµ„æºï¼Œè¿™æ„å‘³ç€ Cilium ä½¿ç”¨çš„æ‰€æœ‰å†…æ ¸èµ„æºåœ¨æ­¤æµ‹è¯•ä¸­éƒ½æœªè®¡å…¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å»ºè®®é€‰æ‹©åˆé€‚çš„å·¥å…·&#34;&gt;å»ºè®®ï¼šé€‰æ‹©åˆé€‚çš„å·¥å…·&lt;/h2&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œæœ€ç»ˆç»“è®ºæ˜¯ä»€ä¹ˆï¼Ÿè¿™å–å†³äºæ‚¨çš„å…·ä½“éœ€æ±‚å’Œä¼˜å…ˆäº‹é¡¹ã€‚å¯¹äºå°å‹é›†ç¾¤ä»¥åŠçº¯ L3/L4 ç”¨ä¾‹ä¸”æ— éœ€åŠ å¯†çš„æƒ…å†µï¼ŒCilium æä¾›äº†ä¸€ä¸ªç»æµé«˜æ•ˆä¸”æ€§èƒ½è‰¯å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œå¯¹äºå¤§å‹é›†ç¾¤ï¼Œä»¥åŠæ³¨é‡ç¨³å®šæ€§ã€å¯æ‰©å±•æ€§å’Œé«˜çº§åŠŸèƒ½çš„æƒ…å†µï¼ŒIstio çš„ Ambient æ¨¡å¼é…åˆæ›¿ä»£çš„ NetworkPolicy å®ç°æ‰æ˜¯é¦–é€‰ã€‚è®¸å¤šå®¢æˆ·é€‰æ‹©å°† Cilium çš„ L3/L4 åŠŸèƒ½ä¸ Istio çš„ L4/L7 å’ŒåŠ å¯†åŠŸèƒ½ç»“åˆï¼Œä»¥å®ç°æ·±åº¦é˜²å¾¡ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;è¯·è®°ä½ï¼Œäº‘åŸç”Ÿç½‘ç»œçš„ä¸–ç•Œåœ¨ä¸æ–­å‘å±•ã€‚å¯†åˆ‡å…³æ³¨ Istio å’Œ Cilium çš„è¿›å±•ï¼Œå®ƒä»¬å°†ç»§ç»­æ”¹è¿›å’Œåº”å¯¹è¿™äº›æŒ‘æˆ˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>è§£å¯† Kubernetes ç½‘ç»œï¼šè·Ÿéšæ•°æ®åŒ…çš„å¥‡å¦™æ—…ç¨‹</title>
      <link>https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/</link>
      <pubDate>Fri, 08 Mar 2024 12:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/</guid>
      <description>&lt;p&gt;æœ€è¿‘å¯¹äºç†è§£ Kubernetes ä¸­çš„ç½‘ç»œæœ‰å¾ˆå¤§çš„å…´è¶£ã€‚æœ¬æ–‡æ˜¯æˆ‘å¯¹è¿™ä¸ªè¯é¢˜çš„è´¡çŒ®ã€‚æˆ‘ä¼šå°½åŠ›ç”¨ç›´è§‚çš„æ–¹å¼è§£é‡Šï¼Œå¹¶å°†æŠ€æœ¯éƒ¨åˆ†ç¿»è¯‘æˆæ˜“æ‡‚çš„è¯­è¨€ï¼Œä»¥ä¾¿ä»»ä½•äººéƒ½èƒ½ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¥½çš„å­¦ä¹ ç½‘ç»œçš„æ–¹å¼æ˜¯é€šè¿‡â€œè¿½è¸ªæ•°æ®åŒ…â€æˆ–â€œæ•°æ®åŒ…çš„ç”Ÿå‘½å‘¨æœŸâ€ã€‚åŸºæœ¬ä¸Šï¼Œä½ è¦è·Ÿéšæ•°æ®åŒ…ä»å‘é€è€…åˆ°æ¥æ”¶è€…çš„æ—…ç¨‹ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥åœä¸‹æ¥ã€‚æˆ‘ä»¥å‰å°±ç”¨ &lt;a href=&#34;https://www.dbi-services.com/blog/exploration-of-calico-in-minikube/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Calico å®ç°çš„ Pod åˆ°å¦ä¸€ä¸ª Pod çš„é€šä¿¡&lt;/a&gt; è¿›è¡Œäº†è¿™æ ·çš„æ“ä½œã€‚è¿™æ¬¡æˆ‘å°†ä½¿ç”¨å¦ä¸€ä¸ªå®¹å™¨ç½‘ç»œæ¥å£ (CNI) å«åš &lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium&lt;/a&gt;ï¼Œå®ƒåŸºäº eBPFï¼ˆäº†è§£å¿«é€Ÿå’Œçµæ´»çš„è·¯ç”±ï¼‰ï¼Œå¹¶å¸¦æœ‰è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½å’Œå·¥å…·ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-ä¸­çš„ä¼ ç»Ÿç½‘ç»œ&#34;&gt;Kubernetes ä¸­çš„ä¼ ç»Ÿç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å°†ä»å¤´å¼€å§‹ã€‚æˆ‘ä¼šå‡è®¾ä½ å¯¹ç½‘ç»œä¸€æ— æ‰€çŸ¥ã€‚ä¹Ÿè®¸ä½ å·²ç»çŸ¥é“ IP åœ°å€æ˜¯ä»€ä¹ˆï¼ŸIP åœ°å€æ˜¯è®¡ç®—æœºç½‘ç»œæ¥å£çš„æ•°å­—åœ°å€ã€‚è¿™å°±æ˜¯ä½ çš„è®¡ç®—æœºå¯ä»¥è¿æ¥åˆ°ä½ çš„ Wi-Fi ç½‘ç»œå¹¶è®©ä½ è®¿é—®äº’è”ç½‘çš„æ–¹å¼ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç¬”è®°æœ¬ç”µè„‘ï¼Œä½ çš„ Wi-Fi ç½‘ç»œæ¥å£æœ‰ä¸€ä¸ª IP åœ°å€ã€‚è¿™ä¸ªç½‘ç»œæ¥å£è¿˜æœ‰å¦ä¸€ä¸ªç”±ç¡¬ä»¶æä¾›å•†çƒ§å½•çš„å”¯ä¸€åœ°å€ã€‚è¿™ä¸ªåœ°å€ç§°ä¸ºä»‹è´¨è®¿é—®æ§åˆ¶ (MAC) åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;IP åœ°å€å±äºä¸€ä¸ªç»„ï¼ˆIP å­ç½‘ï¼‰ã€‚ä¸ºäº†çŸ¥é“å®ƒå±äºå“ªä¸ªç»„ï¼Œå®ƒä½¿ç”¨ä¸€ç§ç§°ä¸ºå­ç½‘æ©ç çš„ä¸œè¥¿ã€‚å½“å­ç½‘æ©ç åº”ç”¨åˆ° IP åœ°å€æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¯¹äºå±äºåŒä¸€ç»„çš„æ¯ä¸ª IP åœ°å€æ¥è¯´ï¼Œè¿™ä¸ªç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™å°±åƒä½ æ‰€åœ¨çš„ç¤¾åŒºä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ç”¨ä¸‹é¢çš„å›¾æ¥åšç±»æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä¼ ç»Ÿç½‘ç»œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä¼ ç»Ÿç½‘ç»œ&#34; srcset=&#34;
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu_8dbab094c0e51c.webp 400w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu_a14291c14aed43e3.webp 760w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu_80258e1794f4cfbf.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu_8dbab094c0e51c.webp&#34;
               width=&#34;760&#34;
               height=&#34;362&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä¼ ç»Ÿç½‘ç»œ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ¿å­æ˜¯ä¸€å°è®¡ç®—æœºã€æœåŠ¡å™¨æˆ–è™šæ‹Ÿæœºã€‚å®ƒçš„å¤§å°å¯ä»¥ä¸åŒï¼Œæ ¹æ®å®ƒçš„ CPU å’Œå†…å­˜ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„å¤§å°ã€‚ä¸€æ ‹æˆ¿å­æœ‰ä¸€æ‰‡é—¨ï¼Œè¿™å°±æ˜¯ä½ çš„ç½‘ç»œæ¥å£ã€‚é—¨ä¸Šçš„åºåˆ—å·æ˜¯ä½ çš„ MAC åœ°å€ï¼Œæˆ¿å­ä¸Šçš„æ•°å­—ï¼ˆé€šå¸¸æ˜¯é’‰åœ¨é—¨ä¸Šçš„ï¼‰æ˜¯ä½ çš„ IP åœ°å€ã€‚åªæœ‰åœ¨ä½ æ¢é—¨æ—¶ï¼Œä½ çš„åºåˆ—å·æ‰ä¼šæ”¹å˜ã€‚ç„¶è€Œï¼Œä½ çš„æˆ¿å­å·ç æ˜¯ç”±ä½ çš„ç¤¾åŒºçš„å»ºç­‘å¸ˆåˆ†é…çš„ï¼Œå¦‚æœæœ‰é‡æ–°åˆ†é…æˆ–è®¾è®¡æ›´æ”¹ï¼Œå®ƒå¯èƒ½ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;è“è‰²çš„ç¬¬ 10 ä¸ªç¤¾åŒºï¼ˆä½¿ç”¨ä» 10 åˆ° 19 çš„æ•°å­—ï¼‰å±äºåŒä¸€ç»„ï¼ˆåŒä¸€ IP å­ç½‘ï¼‰ï¼Œè€Œç»¿è‰²çš„ç¬¬ 20 ä¸ªç¤¾åŒºæ˜¯å¦ä¸€ç»„ã€‚åœ¨æ¯ä¸ªç¤¾åŒºä¸­ï¼Œæœ‰äº”æ ‹æˆ¿å­ï¼Œæ‰€ä»¥æœ‰ç©ºé—´è®©ç¤¾åŒºæˆé•¿ã€‚åœ¨æ¯ä¸ªç¤¾åŒºé‡Œï¼Œé—¨ç›´æ¥è¿æ¥åˆ°ä¸€ä¸ªå–·æ³‰ï¼Œä»£è¡¨ä¸€ä¸ªäº¤æ¢æœºã€‚åœ¨å–·æ³‰å¤„ï¼Œæœ‰ä¸€ä¸ªæŒ‡ç¤ºæ¯æ¡è·¯å¾„çš„æ ‡å¿—ï¼ŒæŒ‡ç¤ºä½ å¯ä»¥åˆ°è¾¾å“ªæ‰‡é—¨ã€‚æ˜¯çš„ï¼Œå–·æ³‰ä¸çŸ¥é“æˆ¿å­å·ç ï¼ŒåªçŸ¥é“é—¨çš„åºåˆ—å·ã€‚å¯¹äºäººç±»æ¥è¯´ï¼Œè¿™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸€å¼ åœ°å›¾ï¼ˆç§°ä¸º ARP è¡¨ï¼‰ï¼Œå®ƒæä¾›äº†æˆ¿å­å·ç ä¸é—¨çš„åºåˆ—å·ä¹‹é—´çš„è½¬æ¢ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½åœ¨ 14 å·æˆ¿å­ï¼Œæƒ³æ‹œè®¿ 15 å·æˆ¿å­ï¼Œä½ ä¼šä½¿ç”¨è¿™æ¡è·¯ï¼ˆåªæœ‰ä¸€æ¡ï¼Œè€Œä¸”æ˜¯ä½ çš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰äº¤é€šå µå¡ï¼ï¼‰å…ˆåˆ°è¾¾å–·æ³‰ï¼Œç„¶åçœ‹çœ‹æ ‡å¿—ã€‚ä½ ä»åœ°å›¾ä¸ŠçŸ¥é“å“ªä¸ªåºåˆ—å·å¯¹åº”å“ªä¸ªæˆ¿å­ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ²¿ç€é€šå¾€ 15 å·æˆ¿å­çš„è·¯çº¿å‰å¾€ã€‚åœ¨è¿™ç§æ˜Ÿå½¢æ‹“æ‰‘ä¸­ï¼Œä½ æ€»æ˜¯å…ˆå»å–·æ³‰ï¼Œè€Œä¸æ˜¯ç›´æ¥å»ä½ æƒ³è¦æ‹œè®¿çš„æˆ¿å­ï¼Œå› ä¸ºæ²¡æœ‰ç›´æ¥çš„è·¯å¾„ã€‚ç¤¾åŒºå†…çš„è·¯å¾„ä»£è¡¨äº†ç¬¬ 2 å±‚é“¾æ¥ã€‚ä½ æ— æ³•é€šè¿‡è¿™äº›è·¯å¾„åˆ°è¾¾å¦ä¸€ä¸ªç¤¾åŒºã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ç¤¾åŒºä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨ç¤¾åŒºä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœä»ä½ çš„ 14 å·æˆ¿å­ï¼Œä½ æƒ³è¦å»æ‹œè®¿ 24 å·æˆ¿å­æ€ä¹ˆåŠï¼Ÿè¿™æ˜¯å¦ä¸€ä¸ªç¤¾åŒºï¼Œè¿™æ„å‘³ç€ 14 å·çš„ IP åœ°å€/å­ç½‘æ©ç ä¸ 24 å·ä¸åŒã€‚å®é™…ä¸Šï¼Œç¬¬ 10 å’Œç¬¬ 20 ç¤¾åŒºæ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥ä½ çŸ¥é“ç›®çš„åœ°æ˜¯å¦ä¸€ä¸ªç¤¾åŒºï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»é¦–å…ˆå»æ‰¾ä½ çš„é—¨å«ï¼ˆä½†æ€»æ˜¯é€šè¿‡å–·æ³‰ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼‰ã€‚ä»–æ˜¯ä½ ç¤¾åŒºçš„é»˜è®¤ç½‘å…³ï¼Œä»–ä½åœ¨ 11 å·æˆ¿å­ã€‚è§„åˆ™æ˜¯å»æ‰¾ä»–ï¼Œå¯¹äºä»»ä½•ç›®çš„åœ°åœ¨ä½ ç¤¾åŒºä¹‹å¤–çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;åªæœ‰ä»–æœ‰åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰èƒ½å¤Ÿåˆ°è¾¾ç¬¬ 20 å·ç¤¾åŒºï¼Œå¹¶ä¸”çŸ¥é“åº”è¯¥èµ°å“ªæ¡è·¯ï¼ˆè¿™è¢«ç§°ä¸ºç¬¬ 3 å±‚è·¯ç”±ï¼Œå› ä¸ºä½ æ­£åœ¨ç¦»å¼€ä½ çš„ç¤¾åŒºï¼‰ã€‚è¿™å¼ åœ°å›¾æ˜¾ç¤ºäº†åˆ°è¾¾ 20 å·ç¤¾åŒºçš„æ­£ç¡®é—¨ã€‚ç­‰ä¸€ä¸‹ï¼Œå¦‚æœä¸€æ‰‡é—¨æ˜¯ä¸€ä¸ªç½‘ç»œæ¥å£ï¼Œé‚£ä¹ˆé—¨å«æˆ¿å­æ˜¯ä¸æ˜¯è¿˜æœ‰å¦ä¸€æ‰‡é—¨ï¼Ÿå®Œå…¨æ­£ç¡®ï¼11 å·æˆ¿å­æœ‰å¦ä¸€æ‰‡é—¨ï¼Œé—¨ä¸Šæœ‰å¦ä¸€ä¸ªå·ç ï¼ˆ101ï¼‰ï¼Œå½“ç„¶è¿™æ‰‡é—¨ä¸Šæœ‰å¦ä¸€ä¸ªåºåˆ—å·ï¼ˆMAC åœ°å€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™æ‰‡é—¨å‡ºå»ï¼Œä½ ç°åœ¨å¯ä»¥æ²¿ç€è·¯å¾„åˆ°è¾¾ç¬¬ 20 å·ç¤¾åŒºï¼Œè¿™ä¸ªç¤¾åŒºæœ‰è‡ªå·±çš„é—¨å«åœ¨ 21 å·æˆ¿å­ã€‚è¿™ä¸ªé—¨å«çš„åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰æŒ‡å¯¼ä½ åˆ°è¾¾ç›®çš„åœ°çš„æ­£ç¡®é—¨ã€‚è¿™æ‰‡é—¨è®©ä½ è¿›å…¥äº†ç¬¬ 20 å·ç¤¾åŒºï¼Œå› ä¸ºä½ çš„ç›®çš„åœ° 24 å±äºå®ƒã€‚é—¨å«è¿˜ç»™äº†ä½ åœ°å›¾ï¼ˆARP è¡¨ï¼‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨å–·æ³‰ä¸Šæ‰¾åˆ°æ–¹å‘ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ²¿ç€é€šå¾€ç»¿è‰²å–·æ³‰çš„è·¯å¾„èµ°äº†ã€‚ä»é‚£é‡Œï¼Œä½ åªéœ€è·Ÿç€æ ‡å¿—å’Œè·¯å¾„åˆ°è¾¾ 24 å·æˆ¿å­ã€‚å½“ä½ æƒ³å›å®¶æ—¶ï¼Œä½ æ²¿ç€ç›¸åçš„æ–¹å‘èµ°åŒæ ·çš„è·¯å¾„å›å»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-ä¸­çš„ç½‘ç»œ&#34;&gt;Kubernetes ä¸­çš„ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä½ äº†è§£äº†ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ Kubernetes ä¸­å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ˜¯çš„ï¼Œå®ƒç¨å¾®å¤æ‚ä¸€äº›ï¼Œä½†è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œä½¿ç”¨ä¸‹é¢çš„å›¾ç‰‡æ¥æ›´å¥½åœ°ç†è§£ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨-cilium-çš„-kubernetes-ç½‘ç»œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨ Cilium çš„ Kubernetes ç½‘ç»œ&#34; srcset=&#34;
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu_637398ad836f180d.webp 400w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu_71b9fa1bac565c6b.webp 760w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu_86ac95aed5215684.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu_637398ad836f180d.webp&#34;
               width=&#34;760&#34;
               height=&#34;435&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨ Cilium çš„ Kubernetes ç½‘ç»œ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨æ²¡æœ‰æˆ¿å­ï¼Œè€Œæ˜¯å»ºç­‘ã€‚å»ºç­‘ä¹‹é—´çš„ç½‘ç»œä¸ä¼ ç»Ÿç½‘ç»œä»ç„¶ç›¸åŒï¼Œä¸­é—´æœ‰ä¸€ä¸ªäº¤æ¢æœº/å–·æ³‰ã€‚å»ºç­‘çš„å…¥å£æœ‰ä¸€æ‰‡é—¨ï¼Œä¸Šé¢æœ‰å»ºç­‘çš„å·ç ï¼ˆå®ƒçš„ IP åœ°å€ï¼‰ï¼Œå®ƒæ˜¯ 1000 ä¸ªç¤¾åŒºçš„ä¸€ä»½å­ã€‚ä¸€ä¸ªå»ºç­‘å°†ä»£è¡¨æˆ‘ä»¬ Kubernetes é›†ç¾¤çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½ çŸ¥é“ Kubernetes æ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’å™¨ã€‚ä¸€ä¸ªå®¹å™¨åŒ…è£…æˆä¸€ä¸ª podã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ª pod åªæœ‰ä¸€ä¸ªå®¹å™¨ï¼Œå› æ­¤è¿™ä¸¤ä¸ªæœ¯è¯­åœ¨è¿™é‡Œæ˜¯ç­‰ä»·çš„ã€‚è¿™ä¸ª pod å°±åƒæˆ‘ä»¬å»ºç­‘ä¸­çš„ä¸€ä¸ªç§äººéƒ¨åˆ†ã€‚å…¬å¯“çš„å¤§å°å¯ä»¥ä¸åŒï¼Œå› ä¸ºå®ƒå¯èƒ½æœ‰ 2ã€3 æˆ– 4 ä¸ªå§å®¤ï¼Œè¿™å°†æ˜¯ä½ çš„å®¹å™¨åœ¨èŠ‚ç‚¹ä¸Šéœ€è¦çš„ CPU å’Œå†…å­˜å®¹é‡ã€‚æœ‰äº›å…¬å¯“æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å»ºç­‘ä»ç„¶æœ‰ä¸€äº›å®¹é‡ã€‚ç„¶è€Œï¼Œåœ¨ Kubernetes ä¸­ï¼Œpod æ˜¯æ ¹æ®éœ€è¦åˆ›å»ºå’Œåˆ é™¤çš„ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬çš„å»ºç­‘ä¸­ï¼Œè¿™æ„å‘³ç€æœ‰æ—¶ä¼šåˆ›å»ºä¸€ä¸ª 2 å§å®¤çš„å…¬å¯“ï¼Œå½“ä¸å†ä½¿ç”¨æ—¶ï¼Œå®ƒå¯èƒ½ä¼šè¢«ä»å»ºç­‘ç‰©ä¸­ç§»é™¤ã€‚ç„¶åï¼Œå¦‚æœå»ºç­‘æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œå¯èƒ½ä¼šåˆ›å»ºä¸€ä¸ª 5 å§å®¤çš„å…¬å¯“ã€‚ç„¶åæƒ³è±¡ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€åº§ä¹é«˜å»ºç­‘ï¼Œé‡Œé¢ä½ å¯ä»¥æ ¹æ®éœ€è¦å»ºé€ å’Œæ‹†é™¤ä¸åŒå¤§å°çš„å…¬å¯“ï¼è¿™ä¸æ˜¯å¾ˆæ£’å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æ¯ä¸ªå»ºç­‘ç‰©ä¸­ï¼Œå®¹å™¨/pod æœ‰è‡ªå·±çš„ç¤¾åŒºï¼ˆIP å­ç½‘ï¼‰ã€‚åœ¨ Kubernetes ä¸­ï¼ŒCNI çš„åŠŸèƒ½åŸºæœ¬ä¸Šæ˜¯ä¸º pod åˆ†é…å·ç ï¼ˆIP åœ°å€ï¼‰ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥å½¼æ­¤é€šä¿¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä¸ºæ¯ä¸ªå»ºç­‘ä½¿ç”¨ä¸åŒçš„ç¤¾åŒºã€‚å½“åˆ›å»ºä¸€ä¸ªå…¬å¯“æ—¶ï¼ŒCilium ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªå·ç ã€‚å½“åˆ é™¤å¹¶é‡æ–°åˆ›å»ºä¸€ä¸ªå…¬å¯“æ—¶ï¼Œå®ƒå°†è·å¾—å¦ä¸€ä¸ªå·ç ï¼Œå› æ­¤å®ƒæ˜¯ä¸´æ—¶çš„ã€‚è¿™é‡Œè“è‰²çš„ç¤¾åŒºä½¿ç”¨ 10 å·èŒƒå›´ï¼Œç»¿è‰²çš„ç¤¾åŒºä½¿ç”¨ 20 å·ã€‚ä½ å¯ä»¥æ³¨æ„åˆ°è“è‰²å’Œç»¿è‰²ç¤¾åŒºçš„æ•°å­—èŒƒå›´ä¸å»ºç­‘ç‰©çš„èŒƒå›´ä¸åŒã€‚åªæ˜¯ä¸ºäº†è®©ä½ çŸ¥é“ï¼Œè¿™ç§è®¾è®¡è¢«ç§°ä¸ºå åŠ ç½‘ç»œã€‚è¿˜æœ‰å…¶ä»–å¯èƒ½çš„ï¼Œä½†è¿™æ˜¯å¸¸ç”¨çš„ä¸€ç§ã€‚è¿™æ˜¯ä¸€ä¸ªåœ¨èŠ‚ç‚¹ç½‘ç»œä¹‹ä¸Šçš„ pod ç½‘ç»œã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨åŒä¸€å»ºç­‘ä¸­çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨åŒä¸€å»ºç­‘ä¸­çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œä½ ä½åœ¨ 12 å·å…¬å¯“ï¼Œä½ è¦æ€ä¹ˆå»æ‹œè®¿ 14 å·å…¬å¯“ï¼Ÿå°±åƒæˆ‘ä»¬åœ¨ä¼ ç»Ÿç½‘ç»œç¤ºä¾‹ä¸­æ‰€åšçš„é‚£æ ·ï¼Œä½ æ˜¯æˆ‘ä»¬è¦è¿½è¸ªçš„æ•°æ®åŒ…ï¼å½“ç„¶ï¼Œä½ é€šè¿‡å®ƒçš„é—¨ï¼ˆå®ƒçš„ç½‘ç»œæ¥å£ï¼‰ç¦»å¼€å…¬å¯“ã€‚ä¸æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹ä¸åŒä¹‹å¤„åœ¨äºï¼Œä½ ç°åœ¨ä¸æ˜¯ç¦»å¼€æˆ¿å­ï¼Œè€Œæ˜¯ç¦»å¼€äº†ä½ çš„å…¬å¯“ï¼Œä½†ä»ç„¶åœ¨å»ºç­‘ç‰©å†…éƒ¨ã€‚ç„¶åä½ èµ°è¿‡ä¸€ä¸ªç§äººèµ°å»Šï¼Œåˆ°è¾¾å¦ä¸€æ‰‡é—¨ï¼ˆè¿™æ˜¯ LXC æ¥å£ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ‰‡é—¨ç»™äº†ä½ è¿›å…¥å»ºç­‘çš„å…¬å…±ç©ºé—´çš„è®¿é—®ï¼Œè¿™é‡Œè¿›è¡Œäº†è·¯ç”±å’Œæ´¾å‘ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º Cilium å¤§å…ï¼ˆè“è‰²çŸ©å½¢ï¼‰ã€‚å½“é€‰æ‹© Cilium ä¸ºè¿™ä¸ª Kubernetes é›†ç¾¤æä¾›é€šä¿¡æ—¶ï¼Œæ¯ä¸ªå»ºç­‘ç‰©éƒ½å®‰è£…äº†è¿™ä¸ªå¤§å…çš„ Cilium ä»£ç†ã€‚å¤§å…é‡Œæœ‰ä¸€ä¸ªé—¨å«ï¼Œä»–ä¸ä½åœ¨å…¬å¯“é‡Œï¼Œè€Œæ˜¯åœ¨å¤§å…çš„ä¸€ä¸ªç”²æ¿ä¸Šç­‰å¾…ã€‚ä»–æœ‰ä¸€ä¸ªæœåŠ¡äººå‘˜å›¢é˜Ÿï¼Œåœ¨å»ºç­‘ç‰©çš„ä¸åŒé—¨å¤„ç­‰å€™æä¾›æŒ‡å¯¼ã€‚è¿™æ˜¯å› ä¸º Cilium ä½¿ç”¨ä¸€ä¸ªå«åš eBPF çš„é­”æ³•è·¯ç”±åœ°å›¾ï¼Œæœ‰æ•ˆåœ°å¸®åŠ©æ—…è¡Œè€…ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ åˆ°è¾¾èµ°å»Šå°½å¤´çš„é—¨æ—¶ï¼Œä½ å‘ç­‰åœ¨è¿™é‡Œçš„æœåŠ¡äººå‘˜è¡¨ç¤ºä½ è¦å» 14 å·ã€‚ä»–åœ¨ä»–çš„é­”æ³• eBPF åœ°å›¾ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªä¸ 14 å·ç›¸åŒ¹é…çš„é¡¹ç›®ï¼Œå¹¶ç›´æ¥å‘ä½ å±•ç¤ºäº†å³ä¸Šè§’çš„èµ°å»Šé—¨ã€‚ä½ ä¸å¿…å»å¤§å…ï¼Œä»–å‘ä½ å±•ç¤ºäº†ä¸€æ¡ç§˜å¯†é€šé“ï¼Œç›´æ¥åˆ°è¾¾é‚£é‡Œã€‚ç„¶åä½ æ‰“å¼€é‚£æ‰‡é—¨ï¼Œè·Ÿç€èµ°å»Šï¼Œåˆ°è¾¾äº† 14 å·å…¬å¯“ã€‚ä½ å›å»åˆ° 12 å·å…¬å¯“ï¼Œæ²¿ç€ç›¸åŒçš„è·¯å¾„å’Œè¿‡ç¨‹ï¼Œä½†æ˜¯æ–¹å‘ç›¸åã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè¿™ç§è°ƒåº¦ä¸ä¼ ç»Ÿçš„äº¤æ¢æ–¹å¼ä¸åŒï¼Œå¹¶ä¸”éå¸¸å¿«é€Ÿï¼Œè¿™è¦å½’åŠŸäºé­”æ³• eBPF åœ°å›¾ï¼&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ä¸åŒå»ºç­‘ç‰©çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨ä¸åŒå»ºç­‘ç‰©çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œä» 12 å·å…¬å¯“ï¼Œä½ æƒ³å»æ‹œè®¿å¦ä¸€ä¸ªå»ºç­‘ç‰©é‡Œçš„ 22 å·å…¬å¯“ã€‚ä½ çš„æ—…è¡Œå¼€å§‹å’Œä»¥å‰ä¸€æ ·ï¼Œä½ ç¦»å¼€ä½ çš„å…¬å¯“ï¼Œæ²¿ç€èµ°å»Šï¼Œè¯¢é—®ç­‰å¾…åœ¨è¿™é‡Œçš„æœåŠ¡äººå‘˜çš„æ–¹å‘ã€‚ç”±äºç›®çš„åœ°æ˜¯å¦ä¸€ä¸ªç¤¾åŒºçš„ 22 å·ï¼Œè¿™æ¬¡ä»–æŠŠä½ å¼•å¯¼åˆ°äº†å¤§å…ã€‚åœ¨è¿™é‡Œï¼Œä¸ä¼ ç»Ÿç½‘ç»œä¸€æ ·ï¼Œä½ éœ€è¦å¤§å…ä¸­çš„é—¨å«çš„å¸®åŠ©ã€‚é—¨å«æŸ¥çœ‹ä»–çš„åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰ï¼ŒæŒ‡å¼•ä½ å» 22 å·çš„æ–¹å‘ï¼Œå¹¶å‘ä½ å±•ç¤ºè¦ä½¿ç”¨çš„é—¨å·ç  11ï¼ˆcilium_hostï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ æ‰“å¼€é‚£æ‰‡é—¨æ—¶ï¼Œä½ ä¼šçœ‹åˆ°åé¢æœ‰å¦ä¸€æ‰‡é—¨ï¼šé‚£å°±æ˜¯è“è‰²çš„ä¸‰è§’å½¢ï¼Œç§°ä¸º VXLAN æ¥å£ã€‚è¿™æ‰‡é—¨é€šå‘ä¸€ä¸ªæ¼‚äº®çš„é€æ˜éš§é“ï¼Œç©¿è¿‡å»ºç­‘ç‰©çš„ä¸»é—¨ã€‚ä½ å—åˆ°é›¨æ°´çš„ä¿æŠ¤ï¼Œå¯ä»¥æ¬£èµåˆ°å¦ä¸€ä¸ªå»ºç­‘ç‰©çš„æ™¯è‰²ã€‚ä½ ç”šè‡³å¯ä»¥çœ‹åˆ°å®¤å¤–çš„å–·æ³‰ï¼å½“ä½ åˆ°è¾¾ç»¿è‰²å»ºç­‘ç‰©æ—¶ï¼Œä½ ç¦»å¼€éš§é“ï¼Œå»è§åœ¨ç»¿è‰²ä¸‰è§’å½¢ï¼ˆVXLAN æ¥å£ï¼‰å¤„ç­‰å¾…ä½ çš„æœåŠ¡äººå‘˜ã€‚ä½ å‘Šè¯‰ä»–ä½ çš„ç›®çš„åœ°ï¼Œä»–åœ¨ä»–çš„é­”æ³• eBPF åœ°å›¾ä¸­æ‰¾åˆ°äº†ä¸ 22 å·ç›¸åŒ¹é…çš„é¡¹ç›®ï¼Œå¹¶å‘ä½ å±•ç¤ºäº†ä¸€æ¡é€šå¾€å·¦ä¸Šè§’èµ°å»Šé—¨çš„ç§˜å¯†é€šé“ã€‚ç„¶åä½ è·Ÿç€èµ°å»Šï¼Œåˆ°è¾¾äº†ä½ çš„ç›®çš„åœ°ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œä½ å›å»çš„è·¯çº¿å°†æ²¿ç€ç›¸åŒçš„è·¯å¾„ï¼Œä½†æ–¹å‘ç›¸åã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ç¬¬ 3 å±‚è·¯ç”±ï¼Œå› ä¸ºç›®çš„ç¤¾åŒºä¸ä½ çš„ä¸åŒã€‚ä½ å¯ä»¥çœ‹åˆ°åœ¨ Kubernetes ä¸­æ¯”ä¼ ç»Ÿè·¯ç”±ç¨å¾®å¤æ‚ä¸€äº›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å¸Œæœ›è¿™æœ‰åŠ©äºä½ ç†è§£ä¼ ç»Ÿç½‘ç»œå’Œ Kubernetes ç½‘ç»œä¹‹é—´çš„åŒºåˆ«ï¼Œä¹Ÿå¸Œæœ›åè€…ç°åœ¨å¯¹ä½ æ¥è¯´æ›´æ¸…æ™°äº†ã€‚å¦‚æœè¿™å°±æ˜¯ä½ æ‰€éœ€è¦çš„ï¼Œé‚£ä¹ˆæˆ‘å¾ˆé«˜å…´ä½ é˜…è¯»äº†è¿™ç¯‡åšæ–‡ï¼Œå¸Œæœ›ä½ å–œæ¬¢å®ƒã€‚å¦‚æœä½ ç°åœ¨æƒ³äº†è§£æ›´å¤šå…³äº Kubernetes ç½‘ç»œçš„å†…å®¹ï¼Œè¯·ä¿æŒå…³æ³¨ï¼Œå› ä¸ºæˆ‘å°†å†™ä¸€ç¯‡ &lt;a href=&#34;https://www.dbi-services.com/blog/kubernetes-networking-by-using-cilium-intermediate-level-part-1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸­çº§ç¯‡&lt;/a&gt;ï¼Œä½ å°†åœ¨å…¶ä¸­çœ‹åˆ°ä¸€ä¸ªçœŸå®é›†ç¾¤ä¸Šå»ºç­‘ç‰©çš„æ ·å­ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å’Œ BGP ä¸º Kubernetes æœåŠ¡è¿›è¡Œè´Ÿè½½å‡è¡¡</title>
      <link>https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/</link>
      <pubDate>Tue, 30 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://sue.eu/blogs/expose-loadbalanced-kubernetes-services-with-bgp-cilium/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Exposing Load-Balanced Kubernetes Services with Cilium&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨ä¸ºäº‘åŸç”Ÿç¯å¢ƒæä¾›ç½‘ç»œã€å®‰å…¨å’Œå¯è§‚æµ‹æ€§ï¼Œä¾‹å¦‚ Kubernetes é›†ç¾¤å’Œå…¶ä»–å®¹å™¨ç¼–æ’å¹³å°ã€‚æœ¬åšå®¢å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Cilium å’Œ BGP å°†æ‚¨çš„ Kubernetes æœåŠ¡æš´éœ²ç»™å¤–éƒ¨ä¸–ç•Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BGP&lt;/strong&gt;
è¾¹ç•Œç½‘å…³åè®®ï¼ˆBGPï¼‰æ˜¯ä¸€ç§æ ‡å‡†åŒ–çš„å¤–éƒ¨ç½‘å…³åè®®ï¼Œæ—¨åœ¨åœ¨äº’è”ç½‘ä¸Šçš„è‡ªæ²»ç³»ç»Ÿï¼ˆASï¼‰ä¹‹é—´äº¤æ¢è·¯ç”±å’Œå¯è¾¾æ€§ä¿¡æ¯ã€‚è¯¥åè®®è¢«åˆ†ç±»ä¸ºè·¯å¾„çŸ¢é‡åè®®ï¼Œå› æ­¤å®ƒæ ¹æ®ç”±ç½‘ç»œç®¡ç†å‘˜é…ç½®çš„è·¯å¾„ã€ç½‘ç»œç­–ç•¥æˆ–è§„åˆ™é›†æ¥åšå‡ºè·¯ç”±å†³ç­–ã€‚å®ƒå‚ä¸åˆ¶å®šæ ¸å¿ƒè·¯ç”±å†³ç­–ï¼Œè¿™ä½¿å¾—å®ƒå¯¹äº’è”ç½‘çš„æ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;BGP ä¸“ä¸ºå¥å£®æ€§å’Œå¯æ‰©å±•æ€§è€Œå¼€å‘ï¼Œç”¨äºåœ¨å¤§å‹ç½‘ç»œä¹‹é—´è·¯ç”±æ•°æ®ï¼ŒåŒ…æ‹¬ ISP å’Œå…¶ä»–å¤§å‹ç»„ç»‡ã€‚å®ƒç¡®ä¿äº†æ— ç¯çš„åŸŸé—´è·¯ç”±ï¼Œå¹¶æœ‰åŠ©äºç»´æŠ¤ç¨³å®šçš„ç½‘ç»œç»“æ„ã€‚BGP å¯ä»¥å¤„ç†æ•°åƒä¸ªè·¯ç”±ï¼Œå¹¶ä»¥å…¶éšç€ç½‘ç»œå¢é•¿è€Œæ‰©å±•çš„èƒ½åŠ›è€Œè„±é¢–è€Œå‡ºã€‚ç”±äºå…¶çµæ´»æ€§å’Œå¯¹è·¯ç”±ç­–ç•¥çš„æ§åˆ¶ï¼Œå®ƒè¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½¿å…¶èƒ½å¤Ÿå¿«é€Ÿå“åº”ç½‘ç»œå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cilium å’Œ BGP&lt;/strong&gt;
åœ¨ç‰ˆæœ¬ 1.10 ä¸­ï¼ŒCilium é›†æˆäº†å¯¹ MetalLB çš„ BGP æ”¯æŒï¼Œä»è€Œä½¿å…¶èƒ½å¤Ÿå®£å¸ƒ Kubernetes æœåŠ¡çš„ IP åœ°å€ç±»å‹ä¸º&lt;a href=&#34;https://sue.eu/insights/bgp-load-balancing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ BGP çš„ LoadBalancer&lt;/a&gt;ã€‚å…¶ç»“æœæ˜¯ï¼ŒæœåŠ¡å¯ä»¥ä» Kubernetes ç½‘ç»œå¤–éƒ¨è®¿é—®ï¼Œæ— éœ€é¢å¤–çš„ç»„ä»¶ï¼Œä¾‹å¦‚ Ingress è·¯ç”±å™¨ã€‚ç‰¹åˆ«æ˜¯â€œæ— éœ€é¢å¤–ç»„ä»¶â€çš„éƒ¨åˆ†æ˜¯ä»¤äººæŒ¯å¥‹çš„æ¶ˆæ¯ï¼Œå› ä¸ºæ¯ä¸ªç»„ä»¶éƒ½ä¼šå¢åŠ å»¶è¿Ÿï¼Œå› æ­¤æ²¡æœ‰é¢å¤–ç»„ä»¶ä¼šå‡å°‘å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu_c90084cc71b9f310.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu_949699ed36a46eaf.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu_b28ed5481d705e36.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu_c90084cc71b9f310.webp&#34;
               width=&#34;760&#34;
               height=&#34;664&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ­¤ç¤ºä¾‹ä¸­æ˜¾ç¤ºçš„ç½‘ç»œé…ç½®ä»£è¡¨äº†å…·æœ‰ç”¨äºæœåŠ¡è´Ÿè½½å‡è¡¡çš„ BGP é›†æˆçš„åŸºäº Kubernetes çš„ç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯é…ç½®çš„è¯¦ç»†ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®¢æˆ·ç«¯ç½‘ç»œï¼ˆLAN ç½‘ç»œï¼‰ï¼š&lt;/strong&gt; å­˜åœ¨ä¸€ä¸ªå…·æœ‰ IP èŒƒå›´ 192.168.10.0/24 çš„æœ¬åœ°åŒºåŸŸç½‘ç»œï¼ˆLANï¼‰ï¼Œè¿æ¥äº†å¤šä¸ªå®¢æˆ·ç«¯ã€‚è¯¥ç½‘ç»œåŒ…å«äº†è®¾ç½®çš„ç”¨æˆ·ç«¯ï¼Œç”¨æˆ·å’Œå…¶ä»–è®¾å¤‡å¯ä»¥åœ¨å…¶ä¸­è®¿é—®æ‰˜ç®¡åœ¨ Kubernetes é›†ç¾¤ä¸Šçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes ç½‘ç»œï¼š&lt;/strong&gt; Kubernetes é›†ç¾¤å…·æœ‰è‡ªå·±çš„ç½‘ç»œç©ºé—´ï¼Œç”±å­ç½‘ 192.168.1.0/24 æŒ‡å®šã€‚è¯¥ç½‘ç»œåŒ…æ‹¬ Kubernetes ä¸»èŠ‚ç‚¹ï¼ˆk8s-master1ï¼‰å’Œå¤šä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆä» k8s-worker1 åˆ° k8s-worker5ï¼‰ã€‚è¿™äº›èŠ‚ç‚¹æ‰˜ç®¡äº† Kubernetes é›†ç¾¤çš„å®é™…å®¹å™¨å’Œå·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç®¡ç†ç½‘ç»œï¼š&lt;/strong&gt; ä¸€ä¸ªç‹¬ç«‹çš„ç®¡ç†ç½‘ç»œï¼Œè‡³å°‘æœ‰ä¸€ä¸ªè®¾å¤‡ï¼ˆk8s-controlï¼‰ç”¨äºæ§åˆ¶å’Œç®¡ç† Kubernetes é›†ç¾¤ã€‚è¿™ä¸ Kubernetes æ•°æ®å¹³é¢åˆ†å¼€ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§å’Œç®¡ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BGP è·¯ç”±å™¨ï¼š&lt;/strong&gt; bgp-router1 æ¡¥æ¥äº†å¤–éƒ¨ç½‘ç»œ/äº’è”ç½‘å’Œ Kubernetes ç½‘ç»œã€‚å®ƒè´Ÿè´£ä½¿ç”¨ BGP æ¥å¹¿æ’­è·¯ç”±å°†æµé‡è·¯ç”±åˆ° Kubernetes é›†ç¾¤ä¸­çš„é€‚å½“æœåŠ¡ã€‚IP èŒƒå›´ 172.16.10.0/24 ä¿ç•™ä¾› Kubernetes é›†ç¾¤å†…çš„ LoadBalancer æœåŠ¡ä½¿ç”¨ã€‚å½“å°† Kubernetes æœåŠ¡å…¬å¼€ä¸º LoadBalancer æ—¶ï¼Œå®ƒä¼šåˆ†é…ä¸€ä¸ªæ¥è‡ªæ­¤æ± çš„ IP åœ°å€ã€‚ç„¶åï¼ŒBGP è·¯ç”±å™¨å°†æ­¤ IP å¹¿æ’­åˆ°å¤–éƒ¨ç½‘ç»œï¼Œä»è€Œä½¿æµé‡è·¯ç”±åˆ° LoadBalancer æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤ç½‘ç»œé…ç½®å…è®¸é€šè¿‡åˆ©ç”¨ BGP è¿›è¡Œ IP åœ°å€ç®¡ç†å’Œè·¯ç”±æ¥å®ç°è¿è¡Œåœ¨ Kubernetes é›†ç¾¤ä¸Šçš„æœåŠ¡çš„å¯æ‰©å±•å’Œçµæ´»çš„è´Ÿè½½å‡è¡¡ã€‚å®ƒå°†å®¢æˆ·ç«¯è®¿é—®ã€é›†ç¾¤ç®¡ç†å’ŒæœåŠ¡æµé‡åˆ†åˆ«åˆ†éš”åˆ°ä¸åŒçš„ç½‘ç»œä¸­ï¼Œä»¥è¿›è¡Œç»„ç»‡å’Œå®‰å…¨æ€§ç›®çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æš´éœ²æœåŠ¡&#34;&gt;æš´éœ²æœåŠ¡&lt;/h2&gt;
&lt;p&gt;ä¸€æ—¦æ„å»ºäº†ä¸Šè¿°åŸºç¡€æ¶æ„ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªéƒ¨ç½²å¹¶ä½¿ç”¨ BGP å°†å…¶æš´éœ²ç»™ç½‘ç»œã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªéƒ¨ç½²å¼€å§‹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç®€å•çš„ NGINX Web æœåŠ¡å™¨ï¼Œæä¾›é»˜è®¤çš„ Web é¡µé¢ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€ä¸ªç±»å‹ä¸º LoadBalancer çš„ Serviceã€‚è¿™å°†å¯¼è‡´ä½¿ç”¨ BGP å‘æˆ‘ä»¬çš„è·¯ç”±å™¨å®£å¸ƒå¤–éƒ¨ IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æ„å»ºå®Œæˆï¼Œå‘½ä»¤ &lt;code&gt;kubectl get svc&lt;/code&gt; æ˜¾ç¤ºæˆ‘ä»¬çš„æœåŠ¡å…·æœ‰å¤–éƒ¨ IP åœ°å€ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;NAME          TYPE           CLUSTER-IP       EXTERNAL-IP       PORT(S)         AGE
kubernetes    ClusterIP      10.96.0.1        &amp;lt;none&amp;gt;            443/TCP         7d3h
web1-lb       LoadBalancer   10.106.236.120   172.16.10.0       80:30256/TCP    7d2h
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;172.16.10.0 è¿™ä¸ªåœ°å€çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†æ²¡é—®é¢˜ã€‚é€šå¸¸ä¼šè·³è¿‡.0 åœ°å€ï¼Œè€Œä½¿ç”¨.1 åœ°å€ä½œä¸ºç¬¬ä¸€ä¸ªåœ°å€ã€‚å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯åœ¨æ—©æœŸï¼Œ.0 åœ°å€ç”¨äºå¹¿æ’­ï¼Œåæ¥æ”¹ä¸º.255ã€‚ç”±äº.0 ä»ç„¶æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„åœ°å€ï¼Œè´Ÿè´£åœ°å€æ± çš„ MetalLB ä¼šå°†å…¶åˆ†é…ä¸ºç¬¬ä¸€ä¸ªåœ°å€ã€‚åœ¨è·¯ç”±å™¨ bgp-router1 ä¸Šè¿è¡Œçš„å‘½ä»¤ &lt;code&gt;vtysh -c &#39;show bgp summary&#39;&lt;/code&gt; æ˜¾ç¤ºå®ƒå·²æ¥æ”¶åˆ°ä¸€ä¸ªå‰ç¼€ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;IPv4 Unicast Summary:
BGP router identifier 192.168.1.1, local AS number 64512 vrf-id 0
BGP table version 17
RIB entries 1, using 192 bytes of memory
Peers 6, using 128 KiB of memoryNeighbour V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd PfxSnt
192.168.1.10 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.21 4 64512 446 435 0 0 0 03:36:54 1 0
192.168.1.22 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.23 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.24 4 64512 446 435 0 0 0 03:36:56 1 0
192.168.1.25 4 64512 445 435 0 0 0 03:36:56 1 0

Total number of neighbors 6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è·¯ç”±è¡¨çš„ä»¥ä¸‹ç‰‡æ®µï¼ˆip routeï¼‰å‘Šè¯‰æˆ‘ä»¬ï¼Œå¯¹äºç‰¹å®šçš„ IP åœ°å€ 172.16.10.0ï¼Œå­˜åœ¨ 6 ä¸ªå¯èƒ½çš„è·¯ç”±/ç›®æ ‡ã€‚æ¢å¥è¯è¯´ï¼Œæ‰€æœ‰ Kubernetes èŠ‚ç‚¹éƒ½å®£å¸ƒå®ƒä»¬æ­£åœ¨å¤„ç†è¯¥åœ°å€çš„æµé‡ã€‚å¤ªæ£’äº†ï¼ï¼&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;172.16.10.0 proto bgp metric 20
nexthop via 192.168.1.10 dev enp7s0 weight 1
nexthop via 192.168.1.21 dev enp7s0 weight 1
nexthop via 192.168.1.22 dev enp7s0 weight 1
nexthop via 192.168.1.23 dev enp7s0 weight 1
nexthop via 192.168.1.24 dev enp7s0 weight 1
nexthop via 192.168.1.25 dev enp7s0 weight 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®é™…ä¸Šï¼Œç°åœ¨ä»æˆ‘ä»¬çš„è·¯ç”±å™¨ä¸Šå¯ä»¥çœ‹åˆ° Web é¡µé¢ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -s -v http://172.16.10.0/ -o /dev/null

* Trying 172.16.10.0â€¦
* TCP_NODELAY set
* Connected to 172.16.10.0 (172.16.10.0) port 80 (#0)
&amp;gt; GET / HTTP/1.1
&amp;gt; Host: 172.16.10.0
&amp;gt; User-Agent: curl/7.61.1
&amp;gt; Accept: */*
&amp;lt; HTTP/1.1 200 OK
&amp;lt; Server: nginx/1.21.3
&amp;lt; Date: Sun, 31 Oct 2023 14:19:17 GMT
&amp;lt; Content-Type: text/html
&amp;lt; Content-Length: 615
&amp;lt; Last-Modified: Tue, 07 Sep 2023 15:21:03 GMT
&amp;lt; Connection: keep-alive
&amp;lt; ETag: â€œ6137835f-267â€
&amp;lt; Accept-Ranges: bytes&amp;gt;
{ [615 bytes data]}
* Connection #0 to host 172.16.10.0 left intact
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è€Œä¸”ï¼Œä½äºæˆ‘ä»¬å®¢æˆ·ç«¯ç½‘ç»œä¸­çš„å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥è®¿é—®ç›¸åŒçš„é¡µé¢ï¼Œå› ä¸ºå®ƒä½¿ç”¨ bgp-router1 ä½œä¸ºé»˜è®¤è·¯ç”±ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu_8dca7188346418a4.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu_332ba01b4bfc8c6b.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu_1155b82e2e46de23.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu_8dca7188346418a4.webp&#34;
               width=&#34;598&#34;
               height=&#34;345&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¤šç»†èŠ‚&#34;&gt;æ›´å¤šç»†èŠ‚&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä¸€åˆ‡éƒ½è¿ä½œæ­£å¸¸ï¼Œå¤§å¤šæ•°å·¥ç¨‹å¸ˆéƒ½æƒ³çœ‹åˆ°æ›´å¤šç»†èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šè®©ä½ å¤±æœ›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ping&#34;&gt;Ping&lt;/h3&gt;
&lt;p&gt;ä½ å°†æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼ŒLoadBalancer çš„ IP åœ°å€æ— æ³•é€šè¿‡ ping è®¿é—®ã€‚æ·±å…¥æŒ–æ˜ä¸€ä¸‹å¯ä»¥æ­ç¤ºåŸå› ã€‚æˆ‘ä»¬åˆ›å»ºäº†æºç«¯å£ 80 å’Œç›®æ ‡ç«¯å£ 80 ä¹‹é—´çš„æ˜ å°„ã€‚æ­¤æ˜ å°„åœ¨æ¥å£ä¸Šä½¿ç”¨ eBPF é€»è¾‘æ‰§è¡Œï¼Œå¹¶å­˜åœ¨äºæ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚æ­¤æ˜ å°„ç¡®ä¿åªæœ‰ç«¯å£ 80 çš„æµé‡è¢«å‡è¡¡ã€‚æ‰€æœ‰å…¶ä»–æµé‡ï¼ŒåŒ…æ‹¬ pingï¼Œéƒ½ä¸è¢«æ¥æ”¶ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥çœ‹åˆ° icmp æ•°æ®åŒ…åˆ°è¾¾èŠ‚ç‚¹ï¼Œä½†ä»æœªå‘é€å“åº”çš„åŸå› ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§‚å¯Ÿæµé‡&#34;&gt;è§‚å¯Ÿæµé‡&lt;/h3&gt;
&lt;p&gt;Hubble æ˜¯å»ºç«‹åœ¨ eBPF å’Œ Cilium ä¹‹ä¸Šçš„ç½‘ç»œå’Œå®‰å…¨æ€§å¯è§‚æµ‹å¹³å°ã€‚é€šè¿‡å‘½ä»¤è¡Œå’Œå›¾å½¢ Web GUIï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰å’Œå†å²æµé‡ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒHubble æ”¾ç½®åœ¨ k8s-control èŠ‚ç‚¹ä¸Šï¼Œè¯¥èŠ‚ç‚¹ç›´æ¥è®¿é—® Hubble Relay çš„ APIã€‚Hubble Relay æ˜¯ä» Cilium èŠ‚ç‚¹è·å–æ‰€éœ€ä¿¡æ¯çš„ç»„ä»¶ã€‚è¯·æ³¨æ„ï¼ŒHubble å‘½ä»¤ä¹Ÿå­˜åœ¨äºæ¯ä¸ª Cilium ä»£ç† Pod ä¸­ï¼Œä½†é‚£ä¸ªå‘½ä»¤åªä¼šæ˜¾ç¤ºç‰¹å®šä»£ç†çš„ä¿¡æ¯ï¼ä»¥ä¸‹è¾“å‡ºæ˜¾ç¤ºäº†ä»è·¯ç”±å™¨ä¸Šæ‰§è¡Œ curl http://172.16.10.0/ å‘½ä»¤åçš„è§‚å¯Ÿè€…ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ hubble observe â€“namespace default â€“follow

Oct 31 15:43:41.382: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: SYN)
Oct 31 15:43:41.384: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.384: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:43:41.385: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.385: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.386: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:43:41.386: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¹‹å‰ï¼Œæˆ‘è­¦å‘Šè¿‡ä¸è¦åœ¨ Cilium ä»£ç† Pod å†…ä½¿ç”¨ hubble å‘½ä»¤ï¼Œä½†åœ¨ç‰¹å®šèŠ‚ç‚¹æµé‡ä¸­çœ‹åˆ°å…·ä½“çš„æƒ…å†µä¹Ÿå¯ä»¥éå¸¸æœ‰ä¿¡æ¯ä»·å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ª Cilium ä»£ç† Pod ä¸­éƒ½æ‰§è¡Œäº† &lt;code&gt;hubble observe â€“namespace default â€“follow&lt;/code&gt;ï¼Œå¹¶ä¸”è·¯ç”±å™¨çš„ curl æ‰§è¡Œäº†ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰˜ç®¡ Pod çš„èŠ‚ç‚¹ï¼ˆk8s-worker2ï¼‰ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢çš„è¾“å‡ºç›¸åŒçš„è¾“å‡ºã€‚ä½†æ˜¯ï¼Œåœ¨å¦ä¸€ä¸ª Podï¼ˆk8s-worker1ï¼‰ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Oct 31 15:56:05.220: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: SYN)
Oct 31 15:56:05.220: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: SYN, ACK)
Oct 31 15:56:05.220: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:05.221: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:05.221: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:05.222: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:05.222: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:05.222: 10.0.3.103:48278 -&amp;gt; default/web1

-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:12.739: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: SYN)
Oct 31 15:56:12.739: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: SYN, ACK)
Oct 31 15:56:12.742: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:12.742: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:12.745: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:12.749: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:12.749: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: ACK, FIN)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°çš„æ˜¯ï¼Œæˆ‘ä»¬çš„è·¯ç”±å™¨å°† IP åœ°å€ 172.16.10.0 çš„æµé‡å‘é€åˆ° k8s-worker1ï¼Œä½†è¯¥å·¥ä½œèŠ‚ç‚¹ä¸æ‰˜ç®¡æˆ‘ä»¬çš„ web1 å®¹å™¨ï¼Œå› æ­¤å®ƒå°†æµé‡è½¬å‘åˆ°å¤„ç†æµé‡çš„ k8s-worker2ã€‚æ‰€æœ‰çš„è½¬å‘é€»è¾‘éƒ½ä½¿ç”¨ eBPF å¤„ç† - é™„åŠ åˆ°æ¥å£çš„ä¸€ä¸ªå°çš„ BPF ç¨‹åºå°†åœ¨éœ€è¦æ—¶å‘é€æµé‡å’Œè·¯ç”±åˆ°å¦ä¸€ä¸ªå·¥ä½œèŠ‚ç‚¹ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ k8s-worker1 ä¸Šè¿è¡Œ tcpdumpï¼Œåˆå§‹æ¥æ”¶åˆ°æµé‡çš„åœ°æ–¹ï¼Œä¸ä¼šæ˜¾ç¤ºä»»ä½•æµé‡çš„åŸå› ã€‚å®ƒå·²ç»åœ¨è¿›å…¥ k8s-worker1 çš„ IP å †æ ˆä¹‹å‰è¢«é‡å®šå‘åˆ° k8s-worker2ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„åˆä½œä¼™ä¼´ &lt;a href=&#34;https://docs.cilium.io/en/stable/network/ebpf/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Isovalent&lt;/a&gt; æœ‰å¾ˆå¤šå…³äº eBPF å’Œå†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å¬è¯´è¿‡ eBPFï¼Œè€Œä¸”ä½ å¯¹ Linux å’Œ/æˆ–ç½‘ç»œæ„Ÿå…´è¶£ï¼Œè¯·åŠ¡å¿…æ¢ç´¢ä¸€ä¸‹åŸºç¡€çŸ¥è¯†ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒeBPF å°†åœ¨ä¸ä¹…çš„å°†æ¥å½»åº•æ”¹å˜ Linux çš„ç½‘ç»œï¼Œç‰¹åˆ«æ˜¯å¯¹äºäº‘åŸç”Ÿç¯å¢ƒï¼&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium.io &lt;/a&gt;ä¸Šæœ‰å¾ˆå¤šå…³äº eBPF å’Œå†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å¬è¯´è¿‡ eBPFï¼Œè€Œä¸”ä½ å¯¹ Linux å’Œ/æˆ–ç½‘ç»œæ„Ÿå…´è¶£ï¼Œè¯·åŠ¡å¿…äº†è§£è‡³å°‘åŸºç¡€çŸ¥è¯†ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒeBPF å°†åœ¨ä¸ä¹…çš„å°†æ¥å½»åº•æ”¹å˜ Linux çš„ç½‘ç»œï¼Œç‰¹åˆ«æ˜¯å¯¹äºäº‘åŸç”Ÿç¯å¢ƒï¼&lt;/p&gt;
&lt;h3 id=&#34;hubble-web-gui&#34;&gt;Hubble Web GUI&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ªå·¥ä½œæ­£å¸¸çš„ BGP è®¾ç½®ï¼Œä½¿ Hubble Web GUI å¯¹å¤–ç•Œä¹Ÿå¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu_2bc19879b089656f.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu_9822941cc7e754e9.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu_bbd37471d1115f7e.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu_2bc19879b089656f.webp&#34;
               width=&#34;760&#34;
               height=&#34;419&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„è¯&#34;&gt;æœ€åçš„è¯&lt;/h2&gt;
&lt;p&gt;é€šè¿‡ MetalLB çš„é›†æˆï¼Œä½¿ç”¨ BGP è®¾ç½® Cilium å˜å¾—éå¸¸ç®€å•ï¼Œæ¶ˆé™¤äº†æ˜‚è´µçš„ç½‘ç»œç¡¬ä»¶çš„éœ€æ±‚ã€‚Cilium/BGP çš„è¿™ç§ç»„åˆï¼Œç‰¹åˆ«æ˜¯ä¸åœç”¨ kube-proxy ç»“åˆä½¿ç”¨ï¼Œæ˜¾è‘—é™ä½äº†åˆ°äº‘ç«¯æœåŠ¡çš„å»¶è¿Ÿã€‚å®ƒè¿˜é€šè¿‡ä»…å®£å¸ƒ LoadBalancer çš„ IP åœ°å€æ¥å¢å¼ºå®‰å…¨æ€§å’Œé€æ˜æ€§ã€‚è™½ç„¶è¿™ç§è®¾ç½®ä¸éœ€è¦ Ingress Controllerï¼Œä½†å¯¹äºå¤§å¤šæ•° HTTP æœåŠ¡ä»ç„¶å»ºè®®ä½¿ç”¨ä¸€ä¸ªã€‚åƒ NGINX æˆ– Traefik è¿™æ ·çš„æ§åˆ¶å™¨ï¼Œé€šè¿‡ BGP å…¬å¼€ï¼Œæä¾›åè®®çº§åˆ«çš„é‡å†™å’Œè¯·æ±‚é€Ÿç‡é™åˆ¶ç­‰é‡å¤§ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§äº‘åŸç”Ÿå’ŒåŸºäº Linux çš„ç½‘ç»œçš„è¿›æ­¥ç¡®å®æ˜¯ä¸€ä¸ªé£è·ƒï¼Œæ ‡å¿—ç€ç½‘ç»œæŠ€æœ¯çš„æ¿€åŠ¨äººå¿ƒçš„æ—¶ä»£ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Cilium çš„æ§åˆ¶å¹³é¢å‡çº§ä¹‹è·¯ï¼šxDS API çš„å¼•å…¥ä¸åº”ç”¨</title>
      <link>https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/</link>
      <pubDate>Mon, 29 Jan 2024 20:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/</guid>
      <description>&lt;p&gt;åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å½“å‰çš„ Cilium æ§åˆ¶å¹³é¢è®¾è®¡ï¼Œ&lt;a href=&#34;https://github.com/cilium/cilium/issues/30283&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤§è§„æ¨¡éƒ¨ç½²å¯èƒ½å‡ºç°çš„é™åˆ¶çš„ä½ç½®å’ŒåŸå› &lt;/a&gt;ï¼Œä»¥åŠç¤¾åŒºå¦‚ä½•ä½¿ç”¨ CNCF çš„ &lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€šç”¨æ•°æ®å¹³é¢ (xDS) API&lt;/a&gt; æ¨è¿›è¿™ä¸ªæ¶æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº†è§£-cilium-çš„æ§åˆ¶å¹³é¢æ¶æ„&#34;&gt;äº†è§£ Cilium çš„æ§åˆ¶å¹³é¢æ¶æ„&lt;/h2&gt;
&lt;p&gt;Cilium éµå¾ªåŸºäºâ€œæ•°æ®å¹³é¢â€å’Œâ€œæ§åˆ¶å¹³é¢â€çš„å¸¸è§ç½‘ç»œæ¶æ„ã€‚åœ¨ Cilium ä¸­ï¼Œæ•°æ®å¹³é¢éƒ¨ç½²åœ¨æ¯ä¸ªä¸»æœºï¼ˆæˆ– Kubernetes èŠ‚ç‚¹ï¼‰ä¸Šï¼ŒåŒ…æ‹¬ç”¨äºå¤„ç† L3/L4 è¿æ¥å’Œç­–ç•¥çš„ eBPF ç¨‹åºã€‚ä¸ºäº†ç®€åŒ–èµ·è§ï¼Œå¯¹äºå®Œæ•´æ€§ï¼ŒCilium è¿˜åœ¨å…¶æ•°æ®å¹³é¢ä¸­ä½¿ç”¨ Envoy ä»£ç†å¤„ç† L7 ç­–ç•¥ï¼Œä½†æˆ‘ä»¬å°†çœç•¥è¿™éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f1_hu_e85b145e78a6e15c.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f1_hu_b3469153a1af1bfa.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f1_hu_3bc5f9732a2287a7.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f1_hu_e85b145e78a6e15c.webp&#34;
               width=&#34;523&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium æ§åˆ¶å¹³é¢ä»¥ cilium-agent å®ˆæŠ¤ç¨‹åºçš„å½¢å¼å®ç°ï¼Œéƒ¨ç½²åœ¨æ¯ä¸ª Kubernetes èŠ‚ç‚¹ä¸Šã€‚æ¯ä¸ª cilium-agent éƒ½æ˜¯æ§åˆ¶å¹³é¢çš„å•ç‹¬ã€ç‹¬ç«‹çš„å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;cilium-agent è¿æ¥åˆ° Kubernetes API æœåŠ¡å™¨ï¼Œç›‘è§†é…ç½®æ›´æ”¹ï¼Œç„¶åä½¿ç”¨å®ƒæ¥é…ç½®æ•°æ®å¹³é¢ã€‚cilium-agent è¿˜å°†é…ç½®å†™å…¥ Kubernetes APIï¼Œè¡¨ç¤ºæ­£åœ¨å…¶å„è‡ªèŠ‚ç‚¹ä¸Šåˆ›å»ºçš„ç«¯ç‚¹æˆ–æ ‡è¯†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå½“åœ¨ Kubernetes èŠ‚ç‚¹ä¸Šå¯åŠ¨ä¸€ä¸ª Pod æ—¶ï¼Œcilium-agent è´Ÿè´£ç¼–å†™ä¸€ä¸ª CiliumEndpoint è‡ªå®šä¹‰èµ„æºï¼ˆCRï¼‰ï¼Œå¹¶å¯èƒ½æ˜¯ä¸€ä¸ªè¡¨ç¤º Pod ç½‘ç»œæ ‡è¯†çš„ CiliumIdentity CRã€‚cilium-agent è¿˜ä¼šæ›´æ–°ä¸æ ‡è¯†å’Œç«¯ç‚¹æ˜ å°„ç›¸å…³çš„èŠ‚ç‚¹ä¸Šçš„ eBPF æ˜ å°„ã€‚å…¶ä»– Kubernetes èŠ‚ç‚¹ä¸Šçš„ cilium-agent ä¹Ÿä¼šç›‘è§†è¿™äº›æ–°çš„ CiliumEndpoint å’Œ CiliumIdentity CR çš„åˆ›å»ºï¼Œå¹¶æ›´æ–°å…¶æœ¬åœ°çš„ eBPF æ•°æ®å¹³é¢ä»¥æ‰§è¡Œç­–ç•¥ã€‚è¿™ç§æœºåˆ¶èƒ½å¤Ÿåè°ƒæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„å…¨å±€ç­–ç•¥æ‰§è¡Œé…ç½®ï¼Œä»¥ä¾¿æ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°ç›¸åŒçš„æ‰§è¡Œè¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f2_hu_64f207ca12a94a57.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f2_hu_8072c86003c65f56.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f2_hu_7348ee7681a1e9fc.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f2_hu_64f207ca12a94a57.webp&#34;
               width=&#34;760&#34;
               height=&#34;501&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ„å»ºæ§åˆ¶å¹³é¢çš„æœ€ä½³å®è·µ&#34;&gt;æ„å»ºæ§åˆ¶å¹³é¢çš„æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»¥å‰ &lt;a href=&#34;https://www.solo.io/blog/building-a-control-plane-for-envoy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›¾å¤šæ¬¡åœ¨åšå®¢ä¸­&lt;/a&gt; &lt;a href=&#34;https://www.solo.io/blog/guidance-for-building-a-control-plane-for-envoy-part-3-domain-specific-configuration/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®¨è®ºè¿‡æ„å»º&lt;/a&gt; &lt;a href=&#34;https://www.solo.io/blog/why-the-control-plane-matters/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯æ‰©å±•ã€å®‰å…¨ã€é«˜æ•ˆçš„æ§åˆ¶å¹³é¢çš„æœ€ä½³å®è·µ&lt;/a&gt;ã€‚åœ¨æ·±å…¥ç ”ç©¶å¦‚ä½•æ‰©å±• Cilium çš„æ§åˆ¶å¹³é¢ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å›é¡¾ä¸€äº›è¿™äº›æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç»œæ¶æ„ä¸­çš„æ•°æ®å¹³é¢åº”è¯¥å°½å¯èƒ½ç®€å•ï¼Œæ€§èƒ½é«˜ï¼Œä»¥åŠé«˜æ•ˆå®Œæˆå®ƒéœ€è¦åšçš„äº‹æƒ…ï¼šåœ¨æœ¬ä¾‹ä¸­ï¼Œæ¥å›ä¼ è¾“å­—èŠ‚ï¼Œå®æ–½ç­–ç•¥ï¼Œå¹¶æ‰§è¡Œå®‰å…¨æ€§ã€‚æ§åˆ¶å¹³é¢çš„ä½œç”¨æ˜¯ä¿æŠ¤æ•°æ®å¹³é¢å…å—å¤æ‚æ€§çš„å¹²æ‰°ï¼Œä»¥åŠä»»ä½•åˆ†æ•£æ•°æ®å¹³é¢æ ¸å¿ƒä»»åŠ¡çš„äº‹ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œç”¨æˆ·éœ€è¦èƒ½å¤Ÿä»¥æœ€é€‚åˆä»–ä»¬ç”¨æˆ·ä½“éªŒçš„å½¢å¼æŒ‡å®šé…ç½®å’Œç­–ç•¥ã€‚å¾ˆå¤šæ—¶å€™ï¼Œé€šè¿‡æŸç§ &lt;a href=&#34;https://www.solo.io/blog/guidance-for-building-a-control-plane-for-envoy-part-3-domain-specific-configuration/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‰¹å®šé¢†åŸŸçš„é…ç½®æ ¼å¼&lt;/a&gt; æ¥å®ç°ã€‚ç„¶åéœ€è¦å°†è¿™ç§æ›´é«˜çº§åˆ«çš„ç”¨æˆ·é…ç½®ä¸åŸºç¡€è®¾æ–½çŠ¶æ€ç›¸ç»“åˆï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºè¾ƒä½çº§åˆ«çš„æ•°æ®å¹³é¢æ ¼å¼ã€‚è½¬è¯‘æ˜¯ä¸€åŠçš„æˆ˜æ–—ã€‚è¿˜éœ€è¦å°†è¾ƒä½çº§åˆ«çš„é…ç½®åˆ†å‘åˆ°æ•°æ®å¹³é¢ï¼Œå¹¶é«˜æ•ˆåœ°æ‰§è¡Œã€‚è¿™å°±æ˜¯æ§åˆ¶å¹³é¢å‡ºç°åœ¨ç”»é¢ä¸­çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f3_hu_326cf5101df16a89.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f3_hu_818d9a1ab05dcb49.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f3_hu_402334f16257c9b3.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f3_hu_326cf5101df16a89.webp&#34;
               width=&#34;529&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å¹³é¢å…è®¸é…ç½®è§£è€¦å¹¶ä¸å¹³å°çš„å…¶ä»–éƒ¨åˆ†é›†æˆï¼Œè¿™äº›éƒ¨åˆ†éšåå¯ä»¥é€šçŸ¥æ•°æ®å¹³é¢ã€‚åœ¨è®¸å¤šæ–¹é¢ï¼Œè¿™ä¸ªå›¾è¡¨ä¸æˆ‘ä»¬æ„å»ºåº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨çš„ &lt;a href=&#34;https://learn.microsoft.com/en-us/azure/architecture/guide/architecture-styles/n-tier&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‰å±‚æ¶æ„&lt;/a&gt; ç±»ä¼¼ï¼šè¡¨ç¤ºå±‚ï¼Œè§£è€¦çš„ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f4_hu_3f0fb52479bcfd4e.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f4_hu_1c65606fdf2c162b.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f4_hu_7ce2e12ee58785c6.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f4_hu_3f0fb52479bcfd4e.webp&#34;
               width=&#34;533&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ç½‘ç»œæ¶æ„çš„æƒ…å†µä¸‹ï¼Œæ§åˆ¶å¹³é¢å±‚å°†å¤„ç†è¯»å–/å†™å…¥ Kubernetes API å’Œåˆ›å»ºç½‘ç»œæ ‡è¯†ç­‰æ•æ„Ÿæ•°æ®ã€‚ç”±äºå®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„å±‚ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œå®‰å…¨å’Œç¡¬åŒ–å¤„ç†ï¼Œå¹¶æ¶ˆé™¤æ•°æ®å¹³é¢éœ€è¦æ‰§è¡Œè¿™äº›ä»»åŠ¡çš„æƒé™ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè™½ç„¶å¼€å§‹æ—¶æ›´ç®€å•ï¼Œä½†åˆå¹¶ä¸€äº›å±‚ä¼šå¯¼è‡´æ•ˆç‡ä½ä¸‹ã€å®‰å…¨é—®é¢˜å’Œæ‰©å±•/è€¦åˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-æ§åˆ¶å¹³é¢æ¶æ„çš„æ‰©å±•è€ƒè™‘&#34;&gt;Cilium æ§åˆ¶å¹³é¢æ¶æ„çš„æ‰©å±•è€ƒè™‘&lt;/h2&gt;
&lt;p&gt;é›†ç¾¤ä¸­çš„æ¯ä¸ª cilium-agent è´Ÿè´£å°†å…¨å±€é›†ç¾¤é…ç½®æ›´æ–°åˆ°å…¶æœ¬åœ°æ•°æ®å¹³é¢é…ç½®ã€‚æ¯ä¸ª cilium-agent å¯èƒ½ä¼šç›‘è§†å¤šè¾¾ 15 ç§ CRD ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;éšç€é›†ç¾¤åœ¨èŠ‚ç‚¹ã€Podã€å‘½åç©ºé—´å’Œç½‘ç»œç­–ç•¥æ–¹é¢çš„è§„æ¨¡å¢é•¿ï¼Œæ¯ä¸ª cilium-agent éœ€è¦æ‰§è¡Œçš„å·¥ä½œé‡ä¹Ÿä¼šå¢åŠ ã€‚ä¸ºäº†æœåŠ¡å’Œæ›´æ–°æ‰€æœ‰è¿™äº›çŠ¶æ€ï¼Œä¼šå¯¹ Kubernetes apiserver é€ æˆå‹åŠ›ï¼Œå¯èƒ½å¯¼è‡´ &lt;a href=&#34;https://github.com/cilium/cilium/issues/29127&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f5_hu_3a4c4e660d187d00.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f5_hu_eba9fd7d2bcc723d.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f5_hu_2144cb1d45806ffc.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f5_hu_3a4c4e660d187d00.webp&#34;
               width=&#34;760&#34;
               height=&#34;478&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨å¤§è§„æ¨¡éƒ¨ç½²ä¸­ï¼Œè¿™ç§å¯¹ Kubernetes API æœåŠ¡å™¨çš„å‹åŠ›å¯èƒ½æœ€ç»ˆä¼šå‡æ…¢ &lt;em&gt;ç”šè‡³å¯¼è‡´&lt;/em&gt; é›†ç¾¤ä¸­çš„æ‰€æœ‰æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æŸ¥çœ‹é›†ç¾¤ä¸­çš„å¸¸è§æ“ä½œä»¥åŠ cilium-agent å¤„ç†å®ƒçš„æ–¹å¼æ—¶ï¼Œå…¨å±€é…ç½®çŠ¶æ€å¯¹æ¯ä¸ªèŠ‚ç‚¹çš„å½±å“ç¡®å®å¼€å§‹æ”¾å¤§ï¼šå·¥ä½œè´Ÿè½½å’Œå‘½åç©ºé—´è¢«æ ‡è®°ã€é‡æ–°æ ‡è®°æˆ–å–æ¶ˆæ ‡è®°ã€‚&lt;/p&gt;
&lt;p&gt;cilium-agent è´Ÿè´£ä¸ºè°ƒåº¦åˆ°å…¶èŠ‚ç‚¹ä¸Šçš„ Pod ç¼–å†™ CiliumEndpoint å’Œ CiliumIdentity èµ„æºã€‚ç”±äºè¿™äº›èµ„æºä¾èµ–äº Pod å’Œå‘½åç©ºé—´æ ‡ç­¾çš„ç»„åˆï¼Œæ ‡ç­¾çš„æ›´æ”¹å°†å¯¼è‡´æ‰€æœ‰ä¾èµ–èµ„æºçš„æ›´æ–°ã€‚è¿™ä¼šå¯¼è‡´å¤§é‡çš„å†™æ“ä½œå’Œç›¸åº”çš„è¯»å–æ“ä½œï¼Œå› ä¸ºæ­¤çŠ¶æ€éšåä¼šä¼ æ’­åˆ°æ‰€æœ‰ cilium-agentï¼Œå®ƒä»¬å¿…é¡»åšå‡ºååº”å¹¶é‡æ–°é…ç½®å…¶æœ¬åœ°æ•°æ®å¹³é¢ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium.io/v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumIdentity&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;50568&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.cilium.k8s.policy.cluster&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.cilium.k8s.policy.serviceaccount&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep-v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.kubernetes.pod.namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;security-labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.cilium.k8s.namespace.labels.team&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;loyalty&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.cilium.k8s.namespace.labels.version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v10.45&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.cilium.k8s.namespace.labels.kubernetes.io/metadata.name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.cilium.k8s.policy.cluster&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.cilium.k8s.policy.serviceaccount&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep-v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:io.kubernetes.pod.namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s:version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä»£ç æ¸…å• 1ï¼š&lt;code&gt;CiliumIdentity&lt;/code&gt; èµ„æºç»“åˆäº† &lt;em&gt;Pod&lt;/em&gt; å’Œ &lt;em&gt;å‘½åç©ºé—´&lt;/em&gt; æ ‡ç­¾ã€‚å¯¹ä»»ä¸€è€…çš„æ›´æ”¹éƒ½ä¼šå¼ºåˆ¶é‡æ–°è®¡ç®—å¹¶ç”Ÿæˆæ–°çš„ &lt;code&gt;CiliumIdentity&lt;/code&gt;ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¹é›†ç¾¤ä¸­çš„å‘½åç©ºé—´è¿›è¡Œæ ‡è®°ç­‰æ“ä½œå¯¹äº Cilium å¯èƒ½éå¸¸æ˜‚è´µï¼Œå¹¶ä¸”æœ‰å¯èƒ½å¯¼è‡´ API æœåŠ¡å™¨æ“ä½œå‡æ…¢åˆ°çˆ¬è¡Œçš„ç¨‹åº¦ï¼ˆ&lt;a href=&#34;https://docs.cilium.io/en/stable/operations/performance/scalability/identity-relevant-labels/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·å‚é˜…ç”¨äºæ ‡è¯†ç›®çš„åŒ…æ‹¬/æ’é™¤æ ‡ç­¾çš„å»ºè®®&lt;/a&gt;ï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸­ç­‰è§„æ¨¡é›†ç¾¤ä¸­æ›´æ”¹å‘½åç©ºé—´çš„æ ‡ç­¾å¯èƒ½ä¼šå¯¼è‡´è¶³å¤Ÿå¤šçš„ cilium-agent å¯¼è‡´ Kubernetes API æœåŠ¡å™¨å“åº”å»¶è¿Ÿçº¦ &lt;strong&gt;4 åˆ†é’Ÿ&lt;/strong&gt;ã€‚è¿™å°†æœ‰æ•ˆåœ°ä½¿é›†ç¾¤ä¸Šçš„æ‰€æœ‰æ“ä½œåœæ»ä¸å‰ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»¥ä¸‹ç¯å¢ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;200 ä¸ªèŠ‚ç‚¹çš„ Kubernetes é›†ç¾¤&lt;/li&gt;
&lt;li&gt;5 ä¸ªå‘½åç©ºé—´&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªå‘½åç©ºé—´æœ‰ 50 ä¸ªéƒ¨ç½²&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªéƒ¨ç½²æœ‰ 80 ä¸ªå‰¯æœ¬ï¼ˆæ€»å…± 20,000 ä¸ª Podï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ä¸€æ¬¡æ›´æ–°è·¨å‘½åç©ºé—´çš„æ ‡ç­¾çš„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° CPU åˆ©ç”¨ç‡æ€¥å‰§ä¸Šå‡ï¼Œçº¦ä¸º 150%ï¼Œå¹¶ä¸”å†…å­˜åœ¨æ•´ä¸ªé›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šå‡åˆ°çº¦ 1 GBã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„-cpu-å’Œå†…å­˜å³°å€¼&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šæ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ CPU å’Œå†…å­˜å³°å€¼&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g1_hu_615248bfbd16ec9a.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g1_hu_304d58c87aca2dc2.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g1_hu_631e786dfbd9fc04.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g1_hu_615248bfbd16ec9a.webp&#34;
               width=&#34;760&#34;
               height=&#34;210&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šæ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ CPU å’Œå†…å­˜å³°å€¼
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨æ•´ä¸ªé›†ç¾¤çš„æ‰€æœ‰èŠ‚ç‚¹ä¸ŠåŒæ—¶æé«˜ CPU å’Œå†…å­˜æ˜¯ä¸å¸Œæœ›çœ‹åˆ°çš„è¡Œä¸ºï¼Œç„¶è€Œæ›´ä¸¥é‡çš„æ˜¯ cilium-agent äº‹ä»¶çš„è¯»å†™å¦‚ä½•å½±å“ Kubernetes API æœåŠ¡å™¨çš„å»¶è¿Ÿã€‚åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°å»¶è¿Ÿå¢é•¿åˆ° 3 åˆ° 4 &lt;em&gt;åˆ†é’Ÿ&lt;/em&gt;ã€‚è¿™è‚¯å®šä¼šå¯¼è‡´å„ç§ç±»å‹çš„åœæœºï¼ä¸å¹¸çš„æ˜¯ï¼Œç”±äºè¿™ç§æ§åˆ¶å¹³é¢æ¶æ„ï¼Œé€šè¿‡å¢åŠ å®¹é‡æ¥å¤„ç†æ‰©å±•é—®é¢˜çš„å…¸å‹æ–¹æ³•ä¸èµ·ä½œç”¨ï¼›å®é™…ä¸Šï¼Œæ·»åŠ æ›´å¤šèŠ‚ç‚¹å’Œ/æˆ–æ›´å¤šå·¥ä½œè´Ÿè½½ä¼šæ”¾å¤§è¿™ç§è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2kubernetes-api-æœåŠ¡å™¨å»¶è¿Ÿå¢åŠ åˆ°-3---4-åˆ†é’Ÿ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šKubernetes API æœåŠ¡å™¨å»¶è¿Ÿå¢åŠ åˆ° 3 - 4 åˆ†é’Ÿ&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g2_hu_6e62b2feb21d20f8.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g2_hu_55c4ca0df3bc6f01.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g2_hu_1be1774be4a5cbde.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g2_hu_6e62b2feb21d20f8.webp&#34;
               width=&#34;760&#34;
               height=&#34;312&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šKubernetes API æœåŠ¡å™¨å»¶è¿Ÿå¢åŠ åˆ° 3 - 4 åˆ†é’Ÿ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å‡è½»-kubernetes-api-æœåŠ¡å™¨çš„å‹åŠ›&#34;&gt;å‡è½» Kubernetes API æœåŠ¡å™¨çš„å‹åŠ›&lt;/h2&gt;
&lt;p&gt;å¯¹äºè¾ƒå¤§çš„ Cilium é›†ç¾¤ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨&lt;a href=&#34;https://docs.cilium.io/en/latest/kvstore/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸“ç”¨çš„é”®å€¼å­˜å‚¨&lt;/a&gt; æ¥å‡è½» Kubernetes API æœåŠ¡å™¨ä¸Šçš„å‹åŠ›ã€‚é”®å€¼å­˜å‚¨ç”¨äºå­˜å‚¨å·¥ä½œè´Ÿè½½æ ‡è¯†ã€ç«¯ç‚¹å’Œ IP åˆ°æ ‡è¯†æ˜ å°„ç­‰å†…å®¹ã€‚Cilium ä¸å†å°†æ­¤ä¿¡æ¯å­˜å‚¨åœ¨ Kubernetes è‡ªå®šä¹‰èµ„æºï¼ˆCRDï¼‰ä¸­ï¼Œè€Œæ˜¯åœ¨å…¶è‡ªå·±çš„æ•°æ®åº“ä¸­ç›´æ¥ç›‘è§†ã€æ“ä½œå’Œå†™å…¥å¯¹è±¡ã€‚Cilium Helm å›¾è¡¨æ”¯æŒå°† etcd ä½œä¸ºä¸“ç”¨é”®å€¼å­˜å‚¨æ¥è¿›è¡Œå®‰è£…ï¼Œä»¥æ»¡è¶³æ­¤ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;éšç€é›†ç¾¤çš„å¢é•¿ï¼Œä½¿ç”¨ kv-store æ¥å¸è½½ Cilium å¯¹è±¡çš„è¯»/å†™æ“ä½œå¯èƒ½æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œè€Œä¸æ˜¯ç»™ Kubernetes API æœåŠ¡å™¨æ–½åŠ å‹åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼šCilium è¿˜è¿›è¡Œäº†å…¶ä»–ä¼˜åŒ–ï¼Œä»¥å‡è½» Kubernetes API æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä¾‹å¦‚ç­–ç•¥çŠ¶æ€æ›´æ–°ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://docs.cilium.io/en/stable/internals/cilium_operator/#policy-status-update&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s-events-handover æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åœ¨å­˜åœ¨ kv-store çš„æƒ…å†µä¸‹é‡æ–°è¿è¡Œå…ˆå‰çš„æµ‹è¯•ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°å¯¹ Kubernetes API æœåŠ¡å™¨çš„å‹åŠ›å‡è½»ï¼Œå°½ç®¡ CPU å¯èƒ½æ²¡æœ‰å‡è½»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„-cpu-å³°å€¼å†…å­˜ä¿æŒåœ¨-300-400-mb-èŒƒå›´å†…&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3ï¼šæ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ CPU å³°å€¼ï¼Œå†…å­˜ä¿æŒåœ¨ 300-400 MB èŒƒå›´å†…&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g3_hu_e094f9dd4cdd32ea.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g3_hu_3b1312df8e2405dd.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g3_hu_8ab2f07bbd6316d4.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g3_hu_e094f9dd4cdd32ea.webp&#34;
               width=&#34;760&#34;
               height=&#34;174&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3ï¼šæ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ CPU å³°å€¼ï¼Œå†…å­˜ä¿æŒåœ¨ 300-400 MB èŒƒå›´å†…
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸å…ˆå‰æƒ…å†µä¸‹çš„ 150% CPU æ¶ˆè€—ä¸åŒï¼ŒCPU åœ¨å¤§çº¦ 100% å·¦å³æ³¢åŠ¨ï¼Œè€Œå†…å­˜ä¿æŒåœ¨å¤§çº¦ 300 åˆ° 400 MB çš„èŒƒå›´å†…ã€‚è¿™æ˜¯å› ä¸ºå¯¹æ¯ä¸ª Pod å’Œæ¯ä¸ªæ ‡è¯†ï¼ˆCilium åœ¨æ›´æ”¹æ ‡ç­¾æ—¶åˆ›å»ºæ‰€æœ‰æ–°æ ‡è¯†ï¼Œå¹¶ä¸”å¿…é¡»æ›´æ–°å¼•ç”¨æ—§æ ‡è¯†çš„æ‰€æœ‰ eBPF æ˜ å°„çš„ CiliumEndpoint å’Œ CiliumIdentity å¯¹è±¡çš„é‡æ–°è®¡ç®—å’Œç”Ÿæˆéœ€è¦ CPU è®¡ç®—èµ„æºæ¥å®Œæˆï¼Œæ— è®ºä½¿ç”¨ä½•ç§åå¤‡å­˜å‚¨ï¼ˆCRDã€kv-store ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è§‚å¯Ÿ kv-storeï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨æ­¤å‘½åç©ºé—´æ ‡ç­¾äº‹ä»¶æœŸé—´ï¼Œäº‹ä»¶æ“ä½œ/ç§’å’Œå»¶è¿Ÿä¼šæ€¥å‰§ä¸Šå‡ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4kv-store-ä¸Šçš„äº‹ä»¶æ“ä½œå’Œå»¶è¿Ÿåœ¨æ­¤å‘½åç©ºé—´æ ‡ç­¾äº‹ä»¶æœŸé—´æ€¥å‰§ä¸Šå‡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4ï¼škv-store ä¸Šçš„äº‹ä»¶æ“ä½œå’Œå»¶è¿Ÿåœ¨æ­¤å‘½åç©ºé—´æ ‡ç­¾äº‹ä»¶æœŸé—´æ€¥å‰§ä¸Šå‡&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g4_hu_5d3c3f2aeb645b88.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g4_hu_a1b2c57ef9acb2dd.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g4_hu_57207f194d2e0dd.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g4_hu_5d3c3f2aeb645b88.webp&#34;
               width=&#34;760&#34;
               height=&#34;183&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4ï¼škv-store ä¸Šçš„äº‹ä»¶æ“ä½œå’Œå»¶è¿Ÿåœ¨æ­¤å‘½åç©ºé—´æ ‡ç­¾äº‹ä»¶æœŸé—´æ€¥å‰§ä¸Šå‡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ° kv-store æ‰¿å—äº†ç›¸å½“å¤§çš„è´Ÿè½½ï¼Œé€šè¿‡äº‹ä»¶ IOï¼Œæˆ‘ä»¬çœ‹åˆ° kv-store è°ƒç”¨çš„å»¶è¿Ÿé™ä½åˆ°çº¦ 15 ç§’å·¦å³ã€‚æ€»ä¹‹ï¼Œè¿™å¯¹äºæ•´ä¸ªé›†ç¾¤æ“ä½œè€Œè¨€è¦å¥½å¾—å¤šï¼Œè€Œä¸æ˜¯ç”¨è¯·æ±‚ä½¿ Kubernetes API æœåŠ¡å™¨é¥±å’Œã€‚äº‹å®ä¸Šï¼Œåœ¨å›¾ 5 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Kubernetes API æœåŠ¡å™¨çš„å»¶è¿Ÿä¿æŒåœ¨ 10 åˆ° 40 æ¯«ç§’çš„å¯æ¥å—èŒƒå›´å†…ï¼Œè€Œåœ¨å…ˆå‰çš„ç¤ºä¾‹ä¸­ï¼Œå»¶è¿Ÿå‡é«˜åˆ° 4 åˆ†é’Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5kubernetes-api-server-å»¶è¿Ÿåœ¨-10-åˆ°-40ms-ä¹‹é—´&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5ï¼šKubernetes API Server å»¶è¿Ÿåœ¨ 10 åˆ° 40ms ä¹‹é—´&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g5_hu_fd927ddd788c12fd.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g5_hu_d212f8cd78cdec33.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g5_hu_3ff367fa94d597cd.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g5_hu_fd927ddd788c12fd.webp&#34;
               width=&#34;760&#34;
               height=&#34;305&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5ï¼šKubernetes API Server å»¶è¿Ÿåœ¨ 10 åˆ° 40ms ä¹‹é—´
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ kv-store åç«¯æ¥å­˜å‚¨ Cilium å¯¹è±¡æ˜¯ä¸€ç§ç¼“è§£ Kubernetes API æœåŠ¡å™¨å‹åŠ›çš„å¥½æ–¹æ³•ï¼Œä½†å®ƒä¹Ÿæœ‰å…¶ç¼ºç‚¹ã€‚ç°åœ¨æœ‰ä¸¤ä¸ªæŒä¹…å­˜å‚¨éœ€è¦ç»´æŠ¤ï¼Œè€Œä¸”éšç€è§„æ¨¡çš„å¢åŠ ï¼Œè¿ç»´è´Ÿæ‹…ä¹Ÿå¢åŠ ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œæ•°æ®åº“æˆ–æŒä¹…å­˜å‚¨ï¼ˆæ€»ä½“æ¥è¯´ï¼‰ä»¥æ”¯æŒè§„æ¨¡åŒ–å¹¶éæ˜“äº‹ã€‚å¦‚æœå¤±å»ä¸€è‡´æ€§ï¼Œæ¢å¤è¿‡ç¨‹æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºç°åœ¨æœ‰ä¸¤ä¸ªâ€œçœŸç›¸æºâ€ã€‚è®¸å¤šå¹³å°å®Œå…¨ç®¡ç† Kubernetes API æœåŠ¡å™¨åŠå…¶å­˜å‚¨ï¼Œä½† kv-store å¹¶ä¸æ˜¯å¦‚æ­¤ã€‚ç”±äºç»å¤§å¤šæ•°è´Ÿè½½æ˜¯è¯»å–æ“ä½œï¼Œç¼“å­˜å°†åœ¨å‡å°‘è¿ç»´å¤æ‚æ€§çš„åŒæ—¶äº§ç”Ÿç›¸åŒçš„æ”¹è¿›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨-xds-æ”¹è¿›-cilium-çš„æ§åˆ¶å¹³é¢æ‰©å±•å®‰å…¨æ€§å’Œæ•ˆç‡&#34;&gt;ä½¿ç”¨ xDS æ”¹è¿› Cilium çš„æ§åˆ¶å¹³é¢æ‰©å±•ã€å®‰å…¨æ€§å’Œæ•ˆç‡&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å¯ä»¥å…¼é¡¾ä¸¤å…¨å‘¢ï¼Ÿæ—¢å‡è½» Kubernetes API æœåŠ¡å™¨çš„å‹åŠ›ï¼Œåˆæ¶ˆé™¤ç»´æŠ¤å•ç‹¬æ•°æ®å­˜å‚¨çš„æ˜‚è´µç”Ÿäº§æ“ä½œçš„éœ€è¦ï¼Ÿç”šè‡³å¯èƒ½è§£å†³ä¸€äº›å…¶ä»–å°šæœªè§£å†³çš„ Cilium æ‰©å±•å’Œå®‰å…¨æ€§é—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨ Solo.ioï¼Œæˆ‘ä»¬å¾ˆé«˜å…´ä¸º Cilium ç¤¾åŒºä¸­æ›´å¹¿æ³›çš„ xDS å·¥ä½œä½œå‡ºè´¡çŒ®ï¼Œå¹¶å¸®åŠ©æ¨åŠ¨è¯¥é¡¹ç›®æœç€å¯æ‰©å±•ã€å®‰å…¨å’Œé«˜æ•ˆçš„æ§åˆ¶å¹³é¢è¿ˆè¿›ã€‚ä½¿ç”¨&lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS åè®®&lt;/a&gt;ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨é›†ç¾¤ä¸­æ‰©å±•åˆ°æ•°åƒç”šè‡³æ•°ä¸‡ä¸ªèŠ‚ç‚¹ã€‚è¿™ç§æ–¹æ³•è§£å†³äº†ä¸Šé¢è®¨è®ºçš„è®¸å¤šé—®é¢˜ï¼Œä»¥åŠå…¶ä»–é—®é¢˜ï¼Œå¦‚å•èŠ‚ç‚¹å¦¥åå½±å“èŒƒå›´å’Œè§„æ¨¡ä¸Šçš„ CiliumIdentity é‡å¤ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS åè®®&lt;/a&gt;æœ€åˆæ˜¯ä¸€ç§åŠ¨æ€é…ç½®&lt;a href=&#34;https://www.envoyproxy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy ä»£ç†&lt;/a&gt;çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒå»ºç«‹çš„ç†å¿µæ˜¯å¯ä»¥ç”¨æ¥æ”¯æŒâ€œé€šç”¨æ•°æ®å¹³é¢â€ã€‚è¯¥åè®®å·²æˆä¸ºåœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´åŒæ­¥çŠ¶æ€çš„æœ‰æ•ˆæ–¹å¼ï¼Œ&lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç°åœ¨ç”± CNCF å·¥ä½œç»„ç®¡ç†&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘ä»¬å¸Œæœ›æ¶ˆé™¤æ¯ä¸ª cilium-agent æ‰€åšçš„å†—ä½™å·¥ä½œï¼Œå°†è¯¸å¦‚æ ‡è¯†åˆ›å»ºä¹‹ç±»çš„å¤æ‚ä¸”æƒé™æ•æ„Ÿçš„æ“ä½œé›†ä¸­åœ¨ä¸€èµ·ï¼Œå¹¶ä»¥é«˜æ•ˆçš„æ–¹å¼ä¸ºä»£ç†æä¾›çŠ¶æ€ï¼ŒåŒæ—¶ä¸æŸå®³ Kubernetes ä½œä¸ºæ•´ä½“çš„å¯é æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä¸å†è®©æ¯ä¸ª cilium-agent å……å½“ç‹¬ç«‹çš„æ§åˆ¶å¹³é¢ï¼Œè€Œæ˜¯è€ƒè™‘è®© cilium-agent å……å½“æ™ºèƒ½é›†ä¸­æ§åˆ¶å¹³é¢çš„ç®€å•åªè¯»å®¢æˆ·ç«¯ã€‚æ§åˆ¶å¹³é¢å°†ä¿æŠ¤ä»£ç†å…å—å¤æ‚å’Œæƒé™æ•æ„Ÿçš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;cilium-agentï¼ˆç°åœ¨å±äºæ•°æ®å¹³é¢çš„ä¸€éƒ¨åˆ†ï¼‰ä¸æ§åˆ¶å¹³é¢ä¹‹é—´çš„é€šä¿¡å°†é‡‡ç”¨&lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS åè®®&lt;/a&gt;ã€‚æ•°æ®å¹³é¢ä¸å…è®¸ä»æ•°æ®å¹³é¢åˆ°æ§åˆ¶å¹³é¢çš„å†™æ“ä½œï¼Œå› æ­¤ cilium-agent ä¸éœ€è¦å¯¹åç«¯å­˜å‚¨ï¼ˆCRD/kv-storeï¼‰å…·æœ‰å†™å…¥è®¿é—®æƒé™ã€‚xDS æ§åˆ¶å¹³é¢æœåŠ¡å¯ä»¥å¾—åˆ°å®‰å…¨åŠ å›ºï¼Œæ˜¯å”¯ä¸€éœ€è¦æ”¯æŒå¯¹ Kubernetes API æœåŠ¡å™¨è¿›è¡Œè¯»/å†™æ“ä½œçš„ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/f6_hu_6cc3ad3bae15435.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/f6_hu_92ef934408073349.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/f6_hu_369497425203c15c.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/f6_hu_6cc3ad3bae15435.webp&#34;
               width=&#34;760&#34;
               height=&#34;562&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¶æ„å‡è½»äº† Kubernetes API æœåŠ¡å™¨çš„è´Ÿè½½ï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•å¤–éƒ¨ç®¡ç†çš„æ•°æ®å­˜å‚¨ã€‚å®ƒçœ‹èµ·æ¥ä¹Ÿæ›´æ¥è¿‘ä¹‹å‰è®¨è®ºçš„ä¸‰å±‚æ§åˆ¶å¹³é¢æ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6xds-å®ç°çš„åˆå§‹æµ‹è¯•æ˜¾ç¤º-cpu-å’Œå†…å­˜ä½¿ç”¨çš„é¢„æœŸè¡Œä¸º&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6ï¼šxDS å®ç°çš„åˆå§‹æµ‹è¯•æ˜¾ç¤º CPU å’Œå†…å­˜ä½¿ç”¨çš„é¢„æœŸè¡Œä¸º&#34; srcset=&#34;
               /blog/scaling-cilium-to-new-heights-with-xds/g6_hu_e99df57e8e3ee45f.webp 400w,
               /blog/scaling-cilium-to-new-heights-with-xds/g6_hu_dbae803dfca4755a.webp 760w,
               /blog/scaling-cilium-to-new-heights-with-xds/g6_hu_5bac9b62c0bdd4df.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/scaling-cilium-to-new-heights-with-xds/g6_hu_e99df57e8e3ee45f.webp&#34;
               width=&#34;760&#34;
               height=&#34;385&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6ï¼šxDS å®ç°çš„åˆå§‹æµ‹è¯•æ˜¾ç¤º CPU å’Œå†…å­˜ä½¿ç”¨çš„é¢„æœŸè¡Œä¸º
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œæˆ‘ä»¬ç¡®å®çœ‹åˆ°äº† xDS æ§åˆ¶å¹³é¢ pods ä¸­çš„ CPU å’Œå†…å­˜å¼€é”€ï¼Œæ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»ç„¶éœ€è¦å¤„ç† eBPF æ•°æ®å¹³é¢çš„ä¸€äº› CPU/å†…å­˜å¤„ç†å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¨¡å‹å¸¦æ¥çš„å…¶ä»–å¥½å¤„åŒ…æ‹¬åœ¨èŠ‚ç‚¹å—æŸæ—¶æ›´å°çš„å½±å“èŒƒå›´ï¼Œä»¥åŠæ¶ˆé™¤äº† cilium-agent åˆ›å»ºçš„é‡å¤æ ‡è¯†ã€‚åœ¨åŸå§‹æ¶æ„ï¼ˆCRD æˆ– kv-storeï¼‰ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå®Œæ•´çš„æ§åˆ¶å¹³é¢ï¼Œéœ€è¦ç‰¹æ®Šæƒé™æ¥è¯»å–å’Œå†™å…¥&lt;code&gt;CiliumEndpoints&lt;/code&gt;å’Œ&lt;code&gt;CiliumIdentity&lt;/code&gt;ã€‚å¦‚æœæŸä¸ªèŠ‚ç‚¹ä¸Šçš„ cilium-agent å—åˆ°å¦¥åï¼Œé‚£ä¹ˆæ•´ä¸ªæ§åˆ¶å¹³é¢å°†å—åˆ°å¨èƒï¼Œå¹¶ä½¿æ”»å‡»è€…èƒ½å¤Ÿå½±å“å…¶ä»–èŠ‚ç‚¹ã€‚è¿™å¯èƒ½å¯¼è‡´æ•´ä¸ªé›†ç¾¤å¦¥åã€‚åœ¨ xDS æ¨¡å‹ä¸­ï¼Œcilium-agent è¢«å…è®¸ä»æ§åˆ¶å¹³é¢è¯»å–æ•°æ®ï¼ˆä¸å…è®¸å†™å…¥ï¼‰ï¼Œå•ä¸ª cilium-agent çš„å¦¥åä¸ä¼šç»™äºˆå¯¹æ•´ä¸ªæ§åˆ¶å¹³é¢æˆ–é›†ç¾¤çš„è®¿é—®æƒé™ã€‚æ­£å¦‚å‰é¢æåˆ°çš„ï¼ŒxDS æ§åˆ¶å¹³é¢è¢«è§†ä¸ºç‰¹æƒç»„ä»¶ï¼Œå¯ä»¥è¿›è¡Œé”å®šå’Œå®‰å…¨è®¾ç½®ï¼Œç”šè‡³å¯ä»¥å®Œå…¨åœ¨é›†ç¾¤ä¹‹å¤–è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;xDS æ–¹æ³•çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡é›†ä¸­æ ‡è¯†åˆ›å»ºæ¥æ¶ˆé™¤ Cilium ä¸­é‡å¤æ ‡è¯†çš„ç”Ÿæˆã€‚åœ¨ç°æœ‰æ¨¡å‹ä¸­ï¼Œæ¯ä¸ª cilium-agent éƒ½ç‹¬ç«‹å……å½“æ§åˆ¶å¹³é¢ï¼Œä¸å…¶ä»–èŠ‚ç‚¹éš”ç¦»ï¼Œæ­£å¦‚åœ¨ç°æœ‰æ¨¡å‹ä¸­ï¼Œå®ƒè¯•å›¾åšå‡ºå¯èƒ½æ˜¯é‡å¤çš„å†³ç­–ã€‚ä¾‹å¦‚ï¼Œå½“ Pod åˆ†é…åˆ°èŠ‚ç‚¹æ—¶ï¼ŒCNI è´Ÿè´£è®¾ç½®ç½‘ç»œç«¯ç‚¹ï¼Œå½“ cilium-agent è¯†åˆ«åˆ°ä¸€ä¸ªæ–°çš„ç«¯ç‚¹ï¼Œå®ƒæ²¡æœ‰ç°æœ‰çš„&lt;code&gt;CiliumIdentity&lt;/code&gt;æ—¶ï¼Œå®ƒå°†å°è¯•åˆ›å»ºå®ƒã€‚å¦‚æœå‘½åç©ºé—´æ ‡ç­¾å‘ç”Ÿæ›´æ”¹å¹¶ä¸”éœ€è¦é‡æ–°è®¡ç®—æ‰€æœ‰æ ‡è¯†ï¼Œé‚£ä¹ˆä¹Ÿä¼šå‘ç”Ÿç›¸åŒçš„æƒ…å†µã€‚ç”±äºæ ‡è¯†åˆ›å»ºåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šç‹¬ç«‹è¿›è¡Œï¼Œå› æ­¤æœ‰å¾ˆå¤§æœºä¼šä¸ºç›¸åŒæ ‡è¯†åˆ›å»ºå¤šä¸ª&lt;code&gt;CiliumIdentity&lt;/code&gt;ï¼ˆåœ¨æç«¯æƒ…å†µä¸‹ï¼Œ&lt;a href=&#34;https://docs.google.com/document/d/1Hcc_2mB9OOUxrqQgZ-gSYDPnLYE_If_TCzVbUGDOdGM/edit?pli=1#heading=h.yzvq0akbw7z9&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æ­¤æè¿°çš„æ˜“äºé‡ç°&lt;/a&gt;ï¼‰ã€‚åœ¨ xDS æ–¹æ³•ä¸­ï¼Œ&lt;code&gt;CiliumIdentity&lt;/code&gt;åœ¨é›†ä¸­åˆ›å»ºï¼Œä»è€Œæ¶ˆé™¤äº†è¿™ç§æƒ…å†µã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;Cilium åœ¨ eBPF åŸºç¡€ä¸Šæ„å»ºäº†å¼ºå¤§çš„æ•°æ®å¹³é¢ï¼Œä½†è¦ä½¿ Cilium åœ¨è§„æ¨¡ä¸Šæœ‰æ•ˆè¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ xDS åè®®æ¥æ”¹è¿›æ§åˆ¶å¹³é¢æ¶æ„ã€‚xDS æ˜¯ä¸€ç§é«˜æ•ˆçš„åè®®ï¼Œå…è®¸æˆ‘ä»¬åˆ©ç”¨å¤šå¹´æ¥å­¦åˆ°çš„æ„å»ºæ§åˆ¶å¹³é¢çš„æœ€ä½³å®è·µã€‚äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å°† xDS æ§åˆ¶å¹³é¢ &lt;a href=&#34;https://docs.google.com/document/d/1U4pO_dTaHERKOtrneNA8njW19HSVbq3sBM3x8an4878/edit#heading=h.ghzkbpzc9oea&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç›´æ¥æ„å»ºåˆ° cilium-operator ä¸­&lt;/a&gt;ï¼Œé‚£ä¹ˆä»è¿™ä¸ªå®æ–½ä¸­ä¸ä¼šå¢åŠ æ–°çš„å¤æ‚æ€§ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿè½¯ä»¶çš„å…³é”®ç”¨ä¾‹å®‰å…¨ä¿éšœä¹‹é“</title>
      <link>https://cloudnativecn.com/blog/securing-cloud-natives-most-important-use-cases/</link>
      <pubDate>Wed, 10 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/securing-cloud-natives-most-important-use-cases/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://www.chainguard.dev/unchained/securing-cloud-natives-most-important-use-cases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Securing cloud nativeâ€™s most important use cases&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‘˜è¦ï¼šäº‘åŸç”Ÿè½¯ä»¶å¼€å‘æ„å‘³ç€ä¸ºå…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„ç‰¹æ€§ä¼˜åŒ–åº”ç”¨å’Œç¯å¢ƒã€‚Chainguard æ—¨åœ¨æä¾›ä¸å½±å“å¼€å‘è€…ä½“éªŒçš„è½¯ä»¶ä¾›åº”é“¾å®‰å…¨å·¥å…·ï¼Œé€šè¿‡æä¾›æœ€å°åŒ–ã€å¼ºåŒ–çš„å®¹å™¨é•œåƒï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®åœ°æ‰«ææ¼æ´å¹¶æ¶ˆé™¤ CVE è­¦æŠ¥ã€‚æœ¬æ–‡ä»‹ç»äº† Chainguard Images ä¸º Istio å’Œ Cilium è¿™ä¸¤ä¸ªäº‘åŸç”ŸåŸºç¡€æŠ€æœ¯æä¾›çš„å®‰å…¨å¢å¼ºæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä»æ ¹æœ¬ä¸Šè¯´ï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€æ„å»ºé’ˆå¯¹å…¬å…±å’Œç§æœ‰äº‘ç‰¹æ€§è¿›è¡Œä¼˜åŒ–çš„åº”ç”¨ç¨‹åºå’Œç¯å¢ƒã€‚å¼€å‘äº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€ç®¡ç†ä¸€å®šç¨‹åº¦çš„æ··ä¹±ï¼Œè¿™ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„è½¯ä»¶éƒ½éœ€è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åœ¨æ–°çš„ä¸€å¹´å°¤å…¶é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸäº§å“å°†è¶‹å‘äºä¼˜å…ˆè€ƒè™‘å¼€å‘è€…ä½“éªŒï¼Œå¹¶ä¸”å¹³å°å·¥ç¨‹çš„å´›èµ·ã€‚è‰¯å¥½çš„å·¥ç¨‹å’Œå·¥å…·ä½¿å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºæ„å»ºå’Œåˆ›æ–°ã€‚å·²ç»æ„å»ºçš„æ‰€æœ‰å†…éƒ¨å¼€å‘è€…å¹³å°å’Œå³å°†æ¨å‡ºçš„å¹³å°éƒ½éœ€è¦å°½é‡å°†åŸºç¡€è®¾æ–½ç®¡ç†ä»å¼€å‘è€…é‚£é‡ŒæŠ½è±¡å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ­£æ˜¯ Chainguard æƒ³è¦è§£å†³çš„é—®é¢˜é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åœ¨å®‰å…¨æ€§å’Œæ¼æ´ç®¡ç†æ–¹é¢ã€‚æˆ‘ä»¬è‡´åŠ›äºæä¾›ä¸å¦¨ç¢å¼€å‘è€…ä½“éªŒçš„å·¥å…·ï¼Œä»¥ç¡®ä¿è½¯ä»¶ä¾›åº”é“¾çš„å®‰å…¨ã€‚æˆ‘ä»¬é€šè¿‡æä¾›æœ€å°åŒ–ã€åŠ å›ºçš„å®¹å™¨é•œåƒæ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œè¿™ä½¿æˆ‘ä»¬çš„ç”¨æˆ·å¯ä»¥è·å¾—å‡†ç¡®çš„æ‰«æç»“æœï¼Œå¹¶å°† CVE æ”¶ä»¶ç®±è­¦æŠ¥é™è‡³é›¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨å‡ºæ–°çš„-chainguard-images-æ†ç»‘åŒ…é€‚ç”¨äº-cilium-å’Œ-istio&#34;&gt;æ¨å‡ºæ–°çš„ Chainguard Images æ†ç»‘åŒ…ï¼Œé€‚ç”¨äº Cilium å’Œ Istio&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å¯†åˆ‡å…³æ³¨æœ€å—æ¬¢è¿çš„å¼€æºé¡¹ç›®ï¼Œä½†ä¹Ÿå…³æ³¨é‚£äº›å¦‚æœç»è¿‡åŠ å›ºï¼Œå°†ä¸ºæ•´ä¸ªå¼€æºç”Ÿæ€ç³»ç»Ÿæä¾›é‡è¦çš„å®‰å…¨æ”¹è¿›çš„é¡¹ç›®ã€‚ä¸ºäº†åœ¨æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­äº§ç”Ÿæœ€å¤§çš„å½±å“ï¼Œæˆ‘ä»¬åº”è¯¥å¸®åŠ©åŠ å›ºé‚£äº›ä½œä¸ºäº‘åŸç”Ÿè½¯ä»¶åŸºçŸ³çš„æŠ€æœ¯ã€‚Istio å’Œ Cilium æ­£æ˜¯è¿™æ ·çš„æ˜æ˜¾ç¤ºä¾‹ï¼Œå®ƒä»¬æ˜¯äº‘åŸç”Ÿè½¯ä»¶ç”Ÿæ€ç³»ç»Ÿçš„åŸºç¡€æ„å»ºæ¨¡å—ä¹‹ä¸€ã€‚é€šè¿‡æä¾›æ–°çš„ Chainguard Images Istio å’Œ Cilium æ†ç»‘åŒ…ï¼Œæˆ‘ä»¬ä¸ºè¿™äº›é¡¹ç›®çš„ç”¨æˆ·æä¾›äº†ä¸€ä¸ªå®‰å…¨åœ°å°†å®ƒä»¬å¼•å…¥å…¶æ„å»ºæµç¨‹çš„ç®€ä¾¿æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»»ä½•ç»™å®šçš„ä¾›åº”é“¾ä¸­ï¼Œæœ‰äº›åŸææ–™æ¯”å…¶ä»–åŸææ–™æ›´ä¸ºåŸºç¡€ã€‚å¦‚æœè¿™äº›åŸææ–™å¾—åˆ°äº†å¦¥å–„ä¿æŠ¤ï¼Œé‚£ä¹ˆè¿™å°†å¯¹åç»­å·¥ä½œäº§ç”Ÿè¿é”æ•ˆåº”ï¼ˆæˆ–è€…å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œå¯ä»¥è¯´æ˜¯å¯¹æ•´ä¸ªå †æ ˆäº§ç”Ÿä¸Šä¸‹æ¸¸å½±å“ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Cilium å’Œ Istio æŠ€æœ¯éƒ½æ¶µç›–äº†å¯¹ Kubernetes ç¯å¢ƒå…·æœ‰åŸºç¡€ä½œç”¨çš„å„ç§ç”¨ä¾‹ã€‚Cilium å’Œ Istio æ˜¯ä¸¤ä¸ªæµè¡Œçš„å·¥å…·ï¼Œé€šè¿‡æä¾›æµé‡è·¯ç”±ã€è´Ÿè½½å¹³è¡¡ã€æœåŠ¡å‘ç°ç­‰åŠŸèƒ½æ¥å¸®åŠ©è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚è¿™äº›åŠŸèƒ½å¯¹äºç¡®ä¿ Kubernetes å’Œå…¶ä»–äº‘åŸç”Ÿè½¯ä»¶éƒ¨ç½²çš„é¡ºåˆ©ã€é«˜æ•ˆå’Œå®‰å…¨è¿è¡Œè‡³å…³é‡è¦ã€‚æœ€ç»ˆï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€åˆ›å»ºä¸“ä¸ºäº‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œè€Œ Cilium å’Œ Istio åœ¨å¸®åŠ©å¼€å‘è€…å®ç°è¿™ä¸€ç›®æ ‡æ–¹é¢å‘æŒ¥äº†å…³é”®ä½œç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;istio-å’Œ-cilium-åœ¨äº‘è®¡ç®—ä¸­ä¸å¯æˆ–ç¼ºçš„ä½œç”¨&#34;&gt;Istio å’Œ Cilium åœ¨äº‘è®¡ç®—ä¸­ä¸å¯æˆ–ç¼ºçš„ä½œç”¨&lt;/h3&gt;
&lt;p&gt;æ ¹æ® 2022 å¹´çš„ &lt;a href=&#34;https://www.cncf.io/reports/cncf-annual-survey-2022/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF å¹´åº¦è°ƒæŸ¥&lt;/a&gt;ï¼ŒIstio æ˜¯å—è®¿è€…ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼ï¼Œ73% çš„å—è®¿å…¬å¸ä½¿ç”¨å®ƒã€‚è¿™ç§å¹¿æ³›çš„é‡‡ç”¨è¯æ˜äº† Istio åœ¨è§£å†³å„ç§æœåŠ¡ç®¡ç†æŒ‘æˆ˜æ–¹é¢çš„æœ‰æ•ˆæ€§ï¼Œä½¿å…¶æˆä¸ºç°ä»£ä¼ä¸šå¯»æ±‚æ„å»ºå¼ºå¤§ã€å®‰å…¨å’Œå¯æ‰©å±•çš„å¾®æœåŠ¡æ¶æ„çš„é‡è¦å·¥å…·ã€‚Istio åœ¨ GitHub ä¸Šæ‹¥æœ‰è¶…è¿‡ 34,000 é¢—æ˜Ÿæ˜Ÿï¼Œä½¿å…¶æˆä¸º CNCF ä¸­æœ€å—æ¬¢è¿çš„é¡¹ç›®ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;ä»åŒä¸€ä»½ CNCF è°ƒæŸ¥ä¸­ï¼Œæœ‰ 47% çš„å—è®¿è€…å°† Cilium ä½œä¸ºä»–ä»¬å®¹å™¨ç¼–æ’å¹³å°ï¼ˆå¦‚ Kubernetesï¼‰çš„é¦–é€‰ç½‘ç»œæ’ä»¶ã€‚å®ƒä¹Ÿå—æ¬¢è¿äºç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œæœ‰ 43% çš„å—è®¿è€…å°†å…¶ç”¨äºæ­¤ç›®çš„ã€‚eBPF çš„æœªæ¥å’ŒåŠ›é‡æ˜¯ä¸å¯æ€è®®çš„ï¼Œæ‰€æœ‰äººéƒ½åŒæ„è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæˆ‘ä»¬æ¨å‡ºäº†æˆ‘ä»¬çš„æ–°çš„ &lt;a href=&#34;https://images.chainguard.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Chainguard Images ç›®å½•&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¬å¼€å¯ç”¨çš„ç½‘ç«™ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­æµè§ˆæˆ‘ä»¬åº“å­˜ä¸­çš„æ‰€æœ‰é•œåƒã€‚åœ¨æ¯ä¸ª Chainguard&lt;/p&gt;
&lt;p&gt;Image åˆ—è¡¨ä¸­ï¼Œä½ å°†æ‰¾åˆ°æœ‰å…³å®‰è£…ã€åŸºç¡€è®¾æ–½ã€ç­¾åå’Œ SBOM çš„æºæ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥åŠæ›´å¤šå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚Chainguard Images ç›®å½•è¿˜åŒ…æ‹¬ä¸€ä¸ªæ–°çš„&lt;a href=&#34;https://images.chainguard.dev/security&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰å…¨é€šæŠ¥&lt;/a&gt;é¡µé¢ï¼Œæ˜¾ç¤ºç”¨æˆ·å·²çŸ¥çš„ CVEï¼Œä¿®å¤çš„çŠ¶æ€ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´å¤šå…³äºå¦‚ä½•åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¯åŠ¨ Chainguard Images Cilium æˆ– Istio æ†ç»‘åŒ…çš„æŠ€æœ¯æŒ‡å¯¼ï¼Œè¯·æŸ¥çœ‹ Chainguard å·¥ç¨‹å¸ˆ&lt;a href=&#34;https://www.linkedin.com/in/tcnghia/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Nghia Tran&lt;/a&gt;åœ¨ Chainguard Academy ä¸Šæä¾›çš„è¿™äº›æ–¹ä¾¿å…¥é—¨çš„æŒ‡å—ã€‚éå¸¸æ„Ÿè°¢æˆ‘ä»¬çš„æœ‹å‹&lt;a href=&#34;https://www.linkedin.com/in/feroz-salam-372a4113/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Isovalent&lt;/a&gt;çš„ Feroz Salam åœ¨ Cilium Images æ–¹é¢ç»™äº†æˆ‘ä»¬å¸®åŠ©ï¼Œä»¥åŠå¤šå¹´æ¥å¸®åŠ©æˆ‘ä»¬çš„ Istio çš„&lt;a href=&#34;https://www.linkedin.com/in/-johnhoward/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;John Howard&lt;/a&gt;ï¼ä»¥ä¸‹æ˜¯æŒ‡å—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://edu.chainguard.dev/chainguard/chainguard-images/getting-started/getting-started-istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å§‹ä½¿ç”¨ Istio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://edu.chainguard.dev/chainguard/chainguard-images/getting-started/getting-started-cilium/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å§‹ä½¿ç”¨ Cilium&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Chainguard Developer Images æä¾›äº†å¸¦æœ‰ &lt;code&gt;:latest&lt;/code&gt; å’Œ &lt;code&gt;:latest-dev&lt;/code&gt; æ ‡ç­¾çš„å…è´¹é•œåƒï¼Œä¾›ä½ åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚åœ¨æ–°çš„ç›®å½•ä¸­ï¼Œæ¯ä¸ªé•œåƒé¡µé¢è¿˜åŒ…æ‹¬é‡è¦çš„ç‰¹å®šäºé•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ç‰ˆæœ¬æ ‡ç­¾å’Œå…¶ä»–å˜ä½“ï¼Œå¦‚ FIPS å’Œé•¿æœŸæ”¯æŒï¼ˆLTSï¼‰ï¼Œè¿™äº›éƒ½é€‚ç”¨äºè´­ä¹°äº†è¿™äº›è§£å†³æ–¹æ¡ˆçš„ Chainguard Images å®¢æˆ·ã€‚å¦‚æœä½ æƒ³äº†è§£æœ‰å…³æˆ‘ä»¬çš„ Production Images ä¸­é¢å‘ä¼ä¸šçš„åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·&lt;a href=&#34;https://www.chainguard.dev/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬çš„å›¢é˜Ÿ&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 2023 å¹´åº¦æŠ¥å‘Šå‘å¸ƒ</title>
      <link>https://cloudnativecn.com/blog/cilium-2023-annual-report/</link>
      <pubDate>Tue, 09 Jan 2024 18:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-2023-annual-report/</guid>
      <description>&lt;p&gt;è¿™ä»½æŠ¥å‘Šå›é¡¾äº† Cilium é¡¹ç›®åœ¨ 2023 å¹´çš„æˆå°±å’Œè¿›å±•ï¼ŒåŒ…æ‹¬è´¡çŒ®è€…å¢é•¿ã€ç‰ˆæœ¬äº®ç‚¹ã€ç”¨æˆ·è°ƒæŸ¥ç»“æœã€ç”Ÿäº§ç¯å¢ƒæ¡ˆä¾‹ã€ç¤¾åŒºæ´»åŠ¨å’Œå¼•ç”¨ã€ä»¥åŠ 2024 å¹´çš„å‘å±•æ–¹å‘ã€‚æŠ¥å‘Šæ˜¾ç¤ºï¼ŒCilium é¡¹ç›®å·²ç»æˆä¸ºäº‘åŸç”Ÿç½‘ç»œã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨æ€§çš„é¢†å¯¼è€…ï¼Œå¾—åˆ°äº†å¹¿æ³›çš„è®¤å¯å’Œé‡‡ç”¨ã€‚æŠ¥å‘Šè¿˜å±•ç¤ºäº† Cilium é¡¹ç›®çš„å¥åº·çŠ¶å†µå’Œæ´»è·ƒåº¦ï¼Œé€šè¿‡æ•°æ®å’Œå›¾è¡¨å±•ç¤ºäº†é¡¹ç›®çš„é‡Œç¨‹ç¢‘å’Œæäº¤æƒ…å†µã€‚æŠ¥å‘Šæœ€åæ„Ÿè°¢äº†ç¤¾åŒºçš„æ”¯æŒå’Œè´¡çŒ®ï¼Œä»¥åŠæœŸå¾…æœªæ¥çš„æ›´å¤šåˆ›æ–°å’Œåä½œã€‚&lt;/p&gt;
&lt;p&gt;è¯¦æƒ…è§ï¼š&lt;a href=&#34;https://www.cncf.io/blog/2023/12/21/ciliums-2023-annual-report/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.cncf.io/blog/2023/12/21/ciliums-2023-annual-report/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½åœ°å€ï¼š&lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium%20Annual%20Report%202023.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹é€‰å–è‡ªæŠ¥å‘Šä¸­çš„ release highlight éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‰ˆæœ¬æ›´æ–°&#34;&gt;ç‰ˆæœ¬æ›´æ–°&lt;/h2&gt;
&lt;p&gt;Cilium åœ¨ 2023 å¹´è¿›è¡Œäº†ä¸¤æ¬¡é‡å¤§å‘å¸ƒã€‚Cilium 1.13 äº 2 æœˆå‘å¸ƒï¼Œé’ˆå¯¹ç½‘ç»œï¼ˆç‰¹åˆ«æ˜¯æœåŠ¡ç½‘æ ¼ï¼‰ã€æ€§èƒ½å’Œè½¯ä»¶ä¾›åº”é“¾å®‰å…¨ç­‰æ–¹é¢è¿›è¡Œäº†è®¸å¤šæ”¹è¿›ã€‚Cilium 1.14 äº 7 æœˆå‘å¸ƒï¼Œå¼•å…¥äº†ä¸€ä¸ªå¤‡å—æœŸå¾…çš„åŠŸèƒ½ï¼šä¸ä¸»è¦æ”¹è¿›ç›¸ç»“åˆçš„åŒå‘èº«ä»½éªŒè¯ï¼ŒåŒæ—¶æ‰©å±•äº† Kubernetes ä¹‹å¤–çš„ç½‘ç»œã€‚Tetragon 1.0 äº 10 æœˆå‘å¸ƒï¼Œå¸¦æ¥äº†ä¸»è¦çš„æ›´æ–°å’Œæ€§èƒ½æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æ‰€æœ‰ç‰ˆæœ¬ä¸­åŒ…å«çš„ä¸€äº›ä¸»è¦å˜åŒ–çš„æ¦‚è¿°ï¼š&lt;/p&gt;
&lt;h2 id=&#34;cilium-113&#34;&gt;Cilium 1.13&lt;/h2&gt;
&lt;h3 id=&#34;gateway-api&#34;&gt;Gateway API&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.13 å¸¦æœ‰ Gateway API çš„å®Œå…¨å…¼å®¹å®ç°ã€‚è¿™ä¸ª API æ˜¯ç”¨äºåŒ—å‘è´Ÿè½½å‡è¡¡å’Œæµé‡è·¯ç”±åˆ° Kubernetes é›†ç¾¤çš„æ–°æ ‡å‡†ï¼Œæ˜¯ Kubernetes Ingress API çš„é•¿æœŸç»§ä»»è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¸¦æ³¨é‡Šçš„-kubernetes-æœåŠ¡çš„-l7-è´Ÿè½½å‡è¡¡&#34;&gt;å¸¦æ³¨é‡Šçš„ Kubernetes æœåŠ¡çš„ L7 è´Ÿè½½å‡è¡¡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.13 å¼•å…¥äº†ä½¿ç”¨ Cilium å†…ç½®çš„ Envoy ä»£ç†æ¥å®ç°ç°æœ‰ Kubernetes æœåŠ¡çš„ L7 è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œé€šè¿‡åº”ç”¨ä»¥ä¸‹æ³¨é‡Šï¼š&lt;code&gt;&amp;quot;service.cilium.io/lb-l7&amp;quot;: &amp;quot;enabled&amp;quot;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ•°æ®é¢ä¸Šçš„åŒå‘èº«ä»½éªŒè¯---beta&#34;&gt;æ•°æ®é¢ä¸Šçš„åŒå‘èº«ä»½éªŒè¯ - Beta&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®é¢çº§åˆ«æ·»åŠ äº†åŒå‘èº«ä»½éªŒè¯æ”¯æŒï¼Œä»¥ä¾¿ Cilium èƒ½å¤Ÿå¯¹é›†ç¾¤ä¸­å¯¹ç­‰èŠ‚ç‚¹ä¸Šçš„ç»ˆç«¯è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ ¹æ®æˆåŠŸçš„åŒå‘èº«ä»½éªŒè¯æ¥æ§åˆ¶æ•°æ®å¹³é¢è¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;loadbalancer-æœåŠ¡å’Œ-bgp-æœåŠ¡å¹¿å‘Šçš„-ipam&#34;&gt;LoadBalancer æœåŠ¡å’Œ BGP æœåŠ¡å¹¿å‘Šçš„ IPAM&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;LoadBalancer IP åœ°å€ç®¡ç†ï¼ˆLB-IPAMï¼‰æ˜¯ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå…è®¸ Cilium ä¸º Kubernetes LoadBalancer æœåŠ¡æä¾› IP åœ°å€ã€‚Cilium BGP é€šè¿‡å¼•å…¥æœåŠ¡åœ°å€å¹¿å‘Šå¾—åˆ°äº†æ”¹è¿›ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥ä¸ LB-IPAM åŠŸèƒ½æ— ç¼é…åˆä½¿ç”¨ï¼Œå¸®åŠ©ç”¨æˆ·é€šè¿‡ BGP å¹¿å‘Š Kubernetes æœåŠ¡çš„ IP åœ°å€ï¼Œä»è€Œä¸å†éœ€è¦ MetalLBï¼Œç®€åŒ–äº†ç½‘ç»œå †æ ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ”¯æŒ-kubernetes-ä¸Šçš„-sctp&#34;&gt;æ”¯æŒ Kubernetes ä¸Šçš„ SCTP&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SCTP æ˜¯ä¸€ç§åœ¨ç”µä¿¡è¡Œä¸šä¸­ç»å¸¸ç”¨äºæ”¯æŒ VoIP å’Œå…¶ä»–å®æ—¶æœåŠ¡çš„ä¼ è¾“å±‚åè®®ã€‚Cilium 1.13 å¼•å…¥äº† STCP çš„åŸºæœ¬æ”¯æŒï¼Œç”šè‡³æ”¯æŒåœ¨ Hubble ä¸­è¿›è¡Œå¯è§†åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ€§èƒ½&#34;&gt;æ€§èƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å¼•å…¥äº†æ”¯æŒ BIG TCP çš„åŠŸèƒ½ï¼Œé€šè¿‡æé«˜ååé‡å¹¶å‡å°‘èŠ‚ç‚¹çš„å»¶è¿Ÿæ¥æé«˜ç½‘ç»œæ€§èƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æ‰©å±•åˆ° 100Gbps é›†ç¾¤ç”šè‡³æ›´å¤§çš„è§„æ¨¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è½¯ä»¶ä¾›åº”é“¾å®‰å…¨&#34;&gt;è½¯ä»¶ä¾›åº”é“¾å®‰å…¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å’Œ Tetragon å®¹å™¨é•œåƒç°åœ¨åœ¨åˆ›å»ºæ—¶ä½¿ç”¨ cosign è¿›è¡Œç­¾åã€‚åˆ©ç”¨é•œåƒç­¾åï¼Œç”¨æˆ·å¯ä»¥ç¡®ä¿¡ä»–ä»¬ä»å®¹å™¨æ³¨å†Œè¡¨è·å–çš„é•œåƒæ˜¯ç»´æŠ¤è€…æ„å»ºå’Œå‘å¸ƒçš„å—ä¿¡ä»»çš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sboms&#34;&gt;SBOMs&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»ç‰ˆæœ¬ 1.13 å¼€å§‹ï¼ŒCilium å’Œ Tetragon é•œåƒç°åœ¨åŒ…å«äº†è½¯ä»¶ææ–™æ¸…å•ï¼ˆSBOMï¼‰ã€‚è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥ç¡®ä¿ Cilium ä¸­ä½¿ç”¨çš„ç»„ä»¶å’Œä¾èµ–å…³ç³»æ˜¯é€æ˜å’Œå¯éªŒè¯çš„ï¼Œä»¥ä¾¿æŸ¥æ‰¾æ½œåœ¨çš„æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;cilium-114&#34;&gt;Cilium 1.14&lt;/h2&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼å’ŒåŒå‘èº«ä»½éªŒè¯&#34;&gt;æœåŠ¡ç½‘æ ¼å’ŒåŒå‘èº«ä»½éªŒè¯&lt;/h3&gt;
&lt;h4 id=&#34;åŒå‘èº«ä»½éªŒè¯---beta&#34;&gt;åŒå‘èº«ä»½éªŒè¯ - Beta&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.14 å¸¦æ¥äº†æ–°çš„åŒå‘èº«ä»½éªŒè¯æ”¯æŒï¼Œé€šè¿‡ SPIFFEï¼ˆSecure Production Identity Framework for Everyoneï¼‰å’Œ SPIREï¼ˆSPIRE æ˜¯ SPIFFE API çš„ç”Ÿäº§å°±ç»ªå®ç°ï¼‰æä¾›ã€‚æœ‰äº†è¿™ä¸ªæ–°æ”¯æŒï¼ŒCilium ç°åœ¨å¯ä»¥ä¸ SPIRE æœåŠ¡å™¨ä¸€èµ·éƒ¨ç½²ï¼Œä»¥å¯ç”¨åŒå‘èº«ä»½éªŒè¯ã€‚è¿™å…è®¸å·¥ä½œè´Ÿè½½åœ¨ SPIRE æœåŠ¡å™¨ä¸Šåˆ›å»ºå’Œç®¡ç†å…¶èº«ä»½ï¼Œè¯¥æœåŠ¡å™¨è‡ªåŠ¨ç®¡ç†å’Œæ—‹è½¬è¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;envoy-daemonset&#34;&gt;Envoy DaemonSet&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ äº† Envoy ä½œä¸º DaemonSet çš„æ”¯æŒã€‚è¿™æ„å‘³ç€ Envoy ä»£ç†ä¸å†éœ€è¦åœ¨ Cilium ä»£ç† Pod å†…ä½œä¸ºè¿›ç¨‹è¿è¡Œï¼Œä»è€Œå…è®¸ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸã€ç‹¬ç«‹çš„ç®¡ç†ä»¥åŠå°†é—®é¢˜çš„å½±å“é™åˆ¶åœ¨ Envoy ä»£ç†æˆ– Cilium ä»£ç†ä¸­çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;wireguard-èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†å’Œ-layer-7-ç­–ç•¥æ”¯æŒ&#34;&gt;WireGuard èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†å’Œ Layer 7 ç­–ç•¥æ”¯æŒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium çš„ä½¿ç”¨ WireGuard çš„åŠ å¯†å·²ç»å¾—åˆ°å¢å¼ºã€‚ç°åœ¨å¯ä»¥åŠ å¯† Pod ä¹‹é—´ã€ä» Pod åˆ°èŠ‚ç‚¹ä»¥åŠèŠ‚ç‚¹ä¹‹é—´çš„æµé‡ï¼Œå¹¶ä¸”è¿˜æ”¯æŒå°† L7 ç½‘ç»œç­–ç•¥åº”ç”¨äºä½¿ç”¨ WireGuard åŠ å¯†çš„æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è¶…è¶Š-kubernetes-çš„ç½‘ç»œ&#34;&gt;è¶…è¶Š Kubernetes çš„ç½‘ç»œ&lt;/h3&gt;
&lt;h4 id=&#34;l2-å…¬å‘Š&#34;&gt;L2 å…¬å‘Š&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.14 å¸¦æœ‰ä¸€ä¸ªåä¸º L2 Announcement policy çš„æ–°åŠŸèƒ½ï¼Œå®ƒå…è®¸ Cilium å“åº”æœ¬åœ°å®¢æˆ·ç«¯å¯¹ ExternalIPs å’Œ/æˆ– LoadBalancer IP çš„ ARP è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;bgp-å¢å¼º&#34;&gt;BGP å¢å¼º&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä¸º Cilium çš„ BGP å®ç°æ·»åŠ äº†æ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šCilium CLI ä¸­çš„ BGP å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ Cilium CLI æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹çš„ BGP å¯¹ç­‰çŠ¶æ€ï¼›BGP Graceful Restartï¼Œå¯ä»¥åœ¨é‡æ–°å¯åŠ¨ä»£ç†æ—¶ä¿æŒå¯¹ç­‰æ–¹çš„è·¯ç”±ï¼›eBGP Multi-Hopï¼Œå…è®¸ç”¨æˆ·åœ¨æ²¡æœ‰æ˜ç¡®çš„ TTL è·³æ•°é™åˆ¶çš„æƒ…å†µä¸‹å¯ç”¨ä¸¤ä¸ª EBGP å¯¹ç­‰æ–¹ä¹‹é—´çš„é‚»å±…è¿æ¥ï¼›è‡ªå®šä¹‰ BGP å®šæ—¶å™¨ï¼Œå¯ä»¥è‡ªå®šä¹‰ Cilium å’Œå¯¹ç­‰æ–¹ä¹‹é—´çš„ BGP ä¼šè¯çš„å®šæ—¶å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é›†ç¾¤ç½‘æ ¼&#34;&gt;é›†ç¾¤ç½‘æ ¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ KVStoreMesh æ¨¡å¼ä¸‹ï¼ŒCilium Cluster Mesh å®ç°äº†æ”¹è¿›çš„å¯æ‰©å±•æ€§å’Œéš”ç¦»ï¼Œé¢å‘å¤§è§„æ¨¡ Cluster Mesh éƒ¨ç½²ï¼Œæ”¯æŒå¤šè¾¾ 50,000 ä¸ªèŠ‚ç‚¹å’Œ 500,000 ä¸ª Podã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tetragon-10&#34;&gt;Tetragon 1.0&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cilium Tetragon 1.0 ä¸»è¦å…³æ³¨æé«˜æ€§èƒ½å¹¶å‡å°ç³»ç»Ÿå¼€é”€ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäº Kubernetes çš„å·¥å…·ï¼Œé€šè¿‡ eBPF åº”ç”¨ç­–ç•¥å’Œè¿‡æ»¤ï¼Œç¡®ä¿ä»¥æœ€å°çš„æ€§èƒ½å½±å“å®ç°æ·±åº¦å¯è§‚æµ‹æ€§ã€‚Tetragon è·Ÿè¸ªå„ç§æ´»åŠ¨ï¼Œå¦‚è¿›ç¨‹æ‰§è¡Œã€ç‰¹æƒå‡çº§ã€æ–‡ä»¶å’Œç½‘ç»œæ´»åŠ¨ï¼Œæä¾›ä¸€ç³»åˆ—çš„å¼€ç®±å³ç”¨çš„å®‰å…¨å¯è§‚æµ‹æ€§ç­–ç•¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tetragon ä½œä¸ºä¸€ä¸ªåŸºäº Kubernetes çš„æœ¬åœ°å·¥å…·ï¼Œä¸ Kubernetes æ— ç¼é›†æˆï¼Œä»¥å¢å¼ºå®‰å…¨å¯è§‚æµ‹æ€§ï¼Œé€šè¿‡ä¸ºç²¾ç¡®çš„ç­–ç•¥åº”ç”¨ä¸°å¯Œäº‹ä»¶æä¾›å¿…è¦çš„å…ƒæ•°æ®ã€‚å®ƒä½¿ç”¨ eBPF è¿›è¡Œäº‹ä»¶è§‚å¯Ÿå’Œè¿‡æ»¤ï¼Œç¡®ä¿æœ€å°çš„å¼€é”€å’Œé«˜æ•ˆçš„æ€§èƒ½ï¼Œæ˜¾ç€å‡å°‘äº†æ•°æ®ä¼ è¾“å’Œæ‰§è¡Œæ“ä½œä¸­çš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æ€§èƒ½æµ‹è¯•ä¸­ï¼Œå…¶æœ‰æ•ˆæ€§å¾—åˆ°äº†è¯æ˜ï¼Œåœ¨è¿›ç¨‹æ‰§è¡Œè·Ÿè¸ªæ–¹é¢çš„å¼€é”€ä¸åˆ° 2%ï¼Œå³ä½¿åœ¨é«˜ I/O æ¡ä»¶ä¸‹ä¹Ÿèƒ½å¤Ÿé«˜æ•ˆåœ°ç›‘è§†æ–‡ä»¶å®Œæ•´æ€§ï¼Œå¯¹ç½‘ç»œæ€§èƒ½çš„å½±å“ä¹Ÿå¾ˆå°ï¼Œå±•ç¤ºäº†å®ƒæœ‰æ•ˆå’Œé«˜æ•ˆåœ°è§‚å¯Ÿç½‘ç»œæµé‡çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—</title>
      <link>https://cloudnativecn.com/blog/cilium-gateway-api/</link>
      <pubDate>Thu, 04 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-gateway-api/</guid>
      <description>&lt;p&gt;åœ¨ Kubernetes ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºåï¼Œé€šå¸¸çš„ä¸‹ä¸€æ­¥æ˜¯è®©ç”¨æˆ·å¯ä»¥è®¿é—®å®ƒã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;&lt;/a&gt;ï¼Œä¾‹å¦‚ Nginxã€Haproxyã€Traefik æˆ–æ¥è‡ªäº‘æä¾›å•†çš„æ§åˆ¶å™¨ï¼Œæ¥å¼•å¯¼ä¼ å…¥çš„æµé‡åˆ°åº”ç”¨ç¨‹åºï¼Œç®¡ç†è´Ÿè½½å¹³è¡¡ã€TLS ç»ˆæ­¢ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä»ä¼—å¤š&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯ç”¨çš„é€‰é¡¹&lt;/a&gt; ä¸­è¿›è¡Œé€‰æ‹©ã€‚Cilium æ˜¯å…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„é€‰é¡¹ï¼Œæ—¨åœ¨å¤„ç†æ‰€æœ‰è¿™äº›ç½‘ç»œæ–¹é¢çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Cilium&lt;/strong&gt;&lt;/a&gt; æ˜¯ä¸€ä¸ªåŸºäº eBPF çš„å¼€æºç½‘ç»œå’Œå®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œå…¶é‡‡ç”¨é€Ÿåº¦å¢é•¿è¿…çŒ›ã€‚å®ƒå¯èƒ½æ˜¯æä¾›æœ€å¤šåŠŸèƒ½çš„ç½‘ç»œæ’ä»¶ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ä¼šæ¶µç›–æ‰€æœ‰åŠŸèƒ½ï¼Œä½†å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ¶‰åŠä½¿ç”¨&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Gateway API&lt;/strong&gt;&lt;/a&gt; (&lt;code&gt;GAPI&lt;/code&gt;) ç®¡ç†ä¼ å…¥æµé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬çš„ç›®æ ‡&#34;&gt;æˆ‘ä»¬çš„ç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‡†ç¡®äº†è§£ &lt;strong&gt;Gateway API&lt;/strong&gt; æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•ä»£è¡¨ä» &lt;code&gt;Ingress&lt;/code&gt; API è¿›åŒ–è€Œæ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ¼”ç¤ºä»¥ GitOps æ–¹å¼éƒ¨ç½²çš„çœŸå®åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰çš„é™åˆ¶å’Œå³å°†æ¨å‡ºçš„æ–°åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;æœ¬æ–‡ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤éƒ½æ¥è‡ªè¿™ä¸ª&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;git å­˜å‚¨åº“&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é¼“åŠ±ä½ æ¢ç´¢å®ƒï¼Œå› ä¸ºå®ƒè¿œè¿œè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å¯ç”¨äº† kube-proxy æ›¿ä»£å¹¶å…·æœ‰ä¸“ç”¨ Daemonset ç”¨äº &lt;code&gt;Envoy&lt;/code&gt; çš„ &lt;code&gt;Cilium&lt;/code&gt; é…ç½®çš„ &lt;strong&gt;EKS&lt;/strong&gt; é›†ç¾¤çš„å®‰è£…ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºäº†å…·æœ‰ä¾èµ–å…³ç³»ç®¡ç†å’Œæˆ‘è®¤ä¸ºéå¸¸é«˜æ•ˆçš„ DRY ä»£ç çš„ &lt;code&gt;Flux&lt;/code&gt; ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;ç®€åŒ–äº†ç”¨äºå¹³å°ç»„ä»¶çš„ IAM æƒé™ç®¡ç†çš„ &lt;code&gt;Crossplane&lt;/code&gt; å’Œ &lt;a href=&#34;https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IRSA&lt;/a&gt; ç»„åˆã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;External-DNS&lt;/code&gt; å’Œ &lt;code&gt;Let&#39;s Encrypt&lt;/code&gt; è‡ªåŠ¨ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªæƒ³æ³•æ˜¯åªéœ€å‡ åˆ†é’Ÿå†…è®¾ç½®å¥½ä¸€åˆ‡ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;ä»‹ç»-gateway-api&#34;&gt;ä»‹ç» Gateway API&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæœ‰è®¸å¤š&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;é€‰é¡¹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹å®šæ€§å’Œç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ‰æ—¶ä¼šä½¿å®ƒä»¬çš„ä½¿ç”¨å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼ŒKubernetes ä¸­ä¼ ç»Ÿçš„ &lt;code&gt;Ingress&lt;/code&gt; API å…·æœ‰éå¸¸æœ‰é™çš„å‚æ•°ã€‚ä¸€äº›è§£å†³æ–¹æ¡ˆç”šè‡³åˆ›å»ºäº†è‡ªå·±çš„&lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRDs&lt;/a&gt;ï¼ˆKubernetes è‡ªå®šä¹‰èµ„æºï¼‰ï¼Œè€Œå…¶ä»–è§£å†³æ–¹æ¡ˆåˆ™ä½¿ç”¨ &lt;code&gt;annotations&lt;/code&gt; æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯&lt;strong&gt;Gateway API&lt;/strong&gt;çš„ç”¨æ­¦ä¹‹åœ°ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§&lt;strong&gt;æ ‡å‡†&lt;/strong&gt;ï¼Œå…è®¸å£°æ˜é«˜çº§ç½‘ç»œåŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº•å±‚æ§åˆ¶å™¨è¿›è¡Œç‰¹å®šæ‰©å±•ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰æ§åˆ¶å™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ APIï¼Œå› æ­¤å¯ä»¥åœ¨ä¸æ”¹å˜é…ç½®çš„æƒ…å†µä¸‹ä»ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆKubernetes æ¸…å•æè¿°äº†å¦‚ä½•è·¯ç”±ä¼ å…¥æµé‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å°†è¦æ¢è®¨çš„æ¦‚å¿µä¸­ï¼ŒGAPI å¼•å…¥äº†ä¸€ä¸ªç²¾ç»†çš„æˆæƒæ¨¡å‹ï¼Œå®šä¹‰äº†å…·æœ‰ä¸åŒæƒé™çš„&lt;strong&gt;æ˜¾å¼è§’è‰²&lt;/strong&gt;ï¼ˆæœ‰å…³ GAPI å®‰å…¨æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/security-model/#roles-and-personas&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡¹ç›®ç”±&lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sig-network-kubernetes&lt;/a&gt;å·¥ä½œç»„æ¨åŠ¨ï¼Œè¿˜æœ‰ä¸€ä¸ª Slack &lt;a href=&#34;https://kubernetes.slack.com/archives/CR0H13KGA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢‘é“&lt;/a&gt;ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶è”ç³»ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨ GAPI ä¸ Ciliumï¼&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾å·²éƒ¨ç½²äº†ä¸€ä¸ª EKS é›†ç¾¤ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/tree/main/terraform/eks&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•&lt;/a&gt;ä½œä¸ºæœ¬æ–‡çš„åŸºç¡€ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›&lt;strong&gt;è¦æ£€æŸ¥çš„è¦ç‚¹&lt;/strong&gt;ï¼Œä»¥ä¾¿ä½¿ç”¨ GAPIã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„æè¿°çš„å®‰è£…æ–¹æ³•åŸºäº &lt;code&gt;Helm&lt;/code&gt;ï¼Œæ‰€æœ‰çš„ &lt;code&gt;values&lt;/code&gt; å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/terraform/eks/helm_values/cilium.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/tree/main/config/crd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt;å­˜å‚¨åº“ä¸­&lt;strong&gt;å®‰è£…&lt;/strong&gt;å¯ç”¨çš„ &lt;code&gt;CRDs&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    å¦‚æœ Cilium è®¾ç½®ä¸ºæ”¯æŒ &lt;code&gt;GAPI&lt;/code&gt;ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œå¹¶ä¸”ç¼ºå°‘ CRDsï¼Œåˆ™å®ƒå°†æ— æ³•å¯åŠ¨ã€‚åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;GAPI CRDs&lt;/strong&gt;åœ¨é›†ç¾¤åˆ›å»ºæœŸé—´å®‰è£…ä¸€æ¬¡ï¼Œä»¥ä¾¿ Cilium å¯ä»¥å¯åŠ¨ï¼Œç„¶åç”± Flux ç®¡ç†ã€‚
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ Cilium å’Œ &lt;code&gt;eBPF&lt;/code&gt; çš„ç½‘ç»œè½¬å‘åŠŸèƒ½&lt;strong&gt;æ›¿æ¢&lt;/strong&gt; &lt;code&gt;kube-proxy&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;kubeProxyReplacement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯ç”¨&lt;/strong&gt; Gateway API æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;gatewayAPI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥&lt;/strong&gt;å®‰è£…ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å®‰è£…åä¸º &lt;code&gt;cilium&lt;/code&gt; çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æˆ‘ä¸ªäººä½¿ç”¨ &lt;a href=&#34;https://blog.ogenki.io/post/asdf/asdf/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;asdf&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf plugin-add cilium-cli
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf install cilium-cli 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf global cilium 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å…è®¸ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status --wait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Deployment             cilium-operator    Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium             Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium-envoy       Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Containers:            cilium             Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Cluster Pods:          33/33 managed by Cilium
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Helm chart version:    1.14.2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Image versions         cilium             quay.io/cilium/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    quay.io/cilium/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       quay.io/cilium/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† Gateway API æ”¯æŒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium config view | grep -w &amp;#34;enable-gateway-api&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api                                true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api-secrets-sync                   true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹ç«¯åˆ°ç«¯æµ‹è¯•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium connectivity test
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œæ­¤å‘½ä»¤ï¼ˆ&lt;code&gt;connectivity test&lt;/code&gt;ï¼‰å½“å‰åœ¨å¯ç”¨ Envoy ä½œä¸º DaemonSet æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚(&lt;a href=&#34;https://github.com/cilium/cilium/issues/28057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Envoy ä½œä¸º DaemonSet&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä»£ç†è¿˜åœ¨åŒä¸€ Pod ä¸­è¿è¡Œ &lt;code&gt;Envoy&lt;/code&gt;ï¼Œå¹¶å§”æ‰˜ç»™å®ƒçº§åˆ« 7 çš„ç½‘ç»œæ“ä½œã€‚ä»ç‰ˆæœ¬ &lt;code&gt;v1.14&lt;/code&gt; å¼€å§‹ï¼Œå¯ä»¥å°† Envoy å•ç‹¬éƒ¨ç½²ï¼Œè¿™å¸¦æ¥äº†ä¸€äº›å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¿®æ”¹/é‡æ–°å¯åŠ¨ä¸€ä¸ªç»„ä»¶ï¼ˆæ— è®ºæ˜¯ Cilium è¿˜æ˜¯ Envoyï¼‰ï¼Œéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ›´å¥½åœ°åˆ†é…èµ„æºç»™æ¯ä¸ªç»„ä»¶ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æŸä¸ª Pod è¢«æ”»å‡»çš„æƒ…å†µä¸‹é™åˆ¶æ”»å‡»é¢ã€‚&lt;/li&gt;
&lt;li&gt;Envoy æ—¥å¿—å’Œ Cilium ä»£ç†æ—¥å¿—ä¸ä¼šæ··åˆåœ¨ä¸€èµ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ­¤åŠŸèƒ½æ˜¯å¦å·²å¯ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-release-114/#h-envoy-daemonset&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;å…¥å£ç‚¹gatewayclass-å’Œ-gateway&#34;&gt;å…¥å£ç‚¹ï¼šGatewayClass å’Œ Gateway&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/gateway_hu_89bbc1de24e85397.webp 400w,
               /blog/cilium-gateway-api/gateway_hu_5ae11f4d59bb594a.webp 760w,
               /blog/cilium-gateway-api/gateway_hu_bdfa651ffa42c058.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/gateway_hu_89bbc1de24e85397.webp&#34;
               width=&#34;760&#34;
               height=&#34;557&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æ»¡è¶³å…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¤šä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Gateway API CRDs å®šä¹‰çš„è‡ªå®šä¹‰èµ„æºã€‚è€Œä¸”ï¼Œåœ¨å®‰è£… Cilium åï¼Œä¸€ä¸ª &lt;code&gt;GatewayClass&lt;/code&gt; ç«‹å³å¯ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gatewayclasses.gateway.networking.k8s.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME     CONTROLLER                     ACCEPTED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium   io.cilium/gateway-controller   True       7m59s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ Kubernetes é›†ç¾¤ä¸Šï¼Œä½ å¯ä»¥é…ç½®å¤šä¸ª &lt;code&gt;GatewayClasses&lt;/code&gt;ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;Gateway&lt;/code&gt; é…ç½®ä¸­å¼•ç”¨ GatewayClass æ¥ä½¿ç”¨ &lt;code&gt;Linkerd&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Gateway&lt;/code&gt; æ˜¯å…è®¸è§¦å‘åœ¨äº‘æä¾›å•†ä¸­åˆ›å»ºè´Ÿè½½å‡è¡¡ç»„ä»¶çš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ AWSï¼ˆEKSï¼‰ä¸Šï¼Œé…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ—¶ï¼ŒCilium ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º &lt;code&gt;LoadBalancer&lt;/code&gt; çš„ &lt;code&gt;Service&lt;/code&gt;ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆ&lt;a href=&#34;https://kubernetes-sigs.github.io/aws-load-balancer-controller&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Load Balancer Controller&lt;/a&gt;ï¼‰å¤„ç†äº‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆ&lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NLB&lt;/a&gt;ï¼‰çš„åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get svc -n echo cilium-gateway-echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395/TCP   2m58s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹Ÿä¸ &lt;code&gt;Gateway&lt;/code&gt; ç›¸å…³è”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gateway -n echo echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è·¯ç”±è§„åˆ™httproute&#34;&gt;è·¯ç”±è§„åˆ™ï¼šHTTPRoute&lt;/h2&gt;
&lt;h3 id=&#34;åŸºæœ¬è§„åˆ™&#34;&gt;åŸºæœ¬è§„åˆ™&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-httproute&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;httproute.jpg&#34; alt=&#34;HTTPRoute&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      HTTPRoute
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä¸Šé¢çš„å›¾è¡¨å¯æ€»ç»“ä¸ºå‡ å¥è¯ï¼š&lt;code&gt;HTTPRoute&lt;/code&gt; å…è®¸é€šè¿‡å¼•ç”¨ Gateway å¹¶å®šä¹‰æ‰€éœ€çš„è·¯ç”±å‚æ•°æ¥é…ç½®åˆ°æœåŠ¡çš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Kyverno&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆªæ­¢ç›®å‰ï¼Œæ— æ³•é…ç½®ç”± &lt;code&gt;Gateways&lt;/code&gt; ç”Ÿæˆçš„æœåŠ¡çš„æ³¨é‡Šï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚å·²æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³åœ¨åˆ›å»º &lt;code&gt;Gateway&lt;/code&gt; åç«‹å³ä¿®æ”¹ç”± &lt;code&gt;Gateway&lt;/code&gt; åˆ›å»ºçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Kyverno æ˜¯ä¸€ç§ç¡®ä¿é…ç½®ç¬¦åˆæœ€ä½³å®è·µå’Œå®‰å…¨è¦æ±‚çš„å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»…ä½¿ç”¨å®ƒæ¥è½»æ¾æè¿°&lt;a href=&#34;https://kyverno.io/docs/writing-policies/mutate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çªå˜&lt;/a&gt;è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/mycluster-0/echo-gw-clusterpolicy.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;security/mycluster-0/echo-gw-clusterpolicy.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mutate-svc-annotations&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kinds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium-gateway-echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mutate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patchStrategicMerge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;external-dns.alpha.kubernetes.io/hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo.${domain_name}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;internet-facing&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-backend-protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tcp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;loadBalancerClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service.k8s.aws/nlb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼ŒæœåŠ¡ &lt;code&gt;cilium-gateway-echo&lt;/code&gt; å°†æ·»åŠ  AWS æ§åˆ¶å™¨çš„æ³¨é‡Šï¼Œä»¥åŠä¸€ä¸ªå…è®¸è‡ªåŠ¨ DNS è®°å½•é…ç½®çš„æ³¨é‡Šã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹éå¸¸ç®€å•ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° &lt;code&gt;echo-1-echo-server&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parentRefs&lt;/code&gt; æŒ‡ç¤ºä½¿ç”¨å“ªä¸ª &lt;code&gt;Gateway&lt;/code&gt;ï¼Œç„¶ååœ¨ &lt;code&gt;rules&lt;/code&gt; éƒ¨åˆ†å®šä¹‰äº†è·¯ç”±è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;è·¯ç”±è§„åˆ™è¿˜å¯ä»¥åŸºäº &lt;code&gt;path&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;foo.bar.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/login&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…åŸºäº HTTP æ ‡å¤´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯è®¿é—®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s http://echo.cloud.ogenki.io | jq -rc &amp;#39;.environment.HOSTNAME&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1-echo-server-fd88497d-w6sgn
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¯¥æœåŠ¡ä»¥ HTTP æ–¹å¼æš´éœ²ï¼Œæ²¡æœ‰è¯ä¹¦ã€‚è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®-tls-è¯ä¹¦&#34;&gt;é…ç½® TLS è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;æœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ GAPI é…ç½® TLSã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¸¸è§çš„æƒ…å†µï¼šHTTPS åè®®å’Œåœ¨ Gateway ä¸Šç»ˆæ­¢ TLSã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³è¦é…ç½®ä¹‹å‰ä½¿ç”¨çš„åŸŸå &lt;code&gt;echo.cloud.ogenki.io&lt;/code&gt;ã€‚é…ç½®ä¸»è¦é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/tls-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/tls-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cert-manager.io/cluster-issuer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;letsencrypt-prod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯å¼•ç”¨ä¸€ä¸ªåŒ…å«åç§°ä¸º &lt;code&gt;echo-tls&lt;/code&gt; çš„è¯ä¹¦çš„å¯†é’¥ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ &lt;strong&gt;Let&amp;rsquo;s Encrypt&lt;/strong&gt; å’Œ &lt;code&gt;cert-manager&lt;/code&gt; æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;}
&lt;strong&gt;cert-manager&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;cert-manager&lt;/code&gt;ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°ç”± &lt;code&gt;Gateway&lt;/code&gt; æš´éœ²çš„è¯ä¹¦éå¸¸ç®€å•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å…è®¸æ§åˆ¶å™¨è®¿é—® &lt;a href=&#34;https://aws.amazon.com/route53/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;route53&lt;/a&gt;ï¼Œä»¥è§£å†³ DNS01 æŒ‘æˆ˜ï¼ˆè¿™æ˜¯ä¸€ç§ç¡®ä¿å®¢æˆ·ç«¯åªèƒ½ä¸ºè‡ªå·±æ‹¥æœ‰çš„åŸŸè¯·æ±‚è¯ä¹¦çš„æœºåˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/base/cert-manager/cluster-issuer-staging.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ClusterIssuer&lt;/a&gt; èµ„æºæè¿°äº†ä½¿ç”¨ cert-manager ç”Ÿæˆè¯ä¹¦æ‰€éœ€çš„é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨é‡Š &lt;code&gt;cert-manager.io/cluster-issuer&lt;/code&gt; å¹¶è®¾ç½®å­˜å‚¨è¯ä¹¦çš„ Kubernetes å¯†é’¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cert-manager.io/docs/usage/gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¼”ç¤ºå­˜å‚¨åº“ä¸­ï¼Œæƒé™æ˜¯ä½¿ç”¨ &lt;code&gt;Crossplane&lt;/code&gt; åˆ†é…çš„ï¼Œå®ƒè´Ÿè´£åœ¨ AWS ä¸­é…ç½®è¿™äº› IAM æƒé™ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä½¿è·¯ç”±æ­£å¸¸å·¥ä½œï¼Œä½ è¿˜éœ€è¦å°† &lt;code&gt;HTTPRoute&lt;/code&gt; é™„åŠ åˆ°æ­£ç¡®çš„ &lt;code&gt;Gateway&lt;/code&gt; å¹¶æŒ‡å®šåŸŸåã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡ ç§’é’Ÿåï¼Œè¯ä¹¦å°†è¢«åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get cert -n echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME       READY   SECRET     AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-tls   True    echo-tls   43m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯ä¹¦ç¡®å®æ¥è‡ª Let&amp;rsquo;s Encryptï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl https://echo.cloud.ogenki.io -v 2&amp;gt;&amp;amp;1 | grep -A 6 &amp;#39;Server certificate&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;* Server certificate:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subject: CN=echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  start date: Sep 15 14:43:00 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  expire date: Dec 14 14:42:59 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subjectAltName: host &amp;#34;echo.cloud.ogenki.io&amp;#34; matched cert&amp;#39;s &amp;#34;echo.cloud.ogenki.io&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  issuer: C=US; O=Let&amp;#39;s Encrypt; CN=R3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  SSL certificate verify ok.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    GAPI è¿˜å…è®¸ä½ é…ç½® &lt;strong&gt;ç«¯åˆ°ç«¯çš„ TLS&lt;/strong&gt;ï¼Œä¸€ç›´åˆ°å®¹å™¨ã€‚è¿™æ˜¯é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; ä¸º &lt;code&gt;Passthrough&lt;/code&gt; æ¨¡å¼å¹¶ä½¿ç”¨ &lt;code&gt;TLSRoute&lt;/code&gt; èµ„æºæ¥å®Œæˆçš„ã€‚è¯ä¹¦ä¹Ÿå¿…é¡»ç”±æ‰§è¡Œ TLS ç»ˆæ­¢çš„ pod æºå¸¦ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº«-gateway&#34;&gt;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº« Gateway&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å…±äº«ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å…±äº«ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/shared-gateway_hu_363b3eeb35c87eae.webp 400w,
               /blog/cilium-gateway-api/shared-gateway_hu_4bdb66bfa0d9adb4.webp 760w,
               /blog/cilium-gateway-api/shared-gateway_hu_aeff7db091c5cc6.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/shared-gateway_hu_363b3eeb35c87eae.webp&#34;
               width=&#34;760&#34;
               height=&#34;507&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å…±äº«ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;GAPI&lt;/code&gt;ï¼Œä½ å¯ä»¥åœ¨ &lt;code&gt;å‘½åç©ºé—´&lt;/code&gt; ä¹‹é—´è·¯ç”±æµé‡ã€‚è¿™å¾—ç›Šäºæ¯ä¸ªåŠŸèƒ½çš„ä¸åŒèµ„æºï¼šä¸€ä¸ª &lt;code&gt;Gateway&lt;/code&gt; å…è®¸é…ç½®åŸºç¡€è®¾æ–½ï¼Œä»¥åŠ &lt;code&gt;*Routes&lt;/code&gt;ã€‚è¿™äº›è·¯ç”±å¯ä»¥é™„åŠ åˆ°ä½äºå¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ Gatewayã€‚å› æ­¤ï¼Œä¸åŒçš„å›¢é˜Ÿ/é¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™éœ€è¦æŒ‡å®šå“ªä¸ªè·¯ç”±å…è®¸å¼•ç”¨è¯¥ Gatewayã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºå†…éƒ¨å·¥å…·çš„ Gatewayï¼Œåä¸º &lt;code&gt;platform&lt;/code&gt;ã€‚é€šè¿‡ä½¿ç”¨ &lt;code&gt;allowedRoutes&lt;/code&gt; å‚æ•°ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†å“ªäº›å‘½åç©ºé—´å…è®¸é™„åŠ åˆ°æ­¤ Gatewayã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/infrastructure/base/gapi/platform-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;infrastructure/base/gapi/platform-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Selector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchExpressions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/metadata.name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;In&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;observability&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;flux-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å‘½åç©ºé—´ &lt;code&gt;observability&lt;/code&gt; å’Œ &lt;code&gt;flux-system&lt;/code&gt; ä¸­é…ç½®çš„ &lt;code&gt;HTTPRoutes&lt;/code&gt; é™„åŠ åˆ°æ­¤å”¯ä¸€çš„ &lt;code&gt;Gateway&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;infrastructure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼Œä½¿ç”¨æ¥è‡ªäº‘æä¾›å•†çš„ç›¸åŒè´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short ${NLB_DOMAIN}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short grafana-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short gitops-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    è¿™äº›å†…éƒ¨å·¥å…·ä¸åº”è¯¥æš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œä½†æ˜¯ä½ çŸ¥é“ï¼šè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…éƒ¨ Gatewayï¼ˆç§æœ‰ IPï¼‰é€šè¿‡è°ƒæ•´æ³¨é‡Šå¹¶ä½¿ç”¨ç§æœ‰è¿æ¥ç³»ç»Ÿï¼ˆVPNã€éš§é“ç­‰ï¼‰æ¥å®ç°ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;æµé‡åˆ†æµ&#34;&gt;æµé‡åˆ†æµ&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åˆ†æµ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åˆ†æµ&#34; srcset=&#34;
               /blog/cilium-gateway-api/split_hu_c72555df10293567.webp 400w,
               /blog/cilium-gateway-api/split_hu_1167691e9056a216.webp 760w,
               /blog/cilium-gateway-api/split_hu_eccf79dd9d17e74.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/split_hu_c72555df10293567.webp&#34;
               width=&#34;760&#34;
               height=&#34;517&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åˆ†æµ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç”±æœåŠ¡ç½‘æ ¼å¸¸å¸¸æä¾›çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨æ—¶ï¼ˆA/B æµ‹è¯•æˆ–é‡‘ä¸é›€éƒ¨ç½²ï¼‰å¯¹éƒ¨åˆ†æµé‡æµ‹è¯•åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ã€‚&lt;code&gt;GAPI&lt;/code&gt;é€šè¿‡ä½¿ç”¨æƒé‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿å…¶å˜å¾—éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°† 5% çš„æµé‡è½¬å‘åˆ°æœåŠ¡ &lt;code&gt;echo-2-echo-server&lt;/code&gt; çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute-split.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute-split.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;split-echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-2-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥åˆ†å‘æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/scripts/check-split.sh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scripts/check-split.sh&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;./scripts/check-split.sh https://split-echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1 çš„è¯·æ±‚æ¬¡æ•°ï¼š95
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-2 çš„è¯·æ±‚æ¬¡æ•°ï¼š5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¿®æ”¹æ ‡å¤´&#34;&gt;ä¿®æ”¹æ ‡å¤´&lt;/h3&gt;
&lt;p&gt;è¿˜å¯ä»¥æ›´æ”¹ HTTP &lt;strong&gt;æ ‡å¤´&lt;/strong&gt;ï¼šæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚è¿™äº›ä¿®æ”¹å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;HTTPRoute&lt;/code&gt; æ¸…å•ä¸­ä½¿ç”¨ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/httproute#filters-optional&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;filters&lt;/a&gt; åº”ç”¨äºè¯·æ±‚æ ‡å¤´æˆ–å“åº”æ ‡å¤´ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;strong&gt;è¯·æ±‚&lt;/strong&gt; ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/req-header-add&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RequestHeaderModifier&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requestHeaderModifier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤å…è®¸æŸ¥çœ‹æ ‡å¤´æ˜¯å¦ç¡®å®å·²æ·»åŠ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s https://echo.cloud.ogenki.io/req-header-add | jq &amp;#39;.request.headers&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;host&amp;#34;: &amp;#34;echo.cloud.ogenki.io&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;user-agent&amp;#34;: &amp;#34;curl/8.2.1&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;accept&amp;#34;: &amp;#34;*/*&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-for&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-proto&amp;#34;: &amp;#34;https&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-envoy-external-address&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-request-id&amp;#34;: &amp;#34;320ba4d2-3bd6-4c2f-8a97-74296a9f3f26&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;foo&amp;#34;: &amp;#34;bar&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ†é…é€‚å½“çš„æƒé™&#34;&gt;åˆ†é…é€‚å½“çš„æƒé™&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;GAPI&lt;/code&gt; æä¾›äº†ä¸€ç§æ¸…æ™°çš„æƒé™å…±äº«æ¨¡å‹ï¼Œç”¨äºç®¡ç†æµé‡è·¯ç”±åŸºç¡€è®¾æ–½ï¼ˆç”±é›†ç¾¤ç®¡ç†å‘˜ç®¡ç†ï¼‰å’Œåº”ç”¨ç¨‹åºï¼ˆç”±å¼€å‘äººå‘˜ç®¡ç†ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¤šä¸ªè‡ªå®šä¹‰èµ„æºçš„å¯ç”¨æ€§å…è®¸ä½¿ç”¨ Kubernetes çš„ &lt;strong&gt;RBAC&lt;/strong&gt; é…ç½®ä»¥å£°æ˜æ€§æ–¹å¼åˆ†é…æƒé™ã€‚æˆ‘å·²ç»æ·»åŠ äº†ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„æ¼”ç¤ºé›†ç¾¤ä¸­æ²¡æœ‰æ•ˆæœï¼Œä½†å¯èƒ½ä¼šç»™ä½ ä¸€ä¸ªæƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„é…ç½®æˆäºˆ &lt;code&gt;developers&lt;/code&gt; ç»„çš„æˆå‘˜åœ¨ echo å‘½åç©ºé—´å†…ç®¡ç† &lt;code&gt;HTTPRoutes&lt;/code&gt; çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä»…æä¾›å¯¹ &lt;code&gt;Gateways&lt;/code&gt; çš„è¯»å–æƒé™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;httproutes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateways&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;list&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;developers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&#34;&gt;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&lt;/h2&gt;
&lt;p&gt;äººä»¬å¯èƒ½ä¼šå¯¹é€šå¸¸ç§°ä¸º &lt;code&gt;API ç½‘å…³&lt;/code&gt; çš„ä¸œè¥¿æ„Ÿåˆ°å›°æƒ‘ã€‚å·²ç»åˆ›å»ºäº† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/faq/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAQ&lt;/a&gt; çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä»¥æ¾„æ¸…å®ƒä¸ &lt;code&gt;Gateway API&lt;/code&gt; çš„ä¸åŒä¹‹å¤„ã€‚å°½ç®¡ GAPI æä¾›äº†é€šå¸¸åœ¨ API ç½‘å…³ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ï¼Œä½†å®ƒä¸»è¦æ˜¯ Kubernetes çš„ä¸€ä¸ªç‰¹å®šå®ç°ã€‚ç„¶è€Œï¼Œé€‰æ‹©è¿™ä¸ªåç§°ç¡®å®å¯èƒ½å¼•èµ· &lt;strong&gt;æ··æ·†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡ä»…å…³æ³¨å…¥ç«™æµé‡ï¼Œé€šå¸¸ç”± &lt;em&gt;Ingress Controllers&lt;/em&gt; ç®¡ç†ï¼Œç§°ä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#northsouth-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å—åŒ—&lt;/a&gt;ï¼Œè¿™å®é™…ä¸Šæ˜¯ GAPI çš„åˆå§‹èŒƒå›´ã€‚æœ€è¿‘çš„ä¸€ä¸ªåä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/gamma/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;GAMMA&lt;/strong&gt;&lt;/a&gt; çš„å€¡è®®æ—¨åœ¨å¤„ç† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#eastwest-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸œè¥¿æµé‡&lt;/a&gt; è·¯ç”±ï¼Œè¿™å°†åœ¨å°†æ¥æ ‡å‡†åŒ–æŸäº›å¸¸è§çš„åŠŸèƒ½ï¼Œé€šå¸¸ç”± &lt;code&gt;Service Meshes&lt;/code&gt; è§£å†³æ–¹æ¡ˆæä¾›ã€‚ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://kubernetes.io/blog/2023/08/29/gateway-api-v0-8/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤æ–‡ç« &lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„æƒ³æ³•&#34;&gt;æœ€åçš„æƒ³æ³•&lt;/h2&gt;
&lt;p&gt;è€å®è¯´ï¼Œæˆ‘å·²ç»çŸ¥é“ &lt;strong&gt;Gateway API&lt;/strong&gt; æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚å°½ç®¡æˆ‘è¯»äº†ä¸€äº›æ–‡ç« ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰çœŸæ­£æ·±å…¥ç ”ç©¶è¿‡ã€‚æˆ‘ä¼šæƒ³ï¼šâ€œä¸ºä»€ä¹ˆè¦éº»çƒ¦å‘¢ï¼Ÿæˆ‘çš„ &lt;em&gt;Ingress Controller&lt;/em&gt; å¯ä»¥å·¥ä½œï¼Œè€Œä¸”è¿™éœ€è¦å­¦ä¹ æ›²çº¿ã€‚â€&lt;/p&gt;
&lt;p&gt;GAPI æ­£åœ¨å´­éœ²å¤´è§’ï¼Œå³å°†å‘å¸ƒ GA ç‰ˆæœ¬ã€‚å¤šä¸ª &lt;a href=&#34;https://gateway-api.sigs.k8s.io/implementations/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¡¹ç›®&lt;/a&gt; å·²ç»æ‹¥æŠ±å®ƒï¼Œè¿™ä¸ªç”¨äºç®¡ç† Kubernetes å†…æµé‡çš„ API å°†è¿…é€Ÿæˆä¸ºæ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¿…é¡»è¯´ï¼Œé…ç½® GAPI æ„Ÿè§‰ç›´è§‚è€Œæ˜ç¡®ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹å–å¾—äº†å¹³è¡¡ï¼Œèµ‹äºˆå¼€å‘äººå‘˜æƒåŠ›è€Œä¸ä¼šæŸå®³å®‰å…¨æ€§ã€‚è€Œä¸”æ— ç¼çš„åŸºç¡€è®¾æ–½ç®¡ç†ï¼Ÿä½ å¯ä»¥åœ¨ä¸è§¦åŠ &lt;code&gt;*Routes&lt;/code&gt; çš„æƒ…å†µä¸‹åœ¨ä¸åŒçš„å®ç°ä¹‹é—´åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±ç”¨ &lt;code&gt;Cilium&lt;/code&gt; äº¤æ¢æˆ‘çš„ Ingress Controller å—ï¼Ÿ&lt;strong&gt;è¿˜æ²¡æœ‰ï¼Œä½†å®ƒå³å°†åˆ°æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼ŒCilium çš„åŠŸèƒ½éå¸¸å¹¿æ³›ï¼šåœ¨ Kubernetes å‘¨å›´æœ‰å¤§é‡çš„å·¥å…·ï¼ŒCilium è„±é¢–è€Œå‡ºï¼Œæ‰¿è¯ºæä¾›æŒ‡æ ‡ã€è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ã€å®‰å…¨æ€§ï¼Œä»¥åŠ &lt;em&gt;Ingress Controller&lt;/em&gt; ä¸ GAPIã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21929&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP å’Œ UDP æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21928&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GRPC æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦ä½¿ç”¨å˜å¼‚è§„åˆ™æ¥é…ç½®äº‘ç»„ä»¶ï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ–‡è®¨è®ºçš„è®¸å¤šåŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µã€‚ä¾‹å¦‚ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ‘å†™ä½œæ—¶çš„ &lt;code&gt;v1.14.2&lt;/code&gt;ï¼‰æ”¯æŒçš„ &lt;a href=&#34;https://github.com/cilium/cilium/pull/27472&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‰©å±•åŠŸèƒ½&lt;/a&gt;ã€‚æˆ‘å°è¯•è®¾ç½®ä¸€ä¸ªç®€å•çš„ HTTP&amp;gt;HTTPS é‡å®šå‘ï¼Œä½†é‡åˆ°äº† &lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/issues/1185&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ªé—®é¢˜&lt;/a&gt;ã€‚å› æ­¤ï¼Œæˆ‘é¢„è®¡ API å°†æ¥ä¼šæœ‰ä¸€äº›ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æˆ‘åªæ˜¯æ¶‰åŠäº† Cilium çš„ GAPI èƒ½å¤Ÿæä¾›çš„ä¸€å°éƒ¨åˆ†å†…å®¹ï¼ˆè€å®è¯´ï¼Œè¿™ç¯‡æ–‡ç« å·²ç»ç›¸å½“é•¿äº†ï¼‰ï¼Œä½†æˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥å¾ˆå¿«åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒã€‚ä½†è€ƒè™‘åˆ°å‰é¢æåˆ°çš„å‡ ç‚¹ï¼Œæˆ‘å»ºè®®ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³ä¸ºæœªæ¥åšå‡†å¤‡ï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™äº†ï¼&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://gateway-api.sigs.k8s.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Isovalent çš„ &lt;a href=&#34;https://isovalent.com/resource-library/labs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;labs&lt;/a&gt; æ˜¯å¼€å§‹ä½¿ç”¨ Gateway API å¹¶ä¸”ä½ å°†è·å¾—æ–°çš„å¾½ç« ä»¥æ·»åŠ åˆ°ä½ çš„æ”¶è—ä¸­çš„å¥½æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Ciilium çš„ç›¸äº’è®¤è¯å¦‚ä½•å±åŠå®‰å…¨</title>
      <link>https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/</link>
      <pubDate>Fri, 01 Dec 2023 10:33:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://thenewstack.io/how-ciliums-mutual-authentication-can-compromise-security/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://thenewstack.io/how-ciliums-mutual-authentication-can-compromise-security/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‘˜è¦ï¼šè¿™ç¯‡æ–‡ç« æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨ Cilium æ¥å®ç° äº’ç›¸è®¤è¯ (mTLS) çš„ï¼Œä»¥åŠè¿™ç§æ–¹æ³•å¯èƒ½å¸¦æ¥çš„å®‰å…¨é—®é¢˜ã€‚æ–‡ç« ä»‹ç»äº† Cilium çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Cilium CLI æˆ– Hubble UI æ¥åˆ›å»ºå’Œç®¡ç†è¯ä¹¦å’Œç­–ç•¥ã€‚æ–‡ç« è¿˜åˆ†æäº† Cilium çš„äº’ç›¸è®¤è¯çš„å±€é™å’Œé£é™©ï¼Œä¾‹å¦‚è¯ä¹¦è¿‡æœŸï¼Œæ’¤é”€ï¼Œæ³„éœ²å’Œä¼ªé€ ç­‰ã€‚æ–‡ç« çš„ç›®çš„æ˜¯å¸®åŠ©ç”¨æˆ·äº†è§£å’Œä½¿ç”¨ Cilium æ¥æé«˜æœåŠ¡é—´çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æœ€è¿‘ï¼ŒCilium é¡¹ç›®å®£å¸ƒæ”¯æŒä¸€ç§&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/mutual-authentication/mutual-authentication/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–°çš„åŒå‘è®¤è¯æœºåˆ¶&lt;/a&gt;ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®æ ‡å¿—é€æ˜åœ°éƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ä»è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ Cilium ä¸º Kubernetes å·¥ä½œè´Ÿè½½å®ç°æœåŠ¡ä¹‹é—´çš„åŒå‘è®¤è¯ã€‚ç„¶è€Œï¼Œè¿™ç§è®¾è®¡å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„ç¼ºé™·ï¼Œä¸å®¹å¿½è§†ï¼š&lt;/p&gt;
&lt;p&gt;Cilium ä¸­çš„åŒå‘è®¤è¯çš„æ•´ä¸ªåŸºç¡€æ˜¯&lt;em&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®‰å…¨å®ç°çš„æ•°æ®è·¯å¾„ä¸­ï¼Œæœ€ç»ˆä¸€è‡´æ€§å¯èƒ½å¯¼è‡´æ„å›¾ä¸­çš„å®‰å…¨å±æ€§å¤±è´¥ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´åœ¨ä¸åº”è¯¥å…è®¸çš„æƒ…å†µä¸‹æœåŠ¡ä¹‹é—´çš„æµé‡ç»§ç»­ä¼ é€’ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-åŒå‘è®¤è¯çš„å·¥ä½œåŸç†&#34;&gt;Cilium åŒå‘è®¤è¯çš„å·¥ä½œåŸç†&lt;/h2&gt;
&lt;p&gt;Cilium çš„è‡ªå®šä¹‰åŒå‘è®¤è¯æœºåˆ¶ä¼šé€æ˜åœ°å¯¹æœåŠ¡ä¹‹é—´çš„æµè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ„å»ºåœ¨ Cilium çš„ç°æœ‰æ‰©å±•ä¼¯å…‹åˆ©æ•°æ®åŒ…è¿‡æ»¤å™¨ï¼ˆ&lt;a href=&#34;https://thenewstack.io/ebpf-offers-a-new-way-to-secure-cloud-native-systems/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt;ï¼‰æ•°æ®å¹³é¢ä¹‹ä¸Šã€‚Cilium ä½¿ç”¨ eBPF æ¥å®ç°è¯¸å¦‚æœåŠ¡ç½‘ç»œã€ç½‘ç»œç­–ç•¥å’Œè¿æ¥å¤„ç†ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;Cilium ä½¿ç”¨â€œæ— åŒå‘ä¼ è¾“å±‚å®‰å…¨ï¼ˆmTLS-lessï¼‰â€ï¼ˆæˆ– mTLessï¼‰æ¥å¯¹æœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯ã€‚æˆ‘ç§°ä¹‹ä¸ºâ€œlessâ€ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ mTLS æ¥å®Œæˆ mTLS è®¾è®¡çš„ä»»åŠ¡ï¼šéªŒè¯ã€åŠ å¯†å’Œæ£€æŸ¥åœ¨ä¸¤ä¸ªå¯¹ç­‰æ–¹ä¹‹é—´ä¼ è¾“çš„æ•°æ®çš„å®Œæ•´æ€§ã€‚Cilium çš„åŒå‘è®¤è¯å®ç°&lt;em&gt;ä¸æ˜¯ mTLS&lt;/em&gt;ï¼Œæˆ‘å°†åœ¨ä¸‹é¢è§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;å½“æœåŠ¡ï¼ˆæˆ– Podï¼‰A æƒ³è¦ä¸æœåŠ¡ï¼ˆæˆ– Podï¼‰B é€šä¿¡æ—¶ï¼ŒCilium ä¼šå°è¯•å¯¹è¿™ä¸¤ä¸ªå¯¹ç­‰æ–¹è¿›è¡Œèº«ä»½éªŒè¯ï¼Œç„¶åæ ‡è®°ä¸€ä¸ªç‰¹æ®Šçš„æœ¬åœ°èŠ‚ç‚¹â€œèº«ä»½éªŒè¯ç¼“å­˜â€ï¼ŒæŒ‡ç¤ºæ˜¯å¦å…è®¸ç‰¹å®šæµã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1ç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu_acc4fd4deeeb9e99.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu_368fd79965fe8765.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu_9c829650d9d2ef74.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu_acc4fd4deeeb9e99.webp&#34;
               width=&#34;760&#34;
               height=&#34;293&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“ Pod A æƒ³è¦ä¸ Pod B é€šä¿¡æ—¶ï¼Œå®ƒä¼šé€šè¿‡æ­£å¸¸çš„ Cilium eBPF æ•°æ®å¹³é¢æµåŠ¨ï¼Œä½† eBPF ä»£ç ä¼šæ£€æŸ¥è¯¥è¿æ¥æ˜¯å¦å·²é€šè¿‡æ£€æŸ¥æœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜è¿›è¡Œèº«ä»½éªŒè¯ã€‚åœ¨ç¬¬ä¸€æ¬¡å°è¯•æ—¶ï¼Œè¯¥è°ƒç”¨å°†ä¸ä¼šå¾—åˆ°èº«ä»½éªŒè¯ï¼Œå› æ­¤&lt;a href=&#34;https://github.com/cilium/cilium/issues/23808&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å°†ä¸¢å¼ƒæ•°æ®åŒ…&lt;/a&gt;ã€‚ä½†è¿™å°†è§¦å‘ä¸€ä¸ªåœ¨å¹•åè¿›è¡Œçš„æœºåˆ¶ï¼Œå°è¯•å¯¹ Pod A å’Œ Pod B ä¹‹é—´çš„æµè¿›è¡Œèº«ä»½éªŒè¯ã€‚å¦‚æœæˆåŠŸï¼Œå®ƒå°†æ›´æ–°æœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;æœŸæœ›çš„æ˜¯ï¼Œåœ¨å¹•åçš„æœºåˆ¶èƒ½å¤Ÿå¿«é€Ÿè¿›è¡Œ Pod A å‘¼å« Pod B çš„èº«ä»½éªŒè¯ï¼Œä»¥ä¾¿æœ€åˆä¸¢å¼ƒçš„æ•°æ®åŒ…å°†è¢«é‡è¯•ï¼Œä¸ä¼šå¯¼è‡´å¤ªå¤šå»¶è¿Ÿã€‚åœ¨å¹•åä½¿ç”¨çš„æœºåˆ¶æ˜¯ä»è¿è¡Œåœ¨ Pod B æ‰€åœ¨èŠ‚ç‚¹ä¸Šçš„ cilium-agentï¼ˆä½¿ç”¨&lt;a href=&#34;https://roadmap.sh/golang&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Go&lt;/a&gt;ç¼–å†™ï¼‰åˆ°å¦ä¸€ä¸ª cilium-agent çš„â€œmTLessâ€è¿æ¥ã€‚æ‰€æœ‰è¿™äº›éƒ½ä¸ä¼šåœ¨ eBPF æ•°æ®å¹³é¢ä¸­å‘ç”Ÿï¼Œè€Œæ˜¯åœ¨ç”¨æˆ·ç©ºé—´çš„ Cilium ä»£ç†ä¸­è¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2å¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„-cilium-agent-ä¹‹é—´çš„-mtls-è¿æ¥æˆåŠŸåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šå¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ cilium-agent ä¹‹é—´çš„ mTLS è¿æ¥æˆåŠŸï¼Œåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu_df7a050534acb098.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu_fb8df9b89d420e54.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu_d76aeb8a17ddefb3.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu_df7a050534acb098.webp&#34;
               width=&#34;760&#34;
               height=&#34;380&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šå¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ cilium-agent ä¹‹é—´çš„ mTLS è¿æ¥æˆåŠŸï¼Œåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘å°†è¿™ä¸ªè¿æ¥ç§°ä¸ºâ€œmTLessâ€ï¼Œå› ä¸ºå®ƒç”¨äºæµ‹è¯•èº«ä»½éªŒè¯å¹¶ç«‹å³å…³é—­ï¼Œå¹¶ä¸”æ‰€æœ‰ç”¨äºåŠ å¯†å’Œå®Œæ•´æ€§çš„åå•†çš„ä¼šè¯å¯†é’¥éƒ½ä¼šè¢«ä¸¢å¼ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCilium ä¸ä¼šåœ¨è¿æ¥çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿ç•™ mTLS å®‰å…¨å±æ€§ï¼›å®ƒåªä½¿ç”¨æ¡æ‰‹çš„èº«ä»½éªŒè¯éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3åœ¨æ¡æ‰‹åcilium-ç»ˆæ­¢-mtless-è¿æ¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3ï¼šåœ¨æ¡æ‰‹åï¼ŒCilium ç»ˆæ­¢ mTLess è¿æ¥ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu_855d3b3a62f6a43.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu_901f5385e25d88f.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu_49291791de3d43a6.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu_855d3b3a62f6a43.webp&#34;
               width=&#34;760&#34;
               height=&#34;284&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3ï¼šåœ¨æ¡æ‰‹åï¼ŒCilium ç»ˆæ­¢ mTLess è¿æ¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚æœæ­¤ mTLess è¿æ¥æˆåŠŸï¼ˆå³æ¡æ‰‹æˆåŠŸï¼‰ï¼ŒCilium å°†è€ƒè™‘å°†æ¥è‡ª Pod A åˆ° Pod B çš„æµç¨‹è§†ä¸ºâ€œå·²éªŒè¯â€ã€‚æ­¤æ—¶ï¼Œæœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ä¸­çš„æ¡ç›®å°†è¢«æ›´æ–°ï¼Œä»¥æŒ‡ç¤ºåº”å…è®¸æ¥è‡ª Pod A åˆ° Pod B çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4cilium-æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜æŒ‡ç¤º-pod-a-å…·æœ‰å‘¼å«-pod-b-çš„èº«ä»½éªŒè¯&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4ï¼šCilium æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜ï¼ŒæŒ‡ç¤º Pod A å…·æœ‰å‘¼å« Pod B çš„èº«ä»½éªŒè¯ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu_d57f1c6066f71ca2.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu_4198447eac394846.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu_b067c639d91a6790.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu_d57f1c6066f71ca2.webp&#34;
               width=&#34;760&#34;
               height=&#34;329&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4ï¼šCilium æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜ï¼ŒæŒ‡ç¤º Pod A å…·æœ‰å‘¼å« Pod B çš„èº«ä»½éªŒè¯ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œå½“å®ƒé‡è¯•è¿æ¥æ•°æ®åŒ…æ—¶ï¼Œèº«ä»½éªŒè¯ç¼“å­˜å°†æŒ‡ç¤ºæµç¨‹å·²ç»é€šè¿‡èº«ä»½éªŒè¯ï¼Œåº”å…è®¸è¿æ¥å¹¶ç»§ç»­ eBPF æ•°æ®å¹³é¢çš„å…¶ä½™éƒ¨åˆ†ï¼ˆè¯¥éƒ¨åˆ†å¼ºåˆ¶æ‰§è¡Œç½‘ç»œå’Œå…¶ä»–ç­–ç•¥ï¼‰ã€‚è¿™ä¸ªæœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ç¡®å®è¡¨ç°å‡ºæœ€ç»ˆä¸€è‡´æ€§çš„è¿¹è±¡ï¼Œå¯èƒ½ä¼šå¤±å»åŒæ­¥ï¼Œä½†è¿™å¹¶ä¸æ˜¯æœ€ä»¤äººæ‹…å¿§çš„æœ€ç»ˆä¸€è‡´æ€§å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5ä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…è¿æ¥å°†ä¼šæµåŠ¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5ï¼šä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…ï¼Œè¿æ¥å°†ä¼šæµåŠ¨ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu_d9f367205d988d5f.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu_6bc70712d4261945.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu_c41d9cb0d2302a97.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu_d9f367205d988d5f.webp&#34;
               width=&#34;760&#34;
               height=&#34;267&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5ï¼šä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…ï¼Œè¿æ¥å°†ä¼šæµåŠ¨ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;cilium-æ–¹æ³•çš„ä¸»è¦é—®é¢˜&#34;&gt;Cilium æ–¹æ³•çš„ä¸»è¦é—®é¢˜&lt;/h2&gt;
&lt;p&gt;å¯¹äºçœŸæ­£çš„ mTLS è¿æ¥ï¼Œåœ¨æˆåŠŸæ¡æ‰‹ä¹‹åï¼Œæ‚¨å¸Œæœ›ä½¿ç”¨åœ¨å‚ä¸å„æ–¹ä¹‹é—´åå•†çš„å¯†é’¥æ¥åŠ å¯†å‰©ä½™çš„æ•°æ®ã€‚Cilium ä¸­æµçš„æˆåŠŸè®¤è¯å¹¶ä¸æ„å‘³ç€å®ƒæ˜¯åŠ å¯†çš„ï¼ˆå®ƒå°†æ˜¯çº¯æ–‡æœ¬ï¼‰ï¼Œä¹Ÿä¸ä¿è¯æµé‡ä»¥ä¸€ç§ä»…å¯¹ç›¸å…³æ–¹å¯è§çš„æ–¹å¼è¿›è¡ŒåŠ å¯†ã€‚å¦‚æœæ‚¨éœ€è¦åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨åŸºäº WireGuardï¼ˆæˆ– IPSecï¼‰çš„ Cilium åŠ å¯†é€‰é¡¹ï¼Œä½†è¿™åªæ˜¯ä¸¤ä¸ª Kubernetes èŠ‚ç‚¹ä¹‹é—´çš„åŠ å¯†ï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„å·²è®¤è¯çš„å·¥ä½œè´Ÿè½½ã€‚åœ¨â€œmTLessâ€è¿æ¥æ£€æŸ¥å’Œå°†å®é™…ï¼ˆæ•æ„Ÿï¼‰æ•°æ®æ”¾å…¥çº¿è·¯ä¹‹é—´ï¼Œå¯èƒ½ä¼šå‘ç”Ÿå¾ˆå¤šäº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;éšç€ä¸€äº› Cilium å¼€å‘äººå‘˜ç»§ç»­è¿­ä»£è¿™ä¸ªå®ç°ï¼Œæœ‰å…³å°† mTLS è¿æ¥ä¸­åå•†çš„æŸäº›å¯†é’¥è½¬ç§»åˆ°åº•å±‚èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†æ–¹æ³•ï¼ˆä¾‹å¦‚ IPSecï¼‰çš„è°ˆè®ºã€‚è¿™ä¸ªå®ç°è¿˜æœ‰å¾…è§‚å¯Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6å…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6ï¼šå…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu_3fe2c5efa206b27f.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu_f9b1a115ea3bd420.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu_719555d108ef0383.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu_3fe2c5efa206b27f.webp&#34;
               width=&#34;760&#34;
               height=&#34;427&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6ï¼šå…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-7åŸºäº-wireguard-çš„åŠ å¯†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 7ï¼šåŸºäº WireGuard çš„åŠ å¯†ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu_841f03f2e26a674f.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu_e0784af1f937a2f6.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu_1bb37650595b5cfb.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu_841f03f2e26a674f.webp&#34;
               width=&#34;760&#34;
               height=&#34;423&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 7ï¼šåŸºäº WireGuard çš„åŠ å¯†ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium æœ€ç»ˆä¸€è‡´æ€§åŒå‘è®¤è¯å®ç°çš„çœŸæ­£é—®é¢˜å‡ºç°åœ¨ Cilium çš„æ ¸å¿ƒèº«ä»½æ¨¡å‹å‘¨å›´ã€‚æˆ‘åœ¨ä¸Šé¢ç®€è¦ä»‹ç»äº† TLS æ¡æ‰‹ï¼Œä½†å¦‚æœæ‚¨é˜…è¯» Cilium æ–‡æ¡£ï¼Œæ‚¨ä¼šçœ‹åˆ°ç”¨äºâ€œmTLessâ€çš„ X509 è¯ä¹¦å…·æœ‰å¯é€‰åŸºäº&lt;a href=&#34;https://thenewstack.io/the-rise-of-workload-identity-in-cloud-native-with-spiffe-spire/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt;ï¼ˆSecure Production Identity Framework For Everyoneï¼‰çš„èº«ä»½æ¨¡å‹ã€‚å®é™…ä¸Šï¼Œåœ¨éƒ¨ç½²å®ç° Cilium åŒå‘è®¤è¯æ‰€éœ€çš„ç»„ä»¶æ—¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©éƒ¨ç½² SPIFFE Runtime Environmentï¼ˆSPIREï¼‰ï¼Œè¿™æ˜¯ SPIFFE çš„ä¸€ä¸ªå®ç°ï¼ŒCilium ä½¿ç”¨å®ƒæ¥ç”Ÿæˆä»£è¡¨å·¥ä½œè´Ÿè½½åŠå…¶èº«ä»½çš„è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª SPIFFE èº«ä»½ç”¨äºæ¡æ‰‹æ‰€ä½¿ç”¨çš„è¯ä¹¦ï¼Œ&lt;em&gt;ä½† SPIFFE ä¸æ˜¯ Cilium ä¸­ä½¿ç”¨çš„åŸºç¡€é€šç”¨å·¥ä½œè´Ÿè½½èº«ä»½&lt;/em&gt;ã€‚SPIFFE ç”¨ä½œç‹¬ç«‹çš„èº«ä»½å±‚ï¼Œæ˜ å°„åˆ° Cilium ç°æœ‰èº«ä»½å®ç°ã€‚Cilium åœ¨å…¶&lt;a href=&#34;https://doc.crds.dev/github.com/cilium/cilium/cilium.io/CiliumIdentity/v2@1.9.3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ¸å¿ƒèº«ä»½&lt;/a&gt;æ¦‚å¿µå‘¨å›´æ„å»ºäº†æ‰€æœ‰çš„ç½‘ç»œç­–ç•¥ã€‚CiliumIdentity å®ç°å°†ä¸€ä¸ªæ•´æ•°æ˜ å°„åˆ°ä¸€ç»„ IP åœ°å€ï¼ˆä¸ä¸€ç»„ Pod å…³è”çš„ Pod IPï¼‰ã€‚è¿™ä¸ªâ€œæ•´æ•°â€åŠå…¶æ˜ å°„åˆ° Pod IP åœ°å€çš„æ–¹å¼ä»£è¡¨äº†&lt;em&gt;Cilium ä¸­çš„æ ¸å¿ƒèº«ä»½åŸè¯­&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-8cilium-çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ°-ip-åœ°å€çš„æ•´æ•°&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 8ï¼šCilium çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ° IP åœ°å€çš„æ•´æ•°ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu_6046b407c03a6304.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu_e97d8d2162656c85.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu_4c23d38b224a68ef.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu_6046b407c03a6304.webp&#34;
               width=&#34;760&#34;
               height=&#34;371&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 8ï¼šCilium çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ° IP åœ°å€çš„æ•´æ•°ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨åšå®¢æ–‡ç« â€œ&lt;a href=&#34;https://www.solo.io/blog/could-network-cache-based-identity-be-mistaken/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œåŸºäºç¼“å­˜çš„èº«ä»½å¯èƒ½ä¼šè¢«è¯¯è§£å—ï¼Ÿ&lt;/a&gt;â€ä¸­è¯¦ç»†è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ã€‚ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å»ºè®®åœ¨è€ƒè™‘ä½¿ç”¨ä¾èµ–èº«ä»½åˆ° IP åœ°å€æ˜ å°„çš„å®¹å™¨ç½‘ç»œæ¥å£ï¼ˆCNIï¼‰å’Œ&lt;a href=&#34;https://thenewstack.io/secure-your-service-mesh-a-13-item-checklist/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;è¿›è¡Œç½‘ç»œå®‰å…¨æ—¶é‡‡å–æ·±åº¦é˜²å¾¡å§¿æ€ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜çš„å…³é”®åœ¨äºï¼š&lt;/p&gt;
&lt;p&gt;ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªèº«ä»½çš„æ‰€æœ‰ IP æ˜ å°„&lt;em&gt;éƒ½å­˜åœ¨äºé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-9æ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„-ip-çš„å›¾è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 9ï¼šæ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„ IP çš„å›¾è¡¨&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu_3569821807e80ff6.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu_7df6e39ddc93db42.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu_92fd448aec2c7800.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu_3569821807e80ff6.webp&#34;
               width=&#34;760&#34;
               height=&#34;461&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 9ï¼šæ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„ IP çš„å›¾è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-10æœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 10ï¼šæœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu_219990b34810c62b.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu_ea5eaf3b699b7f24.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu_d746b134025dffba.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu_219990b34810c62b.webp&#34;
               width=&#34;760&#34;
               height=&#34;452&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 10ï¼šæœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿ Cilium çš„åŒå‘è®¤è¯å’Œç­–ç•¥æ‰§è¡Œæ­£å¸¸å·¥ä½œï¼Œå¿…é¡»ä½¿ç”¨æ­£ç¡®çš„ IP åˆ°èº«ä»½æ˜ å°„æ›´æ–°è¿™äº›ç¼“å­˜ã€‚ç„¶è€Œï¼Œåœ¨é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ›´æ–°å•ç‹¬çš„ç¼“å­˜&lt;em&gt;æ˜¯ä¸€ç§æœ€ç»ˆä¸€è‡´æ€§æ“ä½œ&lt;/em&gt;ã€‚å½“ Cilium çš„ eBPF æ•°æ®å¹³é¢å°è¯•æ¨ç†è¿æ¥ç­–ç•¥æ—¶ï¼Œå®ƒå°†å‚è€ƒå…¶èŠ‚ç‚¹æœ¬åœ°ç¼“å­˜ä¸­çš„ IP åˆ°èº«ä»½æ˜ å°„ã€‚&lt;em&gt;å¦‚æœè¯¥ç¼“å­˜è¿‡æœŸæˆ–å»¶è¿Ÿ&lt;/em&gt;ï¼Œå°†å¯¼è‡´ä¸æ­£ç¡®çš„ç½‘ç»œç­–ç•¥ï¼ˆå¯èƒ½ä¸ç¬¦åˆè¦æ±‚ï¼Œå…è®¸æ¶æ„æ´»åŠ¨ï¼Œå¨èƒæ•°æ®ç­‰ï¼‰ã€‚æ— è®ºæ‚¨æ˜¯å¦ä½¿ç”¨ WireGuard æˆ– IPSec æ¥åŠ å¯†èŠ‚ç‚¹ä¹‹é—´çš„æµé‡ï¼Œè¿™éƒ½ä¸ä¼šå½±å“æ­¤èº«ä»½æ··æ·†åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¼”ç¤ºè¯´æ˜äº†åœ¨ä½¿ç”¨ Cilium çš„åŒå‘è®¤è¯æ—¶å¯èƒ½å¯¼è‡´è¿åç½‘ç»œç­–ç•¥çš„èº«ä»½æ··æ·†ï¼š&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å› æ­¤ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cilium é¡¹ç›®å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„ Kubernetes å·¥ä½œè´Ÿè½½çš„åŒå‘è®¤è¯æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä¸­çš„åŒå‘è®¤è¯å»ºç«‹åœ¨æœ€ç»ˆä¸€è‡´æ€§ä¹‹ä¸Šï¼Œå¯èƒ½ä¼šå±åŠå®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä½¿ç”¨â€œmTLessâ€è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä½†ä¸ä¼šç»´æŠ¤æ•´ä¸ªè¿æ¥çš„åŠ å¯†ã€‚&lt;/li&gt;
&lt;li&gt;Cilium çš„èº«ä»½æ¨¡å‹åŒ…æ‹¬ SPIFFEï¼Œä½†å…¶æ ¸å¿ƒèº«ä»½æ˜¯ä¸€ä¸ªåŸºäºæ•´æ•°çš„å•ç‹¬èº«ä»½å±‚ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒé—®é¢˜åœ¨äºï¼ŒIP åˆ°èº«ä»½çš„æ˜ å°„å­˜å‚¨åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´æœ€ç»ˆä¸€è‡´æ€§çš„æ›´æ–°ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ Cilium çš„åŒå‘è®¤è¯ä¸­çš„æœ€ç»ˆä¸€è‡´æ€§å¯èƒ½å¯¼è‡´ä¸æ­£ç¡®çš„ç½‘ç»œç­–ç•¥å’Œå®‰å…¨æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦æ­£ç¡®ä½¿ç”¨ä¾èµ–èº«ä»½åˆ° IP åœ°å€æ˜ å°„çš„ CNIï¼Œè¯·è€ƒè™‘é‡‡ç”¨æ·±åº¦é˜²å¾¡å§¿æ€ï¼Œå°†ä¸€ä¸ªæœåŠ¡ç½‘æ ¼ï¼ˆå¦‚ Istio Ambientï¼‰å åŠ åœ¨å…¶ä¸Šã€‚Istio Ambient å®ç°äº†ä¸€ç§æ—  sidecar çš„æœåŠ¡ç½‘æ ¼ï¼Œåœ¨æœåŠ¡ä¹‹é—´çš„æ•°æ®è·¯å¾„ä¸Šä½¿ç”¨ mTLSï¼ˆæ— è®ºå…¶ IP åœ°å€å¦‚ä½•ï¼‰ã€‚åœ¨&lt;a href=&#34;https://thenewstack.io/solo-io-istio-is-winning-the-service-mesh-war/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åƒ Istio è¿™æ ·çš„æœåŠ¡ç½‘æ ¼&lt;/a&gt;ä¸­ï¼Œèº«ä»½æ¨¡å‹æ˜¯ç”± SPIFFE å®šä¹‰çš„ï¼Œå¹¶æ ¹æ®è´Ÿè´£ç­¾ç½²ç”¨äºèº«ä»½éªŒè¯æµé‡çš„è¯ä¹¦çš„è¯ä¹¦é¢å‘æœºæ„å»ºç«‹çš„ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æ·±å…¥äº†è§£ Cilium å¤šé›†ç¾¤</title>
      <link>https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/</link>
      <pubDate>Wed, 03 Jul 2019 10:59:29 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/</guid>
      <description>&lt;p&gt;æœ¬æ–‡æ˜¯å¯¹ ClusterMeshï¼ˆCilium çš„å¤šé›†ç¾¤å®ç°ï¼‰çš„æ·±å…¥ç ”ç©¶ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒClusterMesh æä¾›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡éš§é“æˆ–ç›´æ¥è·¯ç”±ï¼Œä»¥æœ¬åœ°æ€§èƒ½å¯¹å¤šä¸ª Kubernetes é›†ç¾¤è¿›è¡Œ Pod IP è·¯ç”±ï¼Œè€Œæ— éœ€ä»»ä½•ç½‘å…³æˆ–ä»£ç†ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ ‡å‡†KubernetesæœåŠ¡å’Œcoredns/kube-dnsçš„é€æ˜æœåŠ¡å‘ç°ã€‚&lt;/li&gt;
&lt;li&gt;è·¨å¤šä¸ªé›†ç¾¤çš„ç½‘ç»œç­–ç•¥å®æ–½ã€‚ç­–ç•¥å¯ä»¥æŒ‡å®šä¸º Kubernetes NetworkPolicy èµ„æºæˆ–æ‰©å±•çš„ CiliumNetworkPolicy CRDã€‚&lt;/li&gt;
&lt;li&gt;é€æ˜åŠ å¯†ï¼Œç”¨äºæœ¬åœ°é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´ä»¥åŠè·¨é›†ç¾¤è¾¹ç•Œçš„æ‰€æœ‰é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-f7dca3e31d252eb9_hu_cf9097a103fa1ac8.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-f7dca3e31d252eb9_hu_d3b57818b0c21f3a.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-f7dca3e31d252eb9_hu_a8b84b588436e0a.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-f7dca3e31d252eb9_hu_cf9097a103fa1ac8.webp&#34;
               width=&#34;736&#34;
               height=&#34;213&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¤šé›†ç¾¤åŠŸèƒ½ä»¥å±‚ä¸ºå•ä½æ„å»ºï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä½¿ç”¨æ‰€æœ‰å±‚ï¼Œä¹Ÿå¯ä»¥ä»…é€‰æ‹©å’Œä½¿ç”¨æ‰€éœ€çš„å±‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”¨ä¾‹&#34;&gt;ç”¨ä¾‹&lt;/h2&gt;
&lt;p&gt;åœ¨æ·±å…¥ç ”ç©¶å®ç°ç»†èŠ‚ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹è¿æ¥å¤šä¸ª Kubernetes é›†ç¾¤çš„ä¸€äº›ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”¨ä¾‹é«˜å¯ç”¨æ€§&#34;&gt;ç”¨ä¾‹ï¼šé«˜å¯ç”¨æ€§&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-5d69ac8aba6c7b47_hu_c2b6bd956f57a19c.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-5d69ac8aba6c7b47_hu_9393c9549f791c8b.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-5d69ac8aba6c7b47_hu_e1c8c11469cdce78.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-5d69ac8aba6c7b47_hu_c2b6bd956f57a19c.webp&#34;
               width=&#34;760&#34;
               height=&#34;254&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¯¹äºå¤§å¤šæ•°äººæ¥è¯´ï¼Œé«˜å¯ç”¨æ€§æ˜¯æœ€æ˜æ˜¾çš„ç”¨ä¾‹ã€‚æ­¤ç”¨ä¾‹åŒ…æ‹¬åœ¨å¤šä¸ªåŒºåŸŸï¼ˆregionsï¼‰æˆ–å¯ç”¨åŒºï¼ˆavailability zonesï¼‰ä¸­è¿è¡Œ Kubernetes é›†ç¾¤ï¼Œå¹¶åœ¨æ¯ä¸ªé›†ç¾¤ä¸­è¿è¡Œç›¸åŒæœåŠ¡çš„å‰¯æœ¬ã€‚ä¸€æ—¦å¤±è´¥ï¼Œè¯·æ±‚å¯ä»¥æ•…éšœè½¬ç§»åˆ°å…¶ä»–é›†ç¾¤ã€‚æ­¤ç”¨ä¾‹ä¸­æ¶µç›–çš„æ•…éšœæƒ…å½¢ä¸»è¦ä¸æ˜¯æ•´ä¸ªåŒºåŸŸæˆ–æ•…éšœåŸŸçš„å®Œå…¨ä¸å¯ç”¨ã€‚æ›´å¯èƒ½çš„æƒ…å†µæ˜¯ä¸€ä¸ªé›†ç¾¤ä¸­èµ„æºæš‚æ—¶ä¸å¯ç”¨æˆ–é…ç½®é”™è¯¯å¯¼è‡´æ— æ³•åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­è¿è¡Œæˆ–æ‰©å±•ç‰¹å®šæœåŠ¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”¨ä¾‹å…±äº«æœåŠ¡&#34;&gt;ç”¨ä¾‹ï¼šå…±äº«æœåŠ¡&lt;/h3&gt;
&lt;p&gt;åŸºäº Kubernetes çš„å¹³å°çš„æœ€åˆè¶‹åŠ¿æ˜¯æ„å»ºå¤§å‹å¤šç§Ÿæˆ· Kubernetes é›†ç¾¤ã€‚ä¸ºæ¯ä¸ªç§Ÿæˆ·æ„å»ºå•ä¸ªé›†ç¾¤æˆ–ä¸ºä¸åŒç±»åˆ«çš„æœåŠ¡æ„å»ºé›†ç¾¤è¶Šæ¥è¶Šæ™®éï¼Œä¾‹å¦‚ï¼Œä¸åŒçº§åˆ«çš„å®‰å…¨æ•æ„Ÿåº¦ã€‚
















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-c950c8dfbc5a9b0d_hu_e540e6f412a496d4.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-c950c8dfbc5a9b0d_hu_e3b61a61e2af6b4b.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-c950c8dfbc5a9b0d_hu_bfa47c897ec48e5d.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-c950c8dfbc5a9b0d_hu_e540e6f412a496d4.webp&#34;
               width=&#34;760&#34;
               height=&#34;330&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;

ä½†æ˜¯ï¼ŒæŸäº›æœåŠ¡ï¼ˆå¦‚å¯†é’¥ç®¡ç†ï¼Œæ—¥å¿—è®°å½•ï¼Œç›‘æ§æˆ– DNSï¼‰é€šå¸¸ä»åœ¨æ‰€æœ‰é›†ç¾¤ä¹‹é—´å…±äº«ã€‚è¿™é¿å…äº†åœ¨æ¯ä¸ªç§Ÿæˆ·é›†ç¾¤ä¸­ç»´æŠ¤è¿™äº›æœåŠ¡çš„æ“ä½œå¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ¨¡å‹çš„ä¸»è¦åŠ¨æœºæ˜¯ç§Ÿæˆ·é›†ç¾¤ä¹‹é—´çš„éš”ç¦»ï¼Œä¸ºäº†ç»´æŒè¯¥ç›®æ ‡ï¼Œç§Ÿæˆ·é›†ç¾¤è¿æ¥åˆ°å…±äº«æœåŠ¡é›†ç¾¤ä½†æœªè¿æ¥åˆ°å…¶ä»–ç§Ÿæˆ·é›†ç¾¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”¨ä¾‹æ‹†åˆ†æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€æœåŠ¡&#34;&gt;ç”¨ä¾‹ï¼šæ‹†åˆ†æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€æœåŠ¡&lt;/h3&gt;
&lt;p&gt;è¿è¡Œæœ‰çŠ¶æ€æˆ–æ— çŠ¶æ€æœåŠ¡çš„æ“ä½œå¤æ‚æ€§æ˜¯éå¸¸ä¸åŒçš„ã€‚æ— çŠ¶æ€æœåŠ¡æ˜“äºæ‰©å±•ï¼Œè¿ç§»å’Œå‡çº§ã€‚å®Œå…¨ä½¿ç”¨æ— çŠ¶æ€æœåŠ¡è¿è¡Œé›†ç¾¤å¯ä½¿é›†ç¾¤ä¿æŒçµæ´»å’Œæ•æ·ã€‚ä»ä¸€ä¸ªäº‘æä¾›å•†è¿ç§»åˆ°å¦ä¸€ä¸ªäº‘æä¾›å•†éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰çŠ¶æ€æœåŠ¡å¯èƒ½ä¼šå¼•å…¥æ½œåœ¨çš„å¤æ‚ä¾èµ–é“¾ã€‚è¿ç§»æœåŠ¡é€šå¸¸æ¶‰åŠå­˜å‚¨è¿ç§»ã€‚
















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-98e2a381af81e811_hu_1971c00af481d380.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-98e2a381af81e811_hu_ebbf1b49864209c7.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-98e2a381af81e811_hu_8d01cde717b54a63.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-98e2a381af81e811_hu_1971c00af481d380.webp&#34;
               width=&#34;760&#34;
               height=&#34;358&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;

ä¸ºæ— çŠ¶æ€å’Œæœ‰çŠ¶æ€åˆ†åˆ«è¿è¡Œç‹¬ç«‹çš„é›†ç¾¤å…è®¸å°†ä¾èµ–å¤æ‚æ€§éš”ç¦»åˆ°è¾ƒå°‘æ•°é‡çš„é›†ç¾¤ï¼Œå¹¶ä½¿æ— çŠ¶æ€é›†ç¾¤ä¾èµ–æ€§ä¿æŒè‡ªç”±ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ§åˆ¶å¹³é¢&#34;&gt;æ§åˆ¶å¹³é¢&lt;/h2&gt;
&lt;h3 id=&#34;è¦æ±‚&#34;&gt;è¦æ±‚&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¿…é¡»ä¸ºæ‰€æœ‰ Kubernetes å·¥ä½œèŠ‚ç‚¹åˆ†é…å”¯ä¸€çš„ IP åœ°å€ï¼Œå¹¶ä¸”æ‰€æœ‰å·¥ä½œèŠ‚ç‚¹å¿…é¡»åœ¨å½¼æ­¤ä¹‹é—´å…·æœ‰ IP è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;å¿…é¡»ä¸ºæ‰€æœ‰é›†ç¾¤åˆ†é…å”¯ä¸€çš„ PodCIDR åŒºé—´ã€‚&lt;/li&gt;
&lt;li&gt;å¿…é¡»å°† Cilium é…ç½®ä¸ºä½¿ç”¨ etcd çš„ kvstoreã€‚&lt;/li&gt;
&lt;li&gt;é›†ç¾¤ä¹‹é—´çš„ç½‘ç»œå¿…é¡»å…è®¸é›†ç¾¤é—´é€šä¿¡ã€‚é˜²ç«å¢™çš„å…·ä½“é…ç½®è¦æ±‚å°†å–å†³äº Cilium æ˜¯å¦é…ç½®ä¸ºä»¥ç›´æ¥è·¯ç”±æˆ–éš§é“æ¨¡å¼è¿è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ¶æ„&#34;&gt;æ¶æ„&lt;/h3&gt;
&lt;p&gt;æ§åˆ¶å¹³é¢åŸºäº etcd å¹¶å°½å¯èƒ½ä¿æŒç®€çº¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª Kubernetes é›†ç¾¤éƒ½ç»´æŠ¤è‡ªå·±çš„ etcd é›†ç¾¤ï¼ŒåŒ…å«è¯¥é›†ç¾¤çš„çŠ¶æ€ã€‚æ¥è‡ªå¤šä¸ªé›†ç¾¤çš„çŠ¶æ€æ°¸è¿œä¸ä¼šåœ¨ etcd æœ¬èº«ä¸­æ··æ·†ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªé›†ç¾¤é€šè¿‡ä¸€ç»„ etcd ä»£ç†å…¬å¼€å®ƒè‡ªå·±çš„ etcdã€‚åœ¨å…¶ä»–é›†ç¾¤ä¸­è¿è¡Œçš„ Cilium ä»£ç†è¿æ¥åˆ° etcd ä»£ç†ä»¥ç›‘è§†æ›´æ”¹å¹¶å°†å¤šé›†ç¾¤ç›¸å…³çŠ¶æ€å¤åˆ¶åˆ°è‡ªå·±çš„é›†ç¾¤ä¸­ã€‚ä½¿ç”¨ etcd ä»£ç†ç¡®ä¿äº† etcd è§‚å¯Ÿè€…çš„å¯æ‰©å±•æ€§ã€‚è®¿é—®å— TLS è¯ä¹¦ä¿æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;ä»ä¸€ä¸ªé›†ç¾¤åˆ°å¦ä¸€ä¸ªé›†ç¾¤çš„è®¿é—®å§‹ç»ˆæ˜¯åªè¯»çš„ã€‚è¿™ç¡®ä¿äº†æ•…éšœåŸŸä¿æŒä¸å˜ï¼Œå³ä¸€ä¸ªé›†ç¾¤ä¸­çš„æ•…éšœæ°¸è¿œä¸ä¼šä¼ æ’­åˆ°å…¶ä»–é›†ç¾¤ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½®é€šè¿‡ç®€å•çš„ Kubernetes secrets èµ„æºè¿›è¡Œï¼Œè¯¥èµ„æºåŒ…å«è¿œç¨‹ etcd ä»£ç†çš„å¯»å€ä¿¡æ¯ä»¥åŠè®¿é—® etcd ä»£ç†æ‰€éœ€çš„é›†ç¾¤åç§°å’Œè¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-47bf320d6635c354_hu_2db58e01a846f85b.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-47bf320d6635c354_hu_1f4f13395ba1498b.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-47bf320d6635c354_hu_bd9854d48ef8b5c8.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-47bf320d6635c354_hu_2db58e01a846f85b.webp&#34;
               width=&#34;760&#34;
               height=&#34;261&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;pod-ip-è·¯ç”±&#34;&gt;Pod IP è·¯ç”±&lt;/h2&gt;
&lt;p&gt;pod IP è·¯ç”±æ˜¯å¤šé›†ç¾¤èƒ½åŠ›çš„åŸºç¡€ã€‚å®ƒå…è®¸è·¨é›†ç¾¤çš„ pod é€šè¿‡å…¶ pod IP ç›¸äº’è”ç³»ã€‚Cilium å¯ä»¥åœ¨å¤šç§æ¨¡å¼ä¸‹è¿è¡Œä»¥æ‰§è¡Œ pod IP è·¯ç”±ã€‚æ‰€æœ‰è¿™äº›æ¨¡å¼éƒ½èƒ½å¤Ÿæ‰§è¡Œå¤šé›†ç¾¤ pod IP è·¯ç”±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;éš§é“æ¨¡å¼&#34;&gt;éš§é“æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-1488d363a7db42ae_hu_2f79781c62be091.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-1488d363a7db42ae_hu_cedc202752bea527.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-1488d363a7db42ae_hu_64fb9a94633249e1.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-1488d363a7db42ae_hu_2f79781c62be091.webp&#34;
               width=&#34;706&#34;
               height=&#34;239&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;éš§é“æ¨¡å¼å°† pod ä¸­å‘å‡ºçš„æ‰€æœ‰ç½‘ç»œæ•°æ®åŒ…å°è£…åœ¨æ‰€è°“çš„å°åŒ…å¤´ä¸­ã€‚å°åŒ…å¤´å¯ä»¥åŒ…å« VXLAN æˆ– Geneve å¸§ã€‚ç„¶åé€šè¿‡æ ‡å‡† UDP åŒ…å¤´ä¼ è¾“è¯¥å°è£…å¸§ã€‚è¯¥æ¦‚å¿µç±»ä¼¼äº VPN éš§é“ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼špod IP åœ¨åº•å±‚ç½‘ç»œä¸Šæ°¸è¿œä¸å¯è§ã€‚ç½‘ç»œåªèƒ½çœ‹åˆ°å·¥ä½œèŠ‚ç‚¹çš„ IP åœ°å€ã€‚è¿™å¯ä»¥ç®€åŒ–å®‰è£…å’Œé˜²ç«å¢™è§„åˆ™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ‰€éœ€çš„é¢å¤–ç½‘ç»œæ ‡å¤´å°†é™ä½ç½‘ç»œçš„ç†è®ºæœ€å¤§ååé‡ã€‚ç¡®åˆ‡çš„æˆæœ¬å–å†³äºé…ç½®çš„ MTUï¼Œä¸ä½¿ç”¨ MTU 9000 çš„å·¨å‹å¸§ç›¸æ¯”ï¼Œä½¿ç”¨ 1500 çš„ä¼ ç»Ÿ MTU æ—¶ä¼šæ›´åŠ æ˜æ˜¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šä¸ºäº†ä¸æ¶ˆè€—è¿‡å¤š CPUï¼ŒåŒ…æ‹¬åº•å±‚ç¡¬ä»¶åœ¨å†…çš„æ•´ä¸ªç½‘ç»œå †æ ˆå¿…é¡»æ”¯æŒæ ¡éªŒå’Œå’Œåˆ†æ®µå¸è½½ï¼Œä»¥è®¡ç®—æ ¡éªŒå’Œå¹¶åœ¨ç¡¬ä»¶ä¸­æ‰§è¡Œåˆ†æ®µï¼Œå°±åƒå¯¹â€œå¸¸è§„â€ç½‘ç»œæ•°æ®åŒ…æ‰€åšçš„é‚£æ ·ã€‚å¦‚ä»Šï¼Œè¿™ç§å¸è½½åŠŸèƒ½çš„å¯ç”¨æ€§éå¸¸å¸¸è§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç›´æ¥è·¯ç”±æ¨¡å¼&#34;&gt;ç›´æ¥è·¯ç”±æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-51340f50bb80261e_hu_1dfadf23bf6da136.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-51340f50bb80261e_hu_b3ea5560c83d74a2.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-51340f50bb80261e_hu_342bb2f06a85edec.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-51340f50bb80261e_hu_1dfadf23bf6da136.webp&#34;
               width=&#34;706&#34;
               height=&#34;240&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ç›´æ¥è·¯ç”±æ¨¡å¼ä¸­ï¼Œæ‰€æœ‰ç½‘ç»œæ•°æ®åŒ…éƒ½ç›´æ¥è·¯ç”±åˆ°ç½‘ç»œã€‚è¿™è¦æ±‚ç½‘ç»œèƒ½å¤Ÿè·¯ç”± pod IPã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ªé€‰é¡¹å®ç°è·¨èŠ‚ç‚¹ä¼ æ’­ pod IP è·¯ç”±ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨&lt;code&gt;--auto-direct-node-routes&lt;/code&gt;é€‰é¡¹ï¼Œè¿™æ˜¯é€šè¿‡ kvstore çš„è¶…è½»é‡çº§è·¯ç”±ä¼ æ’­æ–¹æ³•ï¼Œå¦‚æœæ‰€æœ‰å·¥ä½œèŠ‚ç‚¹å…±äº«ä¸€ä¸ªå•ä¸€çš„ 2 å±‚ç½‘ç»œï¼Œè¯¥é€‰é¡¹å°†èµ·ä½œç”¨ã€‚å¯¹äºæ‰€æœ‰å½¢å¼çš„åŸºäºäº‘æä¾›å•†çš„è™šæ‹Ÿç½‘ç»œï¼Œé€šå¸¸éƒ½æ»¡è¶³æ­¤è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;a href=&#34;http://docs.cilium.io/en/stable/gettingstarted/kube-router/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kube-router é›†æˆ&lt;/a&gt;è¿è¡Œ BGP è·¯ç”±å®ˆæŠ¤è¿›ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä»»ä½•å…¶ä»–è·¯ç”±å®ˆæŠ¤è¿›ç¨‹å°†è·¯ç”±æ³¨å…¥æ ‡å‡† Linux è·¯ç”±è¡¨ï¼ˆbirdï¼Œquaggaï¼Œ&amp;hellip;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç½‘ç»œä¸å†ç†è§£ pod IP æ—¶ï¼Œç½‘ç»œæ•°æ®åŒ…åœ°å€éœ€è¦ä¼ªè£…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜ç‚¹&lt;/strong&gt;ï¼šå‡å°‘çš„ç½‘ç»œæ•°æ®åŒ…æ ‡å¤´å¯ä»¥ä¼˜åŒ–ç½‘ç»œååé‡å’Œå»¶è¿Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼ºç‚¹&lt;/strong&gt;ï¼šæ•´ä¸ªç½‘ç»œå¿…é¡»èƒ½å¤Ÿè·¯ç”± pod IPï¼Œè¿™ä¼šå¢åŠ æ“ä½œçš„å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ··åˆè·¯ç”±æ¨¡å¼&#34;&gt;æ··åˆè·¯ç”±æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;æ··åˆè·¯ç”±æ¨¡å¼å…è®¸åœ¨å¯ç”¨æ—¶ä½¿ç”¨ç›´æ¥è·¯ç”±ï¼Œè¿™é€šå¸¸åœ¨æœ¬åœ°é›†ç¾¤æˆ–åŒä¸€ VPC ä¸­çš„å…¶ä»–é›†ç¾¤ä¸­ï¼Œè€Œå½“è·¨è¶Š VPC æˆ–äº‘æä¾›å•†æ—¶å¯ä»¥å›é€€åˆ°éš§é“æ¨¡å¼ã€‚è¿™å¯ä»¥é™åˆ¶æ“ä½œå¤æ‚æ€§å¹¶ä¸”å…è®¸ä»…åœ¨éœ€è¦æ—¶æ”¯ä»˜ä¼˜åŒ–æˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡å‘ç°&#34;&gt;æœåŠ¡å‘ç°&lt;/h2&gt;
&lt;p&gt;Cilium çš„å¤šé›†ç¾¤æ¨¡å‹çš„æœåŠ¡å‘ç°æ˜¯ä½¿ç”¨æ ‡å‡†çš„ Kubernetes &lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;services&lt;/a&gt;Â æ„å»ºçš„ï¼Œæ—¨åœ¨å¯¹ç°æœ‰çš„ Kubernetes åº”ç”¨ç¨‹åºéƒ¨ç½²å®Œå…¨é€æ˜ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rebel-base&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.cilium/global-service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterIP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rebel-base&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Cilium é€šè¿‡ä¸€ä¸ªæ³¨é‡Š&lt;code&gt;io.cilium/global-service: &amp;quot;true&amp;quot;&lt;/code&gt; æ¥ç›‘æ§ Kubernetes æœåŠ¡å’Œç«¯ç‚¹ä»¥åŠç›‘å¬æœåŠ¡ã€‚å¯¹äºæ­¤ç±»æœåŠ¡ï¼Œå…·æœ‰ç›¸åŒåç§°å’Œå‘½åç©ºé—´ä¿¡æ¯çš„æ‰€æœ‰æœåŠ¡å°†è‡ªåŠ¨åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¹¶å½¢æˆè·¨é›†ç¾¤å¯ç”¨çš„å…¨å±€æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æ®æ ‡å‡† Kubernetes è¿è¡ŒçŠ¶å†µæ£€æŸ¥é€»è¾‘ï¼Œä»»ä½•åˆ°å…¨å±€æœåŠ¡çš„ ClusterIP çš„æµé‡éƒ½å°†è‡ªåŠ¨è´Ÿè½½å¹³è¡¡åˆ°æ‰€æœ‰é›†ç¾¤ä¸­çš„ç«¯ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªé›†ç¾¤ç»§ç»­ä¸ºæ¯ä¸ªæœåŠ¡ç»´æŠ¤è‡ªå·±çš„ ClusterIPï¼Œè¿™æ„å‘³ç€ Kubernetes å’Œ kube-dns / coredns ä¸çŸ¥é“å…¶ä»–é›†ç¾¤ã€‚DNS æœåŠ¡å™¨ç»§ç»­è¿”å›ä»…åœ¨æœ¬åœ°é›†ç¾¤ä¸­æœ‰æ•ˆçš„ ClusterIPï¼ŒCilium å°†é€æ˜åœ°æ‰§è¡Œè´Ÿè½½å¹³è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºç»†ç²’åº¦æ§åˆ¶å­˜åœ¨è‹¥å¹²é™„åŠ æ³¨é‡Šï¼Œä¾‹å¦‚å•å‘æš´éœ²æˆ–äº²å’Œç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-b027eb4bd91ead46_hu_c5d76cb1d862d13.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-b027eb4bd91ead46_hu_7c9bd868514ac8f0.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-b027eb4bd91ead46_hu_7b8396cf1f3a8dd0.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-b027eb4bd91ead46_hu_c5d76cb1d862d13.webp&#34;
               width=&#34;760&#34;
               height=&#34;255&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»&lt;code&gt;frontend-1&lt;/code&gt;åˆ° ClusterIP &lt;code&gt;30.1.1.1&lt;/code&gt;çš„æ‰€æœ‰æµé‡å°†è‡ªåŠ¨è´Ÿè½½å‡è¡¡åˆ°é›†ç¾¤ 1 çš„åç«¯ pod IP&lt;code&gt;[10.0.0.1,10.0.0.2]&lt;/code&gt;ä»¥åŠé›†ç¾¤ 2 çš„åç«¯ pod IP&lt;code&gt;[20.0.0.1,20.0.0.2]&lt;/code&gt;ã€‚æ¯ä¸ªé›†ç¾¤å°†æ‰§è¡Œæœ¬åœ°åç«¯å®ä¾‹çš„è¿è¡ŒçŠ¶å†µæ£€æŸ¥ï¼Œå¹¶åœ¨å®¹å™¨åˆ›å»ºï¼Œé”€æ¯æˆ–å˜å¾—ä¸å¥åº·æ—¶é€šçŸ¥å…¶ä»–é›†ç¾¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€æ˜åŠ å¯†&#34;&gt;é€æ˜åŠ å¯†&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/blog/2019/02/12/cilium-14/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium 1.4&lt;/a&gt;ä¸­å¼•å…¥çš„é€æ˜åŠ å¯†ä¸å¤šé›†ç¾¤å…¼å®¹ã€‚ç¡®ä¿ä½¿ç”¨å…¬å…±å¯†é’¥é…ç½®æ‰€æœ‰é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¦‚æ­¤èŠ‚ç‚¹ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡éƒ½ä¼šè‡ªåŠ¨åŠ å¯†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-be3e56c01fa1ef78_hu_61914c46d35f4f44.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-be3e56c01fa1ef78_hu_3bd3f6d017fde72b.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-be3e56c01fa1ef78_hu_7ef29239facd5233.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-be3e56c01fa1ef78_hu_61914c46d35f4f44.webp&#34;
               width=&#34;709&#34;
               height=&#34;209&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å¤šé›†ç¾¤çš„ç½‘ç»œç­–ç•¥&#34;&gt;å¤šé›†ç¾¤çš„ç½‘ç»œç­–ç•¥&lt;/h2&gt;
&lt;p&gt;ç®€å•ç‰ˆæœ¬æ˜¯æ‚¨ä»å•ä¸ªé›†ç¾¤ä¸­ç†Ÿæ‚‰çš„ç­–ç•¥å®æ–½å°†ç®€å•åœ°æ‰©å±•å¹¶è·¨é›†ç¾¤å·¥ä½œã€‚ç”±äºç­–ç•¥æ˜¯ä½¿ç”¨ pod æ ‡ç­¾æŒ‡å®šçš„ï¼Œå› æ­¤å…è®¸&lt;code&gt;frontend&lt;/code&gt;ä¸&lt;code&gt;backend&lt;/code&gt;é€šä¿¡çš„ç­–ç•¥å°†åº”ç”¨äºé›†ç¾¤æµé‡ï¼Œå°±åƒæµé‡è·¨è¶Šé›†ç¾¤ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;Cilium&lt;strong&gt;ä¸ä¼š&lt;/strong&gt;è·¨é›†ç¾¤è‡ªåŠ¨ä¼ æ’­ NetworkPolicy æˆ– CiliumNetworkPolicyã€‚ç”¨æˆ·æœ‰è´£ä»»å°†ç­–ç•¥å¯¼å…¥æ‰€æœ‰é›†ç¾¤ã€‚è¿™æ˜¯æœ‰æ„ä¸ºä¹‹ï¼Œå› ä¸ºè¿™æ„å‘³ç€æ¯ä¸ªé›†ç¾¤éƒ½å¯ä»¥å†³å®šæ˜¯å¦å…è®¸é›†ç¾¤æ¥æ”¶æ¥è‡ªè¿œç¨‹é›†ç¾¤çš„é€šä¿¡æˆ–è€…å‘å‡ºåˆ°è¿œç¨‹é›†ç¾¤çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…è®¸ç‰¹å®šé›†ç¾¤çš„äº¤å‰è·¯å¾„&#34;&gt;å…è®¸ç‰¹å®šé›†ç¾¤çš„äº¤å‰è·¯å¾„&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ä»…å»ºç«‹é€‚ç”¨äºç‰¹å®šé›†ç¾¤ä¸­çš„ pod çš„ç­–ç•¥ã€‚é›†ç¾¤åç§°ç”± Cilium è¡¨ç¤ºä¸ºæ¯ä¸ª pod ä¸Šçš„æ ‡ç­¾ï¼Œå…è®¸åŒ¹é…çš„é›†ç¾¤åç§°å¯ä»¥æ˜¯&lt;code&gt;endpointSelector&lt;/code&gt;æˆ–è€…æ˜¯ç”±&lt;code&gt;toEndpoints&lt;/code&gt;å’Œ&lt;code&gt;fromEndpoints&lt;/code&gt;æ„é€ çš„&lt;code&gt;matchLabels&lt;/code&gt;æ ‡ç­¾ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cilium.io/v2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumNetworkPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;allow-cross-cluster&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Allow x-wing in cluster1 to contact rebel-base in cluster2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;endpointSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;x-wing&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.cilium.k8s.policy.cluster&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cluster1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;egress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;toEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rebel-base&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;io.cilium.k8s.policy.cluster&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cluster2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹ç­–ç•¥å°†å…è®¸ cluster1 ä¸­çš„&lt;code&gt;x-wing&lt;/code&gt;ä¸ cluster2 ä¸­çš„&lt;code&gt;rebel-base&lt;/code&gt;å¯¹è¯ã€‚é™¤éå­˜åœ¨å°†é€šä¿¡åˆ—å…¥ç™½åå•çš„é™„åŠ ç­–ç•¥ï¼Œå¦åˆ™ x-wing å°†æ— æ³•ä¸æœ¬åœ°é›†ç¾¤ä¸­çš„ rebel-base é€šä¿¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸-istio-å¤šé›†ç¾¤çš„å…³ç³»&#34;&gt;ä¸ Istio å¤šé›†ç¾¤çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªé¡¹ç›®éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä½†å¯ä»¥å¾ˆå¥½åœ°ç›¸äº’è¡¥å……ã€‚ç»„åˆ Cilium å’Œ Istio å¤šé›†ç¾¤çš„å¸¸ç”¨æ–¹æ³•æ˜¯ä½¿ç”¨ Cilium çš„å¤šé›†ç¾¤ Pod IP è·¯ç”±å±‚æ¥æ»¡è¶³&lt;a href=&#34;https://istio.io/docs/setup/kubernetes/multicluster-install/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio å¤šé›†ç¾¤æŒ‡å—&lt;/a&gt;çš„ä»¥ä¸‹è¦æ±‚ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod CIDR å¿…é¡»å¯ä»¥ç›¸äº’è·¯ç”±ã€‚&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ­¤å¤–ï¼ŒCilium ç­–ç•¥æ‰§è¡ŒåŠŸèƒ½å¯ç”¨äºä¿æŠ¤ä¸ Istio æ§åˆ¶å¹³é¢ä¹‹é—´çš„é€šä¿¡ï¼Œä»¥åŠé€šè¿‡ä¸æ”¯æŒçš„åè®®ï¼ˆå¦‚ UDP æˆ– IPV6ï¼‰ä¿æŠ¤ sidecar çš„æ—è·¯å°è¯•ï¼Œä»¥åŠé˜²æ­¢å—æŸçš„ sidecar ä»£ç†ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜å¯ä»¥åŒæ—¶è¿è¡Œå…¨å±€ Istio æœåŠ¡å’Œ Cilium å…¨å±€æœåŠ¡ã€‚æ‰€æœ‰ Istio æ‰˜ç®¡æœåŠ¡éƒ½å¯ä»¥è·å¾— Cilium çš„å…¨å±€æœåŠ¡ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥åƒå¸¸è§„æœåŠ¡ä¸€æ ·é€šè¿‡ DNS å‘ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‡†å¤‡å¼€å§‹&#34;&gt;å‡†å¤‡å¼€å§‹&lt;/h2&gt;
&lt;p&gt;è¦å¼€å§‹ä½¿ç”¨ï¼Œè¯·æŒ‰ç…§æ‰‹æŠŠæ‰‹çš„&lt;a href=&#34;http://docs.cilium.io/en/stable/gettingstarted/clustermesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ClusterMesh æ•™ç¨‹&lt;/a&gt;è¿›è¡Œæ“ä½œï¼Œè¯¥æ•™ç¨‹å°†æŒ‡å¯¼æ‚¨å®Œæˆå°†é›†ç¾¤è¿æ¥åœ¨ä¸€èµ·çš„è¿‡ç¨‹ã€‚è¯·åŠ¡å¿…åŠ å…¥æˆ‘ä»¬çš„&lt;a href=&#34;https://cilium.herokuapp.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack é¢‘é“&lt;/a&gt;ï¼Œæå‡ºé—®é¢˜å¹¶å±•ç¤ºæ‚¨çš„è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-imagepng&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;image.png&#34; srcset=&#34;
               /blog/deep-dive-into-cilium-multi-cluster/14871146-112faa9f90a9352b_hu_29a0000f18baa4a6.webp 400w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-112faa9f90a9352b_hu_4f9375d761acc883.webp 760w,
               /blog/deep-dive-into-cilium-multi-cluster/14871146-112faa9f90a9352b_hu_b8b818c6be9f513e.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/deep-dive-into-cilium-multi-cluster/14871146-112faa9f90a9352b_hu_29a0000f18baa4a6.webp&#34;
               width=&#34;760&#34;
               height=&#34;264&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      image.png
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 1.4 å‘å¸ƒäº†ï¼Œæ–°åŠŸèƒ½ä¸€è§ˆ</title>
      <link>https://cloudnativecn.com/blog/cilium-1-4/</link>
      <pubDate>Mon, 18 Feb 2019 17:59:29 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-1-4/</guid>
      <description>&lt;p&gt;















&lt;figure  id=&#34;figure-å‘å¸ƒæ¦‚è¿°&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å‘å¸ƒæ¦‚è¿°&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmk6vqhj20jg08odga_hu_40b4d47a2dfe24b8.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmk6vqhj20jg08odga_hu_20621b9e54c7fcdb.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmk6vqhj20jg08odga_hu_10a4400055b99bc7.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmk6vqhj20jg08odga_hu_40b4d47a2dfe24b8.webp&#34;
               width=&#34;700&#34;
               height=&#34;312&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å‘å¸ƒæ¦‚è¿°
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸ºç¿»è¯‘æ–‡ç« ï¼Œ&lt;a href=&#34;https://cilium.io/blog/2019/02/12/cilium-14/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‚¹å‡»æŸ¥çœ‹åŸæ–‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ Cilium 1.4 ç‰ˆæœ¬ã€‚è¯¥ç‰ˆæœ¬å¼•å…¥äº†å‡ é¡¹æ–°åŠŸèƒ½ä»¥åŠä¼˜åŒ–å’Œå¯æ‰©å±•æ€§å·¥ä½œã€‚é‡ç‚¹åŒ…æ‹¬å¢åŠ å…¨å±€æœåŠ¡ï¼Œæä¾›è·¨å¤šä¸ªé›†ç¾¤çš„ Kubernetes æœåŠ¡è·¯ç”±ã€DNS è¯·æ±‚/å“åº”æ„ŸçŸ¥æˆæƒå’Œå¯è§æ€§ã€é€æ˜åŠ å¯†ï¼ˆbetaï¼‰ã€IPVLAN æ”¯æŒä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½å’Œå»¶è¿Ÿï¼ˆbetaï¼‰ã€ä¸ Flannel é›†æˆã€GKE åœ¨ COS ä¸Šæ”¯æŒã€åŸºäº AWS å…ƒæ•°æ®çš„ç­–ç•¥å®æ–½ï¼ˆalphaï¼‰ä»¥åŠä¼˜åŒ–å†…å­˜å’Œ CPU ä½¿ç”¨çš„é‡è¦å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;åƒå¾€å¸¸ä¸€æ ·ï¼Œæ„Ÿè°¢è¿‡å» 4 ä¸ªæœˆä¸­åœ¨ç‰ˆæœ¬ 1.3 å’Œ 1.4 ä¹‹é—´è´¡çŒ®äº† 1048 æ¬¡æäº¤çš„ Cilium å¼€å‘äººå‘˜åŠæ•´ä¸ªç¤¾åŒºã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-æ˜¯ä»€ä¹ˆ&#34;&gt;Cilium æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶ï¼Œç”¨äºé€æ˜åœ°æä¾›å’Œä¿æŠ¤ä½¿ç”¨ Kubernetesã€Docker å’Œ Mesos ç­‰ Linux å®¹å™¨ç®¡ç†å¹³å°éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæœåŠ¡ä¹‹é—´çš„ç½‘ç»œå’Œ API è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;Cilium çš„åŸºç¡€æ˜¯ä¸€ç§åä¸º BPF çš„æ–° Linux å†…æ ¸æŠ€æœ¯ï¼Œå®ƒå¯ä»¥åœ¨ Linux æœ¬èº«å†…åŠ¨æ€æ’å…¥å¼ºå¤§çš„å®‰å…¨æ€§ã€å¯è§æ€§å’Œç½‘ç»œæ§åˆ¶é€»è¾‘ã€‚BPF ç”¨äºæä¾›è¯¸å¦‚å¤šé›†ç¾¤è·¯ç”±ï¼Œè´Ÿè½½å‡è¡¡ä»¥å–ä»£ kube-proxyï¼Œä½¿ç”¨ X.509 è¯ä¹¦çš„é€æ˜åŠ å¯†ä»¥åŠç½‘ç»œå’ŒæœåŠ¡å®‰å…¨æ€§ç­‰åŠŸèƒ½ã€‚é™¤äº†æä¾›ä¼ ç»Ÿçš„ç½‘ç»œçº§å®‰å…¨æ€§ä¹‹å¤–ï¼ŒBPF çš„çµæ´»æ€§è¿˜å¯ä»¥é€šè¿‡åº”ç”¨ç¨‹åºåè®®å’Œ DNS è¯·æ±‚/å“åº”çš„ä¸Šä¸‹æ–‡å®ç°å®‰å…¨æ€§ã€‚Cilium ä¸ Envoy ç´§å¯†é›†æˆï¼Œå¹¶æä¾›åŸºäº Go çš„æ‰©å±•æ¡†æ¶ã€‚ç”±äº BPF åœ¨ Linux å†…æ ¸ä¸­è¿è¡Œï¼Œå› æ­¤å¯ä»¥åº”ç”¨æ‰€æœ‰ Cilium åŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº”ç”¨ç¨‹åºä»£ç æˆ–å®¹å™¨é…ç½®è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ &lt;strong&gt;&lt;a href=&#34;https://cilium.readthedocs.io/en/stable/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium&lt;/a&gt;&lt;/strong&gt; çš„æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œè¯·å‚é˜…**&lt;a href=&#34;https://cilium.readthedocs.io/en/stable/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium ç®€ä»‹&lt;/a&gt;** ä¸€èŠ‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤šé›†ç¾¤æœåŠ¡è·¯ç”±&#34;&gt;å¤šé›†ç¾¤æœåŠ¡è·¯ç”±&lt;/h2&gt;
&lt;p&gt;Cilium 1.3 åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´å¼•å…¥äº†åŸºæœ¬çš„ pod IP è·¯ç”±åŠŸèƒ½ã€‚Cilium 1.4 å¼•å…¥äº†åŸºäºæ ‡å‡† Kubernetes æœåŠ¡çš„å…¨å±€æœåŠ¡æ¦‚å¿µã€‚å…¨å±€æœåŠ¡å…è®¸ç”¨æˆ·æŒ‡å®š Kubernetes æœåŠ¡åœ¨å¤šä¸ªé›†ç¾¤ä¸­å¯ç”¨ã€‚ç„¶åï¼Œè¯¥æœåŠ¡å¯ä»¥åœ¨å¤šä¸ªé›†ç¾¤ä¸­å…·æœ‰åç«¯ podã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·ä½“éªŒå°±åƒåœ¨æ¯ä¸ªé›†ç¾¤ä¸­å®šä¹‰å…·æœ‰ç›¸åŒåç§°å’Œå‘½åç©ºé—´çš„ Kubernetes æœåŠ¡å¹¶æ·»åŠ æ³¨é‡Šä»¥å°†å…¶æ ‡è®°ä¸ºå…¨å±€ä¸€æ ·ç®€å•ã€‚ 















&lt;figure  id=&#34;figure-å¤šé›†ç¾¤æœåŠ¡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¤šé›†ç¾¤æœåŠ¡&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkdyp1j21fk0mggly_hu_e709cd77eed54b78.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkdyp1j21fk0mggly_hu_e00ff2b323c1d1bb.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkdyp1j21fk0mggly_hu_9fc56999f47d6ce.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkdyp1j21fk0mggly_hu_e709cd77eed54b78.webp&#34;
               width=&#34;760&#34;
               height=&#34;331&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¤šé›†ç¾¤æœåŠ¡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“ pod å‘ä¸Šæˆ–å‘ä¸‹æ‰©å±•æˆ–å˜å¾—ä¸å¥åº·æ—¶ï¼ŒKubernetes è¿è¡ŒçŠ¶æ€æ£€æŸ¥ä¿¡æ¯å¯ç”¨äºè‡ªåŠ¨æ·»åŠ å’Œåˆ é™¤åç«¯æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¤šé›†ç¾¤æ•…éšœè½¬ç§»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¤šé›†ç¾¤æ•…éšœè½¬ç§»&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmk3324j21g80hkwev_hu_652a9a2d8174f74c.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmk3324j21g80hkwev_hu_7b24d7b9e2dc6157.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmk3324j21g80hkwev_hu_520759dde6ec6db4.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmk3324j21g80hkwev_hu_652a9a2d8174f74c.webp&#34;
               width=&#34;760&#34;
               height=&#34;255&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¤šé›†ç¾¤æ•…éšœè½¬ç§»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å¹³é¢å»ºç«‹åœ¨ etcd ä¹‹ä¸Šï¼Œç±»ä¼¼äº Kubernetes åŸç”Ÿçš„æ“ä½œæ–¹å¼ï¼Œå…·æœ‰å¼¹æ€§å’Œç®€å•æ€§ä½œä¸ºå…¶åŸºæœ¬è®¾è®¡æ¨¡å¼ã€‚æ¯ä¸ªé›†ç¾¤ç»§ç»­è¿è¡Œå…¶è‡ªå·±çš„ etcd é›†ç¾¤ï¼Œå¹¶ä¸”å¤åˆ¶ä»¥åªè¯»æ–¹å¼è¿›è¡Œï¼Œè¿™å¯ç¡®ä¿é›†ç¾¤ä¸­çš„æ•…éšœä¸ä¼šå½±å“å…¶ä»–é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é›†ç¾¤æ§åˆ¶å¹³é¢&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é›†ç¾¤æ§åˆ¶å¹³é¢&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmjzw1jj20jg09ljrn_hu_c7dece338f882564.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmjzw1jj20jg09ljrn_hu_31321667c965d8e8.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmjzw1jj20jg09ljrn_hu_b085c70de168be47.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmjzw1jj20jg09ljrn_hu_c7dece338f882564.webp&#34;
               width=&#34;700&#34;
               height=&#34;345&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é›†ç¾¤æ§åˆ¶å¹³é¢
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å°†é›†ç¾¤è¿æ¥åœ¨ä¸€èµ·å°±åƒä½¿ç”¨äº‘ä¾›åº”å•†çš„æ ‡å‡†è·¯ç”± API æˆ–åŸºäºå¸¸è§„ IP åœ°å€çš„ VPN ç½‘å…³å’Œéš§é“çš„æœ¬åœ°åŸºç¡€è®¾æ–½åœ¨ VPC ä¹‹é—´æä¾›è·¯ç”±ï¼Œç„¶åé€šè¿‡å†…éƒ¨ Kubernetes è´Ÿè½½å‡è¡¡å™¨æš´éœ² Cilium æ§åˆ¶å¹³é¢ä»¥å°†å…¶æš´éœ²ç»™å†…éƒ¨ VPC ä¸€æ ·ç®€å•ã€‚TLS ç”¨äºä½¿ç”¨ä½œä¸º Kubernetes Secret ç®¡ç†çš„è¯ä¹¦å’Œå¯†é’¥å¯¹å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ipvlan-æ”¯æŒæµ‹è¯•ç‰ˆ&#34;&gt;IPVLAN æ”¯æŒï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/h2&gt;
&lt;p&gt;æ·»åŠ äº†ä¸€ç§æ–°çš„åŸºäº IPVLAN çš„æ•°æ®è·¯å¾„æ¨¡å¼ã€‚ä¸åŸºäº veth çš„ä½“ç³»ç»“æ„ç›¸æ¯”ï¼ŒIPVLAN å…·æœ‰ä½å»¶è¿Ÿä¼˜åŠ¿ã€‚ä½¿ç”¨ netperf åœ¨ 3.40Ghz Xeon ä¸Šçš„ä¸¤ä¸ªæœ¬åœ°å®¹å™¨ä¹‹é—´æµ‹é‡äº†ä»¥ä¸‹åŸºå‡†æµ‹è¯•ï¼Œå¹¶ä½¿ç”¨å•æ ¸ç¦ç”¨è¶…çº¿ç¨‹ã€‚ä¸ veth ç›¸æ¯”ï¼ŒIPVLAN çš„ P99 å»¶è¿Ÿç›¸å¯¹è¾ƒä½ï¼ˆè¶Šä½è¶Šå¥½ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ipvlan-æ€§èƒ½-å»¶è¿Ÿ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;IPVLAN æ€§èƒ½ (å»¶è¿Ÿ)&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05ygz1tuxj20wa0iu3yo_hu_4bd8c83c0cd1b3b8.webp 400w,
               /blog/cilium-1-4/61411417ly1g05ygz1tuxj20wa0iu3yo_hu_afed674c24db515f.webp 760w,
               /blog/cilium-1-4/61411417ly1g05ygz1tuxj20wa0iu3yo_hu_3ad9146af94d4b3f.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05ygz1tuxj20wa0iu3yo_hu_4bd8c83c0cd1b3b8.webp&#34;
               width=&#34;760&#34;
               height=&#34;443&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      IPVLAN æ€§èƒ½ (å»¶è¿Ÿ)
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;IPVLAN å’Œ veth ä¹‹é—´çš„æœ€å¤§ååé‡ï¼ˆè¶Šé«˜è¶Šå¥½ï¼‰éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯é€šè¿‡ä»å†…æ ¸ç¼–è¯‘ netfilter/iptables å¯ä»¥å®ç°éå¸¸æ˜¾ç€çš„æ€§èƒ½æå‡ã€‚å¦‚æœæ‚¨ä¸ä½¿ç”¨ NodePort æœåŠ¡å¹¶ä¸”åœ¨ç¦»å¼€ Kubernete worker node æ—¶ä¸éœ€è¦ä¼ªè£…ç½‘ç»œæµé‡ï¼Œåˆ™å·²ç»å¯ä»¥å®Œå…¨è¿è¡Œæ‚¨çš„ Kubernetes é›†ç¾¤ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„å‡ å‘¨å†…æä¾›æœ‰å…³å¦‚ä½•è¿è¡Œ iptables å’Œ kube-proxy çš„æŒ‡å—ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ipvlan-æ€§èƒ½&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;IPVLAN æ€§èƒ½&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkwgobj20gs0abdfq_hu_ac86a7d18487f97b.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkwgobj20gs0abdfq_hu_67f5e93c70431f78.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkwgobj20gs0abdfq_hu_8b049bcac372b8bd.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkwgobj20gs0abdfq_hu_ac86a7d18487f97b.webp&#34;
               width=&#34;604&#34;
               height=&#34;371&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      IPVLAN æ€§èƒ½
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;IPVLAN æ˜¯ 1.4 ä¸­çš„ beta çº§åŠŸèƒ½ï¼Œæœ‰å…³å¦‚ä½•å¯ç”¨å’Œé…ç½®è¯¥åŠŸèƒ½çš„è¯´æ˜ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://docs.cilium.io/en/v1.4/gettingstarted/ipvlan/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IPVLAN å…¥é—¨æŒ‡å—&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;h2 id=&#34;dnsè¯·æ±‚å“åº”çš„å®‰å…¨æ€§å’Œå¯è§æ€§&#34;&gt;DNSè¯·æ±‚/å“åº”çš„å®‰å…¨æ€§å’Œå¯è§æ€§&lt;/h2&gt;
&lt;p&gt;Cilium 1.4 æ‰©å±•äº†ç°æœ‰çš„ DNS å®‰å…¨ç­–ç•¥æ¨¡å‹ï¼Œä»¥äº†è§£å„ä¸ª pod å‘å‡ºçš„ DNS è¯·æ±‚ä»¥åŠå®ƒä»¬æ”¶åˆ°çš„ DNS å“åº”ã€‚è¿™æ˜¾ç€æé«˜äº†è®¿é—®é›†ç¾¤å¤–éƒ¨æœåŠ¡çš„ pod çš„å®‰å…¨æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æ‰§è¡Œ DNS æŸ¥æ‰¾æ—¶ï¼Œå¯ä»¥å°† Pod é™åˆ¶ä¸ºå…·æœ‰æœ€å°æƒé™ï¼Œå³ pod å¯ä»¥ä»…é™äºæŸ¥æ‰¾åŒ¹é…æ¨¡å¼çš„ DNS åç§°ï¼Œä¾‹å¦‚ &lt;code&gt;*.domain.com&lt;/code&gt; ã€‚ä»»ä½•è¶…å‡ºå…è®¸æ¨¡å¼çš„è¯·æ±‚éƒ½å°†æ”¶åˆ° &lt;code&gt;request refused&lt;/code&gt; DNS å“åº”ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DNS æŸ¥æ‰¾åçš„é€šä¿¡å¯ä»¥é™åˆ¶ä¸ºç‰¹å®š pod æ¥æ”¶çš„ DNS å“åº”ä¸­è¿”å›çš„ IP åœ°å€ã€‚è¿™æ˜¾ç€é™ä½äº†å—æŸåº”ç”¨ç¨‹åºçš„æƒé™ï¼Œå¹¶æé«˜äº†åŸºäº DNS çš„ç­–ç•¥è§„åˆ™çš„å¯é æ€§ï¼Œå› ä¸ºæ‰§è¡Œé€»è¾‘ä¸å†éœ€è¦çŸ¥é“ DNS åç§°å¯ä»¥æ˜ å°„åˆ°çš„æ‰€æœ‰å¯èƒ½çš„ IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ç‰¹åˆ«æ˜¯å¯¹äºäº‘ä¾›åº”å•†æä¾›çš„æµè¡Œå­˜å‚¨ï¼Œæ¶ˆæ¯ä¼ é€’å’Œæ•°æ®åº“æœåŠ¡ï¼Œå•ä¸ª DNS åç§°å¯ä»¥æ˜ å°„åˆ°æ•°ç™¾æˆ–æ•°åƒä¸ª IP åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç°åœ¨å¯ä»¥é€šè¿‡ API è®¿é—®çš„ Cilium æˆæƒæ—¥å¿—è®°å½•å±‚è®°å½• DNS æŸ¥æ‰¾å’Œå“åº”ã€‚è¿™æä¾›äº† pod æ‰§è¡Œçš„æ¯ä¸ª DNS è¯·æ±‚å’Œå“åº”çš„ç²¾ç¡®æ—¥å¿—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-dns&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;DNS&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmku6whj217i09c3yk_hu_e940db6deeee1251.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmku6whj217i09c3yk_hu_cd8a82d507cae6ee.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmku6whj217i09c3yk_hu_a8159b922451088d.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmku6whj217i09c3yk_hu_e940db6deeee1251.webp&#34;
               width=&#34;760&#34;
               height=&#34;163&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      DNS
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹æ˜¾ç¤ºäº†ä¸€ä¸ªæˆåŠŸçš„ DNS åºåˆ—ï¼Œç„¶åæ˜¯ DNS æœåŠ¡å™¨å“åº”çš„å¯¹ IP çš„ HTTP è¯·æ±‚ã€‚è¿™æ˜¯åº”ç”¨ç¨‹åºçš„è¡Œä¸ºæ–¹å¼å’Œå…è®¸çš„æ–¹å¼ã€‚åç»­ HTTP è¯·æ±‚å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„ DNS ä¿¡æ¯ï¼Œå…è®¸æ­¤ç±»è¯·æ±‚ã€‚DNS ä¿¡æ¯å°†æ ¹æ®è®°å½•ä¸­çš„ TTL ä¿¡æ¯è¶…æ—¶ã€‚&lt;/p&gt;
&lt;p&gt;å³ä¾§æ˜¯åº”ç”¨ç¨‹åºåœ¨å…è®¸çš„ DNS ç­–ç•¥ä¹‹å¤–æ‰§è¡Œ DNS æŸ¥æ‰¾çš„åºåˆ—ã€‚å®ƒè¿˜æ˜¾ç¤ºï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ— æ³•æ‰§è¡Œ DNS æŸ¥æ‰¾ï¼Œåˆ™åœ¨åº”ç”¨ç¨‹åºæ— æ³•åœ¨ä»¥ä¸‹ä½ç½®æŸ¥æ‰¾ DNS åç§°æ—¶ï¼Œå³ä½¿ IP åœ°å€å®é™…æ˜ å°„åˆ°å…è®¸çš„ DNS åç§°ï¼Œä¹Ÿä¼šé˜»æ­¢ä»»ä½•å°è¯•è”ç³» IP åœ°å€çš„å°è¯•ã€‚ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç­–ç•¥ç¤ºä¾‹&#34;&gt;ç­–ç•¥ç¤ºä¾‹&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cilium.io/v2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumNetworkPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;egress-domain-wildcard&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;endpointSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;myService&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;egress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;toEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#39;k8s:io.kubernetes.pod.namespace&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kube-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s-app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kube-dns&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;53&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;UDP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dns&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchPattern&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*.domain.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;toFQDNs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchPattern&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*.domain.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;443&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°ç­–ç•¥ç¤ºä¾‹æˆäºˆ pod æˆ–å®¹å™¨é€šè¿‡ kube-dns æ‰§è¡Œ DNS è¯·æ±‚çš„æƒé™ï¼Œä½†å°†å…è®¸çš„ DNS æŸ¥æ‰¾é™åˆ¶ä¸º &lt;code&gt;*.domain.com&lt;/code&gt; ã€‚ä¸æ¨¡å¼ä¸åŒ¹é…çš„è¯·æ±‚å°†æ”¶åˆ° &lt;code&gt;request refused&lt;/code&gt; DNS å“åº”ã€‚å®ƒè¿›ä¸€æ­¥æˆäºˆç«¯å£ 443/TCP ä¸Šçš„ pod å‡ºå£è®¿é—®æƒé™åˆ° DNS å“åº”ä¸­è¿”å›çš„ IPã€‚ä»»ä½•å°è¯•è®¿é—®å…ˆå‰æœªåœ¨ DNS å“åº”ä¸­è¿”å›çš„ä»»ä½• IP åœ°å€çš„è¯·æ±‚éƒ½å°†è¢«æ‹’ç»ã€‚&lt;/p&gt;
&lt;p&gt;è¦å¼€å§‹ä½¿ç”¨åŸºäº DNS çš„ç­–ç•¥ï¼Œè¯·éµå¾ª &lt;a href=&#34;https://docs.cilium.io/en/v1.4/gettingstarted/dns/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŸºäº DNS çš„å…¥é—¨æŒ‡å—&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€æ˜åŠ å¯†å’Œèº«ä»½éªŒè¯æµ‹è¯•ç‰ˆ&#34;&gt;é€æ˜åŠ å¯†å’Œèº«ä»½éªŒè¯ï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/h2&gt;
&lt;p&gt;ä¸ºé›†ç¾¤å†…å’Œé›†ç¾¤ä¹‹é—´çš„æ‰€æœ‰æœåŠ¡åˆ°æœåŠ¡é€šä¿¡æä¾›é€æ˜åŠ å¯†æ˜¯ä¸€ç§ç»å¸¸è¢«è¦æ±‚çš„åŠŸèƒ½ã€‚åŠ å¯†å…è®¸åœ¨ä¸å—ä¿¡ä»»çš„ç½‘ç»œä¸­è¿è¡Œ Kubernetesï¼Œé€æ˜åœ°åŠ å¯†é›†ç¾¤ä¸­æœåŠ¡ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡ã€‚èº«ä»½éªŒè¯å¯ç¡®ä¿åªæœ‰å—ä¿¡ä»»çš„å·¥ä½œèŠ‚ç‚¹æ‰èƒ½å‚ä¸é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŠ å¯†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŠ å¯†&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkyg5yj20w80dijrg_hu_ef54f6784f2a1afd.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkyg5yj20w80dijrg_hu_be6867d4081c5732.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkyg5yj20w80dijrg_hu_2eea172ac3e291a0.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkyg5yj20w80dijrg_hu_ef54f6784f2a1afd.webp&#34;
               width=&#34;760&#34;
               height=&#34;318&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŠ å¯†
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åŠ å¯†åŸºäº X.509 è¯ä¹¦å’Œå¯†é’¥ã€‚ç›®å‰ï¼Œä½¿ç”¨ PSKï¼Œä½¿ç”¨ Kubernetes Secret åˆ†å‘ç»™æ‰€æœ‰èŠ‚ç‚¹ã€‚ä½†æ˜¯ï¼ŒåŸºç¡€ç»“æ„ä¸ SPIFFE å…¼å®¹ï¼Œå¹¶å…è®¸åœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­åœ¨æ¯ä¸ªæœåŠ¡çº§åˆ«ä¸Šä½¿ç”¨ SPIFFE è¯ä¹¦æä¾›æœåŠ¡èº«ä»½éªŒè¯ã€‚æ•°æ®è·¯å¾„å®ç°ä½¿ç”¨ Linux å†…æ ¸çš„ IPSec å®ç°ï¼Œå®ƒé¿å…äº†ä½œä¸ºæ‰€æœ‰æœåŠ¡çš„ä¸€éƒ¨åˆ†è¿è¡Œ sidecar ä»£ç†çš„éœ€è¦ï¼Œå¹¶ç¡®ä¿é€šè¿‡ç°ä»£å¤„ç†å™¨ä¸­çš„ä¸“ç”¨ CPU æŒ‡ä»¤é›†æœ‰æ•ˆå’Œè‡ªåŠ¨åœ°ä½¿ç”¨ç¡¬ä»¶è¾…åŠ©åŠ å¯†åŠ é€Ÿã€‚&lt;/p&gt;
&lt;p&gt;é€æ˜åŠ å¯†æ˜¯ä¸€ç§ beta çº§åŠŸèƒ½ã€‚è¦å¯ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å°† &lt;code&gt;--enable-ipsec&lt;/code&gt; é€‰é¡¹ä¼ é€’ç»™ä»£ç†ï¼Œå¹¶é€šè¿‡ &lt;code&gt;--ipsec-key-file&lt;/code&gt; é€‰é¡¹æˆ–ä½¿ç”¨ Kubernetes Secret æä¾›é¢„å…±äº«å¯†é’¥ï¼ˆPSKï¼‰ ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºäº-sockmap-bpf-çš„-sidecar-åŠ é€Ÿalpha&#34;&gt;åŸºäº Sockmap BPF çš„ sidecar åŠ é€Ÿï¼ˆalphaï¼‰&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚&lt;a href=&#34;https://www.youtube.com/watch?v=ER9eIXL2_14&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ KubeCon ä¸Šå®£å¸ƒçš„é‚£æ ·&lt;/a&gt; ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Cilium 1.4 è¿›è¡Œæœ¬åœ°è¿›ç¨‹é€šä¿¡åŠ é€Ÿã€‚&lt;/p&gt;
&lt;p&gt;Sockmap åŠ é€Ÿæœ¬åœ°è¿›ç¨‹é€šä¿¡ä¸»è¦ç”¨äº sidecar ä»£ç†å’Œæœ¬åœ°è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œä½†é€‚ç”¨äºæ‰€æœ‰æœ¬åœ°è¿›ç¨‹ã€‚ 















&lt;figure  id=&#34;figure-sockmap-åŠ é€Ÿäº†å»¶è¿Ÿ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;SockMap åŠ é€Ÿäº†å»¶è¿Ÿ&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_b3dcd470719edb61.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_99c4a33a411437a5.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_95162ba5fe864bac.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_b3dcd470719edb61.webp&#34;
               width=&#34;760&#34;
               height=&#34;454&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      SockMap åŠ é€Ÿäº†å»¶è¿Ÿ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¯ç”¨ sockmap æ—¶ï¼Œè¯·æ±‚æ•°/s å’Œæœ€å¤§ååé‡éƒ½åŠ å€ï¼š 















&lt;figure  id=&#34;figure-sockmap-åŠ é€Ÿäº†è¯·æ±‚å¤„ç†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;SockMap åŠ é€Ÿäº†è¯·æ±‚å¤„â€‹â€‹ç†&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkb7mbj20w20j00su_hu_b115ed91deb8bb18.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkb7mbj20w20j00su_hu_1e6d446073dad646.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkb7mbj20w20j00su_hu_4053b7fa2dc8efcd.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkb7mbj20w20j00su_hu_b115ed91deb8bb18.webp&#34;
               width=&#34;760&#34;
               height=&#34;451&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      SockMap åŠ é€Ÿäº†è¯·æ±‚å¤„â€‹â€‹ç†
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-sockmap-åŠ é€Ÿäº†ååé‡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;SockMap åŠ é€Ÿäº†ååé‡&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_121bcf7dc3314f63.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_8886913a347392a5.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_c67e6e4ed16f5b8c.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_121bcf7dc3314f63.webp&#34;
               width=&#34;579&#34;
               height=&#34;343&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      SockMap åŠ é€Ÿäº†ååé‡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œæ‰€æœ‰è¿™äº›æ€§èƒ½æ•°å­—å‡ä¸ºæ¯ä¸ª CPU æ ¸å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;Sockmap åŠ é€Ÿæ˜¯ 1.4 ä¸­çš„ alpha çº§åˆ«åŠŸèƒ½ã€‚å¯ä»¥ä½¿ç”¨è¯¥ &lt;code&gt;--sockops-enable&lt;/code&gt; é€‰é¡¹å¯ç”¨å®ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–°-grafana-ä»ªè¡¨æ¿&#34;&gt;æ–° Grafana ä»ªè¡¨æ¿&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-grafana&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Grafana&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmjnwpaj22fu0jywfi_hu_b6ed400f84293257.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmjnwpaj22fu0jywfi_hu_189387240c5cc335.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmjnwpaj22fu0jywfi_hu_99d7112368a3b69f.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmjnwpaj22fu0jywfi_hu_b6ed400f84293257.webp&#34;
               width=&#34;760&#34;
               height=&#34;173&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Grafana
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ·»åŠ äº†å‡ ä¸ªæ–°çš„ Prometheus æŒ‡æ ‡ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨å•ä¸ªå‘½ä»¤å°†æ–°çš„ Grafana ä»ªè¡¨æ¿éƒ¨ç½²åˆ°ä»»ä½• Kubernetes é›†ç¾¤ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/cilium/cilium/v1.4/examples/kubernetes/addons/prometheus/monitoring-example.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  id=&#34;figure-grafana&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Grafana&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmjiv1kj22f40z6di3_hu_b5514b474aa7487c.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmjiv1kj22f40z6di3_hu_ddbdc1809e18ecaf.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmjiv1kj22f40z6di3_hu_422cbc4352b3b0cc.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmjiv1kj22f40z6di3_hu_b5514b474aa7487c.webp&#34;
               width=&#34;760&#34;
               height=&#34;307&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Grafana
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;flannel-æ•´åˆæµ‹è¯•ç‰ˆ&#34;&gt;Flannel æ•´åˆï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/h2&gt;
&lt;p&gt;ä¸ä½¿ç”¨ Flannel CNI æ’ä»¶é…ç½®çš„ç°æœ‰é›†ç¾¤çš„ Cilium çš„å®‰å…¨ç­–ç•¥å®æ–½å’Œè´Ÿè½½å¹³è¡¡åŠŸèƒ½çš„ç”¨æˆ·ç»å¸¸è¦æ±‚ä¸ Flannel é›†æˆã€‚&lt;/p&gt;
&lt;p&gt;Cilium 1.4 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é…ç½®é€‰é¡¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;flannel-master-device&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cni0&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä½¿å¾— Cilium å¯ä»¥ä½¿ç”¨ CNI é“¾æ¥åœ¨ flannel ä¸Šè¿è¡Œã€‚é€šè¿‡å¯ç”¨ä»¥ä¸‹é€‰é¡¹ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨è·å–å·¥ä½œèŠ‚ç‚¹ä¸Šçš„ç°æœ‰å®¹å™¨/å®¹å™¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;flannel-manage-existing-containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥é€‰é¡¹è¿˜éœ€è¦ç¼–è¾‘ Cilium DaemonSet ä»¥å¯ç”¨è¯¥ &lt;code&gt;hostPID: true&lt;/code&gt; é€‰é¡¹ï¼Œä»¥ä¾¿ Cilium å¯ä»¥æŸ¥çœ‹é™„åŠ åˆ°ç°æœ‰å®¹å™¨çš„æ‰€æœ‰è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;Flannel é›†æˆä¸»è¦ç”¨äºåœ¨ç°æœ‰é›†ç¾¤ä¸­å°è¯• Cilium åŠŸèƒ½æˆ–ç”¨äºè¿ç§»ç›®çš„ã€‚æœ‰äº›å¤§è§„æ¨¡æœ‰ç”¨çš„åŠŸèƒ½å°†æ— æ³•è¿è¡Œï¼Œè¿™åŒ…æ‹¬å°†æºçš„å®‰å…¨èº«ä»½åµŒå…¥ç½‘ç»œæ•°æ®åŒ…çš„èƒ½åŠ›ï¼Œè¿™éœ€è¦å›é€€åˆ°åŸºäº IP çš„è¯†åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://docs.cilium.io/en/v1.4/gettingstarted/flannel-integration/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;flannel å…¥é—¨æŒ‡å—&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä¸å…¶ä»–-cni-çš„åŸºå‡†æµ‹è¯•&#34;&gt;ä¸å…¶ä»– CNI çš„åŸºå‡†æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;åœ¨è¿‡å»çš„ä¸¤ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦è¿‡å¾ˆå¤š Cilium ä¸å…¶ä»– CNI æ’ä»¶çš„æ¯”è¾ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬é’ˆå¯¹å…¶ä»–æµè¡Œçš„ CNI æ’ä»¶è¿è¡Œäº†å‡ ä¸ªåŸºå‡†æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬è¿›å…¥å®é™…æ•°å­—ä¹‹å‰çš„ä¸¤ä¸ªå•è¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºå‡†æµ‹è¯•å¾ˆéš¾ã€‚æˆ‘ä»¬å¹¶æœªå£°ç§°æˆ‘ä»¬å¯ä»¥åœ¨ç†æƒ³é…ç½®ä¸­é…ç½®å…¶ä»– CNI æ’ä»¶ã€‚å¦‚æœæ‚¨æœ‰æ„è§ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¾ˆä¹æ„è¿›è¡Œè°ƒæ•´ã€‚è¿™äº›åŸºå‡†æµ‹è¯•çš„ç›®æ ‡æ˜¯è¡¨æ˜ï¼Œé€šè¿‡æ”¹å˜æ¶æ„å’Œåœ¨å †æ ˆä¸­ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯ï¼Œè€Œä¸æ˜¯ä»…ä»…å°†ä¸€ä¸ª CNI ä¸å¦ä¸€ä¸ª CNI è¿›è¡Œæ¯”è¾ƒï¼Œå¯ä»¥äº§ç”Ÿæœ€å¤§çš„å½±å“ã€‚å³ä½¿æ˜¯ Ciliumï¼Œå…¶æ€§èƒ½ä¹Ÿä¼šå› é…ç½®è€Œå¼‚ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ä¸“æ³¨äºæµ‹é‡ç½‘ç»œå¼€é”€ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ä¸¤ä¸ªæœ¬åœ°å®¹å™¨ä¹‹é—´è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼Œä»¥å°½å¯èƒ½å¤šåœ°æ¶ˆé™¤ç¡¬ä»¶é™åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;ç›®æ ‡ä¸æ˜¯è¾¾åˆ°æœ€å¤§æˆ–æœ€ä½çš„æ•°é‡ã€‚æˆ‘ä»¬ä½¿ç”¨å•ä¸ª CPU æ ¸å¿ƒè¿›è¡Œæµ‹é‡ï¼Œé™åˆ¶ CPU çš„æ•°é‡ã€‚ç³»ç»Ÿçš„ CPU è¶Šå¤šé‚£ä¹ˆä¸Šé™å¯èƒ½ä¼šæ›´é«˜ã€‚è€Œæˆ‘ä»¬å…³æ³¨åœ¨å•æ ¸ä¸‹æ•°å­—ä¹‹é—´çš„å·®å¼‚ï¼Œè€Œä¸æ˜¯æµ‹è¯•ç»“æœæ•°çš„æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;li&gt;é€šå¸¸é‡‡å–å‡ ä¸ªé‡ç‚¹æ¥åšåŸºå‡†ã€‚åŸºå‡†æµ‹è¯•æ€»æ˜¯åœ¨ç‰¹å®šçš„ç¯å¢ƒä¸­å®Œæˆã€‚ç†è§£ä¸Šä¸‹æ–‡å¾ˆé‡è¦ã€‚å¦‚æœæ‚¨ä¸æ¸…æ¥šæˆ‘ä»¬åœ¨è¿™é‡Œå‘å¸ƒçš„æ•°å­—ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šæ¾„æ¸…å®ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯´äº†é‚£ä¹ˆå¤šï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶æ•°å­—ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cni-å»¶è¿Ÿ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;CNI å»¶è¿Ÿ&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkgwo1j20fz09ta9z_hu_bcb27ae78e6da604.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkgwo1j20fz09ta9z_hu_c79cbb5d5b9bf95d.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkgwo1j20fz09ta9z_hu_a910feabbdde3cea.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkgwo1j20fz09ta9z_hu_bcb27ae78e6da604.webp&#34;
               width=&#34;575&#34;
               height=&#34;353&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      CNI å»¶è¿Ÿ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»¥ä¸Šæ•°å­—æ˜¾ç¤ºäº†ä¸¤ä¸ªå®¹å™¨åœ¨å•ä¸ªè¿æ¥ä¸Šäº¤æ¢å°½å¯èƒ½å¤šçš„ 1 å­—èŠ‚è¯·æ±‚å’Œå“åº”æ¶ˆæ¯æ—¶çš„å„ç§å»¶è¿Ÿæµ‹é‡ã€‚æ­¤æµ‹è¯•ä¸»è¦æ˜¾ç¤ºç‰¹å®šè½¬å‘è·¯å¾„æ˜¯å¦éå¸¸æœ‰åˆ©äºååé‡è€Œéå»¶è¿Ÿã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cilium Sockmap æ­£åœ¨å¤§åŠ›åˆ©ç”¨å…¶èƒ½å¤Ÿåœ¨å¥—æ¥å­—çº§åˆ«ä¸Šè¿è¡Œçš„ä¼˜åŠ¿ã€‚è¿™ä»…é€‚ç”¨äºèŠ‚ç‚¹å†…çš„è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;ä¸‹ä¸€ä¸ªæœ€ä½³ç±»åˆ«æ˜¯åœ¨ IPVLAN æ¨¡å¼ä¸‹è¿è¡Œçš„ Ciliumï¼Œnetfilter/iptables å·²å®Œå…¨åˆ é™¤ã€‚Cilium æ˜¯å¦åœ¨åŠ è½½å®‰å…¨ç­–ç•¥è§„åˆ™æ—¶è¿è¡Œæ˜¯æœ‰åŒºåˆ«çš„ï¼Œä½†è¿™ç§å·®å¼‚å¾ˆå°ã€‚è¿™æ˜¯å› ä¸ºç”¨äºç­–ç•¥å®æ–½çš„é«˜æ•ˆçš„æ¯ CPU å“ˆå¸Œè¡¨å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å¼€é”€ã€‚è¯·æ³¨æ„ï¼Œæ­¤æ•°å­—å·²åŒ…å«è´Ÿè½½å¹³è¡¡ BPF æ˜ å°„æŸ¥æ‰¾ï¼Œå› æ­¤æ­¤æ¨¡å¼å…è®¸æ›¿æ¢å…¶ä»–æµ‹è¯•æœªè€ƒè™‘çš„ kube-proxyã€‚&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥æ˜¯ Flannel å’Œ Cilium ä»¥ veth æ¨¡å¼è¿è¡Œã€‚Flannel æ˜¯ä¸€ä¸ªä½¿ç”¨ Linux è·¯ç”±è¡¨çš„æœ€å°ç½‘ç»œæ’ä»¶ã€‚æç®€ä¸»ä¹‰å¾—åˆ°äº†å›æŠ¥ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€ flannel ä¸èƒ½æ‰§è¡Œä»»ä½•ç­–ç•¥æ‰§è¡Œï¼Œå¹¶ä¸”å¿…é¡»ä¾èµ–äº iptables æˆ– IPVS æ¨¡å¼çš„ kube-proxyã€‚ç”±äºæ‰§è¡Œäº†ä¸€äº›å·¥ä½œä»¥åœ¨è¿æ¥è¿‡ç¨‹ä¸­å¯ç”¨ç­–ç•¥å®æ–½ï¼Œå³ä½¿ä¹‹å‰æœªåŠ è½½ä»»ä½•ç­–ç•¥è§„åˆ™ï¼ŒCilium ä¹Ÿä¼šç•¥å¾®æ¶åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;Calico åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­æ˜¾ç¤ºå‡ºç•¥å¾®å¢åŠ çš„å¼€é”€ã€‚å¯èƒ½ç”±äºæ·»åŠ äº†æ›´å¤šçš„ iptables è§„åˆ™å¹¶ä¸”æ­£åœ¨ä½¿ç”¨æ›´å¤šçš„ netfilter é“¾ã€‚æˆ‘ä»¬æ²¡æœ‰ä¸ºæ­¤ç‰¹å®šæµ‹è¯•åŠ è½½ä»»ä½•ç­–ç•¥è§„åˆ™åˆ° Calico ä½†æ˜¯å‡è®¾ä½¿ç”¨ ipset å°†å…è®¸ç¼©æ”¾ OKã€‚ä¸å¦‚æ¯ä¸ª CPU å“ˆå¸Œè¡¨å¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™äº›åŸºå‡†æµ‹è¯•çš„å…¸å‹æ•Œäººæ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸Šä¸‹æ–‡åœ¨å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´åˆ‡æ¢ã€‚è¿™äº›æ•°å­—ä¼šç”±äº &lt;strong&gt;å¾ˆå¤š&lt;/strong&gt; å½“L4/L7ä»£ç†ä¼šç°å®çš„æ›´ç³Ÿã€‚&lt;/li&gt;
&lt;li&gt;ä»»ä½•æ¯ä¸ªæ•°æ®åŒ…å¼€é”€éƒ½ä¼šäº§ç”Ÿå·¨å¤§å½±å“ã€‚å†·ç¼“å­˜å’Œæ•°æ®ç»“æ„ä¹Ÿä¼šäº§ç”Ÿè´Ÿé¢å½±å“ã€‚å¿…é¡»éå†çš„ä»£ç è¶Šå°‘è¶Šå¥½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cni-rr&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;CNI RR&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_b3dcd470719edb61.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_99c4a33a411437a5.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_95162ba5fe864bac.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkn6wfj20vs0j0glt_hu_b3dcd470719edb61.webp&#34;
               width=&#34;760&#34;
               height=&#34;454&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      CNI RR
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾æ˜¾ç¤ºäº†æ‰§è¡Œç›¸åŒåŸºå‡†æµ‹è¯•çš„æ¯ç§’è¯·æ±‚æ•°ã€‚æ¯ç§’è¯·æ±‚ä¸å»¶è¿Ÿç›¸å½“é‡å ã€‚å¯¹äºä¹‹å‰çš„æµ‹è¯•ï¼Œè¿™äº›æ•°å­—æ˜¯æŒ‰ CPU æ ¸å¿ƒæµ‹é‡çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cni-stream&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;CNI Stream&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmjsdpnj20wk0iuaa4_hu_3f6a241e5d91472c.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmjsdpnj20wk0iuaa4_hu_1399a28bf196520.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmjsdpnj20wk0iuaa4_hu_b34d186c3a3468a1.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmjsdpnj20wk0iuaa4_hu_3f6a241e5d91472c.webp&#34;
               width=&#34;760&#34;
               height=&#34;439&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      CNI Stream
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ€åä¸€å¼ å›¾è¯´æ˜äº†é¢‘è°±çš„ç›¸åæƒ…å†µã€‚TCP_STREAM æµ‹è¯•è¯•å›¾é€šè¿‡å•ä¸ª TCP è¿æ¥æŠ½å–å°½å¯èƒ½å¤šçš„å­—èŠ‚ã€‚è¿™æ˜¯å†…å­˜å¸¦å®½å¯ä»¥å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œç½‘ç»œç¡¬ä»¶æˆ–äº‘ä¾›åº”å•†é™åˆ¶é€šå¸¸å¯ä»¥äººä¸ºåœ°é™åˆ¶åŸºå‡†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æŠ›å¼€ Sockmap çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° IPVLAN æ¨¡å¼æ¯”å…¶ä»–æ‰€æœ‰æ¨¡å¼éƒ½æœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬é¢„è®¡ Calico ä¸ Cilium çš„æ•°å­—ç›¸ä¼¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½ä¼šé”™è¯¯åœ°é…ç½®ä¸€äº›ä¸œè¥¿ã€‚ä»»ä½•å¸®åŠ©è¡¨ç¤ºèµèµã€‚Calico åœ¨ TCP_STREAM ä¸­è¡¨ç°æ›´å·®å¹¶æ²¡æœ‰å¤šå¤§æ„ä¹‰ï¼Œå› ä¸ºæ­¤æµ‹è¯•ä¸­çš„ iptables å¼€é”€åœ¨å¤§é‡æ•°æ®ä¸­åˆ†æ‘Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¸¦æœ‰-sockmap-çš„-cni-stream&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¸¦æœ‰ SockMap çš„ CNI Stream&#34; srcset=&#34;
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_121bcf7dc3314f63.webp 400w,
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_8886913a347392a5.webp 760w,
               /blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_c67e6e4ed16f5b8c.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-1-4/61411417ly1g05xmkrc2cj20g309jgli_hu_121bcf7dc3314f63.webp&#34;
               width=&#34;579&#34;
               height=&#34;343&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¸¦æœ‰ SockMap çš„ CNI Stream
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å°† Sockmap æ·»åŠ å›å›¾ç‰‡è¯æ˜äº†åœ¨å¥—æ¥å­—çº§åˆ«è¿›è¡Œç½‘ç»œè¿æ¥çš„æ€§èƒ½ä¼˜åŠ¿ã€‚åŒæ ·ï¼Œè¿™ç§å¥½å¤„ä»…åœ¨æœ¬åœ°è¿›ç¨‹ä¹‹é—´è·å¾—ï¼Œå› ä¸ºå½“ sidecar ä»£ç†ç”Ÿæ•ˆæ—¶æˆ–è€…å½“æœåŠ¡è¢«è°ƒåº¦åˆ°åŒä¸€èŠ‚ç‚¹ä¸Šä»¥ä¾¿æ”¹è¿›æœ¬åœ°é€šä¿¡æ—¶ï¼Œå®ƒç»å¸¸å‘ç”Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”¨-cos-æ”¯æŒ-gke&#34;&gt;ç”¨ COS æ”¯æŒ GKE&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªå…¨æ–°çš„ &lt;a href=&#34;https://docs.cilium.io/en/v1.4/gettingstarted/k8s-install-gke/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŒ‡å—&lt;/a&gt; è®°å½•äº†å¦‚ä½•ä½¿ç”¨ COS åœ¨ GKE ä¸Šè¿è¡Œ Ciliumã€‚ä¸€ä¸ªå…¨æ–°çš„ &lt;a href=&#34;https://github.com/cilium/cilium/tree/master/examples/kubernetes/node-init&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;node-init DaemonSet&lt;/a&gt; å¯ä»¥é€šè¿‡å®‰è£… BPF æ–‡ä»¶ç³»ç»Ÿå¹¶é‡æ–°é…ç½® kubelet ä»¥åœ¨ CNI æ¨¡å¼ä¸‹è¿è¡Œæ¥å‡†å¤‡ GKE èŠ‚ç‚¹ã€‚ä½¿ç”¨ &lt;a href=&#34;https://github.com/cilium/cilium-etcd-operator&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cilium-etcd-operator&lt;/a&gt; æä¾› kvstore è¦æ±‚ï¼ŒåŒæ—¶ä¿æŒå®‰è£…ç®€å•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;14-å‘å¸ƒäº®ç‚¹&#34;&gt;1.4 å‘å¸ƒäº®ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¤šé›†ç¾¤&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¢åŠ å…¨çƒæœåŠ¡ï¼Œé€šè¿‡æ³¨é‡Šå®ç°è·¨å¤šä¸ª Kubernetes æœåŠ¡çš„ Kubernetes æœåŠ¡ã€‚ ï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/li&gt;
&lt;li&gt;è®¸å¤šæ”¹è¿›çš„å®‰è£…æŒ‡å—ï¼ŒåŒ…æ‹¬åœ¨ä½¿ç”¨ &lt;a href=&#34;https://github.com/cilium/cilium-etcd-operator&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cilium-etcd-operator&lt;/a&gt; æ—¶è‡ªåŠ¨æå– SSL è¯ä¹¦çš„å·¥å…·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€æ˜åŠ å¯†ï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å¸¦æœ‰PSKçš„IPsecå°†æ‰€æœ‰pod/hoståŠ å¯†åˆ°pod/hosté€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;IPv4 å’Œ IPv6&lt;/li&gt;
&lt;li&gt;PSK é€šè¿‡ Kubernetes Secret é…ç½®&lt;/li&gt;
&lt;li&gt;æ— éœ€ä¿®æ”¹ app æˆ– podã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;IPVLAN æ”¯æŒï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨ IPVLAN çš„æ–°çš„æ›¿ä»£æ•°æ®è·¯å¾„æ¨¡å¼å–ä»£äº† veth å¯¹çš„ä½¿ç”¨ï¼Œä»¥æ”¹å–„å»¶è¿Ÿå’Œæ€§èƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DNSè¯·æ±‚/å“åº”æˆæƒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ç°åœ¨ï¼ŒåŸºäºæ¯ä¸ªæœåŠ¡æ‰§è¡Œçš„å®é™… DNS è¯·æ±‚å’Œå“åº”ï¼Œå¼ºåˆ¶æ‰§è¡ŒåŸºäº FQDN çš„å®‰å…¨ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;èƒ½å¤ŸæŒ‡å®šæœåŠ¡å¯ä»¥æ‰§è¡Œçš„ DNS è¯·æ±‚çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨äºæŸ¥è¯¢å„ä¸ªç«¯ç‚¹æ‰§è¡Œçš„ FQDN ä¸»æœºåæŸ¥æ‰¾çš„ API å’Œ CLI&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿåœ¨ä»£ç†è¿˜åŸä¸Šæ¢å¤ FQDN æ˜ å°„ä»¥è¿›è¡ŒæŒä¹…æ˜ å°„&lt;/li&gt;
&lt;li&gt;æ¯ä¸ªç«¯ç‚¹å¯é…ç½®çš„æœ€å° TTL å’Œæœ€å¤§ FQDN ä¸»æœº&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;flannel æ•´åˆï¼ˆæµ‹è¯•ç‰ˆï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èƒ½å¤Ÿåœ¨ flannel ä¸Šè¿è¡Œ Ciliumã€‚Flannel æä¾›ç½‘ç»œï¼ŒCilium æä¾›è´Ÿè½½å¹³è¡¡å’Œç­–ç•¥å®æ–½ã€‚&lt;/li&gt;
&lt;li&gt;èƒ½å¤ŸæŒ‚é’©ç°æœ‰çš„ Flannel éƒ¨ç½²è€Œæ— éœ€é‡æ–°å¯åŠ¨ä»»ä½• podã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºäº AWS å…ƒæ•°æ®çš„ç­–ç•¥å®æ–½ï¼ˆalphaï¼‰&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;èƒ½å¤Ÿæ ¹æ® AWS å…ƒæ•°æ®æŒ‡å®šç­–ç•¥è§„åˆ™ï¼Œä¾‹å¦‚ EC2 æ ‡ç­¾ï¼Œå®‰å…¨ç»„åç§°ï¼ŒVPC åç§°ï¼Œå­ç½‘åç§°ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¶ä»–æŒ‡æ ‡å’Œç›‘æ§&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è”ç½‘&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ kvstore å®ç°æ–°çš„ç®€å• PodCIDR è·¯ç”±ä¼ æ’­æ¨¡å¼ã€‚é€šè¿‡ --auto-direct-node-routes`å¯ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨ï¼Œå¯¹äºæ–°å®‰è£…ï¼ŒIPv6 ç°åœ¨å·²ç¦ç”¨ã€‚ç°æœ‰çš„ ConfigMaps å°†ç»§ç»­å½“å‰è¡Œä¸ºã€‚å¯ç”¨é€šè¿‡ &lt;code&gt;--enable-ipv6=true&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨è¯¥ &lt;code&gt;--enable-ipv4=false&lt;/code&gt; é€‰é¡¹ åˆ†é…ä»»ä½• IPv4 åœ°å€çš„æƒ…å†µä¸‹è¿è¡Œä»… IPv6 é›†ç¾¤ã€‚&lt;/li&gt;
&lt;li&gt;æ”¹è¿›äº†è´Ÿè½½å‡è¡¡å™¨çš„æŒä¹…è¡Œä¸º&lt;/li&gt;
&lt;li&gt;BPF sockmap æ”¯æŒåŠ é€Ÿæœ¬åœ°è¿›ç¨‹é€šä¿¡ã€‚å¯é€šè¿‡é€‰é¡¹ &lt;code&gt;--sockops-enable&lt;/code&gt; ï¼ˆalphaï¼‰è·å¾—&lt;/li&gt;
&lt;li&gt;ä» IP åœ°å€è¯†åˆ«çš„è§£è€¦ç«¯ç‚¹ï¼Œä»¥æ”¯æŒä»»æ„ IP å¯»å€æ¨¡å‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆç‡å’Œè§„æ¨¡&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¤§å¤§æé«˜äº† CiliumEndpoint CRD çš„å¯æ‰©å±•æ€§ã€‚ä¸å†éœ€è¦ä¸ºå¤§å‹éƒ¨ç½²ç¦ç”¨ CEPã€‚&lt;/li&gt;
&lt;li&gt;å¼•å…¥åŸºäºCIDR/DNSçš„è§„åˆ™çš„æ¯èŠ‚ç‚¹æœ¬åœ°æ ‡è¯†ï¼Œä¸éœ€è¦é›†ç¾¤æˆ–å…¨å±€èŒƒå›´ã€‚åœ¨èŠ‚ç‚¹ 23 ä¸Šæ‰§è¡Œ DNS è¯·æ±‚çš„ pod å¯¼è‡´è¯¥ pod çš„ç™½åå• IP ä¸å†å¯¹é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹äº§ç”Ÿä»»ä½•å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ç¦ç”¨ IPv6 ä»¥å‡å°‘å°å‹éƒ¨ç½²ä¸­çš„å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨ï¼Œé»˜è®¤æƒ…å†µä¸‹ç¦ç”¨ BPF æ˜ å°„é¢„åˆ†é…ï¼Œä»¥å‡å°‘å°å‹éƒ¨ç½²ä¸­çš„å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨äºä»£ç†å’Œå®¢æˆ·ç«¯å‘½ä»¤çš„å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä»¥å‡å°‘å®¹å™¨å›¾åƒå¤§&lt;/li&gt;
&lt;li&gt;å°† bugtool ç¼–è¯‘ä¸ºé™æ€äºŒè¿›åˆ¶æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;æ–°çš„ cilium-operator æä¾›å•ä¾‹ä»»åŠ¡ï¼Œå¦‚ CEP åƒåœ¾æ”¶é›†ã€‚&lt;/li&gt;
&lt;li&gt;CNI ADD ä¸Šçš„åŒæ­¥ pod æ ‡ç­¾æ£€ç´¢ã€‚è¿™å¯ä»¥ç¨å¾®é™ä½ pod è°ƒåº¦é€Ÿç‡ï¼Œä½†é¿å…åœ¨æ²¡æœ‰ init ç­–ç•¥çš„æƒ…å†µä¸‹å¯åŠ¨ pod çš„ç­–ç•¥ä¸¢å¤±ã€‚&lt;/li&gt;
&lt;li&gt;çŠ¶æ€æ¢æµ‹å™¨ç°åœ¨åŒæ—¶æ”¶é›†çŠ¶æ€ä»¥æé«˜å‡†ç¡®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;ç»ˆæ­¢æ—¶æ›´å¥½çš„ä¿¡å·å¤„ç†å’Œæ–°çš„ terminationGracePeriodSeconds é»˜è®¤å€¼ä¸º 1 ç§’ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘ä»£ç†çš„åœæœºæ—¶é—´&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¢åŠ äº†å¯¹ Kubernetes 1.13 çš„æ”¯æŒ&lt;/li&gt;
&lt;li&gt;æ”¯æŒè‡ªåŠ¨æŒ‚è½½ BPF æ–‡ä»¶ç³»ç»Ÿçš„æ–° CRI-O ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;æ–°çš„ NodeInit DaemonSet ä¸º Cilium å®‰è£…è‡ªåŠ¨å‡†å¤‡ GKE èŠ‚ç‚¹ã€‚è¿™æ ·å¯ä»¥ä½¿ç”¨ COS å’Œè‡ªåŠ¨ç¼©æ”¾ã€‚&lt;/li&gt;
&lt;li&gt;å½“ cilium ä¸ç®¡ç† kube-dns æ—¶ï¼Œcilium-operator ç°åœ¨ä¼šè‡ªåŠ¨é‡å¯ kube-dnsã€‚è¿™ç®€åŒ–äº†æ‰˜ç®¡ Kubernetes äº§å“çš„åˆå§‹å®‰è£…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Istio&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ”¹è¿›äº† Istio é›†æˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è§‚æµ‹&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–°æŒ‡æ ‡ï¼škvstore æ“ä½œï¼Œä»£ç†ä¸Šæ¸¸/å¤„ç†å»¶è¿Ÿï¼Œè½¬å‘å’Œä¸¢å¼ƒå­—èŠ‚ï¼ŒèŠ‚ç‚¹äº‹ä»¶ï¼ŒèŠ‚ç‚¹æ•°ï¼Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ ‡å‡†å®‰è£…ç°åœ¨ä½¿ç”¨ &lt;a href=&#34;https://github.com/cilium/cilium-etcd-operator&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cilium-etcd-operator&lt;/a&gt; ï¼Œä¸å†ä¾èµ–äºæä¾›å¤–éƒ¨ kvstore çš„ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;li&gt;æ–°çš„ GKE æŒ‡å—ï¼ŒåŒ…æ‹¬ COS æ”¯æŒ&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ eksctl çš„ç®€åŒ– EKS æŒ‡å—&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·æ”¹è¿›äº†é›†ç¾¤ç½‘æ ¼æŒ‡å—&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‡çº§è¯´æ˜&#34;&gt;å‡çº§è¯´æ˜&lt;/h2&gt;
&lt;p&gt;åƒå¾€å¸¸ä¸€æ ·ï¼Œè¯·æŒ‰ç…§&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.4/install/upgrade/#upgrading-minor-versions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‡çº§æŒ‡å—&lt;/a&gt; å‡çº§æ‚¨çš„ Cilium éƒ¨ç½²ã€‚éšæ„åœ¨ &lt;a href=&#34;https://cilium.herokuapp.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack&lt;/a&gt; ä¸Š ping æˆ‘ä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‘å¸ƒ&#34;&gt;å‘å¸ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘è¡Œè¯´æ˜å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼š &lt;a href=&#34;https://github.com/cilium/cilium/releases/tag/1.4.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;1.4.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å®¹å™¨ imageï¼š &lt;code&gt;docker.io/cilium/cilium:v1.4.0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Ciliumâ€”â€”å…·å¤‡ API æ„ŸçŸ¥çš„ç½‘ç»œå’Œå®‰å…¨æ€§ç®¡ç†çš„å¼€æºè½¯ä»¶</title>
      <link>https://cloudnativecn.com/blog/cilium-intro/</link>
      <pubDate>Wed, 07 Nov 2018 14:14:01 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-intro/</guid>
      <description>&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªçº¯å¼€æºè½¯ä»¶ï¼Œæ²¡æœ‰å“ªå®¶å…¬å¸æä¾›å•†ä¸šåŒ–æ”¯æŒï¼Œä¹Ÿä¸æ˜¯ç”±æŸä¸€å…¬å¸å¼€æºï¼Œè¯¥è½¯ä»¶ç”¨äºé€æ˜åœ°ä¿æŠ¤ä½¿ç”¨ Linux å®¹å™¨ç®¡ç†å¹³å°ï¼ˆå¦‚ Docker å’Œ Kubernetesï¼‰éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæœåŠ¡ä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;Cilium çš„åŸºç¡€æ˜¯ä¸€ç§åä¸º BPF çš„æ–° Linux å†…æ ¸æŠ€æœ¯ï¼Œå®ƒå¯ä»¥åœ¨ Linux æœ¬èº«åŠ¨æ€æ’å…¥å¼ºå¤§çš„å®‰å…¨å¯è§æ€§å’Œæ§åˆ¶é€»è¾‘ã€‚ç”±äº BPF åœ¨ Linux å†…æ ¸ä¸­è¿è¡Œï¼Œå› æ­¤å¯ä»¥åº”ç”¨å’Œæ›´æ–° Cilium å®‰å…¨ç­–ç•¥ï¼Œè€Œæ— éœ€å¯¹åº”ç”¨ç¨‹åºä»£ç æˆ–å®¹å™¨é…ç½®è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cilium&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Cilium&#34; srcset=&#34;
               /blog/cilium-intro/006tNbRwly1fwqi98i51ij30sc0j80zn_hu_bee2c5fe72f0b97e.webp 400w,
               /blog/cilium-intro/006tNbRwly1fwqi98i51ij30sc0j80zn_hu_e21a5aaa73aca740.webp 760w,
               /blog/cilium-intro/006tNbRwly1fwqi98i51ij30sc0j80zn_hu_5c466adad917d6d0.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-intro/006tNbRwly1fwqi98i51ij30sc0j80zn_hu_bee2c5fe72f0b97e.webp&#34;
               width=&#34;760&#34;
               height=&#34;515&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Cilium
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åŸºäºå¾®æœåŠ¡çš„åº”ç”¨ç¨‹åºåˆ†ä¸ºå°å‹ç‹¬ç«‹æœåŠ¡ï¼Œè¿™äº›æœåŠ¡ä½¿ç”¨&lt;strong&gt;HTTP&lt;/strong&gt;ã€&lt;strong&gt;gRPC&lt;/strong&gt;ã€&lt;strong&gt;Kafka&lt;/strong&gt;ç­‰è½»é‡çº§åè®®é€šè¿‡ API ç›¸äº’é€šä¿¡ã€‚ä½†æ˜¯ï¼Œç°æœ‰çš„ Linux ç½‘ç»œå®‰å…¨æœºåˆ¶ï¼ˆä¾‹å¦‚ iptablesï¼‰ä»…åœ¨ç½‘ç»œå’Œä¼ è¾“å±‚ï¼ˆå³ IP åœ°å€å’Œç«¯å£ï¼‰ä¸Šè¿è¡Œï¼Œå¹¶ä¸”ç¼ºä¹å¯¹å¾®æœåŠ¡å±‚çš„å¯è§æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Cilium ä¸º Linux å®¹å™¨æ¡†æ¶ï¼ˆå¦‚&lt;a href=&#34;https://www.docker.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Docker&lt;/strong&gt;&lt;/a&gt;å’Œ&lt;a href=&#34;https://kubernetes.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Kubernetesï¼‰&lt;/strong&gt;&lt;/a&gt;å¸¦æ¥äº† API æ„ŸçŸ¥ç½‘ç»œå®‰å…¨è¿‡æ»¤ã€‚ä½¿ç”¨åä¸º&lt;strong&gt;BPF&lt;/strong&gt;çš„æ–° Linux å†…æ ¸æŠ€æœ¯ï¼ŒCilium æä¾›äº†ä¸€ç§åŸºäºå®¹å™¨/å®¹å™¨æ ‡è¯†å®šä¹‰å’Œå®æ–½ç½‘ç»œå±‚å’Œåº”ç”¨å±‚å®‰å…¨ç­–ç•¥çš„ç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨&lt;/strong&gt;ï¼šCilium ä¸­æ–‡æ„æ€æ˜¯â€œçº¤æ¯›â€œï¼Œå®ƒååˆ†ç»†å°è€Œåˆæ— å¤„ä¸åœ¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;bpf&#34;&gt;BPF&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;æŸå…‹è±å°åŒ…è¿‡æ»¤å™¨&lt;/strong&gt;ï¼ˆBerkeley Packet Filterï¼Œç¼©å†™ BPFï¼‰ï¼Œæ˜¯&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%B1%BBUnix&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç±» Unix&lt;/a&gt;ç³»ç»Ÿä¸Š&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°æ®é“¾è·¯å±‚&lt;/a&gt;çš„ä¸€ç§åŸå§‹æ¥å£ï¼Œæä¾›åŸå§‹é“¾è·¯å±‚&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E5%B0%81%E5%8C%85&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°åŒ…&lt;/a&gt;çš„æ”¶å‘ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœç½‘å¡é©±åŠ¨æ”¯æŒ&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%B4%AA%E6%B3%9B&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ´ªæ³›&lt;/a&gt;æ¨¡å¼ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥è®©ç½‘å¡å¤„äºæ­¤ç§æ¨¡å¼ï¼Œè¿™æ ·å¯ä»¥æ”¶åˆ°&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œ&lt;/a&gt;ä¸Šçš„æ‰€æœ‰åŒ…ï¼Œä¸ç®¡ä»–ä»¬çš„ç›®çš„åœ°æ˜¯ä¸æ˜¯æ‰€åœ¨&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E4%B8%BB%E6%A9%9F&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸»æœº&lt;/a&gt;ã€‚å‚è€ƒ&lt;a href=&#34;https://zh.wikipedia.org/wiki/BPF&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»´åŸºç™¾ç§‘&lt;/a&gt;å’Œ&lt;a href=&#34;https://www.ibm.com/developerworks/cn/linux/l-lo-eBPF-history/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF ç®€å²&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‰¹æ€§&#34;&gt;ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ Cilium çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸºäºèº«ä»½çš„å®‰å…¨æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cilium å¯è§æ€§å’Œå®‰å…¨ç­–ç•¥åŸºäºå®¹å™¨ç¼–æ’ç³»ç»Ÿçš„æ ‡è¯†ï¼ˆä¾‹å¦‚ï¼ŒKubernetes ä¸­çš„ Labelï¼‰ã€‚åœ¨ç¼–å†™å®‰å…¨ç­–ç•¥ã€å®¡è®¡å’Œæ•…éšœæ’æŸ¥æ—¶ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒç½‘ç»œå­ç½‘æˆ–å®¹å™¨ IP åœ°å€äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å“è¶Šçš„æ€§èƒ½&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;BPF åˆ©ç”¨ Linux åº•å±‚çš„å¼ºå¤§èƒ½åŠ›ï¼Œé€šè¿‡æä¾› Linux å†…æ ¸çš„æ²™ç›’å¯ç¼–ç¨‹æ€§æ¥å®ç°æ•°æ®è·¯å¾„ï¼Œä»è€Œæä¾›å“è¶Šçš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;API åè®®å¯è§æ€§ + å®‰å…¨æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¼ ç»Ÿé˜²ç«å¢™ä»…æ ¹æ® IP åœ°å€å’Œç«¯å£ç­‰ç½‘ç»œæ ‡å¤´æŸ¥çœ‹å’Œè¿‡æ»¤æ•°æ®åŒ…ã€‚Cilium ä¹Ÿå¯ä»¥è¿™æ ·åšï¼Œä½†ä¹Ÿå¯ä»¥ç†è§£å¹¶è¿‡æ»¤å•ä¸ª HTTPã€gRPC å’Œ Kafka è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚å°†å¾®æœåŠ¡æ‹¼æ¥åœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸“ä¸ºæ‰©å±•è€Œè®¾è®¡&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cilium æ˜¯ä¸ºæ‰©å±•è€Œè®¾è®¡çš„ï¼Œåœ¨éƒ¨ç½²æ–° pod æ—¶ä¸éœ€è¦èŠ‚ç‚¹é—´äº¤äº’ï¼Œå¹¶ä¸”é€šè¿‡é«˜åº¦å¯æ‰©å±•çš„é”®å€¼å­˜å‚¨è¿›è¡Œæ‰€æœ‰åè°ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé€‰æ‹©-cilium&#34;&gt;ä¸ºä»€ä¹ˆé€‰æ‹© Ciliumï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç°ä»£æ•°æ®ä¸­å¿ƒåº”ç”¨ç¨‹åºçš„å¼€å‘å·²ç»è½¬å‘é¢å‘æœåŠ¡çš„ä½“ç³»ç»“æ„ï¼ˆSOAï¼‰ï¼Œé€šå¸¸ç§°ä¸º&lt;em&gt;å¾®æœåŠ¡&lt;/em&gt;ï¼Œå…¶ä¸­å¤§å‹åº”ç”¨ç¨‹åºè¢«åˆ†æˆå°å‹ç‹¬ç«‹æœåŠ¡ï¼Œè¿™äº›æœåŠ¡ä½¿ç”¨ HTTP ç­‰è½»é‡çº§åè®®é€šè¿‡ API ç›¸äº’é€šä¿¡ã€‚å¾®æœåŠ¡åº”ç”¨ç¨‹åºå¾€å¾€æ˜¯é«˜åº¦åŠ¨æ€çš„ï¼Œä½œä¸ºæŒç»­äº¤ä»˜çš„ä¸€éƒ¨åˆ†éƒ¨ç½²çš„æ»šåŠ¨æ›´æ–°æœŸé—´å•ä¸ªå®¹å™¨å¯åŠ¨æˆ–é”€æ¯ï¼Œåº”ç”¨ç¨‹åºæ‰©å±•/ç¼©å°ä»¥é€‚åº”è´Ÿè½½å˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§å‘é«˜åº¦åŠ¨æ€çš„å¾®æœåŠ¡çš„è½¬å˜è¿‡ç¨‹ï¼Œç»™ç¡®ä¿å¾®æœåŠ¡ä¹‹é—´çš„è¿æ¥æ–¹é¢æå‡ºäº†æŒ‘æˆ˜å’Œæœºé‡ã€‚ä¼ ç»Ÿçš„ Linux ç½‘ç»œå®‰å…¨æ–¹æ³•ï¼ˆä¾‹å¦‚ iptablesï¼‰è¿‡æ»¤ IP åœ°å€å’Œ TCP/UDP ç«¯å£ï¼Œä½† IP åœ°å€ç»å¸¸åœ¨åŠ¨æ€å¾®æœåŠ¡ç¯å¢ƒä¸­æµå¤±ã€‚å®¹å™¨çš„é«˜åº¦ä¸ç¨³å®šçš„ç”Ÿå‘½å‘¨æœŸå¯¼è‡´è¿™äº›æ–¹æ³•éš¾ä»¥ä¸åº”ç”¨ç¨‹åºå¹¶æ’æ‰©å±•ï¼Œå› ä¸ºè´Ÿè½½å‡è¡¡è¡¨å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨è¦ä¸æ–­æ›´æ–°ï¼Œå¯èƒ½å¢é•¿æˆåŒ…å«æ•°åä¸‡æ¡è§„åˆ™ã€‚å‡ºäºå®‰å…¨ç›®çš„ï¼Œåè®®ç«¯å£ï¼ˆä¾‹å¦‚ï¼Œç”¨äº HTTP æµé‡çš„ TCP ç«¯å£ 80ï¼‰ä¸èƒ½å†ç”¨äºåŒºåˆ†åº”ç”¨æµé‡ï¼Œå› ä¸ºè¯¥ç«¯å£ç”¨äºè·¨æœåŠ¡çš„å„ç§æ¶ˆæ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯æä¾›å‡†ç¡®çš„å¯è§æ€§ï¼Œå› ä¸ºä¼ ç»Ÿç³»ç»Ÿä½¿ç”¨ IP åœ°å€ä½œä¸ºä¸»è¦è¯†åˆ«å·¥å…·ï¼Œå…¶åœ¨å¾®æœåŠ¡æ¶æ„ä¸­çš„å¯¿å‘½å¯èƒ½æ‰ä»…ä»…å‡ ç§’é’Ÿï¼Œè¢«å¤§å¤§ç¼©çŸ­ã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ Linux BPFï¼ŒCilium ä¿ç•™äº†é€æ˜åœ°æ’å…¥å®‰å…¨å¯è§†æ€§ + å¼ºåˆ¶æ‰§è¡Œçš„èƒ½åŠ›ï¼Œä½†è¿™ç§æ–¹å¼åŸºäºæœåŠ¡/pod/å®¹å™¨æ ‡è¯†ï¼ˆä¸ä¼ ç»Ÿç³»ç»Ÿä¸­çš„ IP åœ°å€è¯†åˆ«ç›¸åï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®åº”ç”¨å±‚è¿›è¡Œè¿‡æ»¤ï¼ˆä¾‹å¦‚ HTTPï¼‰ã€‚å› æ­¤ï¼Œé€šè¿‡å°†å®‰å…¨æ€§ä¸å¯»å€åˆ†ç¦»ï¼ŒCilium ä¸ä»…å¯ä»¥åœ¨é«˜åº¦åŠ¨æ€çš„ç¯å¢ƒä¸­åº”ç”¨å®‰å…¨ç­–ç•¥ï¼Œè€Œä¸”é™¤äº†æä¾›ä¼ ç»Ÿçš„ç¬¬ 3 å±‚å’Œç¬¬ 4 å±‚åˆ†å‰²ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡åœ¨ HTTP å±‚è¿è¡Œæ¥æä¾›æ›´å¼ºçš„å®‰å…¨éš”ç¦»ã€‚ ã€‚&lt;/p&gt;
&lt;p&gt;BPF çš„ä½¿ç”¨ä½¿å¾— Cilium èƒ½å¤Ÿä»¥é«˜åº¦å¯æ‰©å±•çš„æ–¹å¼å®ç°ä»¥ä¸ŠåŠŸèƒ½ï¼Œå³ä½¿å¯¹äºå¤§è§„æ¨¡ç¯å¢ƒä¹Ÿä¸ä¾‹å¤–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŠŸèƒ½æ¦‚è¿°&#34;&gt;åŠŸèƒ½æ¦‚è¿°&lt;/h2&gt;
&lt;h3 id=&#34;é€æ˜çš„ä¿æŠ¤-api&#34;&gt;é€æ˜çš„ä¿æŠ¤ API&lt;/h3&gt;
&lt;p&gt;èƒ½å¤Ÿä¿æŠ¤ç°ä»£åº”ç”¨ç¨‹åºåè®®ï¼Œå¦‚ REST/HTTPã€gRPC å’Œ Kafkaã€‚ä¼ ç»Ÿé˜²ç«å¢™åœ¨ç¬¬ 3 å±‚å’Œç¬¬ 4 å±‚è¿è¡Œï¼Œåœ¨ç‰¹å®šç«¯å£ä¸Šè¿è¡Œçš„åè®®è¦ä¹ˆå®Œå…¨å—ä¿¡ä»»ï¼Œè¦ä¹ˆå®Œå…¨è¢«é˜»æ­¢ã€‚Cilium æä¾›äº†è¿‡æ»¤å„ä¸ªåº”ç”¨ç¨‹åºåè®®è¯·æ±‚çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…è®¸æ‰€æœ‰å¸¦æœ‰æ–¹æ³•&lt;code&gt;GET&lt;/code&gt;å’Œè·¯å¾„&lt;code&gt;/public/.*&lt;/code&gt;çš„ HTTP è¯·æ±‚ã€‚æ‹’ç»æ‰€æœ‰å…¶ä»–è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;å…è®¸&lt;code&gt;service1&lt;/code&gt;åœ¨ Kafka topic ä¸Šç”Ÿæˆ&lt;code&gt;topic1&lt;/code&gt;ï¼Œ&lt;code&gt;service2&lt;/code&gt;æ¶ˆè´¹&lt;code&gt;topic1&lt;/code&gt;ã€‚æ‹’ç»æ‰€æœ‰å…¶ä»– Kafka æ¶ˆæ¯ã€‚&lt;/li&gt;
&lt;li&gt;è¦æ±‚ HTTP æ ‡å¤´&lt;code&gt;X-Token: [0-9]+&lt;/code&gt;å‡ºç°åœ¨æ‰€æœ‰ REST è°ƒç”¨ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¦æƒ…è¯·å‚è€ƒ&lt;a href=&#34;http://docs.cilium.io/en/stable/policy/#layer-7&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;7 å±‚åè®®&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸºäºèº«ä»½æ¥ä¿æŠ¤æœåŠ¡é—´é€šä¿¡&#34;&gt;åŸºäºèº«ä»½æ¥ä¿æŠ¤æœåŠ¡é—´é€šä¿¡&lt;/h3&gt;
&lt;p&gt;ç°ä»£åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºä¾èµ–äºè¯¸å¦‚å®¹å™¨ä¹‹ç±»çš„æŠ€æœ¯æ¥ä¿ƒè¿›æ•æ·æ€§å¹¶æŒ‰éœ€æ‰©å±•ã€‚è¿™å°†å¯¼è‡´åœ¨çŸ­æ—¶é—´å†…å¯åŠ¨å¤§é‡åº”ç”¨å®¹å™¨ã€‚å…¸å‹çš„å®¹å™¨é˜²ç«å¢™é€šè¿‡è¿‡æ»¤æº IP åœ°å€å’Œç›®æ ‡ç«¯å£æ¥ä¿æŠ¤å·¥ä½œè´Ÿè½½ã€‚è¿™å°±è¦æ±‚ä¸è®ºåœ¨é›†ç¾¤ä¸­çš„å“ªä¸ªä½ç½®å¯åŠ¨å®¹å™¨æ—¶éƒ½è¦æ“ä½œæ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„é˜²ç«å¢™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…å—åˆ°è§„æ¨¡é™åˆ¶ï¼ŒCilium ä¸ºå…±äº«ç›¸åŒå®‰å…¨ç­–ç•¥çš„åº”ç”¨ç¨‹åºå®¹å™¨ç»„åˆ†é…å®‰å…¨æ ‡è¯†ã€‚ç„¶åï¼Œè¯¥æ ‡è¯†ä¸åº”ç”¨ç¨‹åºå®¹å™¨å‘å‡ºçš„æ‰€æœ‰ç½‘ç»œæ•°æ®åŒ…ç›¸å…³è”ï¼Œä»è€Œå…è®¸éªŒè¯æ¥æ”¶èŠ‚ç‚¹å¤„çš„èº«ä»½ã€‚ä½¿ç”¨é”®å€¼å­˜å‚¨æ‰§è¡Œå®‰å…¨èº«ä»½ç®¡ç†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®‰å…¨è®¿é—®å¤–éƒ¨æœåŠ¡&#34;&gt;å®‰å…¨è®¿é—®å¤–éƒ¨æœåŠ¡&lt;/h3&gt;
&lt;p&gt;åŸºäºæ ‡ç­¾çš„å®‰å…¨æ€§æ˜¯é›†ç¾¤å†…éƒ¨è®¿é—®æ§åˆ¶çš„é¦–é€‰å·¥å…·ã€‚ä¸ºäº†ä¿æŠ¤å¯¹å¤–éƒ¨æœåŠ¡çš„è®¿é—®ï¼Œæ”¯æŒå…¥å£ï¼ˆingressï¼‰å’Œå‡ºå£ï¼ˆegressï¼‰çš„ä¼ ç»ŸåŸºäº CIDR çš„å®‰å…¨ç­–ç•¥ã€‚è¿™å…è®¸é™åˆ¶å¯¹åº”ç”¨ç¨‹åºå®¹å™¨çš„è®¿é—®ä»¥åŠå¯¹ç‰¹å®š IP èŒƒå›´çš„è®¿é—®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç®€å•ç½‘ç»œ&#34;&gt;ç®€å•ç½‘ç»œ&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªç®€å•çš„æ‰å¹³ç¬¬ 3 å±‚ç½‘ç»œèƒ½å¤Ÿè·¨è¶Šå¤šä¸ªé›†ç¾¤è¿æ¥æ‰€æœ‰åº”ç”¨ç¨‹åºå®¹å™¨ã€‚ä½¿ç”¨ä¸»æœºèŒƒå›´åˆ†é…å™¨å¯ä»¥ç®€åŒ– IP åˆ†é…ã€‚è¿™æ„å‘³ç€æ¯ä¸ªä¸»æœºå¯ä»¥åœ¨ä¸»æœºä¹‹é—´æ²¡æœ‰ä»»ä½•åè°ƒçš„æƒ…å†µä¸‹åˆ†é… IPã€‚&lt;/p&gt;
&lt;p&gt;æ”¯æŒä»¥ä¸‹å¤šèŠ‚ç‚¹ç½‘ç»œæ¨¡å‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Overlay&lt;/strong&gt;ï¼šåŸºäºå°è£…çš„è™šæ‹Ÿç½‘ç»œäº§ç”Ÿæ‰€æœ‰ä¸»æœºã€‚ç›®å‰ VXLAN å’Œ Geneve å·²ç»å®Œæˆï¼Œä½†å¯ä»¥å¯ç”¨ Linux æ”¯æŒçš„æ‰€æœ‰å°è£…æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä½•æ—¶ä½¿ç”¨æ­¤æ¨¡å¼ï¼šæ­¤æ¨¡å¼å…·æœ‰æœ€å°çš„åŸºç¡€æ¶æ„å’Œé›†æˆè¦æ±‚ã€‚å®ƒå‡ ä¹é€‚ç”¨äºä»»ä½•ç½‘ç»œåŸºç¡€æ¶æ„ï¼Œå”¯ä¸€çš„è¦æ±‚æ˜¯ä¸»æœºä¹‹é—´å¯ä»¥é€šè¿‡ IP è¿æ¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æœ¬æœºè·¯ç”±&lt;/strong&gt;ï¼šä½¿ç”¨ Linux ä¸»æœºçš„å¸¸è§„è·¯ç”±è¡¨ã€‚ç½‘ç»œå¿…é¡»èƒ½å¤Ÿè·¯ç”±åº”ç”¨ç¨‹åºå®¹å™¨çš„ IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä½•æ—¶ä½¿ç”¨æ­¤æ¨¡å¼ï¼šæ­¤æ¨¡å¼é€‚ç”¨äºé«˜çº§ç”¨æˆ·ï¼Œéœ€è¦äº†è§£åº•å±‚ç½‘ç»œåŸºç¡€ç»“æ„ã€‚æ­¤æ¨¡å¼é€‚ç”¨äºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬åœ° IPv6 ç½‘ç»œ&lt;/li&gt;
&lt;li&gt;ä¸äº‘ç½‘ç»œè·¯ç”±å™¨é…åˆä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å¦‚æœæ‚¨å·²ç»åœ¨è¿è¡Œè·¯ç”±å®ˆæŠ¤è¿›ç¨‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è´Ÿè½½å‡è¡¡&#34;&gt;è´Ÿè½½å‡è¡¡&lt;/h3&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºå®¹å™¨å’Œå¤–éƒ¨æœåŠ¡ä¹‹é—´çš„æµé‡çš„åˆ†å¸ƒå¼è´Ÿè½½å‡è¡¡ã€‚è´Ÿè½½å‡è¡¡ä½¿ç”¨ BPF å®ç°ï¼Œå…è®¸å‡ ä¹æ— é™çš„è§„æ¨¡ï¼Œå¹¶ä¸”å¦‚æœæœªåœ¨æºä¸»æœºä¸Šæ‰§è¡Œè´Ÿè½½å‡è¡¡æ“ä½œï¼Œåˆ™æ”¯æŒç›´æ¥æœåŠ¡å™¨è¿”å›ï¼ˆDSRï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šè´Ÿè½½å‡è¡¡éœ€è¦å¯ç”¨è¿æ¥è·Ÿè¸ªã€‚è¿™æ˜¯é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›‘æ§å’Œæ•…éšœæ’é™¤&#34;&gt;ç›‘æ§å’Œæ•…éšœæ’é™¤&lt;/h3&gt;
&lt;p&gt;å¯è§æ€§å’Œæ•…éšœæ’æŸ¥æ˜¯ä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿè¿è¡Œçš„åŸºç¡€ã€‚è™½ç„¶æˆ‘ä»¬å–œæ¬¢ç”¨&lt;code&gt;tcpdump&lt;/code&gt;å’Œ &lt;code&gt;ping&lt;/code&gt;ï¼Œå®ƒä»¬å¾ˆå¥½ç”¨ï¼Œä½†æˆ‘ä»¬åŠªåŠ›ä¸ºæ•…éšœæ’é™¤æä¾›æ›´å¥½çš„å·¥å…·ã€‚åŒ…æ‹¬ä»¥ä¸‹å·¥å…·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å…ƒæ•°æ®è¿›è¡Œäº‹ä»¶ç›‘æ§ï¼šå½“æ•°æ®åŒ…è¢«ä¸¢å¼ƒæ—¶ï¼Œè¯¥å·¥å…·ä¸ä»…ä»…æŠ¥å‘Šæ•°æ®åŒ…çš„æº IP å’Œç›®æ ‡ IPï¼Œè¯¥å·¥å…·è¿˜æä¾›å‘é€æ–¹å’Œæ¥æ”¶æ–¹çš„å®Œæ•´æ ‡ç­¾ä¿¡æ¯ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ç­–ç•¥å†³ç­–è·Ÿè¸ªï¼šä¸ºä»€ä¹ˆä¸¢å¼ƒæ•°æ®åŒ…æˆ–æ‹’ç»è¯·æ±‚ã€‚ç­–ç•¥è·Ÿè¸ªæ¡†æ¶å…è®¸è·Ÿè¸ªè¿è¡Œå·¥ä½œè´Ÿè½½å’ŒåŸºäºä»»æ„æ ‡ç­¾å®šä¹‰çš„ç­–ç•¥å†³ç­–è¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ Prometheus å¯¼å‡ºæŒ‡æ ‡ï¼šé€šè¿‡ Prometheus å¯¼å‡ºå…³é”®æŒ‡æ ‡ï¼Œä»¥ä¾¿ä¸ç°æœ‰ä»ªè¡¨æ¿é›†æˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é›†æˆ&#34;&gt;é›†æˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘ç»œæ’ä»¶é›†æˆï¼š&lt;a href=&#34;https://github.com/containernetworking/cni&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNI&lt;/a&gt;ã€&lt;a href=&#34;https://github.com/docker/libnetwork&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;libnetwork&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å®¹å™¨è¿è¡Œæ—¶ï¼š&lt;a href=&#34;https://github.com/containerd/containerd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Kubernetesï¼š&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/network-policies/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NetworkPolicy&lt;/a&gt;ã€&lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Label&lt;/a&gt;ã€&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingress&lt;/a&gt;ã€&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Service&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ—¥å¿—è®°å½•ï¼šsyslogã€&lt;a href=&#34;http://www.fluentd.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;fluentd&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://cilium.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å®˜æ–¹ç½‘ç«™ - cilium.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.ibm.com/developerworks/cn/linux/l-lo-eBPF-history/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF ç®€å² - ibm.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/25672552&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œå±‚æ‹¦æˆªå¯é€‰é¡¹ - zhihu.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 1.3ï¼šæ”¯æŒ Envoyã€Cassandra å’Œ Memcached çš„ Go è¯­è¨€æ‰©å±•</title>
      <link>https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/</link>
      <pubDate>Tue, 06 Nov 2018 12:20:51 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/</guid>
      <description>&lt;p&gt;















&lt;figure  id=&#34;figure-cilium-kubernetes&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Cilium Kubernetes&#34; srcset=&#34;
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwqjul334zj30je07p0t1_hu_e029125c61262eae.webp 400w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwqjul334zj30je07p0t1_hu_fc4c3343b94f5d73.webp 760w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwqjul334zj30je07p0t1_hu_a6531d3079efa267.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwqjul334zj30je07p0t1_hu_e029125c61262eae.webp&#34;
               width=&#34;698&#34;
               height=&#34;277&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Cilium Kubernetes
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸ºç¿»è¯‘æ–‡ç« ï¼Œ&lt;a href=&#34;https://cilium.io/blog/2018/10/23/cilium-13-envoy-go/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‚¹å‡»æŸ¥çœ‹åŸæ–‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ Cilium 1.3 å‘å¸ƒäº†ã€‚è¿™ä¸ªç‰ˆæœ¬åŠ å…¥äº†å‡ ä¸ªæ–°ç‰¹æ€§ã€‚ä¸»è¦çš„äº®ç‚¹æ˜¯å®ç°äº† Cassandra å’Œå¸¦æœ‰ç­–ç•¥æ‰§è¡Œèƒ½åŠ›çš„ Memcached åè®®è§£æå™¨ï¼Œä½œä¸º&lt;a href=&#34;https://github.com/envoyproxy/envoy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy&lt;/a&gt;çš„ Go è¯­è¨€æ‰©å±•åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;å’Œå¾€å¸¸ä¸€æ ·ï¼Œæ•´ä¸ª Cilium ç¤¾åŒºçš„å¼€å‘è€…è´¡çŒ®å·¨å¤§ï¼Œä»–ä»¬åœ¨ 1.2 åˆ° 1.3 ç‰ˆæœ¬çš„è¿™æ®µæ—¶é—´è´¡çŒ®äº† 785 ä¸ªæäº¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-envoy-çš„-go-è¯­è¨€æ‰©å±•&#34;&gt;ä»€ä¹ˆæ˜¯ Envoy çš„ Go è¯­è¨€æ‰©å±•ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä» 1.0 ç‰ˆæœ¬å¼€å§‹ï¼Œæˆ‘ä»¬ä¸€ç›´ä¾èµ–&lt;a href=&#34;https://github.com/envoyproxy/envoy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy&lt;/a&gt;å¤„ç†æ‰€æœ‰çš„ HTTPã€gRPC ä»¥åŠ HTTP çš„æ´¾ç”Ÿå¦‚ Elasticsearch çš„è¯·æ±‚ã€‚ç¤¾åŒºè®¨è®ºå¦‚ä½•æ‰©å¤§æ”¯æŒ 7 å±‚åè®®çš„èŒƒå›´ï¼ŒEnvoy ä½œä¸ºæ¨åŠ¨æœªæ¥åè®®è¡¥å……çš„é¦–é€‰å¹³å°æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ç„¦ç‚¹è¿…é€Ÿè½¬ç§»åˆ°å¯»æ‰¾ç®€åŒ– Envoy å¯æ‰©å±•æ€§çš„æ–¹æ³•ï¼Œå¹¶ä¸”å…è®¸é‡ç”¨ç°æœ‰çš„å¼€æºé¡¹ç›®ï¼Œå¦‚ CNCF é¡¹ç›®&lt;a href=&#34;https://vitess.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vitess&lt;/a&gt;ã€‚äºæ˜¯å®ç° Envoy çš„ Go æ‰©å±•çš„æƒ³æ³•å°±è¯ç”Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Cilium 1.3 ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº† Envoy çš„ Go æ‰©å±•ä½œä¸ºå…¶ Beta ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-envoy-golang-extension-architecture&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Envoy Golang Extension Architecture&#34; srcset=&#34;
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwql07xp02j30lp0buaay_hu_e5571cff78bf0cc2.webp 400w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwql07xp02j30lp0buaay_hu_5124b0102ad9862e.webp 760w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwql07xp02j30lp0buaay_hu_bac619b73d5d5c4b.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwql07xp02j30lp0buaay_hu_e5571cff78bf0cc2.webp&#34;
               width=&#34;760&#34;
               height=&#34;415&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Envoy Golang Extension Architecture
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;**æ‰©å±•çš„é€æ˜æ³¨å…¥ï¼š**åœ¨ Cilium çš„å¸®åŠ©ä¸‹ï¼Œè¿æ¥è¢«é€æ˜åœ°é‡å®šå‘åˆ° Envoyï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºæˆ– podã€‚é‡å®šå‘åŸºäºç›®æ ‡ç«¯å£é…ç½®ï¼Œå¯ä»¥æ ¹æ® labelsã€IPsã€DNS ä»¥åŠ ingress å’Œ egress è¿æ¥çš„æœåŠ¡åç§°é™å®šåˆ°æºæˆ–ç›®æ ‡æœåŠ¡ï¼Œå¹¶é€šè¿‡æ‰©å±•çš„åç§°å°†è¿æ¥æ˜ å°„åˆ°æ‰©å±•ã€‚é‡å®šå‘æ˜¯é€šè¿‡ CiliumNetworkPolicy CRD æˆ– REST API é…ç½®çš„ã€‚Envoy å¯ä»¥è¢«é…ç½®ä¸ºåœ¨æ¯ä¸ª pod ä¸­ä½œä¸º sidecar æˆ–ä½œä¸ºæ¯ä¸ª node çš„ç‹¬ç«‹ä»£ç†è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;**å®Œå…¨åˆ†å¸ƒå¼ï¼š**Go æ‰©å±•å®Œå…¨åˆ†å¸ƒåœ¨æ¯ä¸ª Envoy èŠ‚ç‚¹æˆ– pod å†…éƒ¨ï¼Œä¸éœ€è¦ä¸ºä¸€ä¸ªæ•°æ®å¤„ç†çš„é›†ä¸­åŒ–æ§åˆ¶é¢æ¿ã€‚å½“ç„¶ï¼Œgo æ‰©å±•æœ¬èº«å¯ä»¥è°ƒç”¨ä»»æ„çš„å¤–éƒ¨æ§åˆ¶é¢æ¿ç»„ä»¶æ¥æŠ¥å‘Šé¥æµ‹æ•°æ®æˆ–éªŒè¯è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;**åŠ¨æ€æ‰©å±•æ˜ å°„ï¼š**Go æ‰©å±•è¢«è®¾è®¡ä¸ºå…±äº«åº“æä¾›ç»™ Envoyã€‚Cilium å¯ä»¥æ ¹æ®è®¾ç½®å¥½çš„é‡å®šå‘è‡ªåŠ¨åŠ è½½ç›¸åº”çš„ Go æ‰©å±•æ¥é…ç½® Envoyï¼Œå¹¶åœ¨è¿æ¥æ•°æ®æ—¶è°ƒç”¨å®ƒã€‚æœªæ¥çš„ç‰ˆæœ¬å°†æ”¯æŒåœ¨è¿è¡Œæ—¶æ›´æ–°å’Œé‡æ–°åŠ è½½æ‰©å±•ï¼Œè€Œæ— éœ€é‡å¯ Envoy å¹¶ä¸”ä¹Ÿä¸ä¼šä¸¢å¤±è¿æ¥çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;**é€šè¿‡ CRD é…ç½®æ‰©å±•ï¼š**é€šè¿‡ CRD æˆ– REST API ä½¿ç”¨é€šç”¨é”®å€¼å¯¹é…ç½® Go æ‰©å±•ã€‚è¿™å…è®¸ä¼ é€’å¦‚å®‰å…¨ç­–ç•¥ã€å®‰å…¨ä»¤ç‰Œæˆ–å…¶ä»–çš„é…ç½®ï¼Œè€Œæ— éœ€è®© Envoy çŸ¥é“ã€‚&lt;/li&gt;
&lt;li&gt;**é€šç”¨è®¿é—®æ—¥å¿—ï¼š**ä¸é…ç½®ç±»ä¼¼ï¼Œæ‰©å±•å¯ä»¥è¿”å›é€šç”¨é”®å€¼å¯¹ï¼Œè¿™äº›é”®å€¼å¯¹å°†æå–çš„å¯è§æ€§ä¼ é€’åˆ°è®¿é—®æ—¥å¿—å±‚ã€‚&lt;/li&gt;
&lt;li&gt;**æ²™ç›’åŒ–ï¼š**æ²™ç›’ç¡®ä¿ä»»ä½•è§£æå™¨çš„ä¸ç¨³å®šæ€§éƒ½ä¸ä¼šç ´å Envoy çš„æ ¸å¿ƒã€‚å— Matt Klein å‘è¡¨çš„æ–‡ç« &lt;a href=&#34;https://medium.com/@mattklein123/exceptional-go-1dd1488a6a47&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Exceptional Go&lt;/a&gt;å¯å‘ï¼Œè§£æå™¨è¢«å®¹è®¸ panic æˆ–æŠ›å‡ºå¼‚å¸¸ã€‚å½“ panic å‘ç”Ÿæ—¶ï¼Œä¿¡æ¯è¢«è®°å½•åˆ°è®¿é—®æ—¥å¿—ä¸­ï¼ŒTCP è¿æ¥ä¸è¢«å…³é—­çš„è¯·æ±‚å…³è”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;cilium-æ˜¯ä»€ä¹ˆ&#34;&gt;Cilium æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶ï¼Œå¯ä»¥é€æ˜åœ°æä¾›å’Œä¿æŠ¤éƒ¨ç½²åœ¨è¯¸å¦‚ Kubernetesã€Docker å’Œ Mesos ç­‰ Linux å®¹å™¨ç®¡ç†å¹³å°çš„åº”ç”¨ç¨‹æœåŠ¡ä¹‹é—´çš„ç½‘ç»œå’Œ API è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;Cilium çš„åŸºç¡€æ˜¯ä¸€ç§æ–°çš„ Linux å†…æ ¸æŠ€æœ¯ BPFï¼Œå®ƒæ”¯æŒåœ¨ Linux å†…éƒ¨åŠ¨æ€çš„æ³¨å…¥å®‰å…¨ã€å¯è§æ€§å’Œç½‘ç»œæ§åˆ¶é€»è¾‘ã€‚é™¤äº†æä¾›ä¼ ç»Ÿçš„ç½‘ç»œå±‚å®‰å…¨ï¼ŒBPF çš„çµæ´»æ€§è¿˜è®© API å’Œæµç¨‹çº§åˆ«çš„å®‰å…¨ï¼Œä¿æŠ¤å®¹å™¨æˆ– pod é—´é€šä¿¡æˆä¸ºäº†å¯èƒ½ã€‚å› ä¸º BPF åœ¨ Linux å†…æ ¸ä¸­è¿è¡Œï¼ŒCilium çš„å®‰å…¨ç­–ç•¥å¯ä»¥åœ¨ä¸ä¿®æ”¹ç¨‹åºä»£ç æˆ–å®¹å™¨é…ç½®çš„æƒ…å†µä¸‹ä½¿ç”¨å’Œæ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ Cilium æ›´è¯¦ç»†çš„ä»‹ç»è¯·å‚è§**&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Introduction to Cilium&lt;/a&gt;**&lt;/p&gt;
&lt;h2 id=&#34;envoy-æ˜¯ä»€ä¹ˆ&#34;&gt;Envoy æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Envoy æ˜¯ä¸€ä¸ª 7 å±‚ä»£ç†å’Œé€šä¿¡æ€»çº¿ï¼Œè¢«è®¾è®¡ç”¨äºå¤§å‹çš„é¢å‘æœåŠ¡çš„æ¶æ„ã€‚è¿™ä¸ªé¡¹ç›®è¯ç”Ÿäºä»¥ä¸‹ç†å¿µï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç½‘ç»œåº”è¯¥å¯¹åº”ç”¨ç¨‹åºé€æ˜ã€‚å½“ç½‘ç»œå’Œåº”ç”¨ç¨‹åºå‡ºç°é—®é¢˜æ—¶ï¼Œåº”è¯¥å¾ˆå®¹æ˜“ç¡®å®šé—®é¢˜çš„æ ¹æºã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ Envoy çš„æ–‡æ¡£ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/what_is_envoy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;What is Envoy&lt;/a&gt;äº†è§£æ›´å¤šå…³äº Envoy çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;h1 id=&#34;æ€æ ·ç¼–å†™-envoy-çš„-go-è¯­è¨€æ‰©å±•&#34;&gt;æ€æ ·ç¼–å†™ Envoy çš„ Go è¯­è¨€æ‰©å±•&lt;/h1&gt;
&lt;p&gt;ç¼–å†™ Envoy çš„ Go æ‰©å±•å¾ˆç®€å•ã€‚ä¸ºè¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä¸º R2-D2 æ§åˆ¶åè®®å®ç°ä¸€ä¸ªåŸºæœ¬çš„åè®®è§£æå™¨ï¼Œå¹¶å®ç°è¿‡æ»¤é€»è¾‘ç”¨æ¥æ’é™¤ä»»ä½•åŒ…å«å­—ç¬¦ä¸²â€C-3POâ€çš„æ§åˆ¶è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-envoy-golang-extension-architecture&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Envoy Golang Extension Architecture&#34; srcset=&#34;
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwvz4inau1j30kg09waal_hu_d444b7a17ed5fb59.webp 400w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwvz4inau1j30kg09waal_hu_7b89e9f03dfc1100.webp 760w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwvz4inau1j30kg09waal_hu_943c4808d56d5e96.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwvz4inau1j30kg09waal_hu_d444b7a17ed5fb59.webp&#34;
               width=&#34;736&#34;
               height=&#34;356&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Envoy Golang Extension Architecture
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¦å®ç°æ‰©å±•çš„ä¸»è¦ API æ˜¯&lt;code&gt;OnData()&lt;/code&gt;å‡½æ•°ï¼Œå½“ Envoy æ”¶åˆ°é€šè¿‡&lt;code&gt;CiliumNetworkPolicy&lt;/code&gt;æ˜ å°„åˆ°æ‰©å±•è¿æ¥çš„æ•°æ®æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å‡½æ•°å¿…é¡»è§£ææ•°æ®å¹¶è¿”å›ä¸‹é¢çš„æ–­è¨€ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;MORE&lt;/strong&gt;ï¼šè§£æå™¨éœ€è¦æ›´å¤šçš„å­—èŠ‚æ¥ç»§ç»­è§£æã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PASS&lt;/strong&gt;ï¼šä¼ é€’&lt;em&gt;n&lt;/em&gt;å­—èŠ‚æ•°æ®æµã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DROP&lt;/strong&gt;ï¼šåˆ é™¤&lt;em&gt;n&lt;/em&gt;å­—èŠ‚æ•°æ®æµã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;INJECT&lt;/strong&gt;ï¼šå‘æŒ‡å®šçš„æ–¹å‘æ³¨å…¥&lt;em&gt;n&lt;/em&gt;å­—èŠ‚çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ERROR&lt;/strong&gt;ï¼šå‘ç”Ÿäº†è§£æé”™è¯¯ï¼Œè¿æ¥å¿…é¡»å…³é—­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;NOP&lt;/strong&gt;ï¼šä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†æ³¨å†Œæ‰©å±•ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªå¿…é¡»å®ç°&lt;code&gt;Create()&lt;/code&gt;å‡½æ•°çš„è§£æå™¨å·¥å‚ã€‚å½“ Envoy å»ºç«‹äº†ä¸€ä¸ªæ–°çš„è¿æ¥å¹¶ä½¿ç”¨è§£æå™¨æ—¶å°±ä¼šè°ƒç”¨è¯¥å‡½æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/cilium/cilium/proxylib/proxylib&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;parser&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;connection&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Connection&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;parser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;reply&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;endStream&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dataArray&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[][]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;OpType&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;dataArray&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;\r\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;MORE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// No delimiter, request more data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;msgStr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Inlcude the &amp;#34;\r\n&amp;#34; in the request&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;reply&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PASS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Pass responses without additional parsing&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Contains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;msgStr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;C-3PO&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;DROP&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PASS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;msgLen&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;connection&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Parser&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;parser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;connection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;connection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;proxylib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RegisterParserFactory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;r2d2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;factory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œå°†æ–°çš„è§£æå™¨å¯¼å…¥åˆ° proxylib åŒ…ä¸­ã€‚&lt;code&gt;libcilium.so&lt;/code&gt;å°†åŒ…å«è§£æå™¨å¹¶è¢« Envoy åŠ è½½ã€‚ç¼–è¾‘æ–‡ä»¶&lt;code&gt;proxylib/proxylib.go&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/cilium/cilium/proxylib/r2d2&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢çš„ç¤ºä¾‹çœç•¥äº†æ‰©å±•é…ç½®ã€é›†æˆåˆ°ç­–ç•¥ä»£ç åº“ä»¥åŠè®¿é—®æ—¥å¿—ç­‰å†…å®¹ã€‚å­¦ä¹ å¦‚ä½•ç¼–å†™ Go æ‰©å±•ï¼Œè¯·å‚é˜…æŒ‡å—&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/envoy/extensions/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Go Extensions&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;cassandra-æ”¯æŒbeta&#34;&gt;Cassandra æ”¯æŒï¼ˆBetaï¼‰&lt;/h1&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cassandra-logo&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Cassandra Logo&#34; srcset=&#34;
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc47hgkbj30io07edgp_hu_2fda169102f8861c.webp 400w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc47hgkbj30io07edgp_hu_79305a210b942994.webp 760w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc47hgkbj30io07edgp_hu_534499205ca14b9e.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc47hgkbj30io07edgp_hu_2fda169102f8861c.webp&#34;
               width=&#34;672&#34;
               height=&#34;266&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Cassandra Logo
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/apache/cassandra&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cassandra&lt;/a&gt; æ˜¯ä¸€ä¸ªæµè¡Œçš„ NoSQL æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚å®ƒé€šå¸¸è¢«å¤šä¸ªæœåŠ¡å¤§è§„æ¨¡çš„è®¿é—®å¹¶åœ¨å›¢é˜Ÿé—´å…±äº«ã€‚Cilium 1.3 å¼•å…¥äº†å¯¹ Apache &lt;a href=&#34;https://github.com/apache/cassandra&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cassandra&lt;/a&gt; åè®®çš„æ”¯æŒï¼Œå¹¶æä¾›äº†å¯è§æ€§å’Œç­–ç•¥æ‰§è¡Œèƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Cassandra çš„ Go æ‰©å±•èƒ½å¤Ÿåœ¨ä»¥ä¸‹åè®®å­—æ®µä¸Šæä¾›å¯è§æ€§å’Œæ‰§è¡Œèƒ½åŠ›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;query_action&lt;/strong&gt;ï¼šè¿™ä¸ªè¡Œä¸ºåœ¨æ•°æ®åº“çš„&lt;code&gt;SELECT&lt;/code&gt;ï¼Œ &lt;code&gt;INSERT&lt;/code&gt;ï¼Œ &lt;code&gt;UPDATE&lt;/code&gt;ç­‰æ“ä½œä¸Šæ‰§è¡Œï¼Œå­—æ®µæ€»æ˜¯ç²¾ç¡®åŒ¹é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;query_table&lt;/strong&gt;ï¼šæŸ¥è¯¢æ‰§è¡Œçš„è¡¨ï¼Œä»¥æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ä¾‹å­empire-å¦‚ä½•é€šè¿‡è¡¨é™åˆ¶-cassandra-è®¿é—®&#34;&gt;ä¾‹å­ï¼šEmpire å¦‚ä½•é€šè¿‡è¡¨é™åˆ¶ Cassandra è®¿é—®&lt;/h3&gt;
&lt;p&gt;ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºäº† Empire å¦‚ä½•æš´éœ²æœ‰é™çš„è®¿é—®ç»™è¿è¡Œåœ¨ç«¯å£ 9042 çš„ Empire Cassandra é›†ç¾¤ã€‚Outposts è¢«æ ‡ç­¾&lt;code&gt;app=empire-outpost&lt;/code&gt;æ ‡è¯†ï¼Œå¹¶å…·æœ‰ä»¥ä¸‹æƒé™ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;SELECT&lt;/code&gt; æ“ä½œåœ¨è¡¨&amp;quot;system.&lt;em&gt;â€å’Œâ€system_schema.&lt;/em&gt;â€œä¸Šæ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;INSERT&lt;/code&gt;æ“ä½œåœ¨è¡¨&amp;quot;attendance.daily_records&amp;quot;ä¸Šæ‰§è¡Œã€‚æ³¨æ„ outposts ä¸èƒ½ä»è¿™äº›è¡¨è¯»å–ï¼Œå› æ­¤ä¸èƒ½ä»å…¶ä»– outposts è¯»å–æ¯æ—¥è®°å½•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cilium.io/v2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumNetworkPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Allow only permitted requests to empire Cassandra server&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;secure-empire-cassandra&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;specs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;endpointSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cass-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;fromEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;empire-outpost&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;9042&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7proto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cassandra&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;query_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;select&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;query_table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;system\\..*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;query_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;select&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;query_table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;system_schema\\..*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;query_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;insert&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;query_table&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;attendance.daily_records&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ›´å¤šå¤æ‚ç¤ºä¾‹è¯·å‚é˜… &lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/gettingstarted/cassandra/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cassandra getting started guide &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;memcached-æ”¯æŒbeta&#34;&gt;Memcached æ”¯æŒï¼ˆBetaï¼‰&lt;/h1&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-memcached-logo&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Memcached Logo&#34; srcset=&#34;
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc9b9qp7j30g607gt97_hu_d319c73597a7663b.webp 400w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc9b9qp7j30g607gt97_hu_516a189b92d19047.webp 760w,
               /blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc9b9qp7j30g607gt97_hu_33c152ad0a31ec57.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-13-go-extensions-for-envoy-cassandra-memcached-support/006tNbRwly1fwxc9b9qp7j30g607gt97_hu_d319c73597a7663b.webp&#34;
               width=&#34;582&#34;
               height=&#34;268&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Memcached Logo
    &lt;/figcaption&gt;&lt;/figure&gt;

Memcached æ˜¯ä¸€ç§æµè¡Œçš„åŸºäºå†…å­˜çš„åˆ†å¸ƒå¼ç¼“å­˜ï¼Œé€šå¸¸ç”¨äºç¼“å­˜æˆ–åœ¨æœåŠ¡ä¹‹é—´å…±äº«æ•°æ®ã€‚éšç€ memcached è§£æå™¨çš„ golang æ‰©å±•åŠ å…¥ Envoyï¼ŒCilium ç°åœ¨å¯ä»¥æ‰§è¡Œå®‰å…¨è§„åˆ™å»é™åˆ¶ memcached å®¢æˆ·ç«¯çš„æŸäº›å‘½ä»¤ï¼Œæ¯”å¦‚è¯»å†™ï¼Œä¹Ÿå¯ä»¥æ ¹æ® key å‰ç¼€è¿›è¡Œé™åˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¾‹å­rebels-å¦‚ä½•ä¿æŠ¤å…±äº«çš„-memcached-æœåŠ¡&#34;&gt;ä¾‹å­ï¼šRebels å¦‚ä½•ä¿æŠ¤å…±äº«çš„ memcached æœåŠ¡&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼ŒRebels è¿è¡Œäº†ä¸€ä¸ªæ ‡ç­¾ä¸º&lt;code&gt;app=memcached&lt;/code&gt;çš„ memcached æœåŠ¡ï¼Œå‡ ä¸ªæœåŠ¡ä¸ memcached äº¤äº’å¹¶åº”ç”¨ä¸åŒçš„è§„åˆ™ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;function=fleet-maintenance&lt;/code&gt; æ ‡è¯†çš„ç»´æŠ¤æœåŠ¡è¢«æˆäºˆå¯¹å‰ç¼€ä¸º&lt;code&gt;alliance/fleet&lt;/code&gt;çš„æ‰€æœ‰ key çš„è¯»å†™æƒé™ã€‚ç¦æ­¢è®¿é—®ä»»ä½•å…¶ä»– keyã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;function=fleet-monitoring&lt;/code&gt;æ ‡è¯†çš„ç›‘æ§æœåŠ¡ä»…å¯¹å‰ç¼€ä¸º&lt;code&gt;alliance/fleet&lt;/code&gt;çš„ key æˆäºˆè¯»æƒé™ã€‚ç¦æ­¢å¯¹å‰ç¼€ä¸­çš„ key è¿›è¡Œå†™å…¥è®¿é—®æˆ–è®¿é—®å‰ç¼€ä¹‹å¤–çš„ä»»ä½• keyã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰ Jedis è¢«æ ‡ç­¾&lt;code&gt;role=jedi&lt;/code&gt;æ ‡è¯†ï¼Œæ‹¥æœ‰å®Œæ•´çš„ Memcached æœåŠ¡ï¼Œå¯ä»¥è®¿é—®æ‰€æœ‰çš„ keyã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cilium.io/v2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumNetworkPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;summary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Secure the Rebel memcached service&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;secure-rebel-alliance-memcache&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;specs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;endpointSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;memcached&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ingress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;fromEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;fleet-maintanence&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;11211&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7proto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;memcache&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;writeGroup&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;keyPrefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;alliance/fleet/&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;keyPrefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;alliance/fleet/&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;fromEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;fleet-monitoring&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;11211&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7proto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;memcache&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;keyPrefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;alliance/fleet/&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;fromEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;role&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;jedi&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;11211&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7proto&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;memcache&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;l7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½¿ç”¨ memcached çš„å®Œæ•´ç¤ºä¾‹ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/gettingstarted/memcached/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Memcached getting started guide&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h1 id=&#34;ç¤¾åŒº&#34;&gt;ç¤¾åŒº&lt;/h1&gt;
&lt;h2 id=&#34;linux-åŸºé‡‘ä¼šcore-infrastructure-initiativeæœ€ä½³å®è·µ&#34;&gt;Linux åŸºé‡‘ä¼š&amp;quot;Core Infrastructure Initiative&amp;quot;æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬è‡´åŠ›äºåœ¨å¼€æ”¾å’Œæœ€å¥½çš„å¼€æºå®è·µä¸­å¼€å‘ Ciliumï¼ŒåŒ…æ‹¬å¯¹å®‰å…¨çš„åšå®šæ‰¿è¯ºã€‚æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰å·¥ä½œï¼Œè·å¾—äº† Linux åŸºé‡‘ä¼š &lt;a href=&#34;https://www.coreinfrastructure.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Core Infrastructure Initiative&lt;/a&gt;çš„ &lt;a href=&#34;https://bestpractices.coreinfrastructure.org/en&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CII Best Practices&lt;/a&gt;æ®Šè£ã€‚åœ¨ &lt;a href=&#34;https://www.coreinfrastructure.org/programs/badge-program/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;äº†è§£æ›´å¤šå…³äºå¥–ç« çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‰¹åˆ«å…´è¶£ç»„sigä»‹ç»&#34;&gt;ç‰¹åˆ«å…´è¶£ç»„ï¼ˆSIGï¼‰ä»‹ç»&lt;/h2&gt;
&lt;p&gt;ç¤¾åŒºçš„å…³æ³¨ç‚¹è¶Šæ¥è¶Šå¤šæ ·åŒ–ã€‚ä¸ºäº†ç¡®ä¿é¡¹ç›®çš„å¯ä¼¸ç¼©æ€§ï¼Œæˆ‘ä»¬æ­£å¼å¼•å…¥äº†ç‰¹æ®Šå…´è¶£ç»„ï¼ˆSIGsï¼‰æ¥å¸®åŠ©æä¾›ä¸€äº›ç»„ç»‡ç»“æ„ã€‚å·²ç»åˆ›å»ºäº†ä»¥ä¸‹çš„ SIGsï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Datapath&lt;/strong&gt;ï¼š (#sig-datapath) æ‰€æœ‰ BPF å’Œ Linux å†…æ ¸ç›¸å…³çš„æ•°æ®é€šè·¯ä»£ç æ‹¥æœ‰è€…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Documentation&lt;/strong&gt;ï¼š (#sig-docs) æ‰€æœ‰æ–‡æ¡£ç›¸å…³çš„è®¨è®ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Envoy&lt;/strong&gt;ï¼š (#sig-envoy) Envoyï¼ŒIstio å’Œæ‰€æœ‰ 7 å±‚åè®®è§£æå™¨çš„ç»´æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Policy&lt;/strong&gt;ï¼š (#sig-policy) æ‰€æœ‰ç­–ç•¥ç›¸å…³çš„ä¸»é¢˜ã€‚è¿™ä¸ª SIG è´Ÿè´£æ‰€æœ‰ä¸å®‰å…¨ç›¸å…³çš„ API å’Œå®ç°é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Release Management&lt;/strong&gt;ï¼š (#launchpad) è´Ÿè´£å‘å¸ƒç®¡ç†å’Œå‘åç§»æ¤çš„è¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»»ä½•äººéƒ½å¯ä»¥å»ºç«‹é¢å¤–çš„ SIGsã€‚è¿™ä¸ªè¿‡ç¨‹å¾ˆç®€å•æœ‰&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/community/#how-to-create-a-sig&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡æ¡£è¯´æ˜&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;13-ç‰ˆæœ¬æ–°ç‰¹æ€§&#34;&gt;1.3 ç‰ˆæœ¬æ–°ç‰¹æ€§&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Envoy çš„ Go è¯­è¨€æ‰©å±•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä»¤äººå…´å¥‹çš„å…¨æ–°çš„ Envoy Go æ‰©å±• APIï¼ŒåŒ…æ‹¬é€šç”¨é…ç½®å’Œè®¿é—®æ—¥å¿— APIï¼ˆBeta ç‰ˆæœ¬ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cassandra å’Œ Memcached åè®®æ”¯æŒ&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨æ–°çš„ Envoy Go æ‰©å±•å®ç°äº† Cassandra å’Œ Memcached çš„æ–°åè®®è§£æå™¨ã€‚è¿™ä¸¤ä¸ªè§£æå™¨éƒ½ä½¿ç”¨ç²¾ç¡®åŒ¹é…ã€å‰ç¼€åŒ¹é…å’Œæ­£åˆ™è¡¨è¾¾å¼ä¸ºæ“ä½œç±»å‹å’Œé”®/è¡¨åæä¾›å¯è§æ€§å’Œå¼ºåˆ¶å®‰å…¨ç­–ç•¥ã€‚ï¼ˆBetaï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºDNS/FQDNç­–ç•¥è§„åˆ™æä¾›TTLsæ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;å¼•å…¥ kube-dnsã€coredns å’Œ etcd æ“ä½œç¬¦çš„æ ‡è¯†ã€‚&lt;/li&gt;
&lt;li&gt;æ–°çš„å®‰å…¨æ ‡è¯†&amp;quot;unmanaged&amp;quot;ä»£è¡¨æ²¡æœ‰è¢« Cilium ç®¡ç†çš„ podã€‚&lt;/li&gt;
&lt;li&gt;æ”¹è¿›çš„å®‰å…¨å®ä½“â€œé›†ç¾¤â€ï¼Œå…è®¸ä¸ºé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod å®šä¹‰ç­–ç•¥ï¼ˆå·²ç®¡ç†ã€æœªç®¡ç†å’Œä¸»æœºç½‘ç»œçš„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢å¤–çš„é¥æµ‹æŒ‡æ ‡å’Œç›‘æ§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–°çš„&amp;quot;cilium metrics list&amp;quot;å‘½ä»¤é€šè¿‡ CLI æŸ¥çœ‹ metrics åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;è®¸å¤šé¢å¤–çš„ metricsï¼šè¿æ¥è·Ÿè¸ªåƒåœ¾å›æ”¶ï¼ŒKubernetes èµ„æºäº‹ä»¶ï¼ŒIPAMï¼Œå†ç”ŸèŠ‚ç‚¹ï¼ŒæœåŠ¡ï¼Œé”™è¯¯å’Œè­¦å‘Šè®¡æ•°å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰æ›´é«˜æ•ˆçš„ç¼–è§£ç åè®®çš„æ–°ç›‘æ§æ¥å£ã€‚é»˜è®¤æƒ…å†µä¸‹ç”¨äºè¾ƒè€çš„å®¢æˆ·ç«¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œæ”¹è¿›&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å°†è¿æ¥è·Ÿè¸ªè¡¨åˆ’åˆ†ä¸º TCP å’Œé TCPï¼Œä»¥æ›´å¥½åœ°å¤„ç†æ¯ä¸ªåè®®çš„é•¿çŸ­è¿æ¥çš„æ··åˆã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ ConfigMap æè¿°è¿æ¥è¡¨å¤§å°çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ NodePort å’Œ HostPort æ›´å¥½çš„ä¼ªè£…æµé‡è¡Œä¸ºï¼Œå®¹è®¸ pods å¯ä»¥æŸ¥çœ‹åŸå§‹æº IPã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…¨é”®å€¼å­˜å‚¨å¼¹æ€§&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¼•å…¥äº†åœ¨ä»»ä½•çŠ¶æ€ä¸¢å¤±åç«‹å³é‡æ–°æ„é€ é”®å€¼å­˜å‚¨å†…å®¹çš„èƒ½åŠ›ã€‚å…è®¸ä»å¤‡ä»½ä¸­æ¢å¤ etcdï¼Œæˆ–è€…åœ¨è¿è¡Œçš„é›†ç¾¤ä¸­å®Œå…¨åˆ é™¤å®ƒï¼Œå¹¶å½±å“æœ€å°ã€‚(Beta)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•ˆç‡å’Œæ‰©å±•&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨è®¡ç®—ç‹¬ç«‹ endpoint ç­–ç•¥çš„æˆæœ¬æ–¹é¢æœ‰é‡å¤§æ”¹è¿›ã€‚å…³äºè¿™æ–¹é¢çš„å·¥ä½œè¿˜åœ¨ç»§ç»­ã€‚&lt;/li&gt;
&lt;li&gt;æ–°çš„å®½é™æœŸï¼Œé€šè¿‡å·¥ä½œè´Ÿè½½æ›´æ”¹èº«ä»½æœ€å°åŒ–è¿æ¥å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;æ›´é«˜æ•ˆçš„å®‰å…¨èº«ä»½åˆ†é…ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;æ–°çš„é€šç”¨æ¡†æ¶æ£€æµ‹å’Œå¿½ç•¥ Kubernetes äº‹ä»¶é€šçŸ¥ï¼ŒCilium ä¸éœ€è¦åŠ¨ä½œã€‚&lt;/li&gt;
&lt;li&gt;åœ¨é¿å…ä¸å¿…è¦çš„ BPF ç¼–è¯‘æ–¹é¢çš„æ”¹è¿›ï¼Œä»¥å‡å°‘ç”±æ­¤å¯¼è‡´çš„ CPU è´Ÿè½½ã€‚åˆå§‹åŒ– BPF æ¨¡æ¿ä»¥é¿å…å…¨ç¼–è¯‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kubernetes&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;å¢åŠ å¯¹ Kubernetes 1.12 çš„æ”¯æŒ&lt;/li&gt;
&lt;li&gt;ä¸º CiliumEndpoints CRD è‡ªå®šä¹‰åˆ—ï¼ˆéœ€è¦ Kubernetes 1.11 æ”¯æŒï¼‰&lt;/li&gt;
&lt;li&gt;ä¸º ulibc çš„å…¼å®¹æ€§ä» cilium-cni ç§»é™¤ cgo&lt;/li&gt;
&lt;li&gt;ç§»é™¤å¯¹ Kubernetes 1.7 çš„æ”¯æŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ–°çš„ Ubuntu 18.04 æ‰‹å†Œ&lt;/li&gt;
&lt;li&gt;å¯¹æœ€æ–°çš„ BPF è¿è¡Œæ—¶ç‰¹æ€§çš„è¦†ç›–ï¼Œä¾‹å¦‚ BTFï¼ˆBPF Type Formatï¼‰&lt;/li&gt;
&lt;li&gt;é’ˆå¯¹è¿è¡Œå¤šä¸»æœºç½‘ç»œçš„è™šæ‹Ÿæœº/ä¸»æœºé˜²ç«å¢™éœ€æ±‚çš„æ–‡æ¡£&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é•¿æœŸç¨³å®šç‰ˆæœ¬ (LTS)&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;1.3 å·²ç»å£°æ˜ä¸º LTS ç‰ˆæœ¬ï¼Œåœ¨åç»­çš„ 6 ä¸ªæœˆå°†ä½œä¸ºå‘åç§»æ¤çš„ç‰ˆæœ¬ç»§ç»­æ”¯æŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ›´æ–°æŒ‡å¯¼&#34;&gt;æ›´æ–°æŒ‡å¯¼&lt;/h2&gt;
&lt;p&gt;è¯·æŸ¥é˜…&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.3/install/upgrade/#upgrading-minor-versions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;upgrade guide&lt;/a&gt;å»æ›´æ–°ä½ çš„ Cilium éƒ¨ç½²ï¼Œå¯ä»¥éšæ—¶åœ¨&lt;a href=&#34;http://cilium.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack&lt;/a&gt;ä¸Šè”ç³»æˆ‘ä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‘å¸ƒ&#34;&gt;å‘å¸ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‘å¸ƒè®°å½•å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ &lt;a href=&#34;https://github.com/cilium/cilium/releases/tag/1.3.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;1.3.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å®¹å™¨é•œåƒï¼š &lt;code&gt;docker.io/cilium/cilium:v1.3.0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 1.2 å‘å¸ƒâ€”DNS å®‰å…¨æ€§ç­–ç•¥ã€EKS æ”¯æŒã€ClusterMeshã€kube-router é›†æˆç­‰</title>
      <link>https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/</link>
      <pubDate>Mon, 27 Aug 2018 19:52:29 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/</guid>
      <description>&lt;p&gt;















&lt;figure  id=&#34;figure-cilium&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Cilium&#34; srcset=&#34;
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqoaw4wj310o0qegwa_hu_7a3b6a596c16bb7c.webp 400w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqoaw4wj310o0qegwa_hu_3d4c9179a7c05578.webp 760w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqoaw4wj310o0qegwa_hu_86027870cf523939.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqoaw4wj310o0qegwa_hu_7a3b6a596c16bb7c.webp&#34;
               width=&#34;760&#34;
               height=&#34;547&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Cilium
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸ºç¿»è¯‘æ–‡ç« ï¼Œ&lt;a href=&#34;https://cilium.io/blog/2018/08/21/cilium-12/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‚¹å‡»æŸ¥çœ‹åŸæ–‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒæ¨å‡º Cilium 1.2ã€‚è¯¥ç‰ˆæœ¬å¼•å…¥äº†å‡ ä¸ªæ–°åŠŸèƒ½å®ç°äº† Cilium ç”¨æˆ·å’Œç¤¾åŒºæˆå‘˜æœ€è¿«åˆ‡æƒ³è¦çš„åŠŸèƒ½ã€‚å…¶ä¸­æœ€å¸å¼•äººçš„åŠŸèƒ½ä¹‹ä¸€æ˜¯å¼•å…¥åŸºäº DNS åç§°çš„å®‰å…¨ç­–ç•¥ï¼Œç›®çš„æ˜¯ä¿æŠ¤å¯¹é›†ç¾¤å¤–æœåŠ¡çš„è®¿é—®ã€‚å¦ä¸€ä¸ªæœ€å—å…³æ³¨çš„é—®é¢˜æ˜¯åŠ å…¥äº†è¿æ¥å’Œä¿æŠ¤å¤šä¸ª Kubernetes é›†ç¾¤çš„èƒ½åŠ›ã€‚æˆ‘ä»¬å°† ClusterMesh åŠŸèƒ½è¿›å…¥ Alpha ç‰ˆæœ¬ã€‚å®ƒå¯ä»¥è¿æ¥å’Œä¿æŠ¤åœ¨å¤šä¸ª Kubernetes é›†ç¾¤ä¸­è¿è¡Œçš„ podã€‚Kube-router ä¸ Cilium çš„é›†æˆåŒç­‰é‡è¦ã€‚DigitalOcean å›¢é˜Ÿçš„åŠªåŠ›ä½¿ kube-router æä¾› BGP ç½‘ç»œä¸ Cilium æä¾›çš„åŸºäº BPF çš„å®‰å…¨æ€§å’Œè´Ÿè½½å‡è¡¡ç›¸ç»“åˆã€‚æ•´ä¸ª Cilium å¼€å‘è€…ç¤¾åŒºè´¡çŒ®è€…æ€»æ•°å·²å¢åŠ åˆ° 85 ä¸ªï¼Œåœ¨ 1.1 åˆ° 1.2 ç‰ˆæœ¬å†…è´¡çŒ®äº† 579 ä¸ª PRã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-æ˜¯ä»€ä¹ˆ&#34;&gt;Cilium æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶ï¼Œç”¨äºåœ¨ Kubernetesã€Docker å’Œ Mesos ç­‰ Linux å®¹å™¨ç®¡ç†å¹³å°éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæœåŠ¡ä¹‹é—´æä¾›é€æ˜è¿æ¥ã€ä¿æŠ¤ç½‘ç»œå’Œ APIã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohq4pg7kj31kw0cjtcq_hu_7e31deccea296d96.webp 400w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohq4pg7kj31kw0cjtcq_hu_e5a6872f81a3851f.webp 760w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohq4pg7kj31kw0cjtcq_hu_9c48752369266164.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohq4pg7kj31kw0cjtcq_hu_7e31deccea296d96.webp&#34;
               width=&#34;760&#34;
               height=&#34;167&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium æ˜¯åŸºäºä¸€ç§å« BPF çš„æ–°å†…æ ¸æŠ€æœ¯ï¼Œå®ƒä½¿å¾—èƒ½å¤Ÿåœ¨ Linux è‡ªèº«å†…éƒ¨åŠ¨æ€æ’å…¥å¼ºå¤§çš„å®‰å…¨æ€§ã€å¯è§æ€§å’Œç½‘ç»œæ§åˆ¶é€»è¾‘ã€‚é™¤äº†æä¾›ä¼ ç»Ÿçš„ç½‘ç»œçº§å®‰å…¨æ€§ä¹‹å¤–ï¼ŒBPF çš„çµæ´»æ€§è¿˜å¯ä»¥åœ¨ API å’Œè¿›ç¨‹çº§åˆ«å®ç°å®‰å…¨æ€§ï¼Œä»¥ä¿æŠ¤å®¹å™¨æˆ– pod å†…çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ Cilium çš„æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œè¯·å‚é˜…&lt;a href=&#34;http://docs.cilium.io/en/v1.1/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium ç®€ä»‹&lt;/a&gt;éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;12-ç‰ˆæœ¬çš„é‡è¦åŠŸèƒ½&#34;&gt;1.2 ç‰ˆæœ¬çš„é‡è¦åŠŸèƒ½&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºDNS/FQDNçš„å®‰å…¨ç­–ç•¥
&lt;ul&gt;
&lt;li&gt;åŸºäºFQDN/DNSå‘½åå®šä¹‰ç½‘ç»œå®‰å…¨è§„åˆ™ï¼Œè¡¨ç¤ºå…è®¸è¿æ¥åˆ°å¤–éƒ¨æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œå…è®¸è®¿é—®foo.comã€‚ï¼ˆå¤„äºBetaç‰ˆï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ”¯æŒ AWS EKS
&lt;ul&gt;
&lt;li&gt;ä¸ºç®¡ç† Kubernetes é›†æˆé‡èº«å®šåˆ¶çš„ etcd operatorï¼Œæ¶ˆé™¤äº†å¯¹éœ€è¦å¤–éƒ¨ kvstore çš„ä¾èµ–ã€‚ï¼ˆå¤„äº Beta ç‰ˆï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Clustermeshï¼ˆé›†ç¾¤é—´è¿æ¥ï¼‰
&lt;ul&gt;
&lt;li&gt;è·¨å¤šä¸ª Kubernetes é›†ç¾¤çš„ pod é—´ç½‘ç»œè¿æ¥ã€‚ï¼ˆå¤„äº Alpha ç‰ˆï¼‰&lt;/li&gt;
&lt;li&gt;è·¨é›†ç¾¤çš„åŸºäº label çš„ç½‘ç»œå®‰å…¨ç­–ç•¥å®æ–½ï¼Œä¾‹å¦‚å…è®¸ cluster1 ä¸­çš„ pod foo ä¸ cluster2 ä¸­çš„ pod bar é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä¸ºæ”¯æŒ BPF é›†æˆ Kube-route
&lt;ul&gt;
&lt;li&gt;ä¸ kube-router ä¸€èµ·åä½œè¿è¡Œä»¥å¯ç”¨ BGP ç½‘ç»œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åŸºäºèŠ‚ç‚¹å‘ç°çš„ KV å­˜å‚¨
&lt;ul&gt;
&lt;li&gt;åœ¨é Kubernetes ç¯å¢ƒä¸­å¯ç”¨è‡ªåŠ¨èŠ‚ç‚¹å‘ç°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å‡è¡¡
&lt;ul&gt;
&lt;li&gt;æ”¯æŒä¸€è‡´çš„åç«¯ selection ç”¨äºæœåŠ¡åç«¯æ‰©ç¼©å®¹&lt;/li&gt;
&lt;li&gt;æ”¯æŒåŸºäºæœåŠ¡label/nameçš„ç­–ç•¥ä»¥åŠL4è§„åˆ™&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é«˜æ•ˆæ€§ &amp;amp; æ‰©ç¼©å®¹
&lt;ul&gt;
&lt;li&gt;å¯¹äºå¤§å‹å’Œå¤šé›†ç¾¤è§„æ¨¡çš„ç¯å¢ƒï¼Œå®‰å…¨èº«ä»½è®¤è¯ç©ºé—´ä» 16bits å¢åŠ åˆ° 24bitsã€‚&lt;/li&gt;
&lt;li&gt;é¦–æ¬¡å®ç°åŸºäº BPF çš„æ•°æ®è·¯å¾„é€šçŸ¥èšåˆã€‚&lt;/li&gt;
&lt;li&gt;å–å¾—æŒç»­é«˜æ•ˆçš„ CPU åˆ©ç”¨è¿›å±•ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨æ£€æµ‹ underlying ç½‘ç»œçš„ MTUã€‚&lt;/li&gt;
&lt;li&gt;ç¦ç”¨ DSR æ—¶ä½¿ç”¨æœ¬åœ° service ID åˆ†é…ä»¥æé«˜è´Ÿè½½å‡è¡¡å¯ä¼¸ç¼©æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£
&lt;ul&gt;
&lt;li&gt;æ–°çš„ AWS EKS å®‰è£…æŒ‡å—ã€‚&lt;/li&gt;
&lt;li&gt;å‚è€ƒ kubespray å®‰è£…æŒ‡å—ã€‚&lt;/li&gt;
&lt;li&gt;æ–°çš„ç®€åŒ–å®‰è£…å’Œå‡çº§è¯´æ˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åŸºäº-dns-çš„å®‰å…¨ç­–ç•¥&#34;&gt;åŸºäº DNS çš„å®‰å…¨ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;åœ¨ Kubernetes é›†ç¾¤ä¸­è¿è¡Œçš„æœåŠ¡é€šå¸¸ä¸é›†ç¾¤å¤–éƒ¨çš„ä¸€ç³»åˆ—æœåŠ¡è¿›è¡Œäº¤äº’ã€‚å¸¸è§ç¤ºä¾‹åŒ…æ‹¬ SaaS æœåŠ¡ï¼Œå¦‚ S3ã€RDSã€DynamoDB ç­‰ã€‚åŸºäº API çš„æœåŠ¡ï¼Œä¾‹å¦‚ Google åœ°å›¾ã€Salesforce APIã€Twilio ç­‰ã€‚æˆ–è‡ªæ‰˜ç®¡æœåŠ¡ï¼Œå¦‚ Oracle æ•°æ®åº“é›†ç¾¤ã€åŸºäº Windows çš„åº”ç”¨ç¨‹åºç­‰ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒCilium æ”¯æŒåŸºäº CIDR çš„ç­–ç•¥ï¼Œä»¥ä¾¿ä¸æ­¤ç±»å¤–éƒ¨æœåŠ¡è¿›è¡Œäº¤äº’ã€‚ç„¶è€Œï¼ŒåŸºäº CIDR çš„ç­–ç•¥å¾ˆéš¾å®šä¹‰å’Œç»´æŠ¤ï¼Œå› ä¸ºæœåŠ¡çš„ IP åœ°å€å¯èƒ½ç»å¸¸å‘ç”Ÿå˜åŒ–ã€‚Cilium 1.2 ç°åœ¨æ”¯æŒåŸºäº DNS åç§°çš„ç‰¹å®šç­–ç•¥ã€‚å½“å‰å®ç°æ”¯æŒåŸºäºå…¶ FQDN çš„ç™½åå•å¤–éƒ¨æœåŠ¡çš„æ ¸å¿ƒå®ä¾‹ã€‚è€ƒè™‘åˆ° DNS è§£å†³æ–¹æ¡ˆï¼ˆä¾‹å¦‚ TTLã€CNAME ç­‰ï¼‰å’Œç›¸å…³ç­–ç•¥è¦æ±‚ï¼ˆä¾‹å¦‚&lt;code&gt;*.google.com&lt;/code&gt;ç­‰åŸºäºé€šé…ç¬¦çš„è§„èŒƒï¼‰çš„å¤æ‚æ€§ï¼Œå¯¹äºåŸºäº DNS çš„ç»¼åˆç­–ç•¥ï¼Œåç»­ç‰ˆæœ¬ä¸­è¿˜æœ‰æ›´å¤šå·¥ä½œè¦åšã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹å…è®¸è®¿é—®-my-remote-servicecom&#34;&gt;ç¤ºä¾‹ï¼šå…è®¸è®¿é—® my-remote-service.com&lt;/h2&gt;
&lt;p&gt;ä¸‹é¢çš„ç®€å•ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•å®šä¹‰ç½‘ç»œå®‰å…¨ç­–ç•¥ï¼Œè¯¥ç­–ç•¥å…è®¸æ‰€æœ‰ label ä¸º&lt;code&gt;app = test-app&lt;/code&gt;çš„ pod é€šè¿‡ kube-dns è§£æ DNS åç§°ï¼Œå¹¶å‘æœåŠ¡&lt;code&gt;my-remote-service.com&lt;/code&gt;å‘å‡ºå¤–éƒ¨è¯·æ±‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cilium.io/v2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;CiliumNetworkPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;to-fqdn-example&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;endpointSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;test-app&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;egress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;toFQDNs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;my-remote-service.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;toEndpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;k8s:io.cilium.k8s.policy.serviceaccount&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kube-dns&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;k8s:io.kubernetes.pod.namespace&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kube-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;k8s:k8s-app&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kube-dns&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;toPorts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;53&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;UDP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Cilium å°†è‡ªåŠ¨ç»´æŠ¤ç›¸åº”çš„åŸºäº CIDR çš„è§„åˆ™ï¼Œä»¥å…è®¸æ‰€æœ‰ pod ä¸æ‰€æœ‰ä¸ºè¯¥ DNS åç§°è¿”å›çš„ IP åœ°å€è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ”¯æŒ-aws-eks&#34;&gt;æ”¯æŒ AWS EKS&lt;/h2&gt;
&lt;p&gt;æŒ‰ç…§&lt;a href=&#34;http://docs.cilium.io/en/v1.2/kubernetes/install/eks/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS EKS ä¸Šä½¿ç”¨ etcd operator çš„æ–°æŒ‡å—&lt;/a&gt;ï¼Œåœ¨ AWS EKS æ‰˜ç®¡çš„ Kubernetes é›†ç¾¤ä¸Šå®‰è£… Ciliumã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…æŒ‡å—ä¸º Cilium æä¾›å…¨æ–°çš„é›†æˆ etcd operatorï¼Œä»¥ç®¡ç†è‡ªå·±çš„ etcd é›†ç¾¤ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒKubernetes ä½¿ç”¨çš„ etcd æ— æ³•è¢« Cilium ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ç®¡ç†çš„ Kubernetes ä¸­ï¼Œä¾‹å¦‚ EKSã€GKEã€AKS ç­‰ã€‚å¯ä»¥æœ‰é™åœ°è®¿é—® Kubernetes etcd æœåŠ¡ã€‚åœ¨ Cilium 1.2 ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª etcd operatorï¼Œå®ƒå°†å®‰è£…å’Œç®¡ç†ä¸€ä¸ªé«˜åº¦å¯ç”¨çš„ etcd é›†ç¾¤ä¾› Cilium ä½¿ç”¨ã€‚è¿™å°†ä½¿ Cilium çš„å®‰è£…å’Œä½¿ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œè€Œä¸ä¾èµ–äº Kubernetes ç­‰ï¼Œå¹¶ä¸”ä¸éœ€è¦å¯¹ etcd é›†ç¾¤è¿›è¡Œé¢å¤–ç®¡ç†ã€‚æˆ‘ä»¬æ­£åœ¨ç§¯æè‡´åŠ›äº AKS æ•´åˆï¼Œå¹¶å°†åœ¨æœªæ¥å‡ å‘¨å†…å‘å¸ƒå…³äºå¦‚ä½•åœ¨ GKE ä¸Šè¿è¡Œçš„æŒ‡å—ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œè¯·ä½¿ç”¨&lt;a href=&#34;http://cilium.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack&lt;/a&gt;è”ç³»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;clustermeshè·¨å¤šä¸ª-kubernetes-é›†ç¾¤çš„ç½‘ç»œè¿é€šå’Œå®‰å…¨æ€§&#34;&gt;ClusterMeshï¼šè·¨å¤šä¸ª Kubernetes é›†ç¾¤çš„ç½‘ç»œè¿é€šå’Œå®‰å…¨æ€§&lt;/h2&gt;
&lt;p&gt;è¿è¡Œå¤šä¸ª Kubernetes é›†ç¾¤å˜å¾—è¶Šæ¥è¶Šæ™®éã€‚è¿è¡Œåœ¨ä¸åŒå¯ç”¨åŒºæˆ– Regions æœåŠ¡çš„é«˜å¯ç”¨å®ä¾‹ï¼›åœ¨å¤šä¸ªé›†ç¾¤ä¸­è¿è¡Œçš„ point-of-presenceï¼ŒæœåŠ¡äºä¸åŒçš„åœ°ç†ä½ç½®ï¼›ç»„ç»‡åŸå› å¦‚åˆ†ç¦» PCI ä¸é PCI å…¼å®¹æœåŠ¡ï¼›æˆ–è€…ç®€å•åœ°åˆ†ç¦» devã€test å’Œ prod å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œå¤šä¸ª Kubernetes é›†ç¾¤çš„åŸºæœ¬è¦æ±‚ä¹‹ä¸€æ˜¯å¦‚ä½•è¿æ¥æœåŠ¡ä»¥åŠå¦‚ä½•ä¸ºè·¨é›†ç¾¤äº¤äº’ä¿è¯ä¸œè¥¿æµé‡å®‰å…¨ã€‚åœ¨ Cilium 1.2 ä¸­ï¼Œæˆ‘ä»¬å°†å¼•å…¥å¤šé›†ç¾¤ä¸­ä¸è¯·æ±‚ ingress controller æˆ–è€…è´Ÿè½½å‡è¡¡å®ç°ä¸åŒé›†ç¾¤ pod ä¹‹é—´è¿æ¥çš„èƒ½åŠ›ã€‚ç”±äº pod é—´å¯ä»¥ç›´æ¥äº¤äº’ï¼Œå› æ­¤ Cilium èƒ½å¤Ÿä¿ç•™å…¶èº«ä»½è®¤è¯å¹¶å¯¹ä¸œè¥¿å‘æµé‡å®æ–½å®Œæ•´çš„ L3/L4 å’Œ L7 è®¿é—®æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqzj9tnj30jg08a0ts_hu_d251671c6f514f23.webp 400w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqzj9tnj30jg08a0ts_hu_14f8765afbab61fd.webp 760w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqzj9tnj30jg08a0ts_hu_c8c02ab9b3ca618d.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohqzj9tnj30jg08a0ts_hu_d251671c6f514f23.webp&#34;
               width=&#34;700&#34;
               height=&#34;298&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium ä½¿ç”¨å»ä¸­å¿ƒåŒ–çš„æ–¹å¼åˆ›å»º Cluster Mesh å¹¶å»ºç«‹ pod èº«ä»½è®¤è¯ï¼Œè€Œä¸æ˜¯ä¸ºæ‰€æœ‰é›†ç¾¤ä½¿ç”¨å•ä¸ªé›†ä¸­å¼ etcdã€‚ç”¨è¿™ç§æ–¹å¼ï¼Œæ¯ä¸ªé›†ç¾¤éƒ½èƒ½ç‹¬ç«‹ç®¡ç†å®ƒä»¬ pod çš„èº«ä»½ã€‚æ¯ä¸ªé›†ç¾¤éƒ½è¢«èµ‹äºˆä¸€ä¸ªç‹¬ç«‹çš„æ ‡è¯†ä½œä¸ºèº«ä»½å‘½åç©ºé—´ã€‚å› æ­¤ pod èº«ä»½æˆä¸ºé›†ç¾¤èº«ä»½ + pod èº«ä»½çš„ç»„åˆã€‚è¿™ç§æ–¹æ³•æ˜“äºç®¡ç†å’Œæ‰©å±•ï¼Œè€Œä¸ç”¨åè°ƒæ‰€æœ‰é›†ç¾¤ä¸­çš„èº«ä»½ã€‚è¿™ç§æ–¹å¼ä¸å¤šé›†ç¾¤é«˜å¯ç”¨ç›®æ ‡ä¿æŒä¸€è‡´ï¼Œæ¯ä¸ªé›†ç¾¤çš„ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºå…¶ä»–é›†ç¾¤çš„ç”Ÿå‘½å‘¨æœŸã€‚æŸ¥çœ‹&lt;a href=&#34;https://cilium.readthedocs.io/en/stable/install/guides/clustermesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤šé›†ç¾¤å®‰è£…æŒ‡å—&lt;/a&gt;è¯•ç€ä½“éªŒ Cilium cluster-meshã€‚&lt;/p&gt;
&lt;h2 id=&#34;bgp-æ”¯æŒåŸºäº-kube-router--cilium&#34;&gt;BGP æ”¯æŒï¼šåŸºäº Kube-router + Cilium&lt;/h2&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrg84iaj30du03ojrm_hu_797979abed3328e0.webp 400w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrg84iaj30du03ojrm_hu_2132fe5927fc942a.webp 760w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrg84iaj30du03ojrm_hu_c9be4e90d91e5fae.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrg84iaj30du03ojrm_hu_797979abed3328e0.webp&#34;
               width=&#34;498&#34;
               height=&#34;132&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Kube-router æ˜¯ä¸€ä¸ªç”± cloudnativelabs å€¡è®®ï¼Œæ—¨åœ¨æ»¡è¶³å„ç§ Kubernetes ç½‘ç»œéœ€æ±‚å¹¶æä¾›ç»Ÿä¸€çš„è§£å†³æ–¹æ¡ˆã€‚ä»æ•°æ®è½¬å‘çš„è§’åº¦æ¥çœ‹ï¼ŒKube-router ä½¿ç”¨ BGP æ¥å¹¿æ’­å’Œç®¡ç†é›†ç¾¤ä¸­æ‰€æœ‰ pod çš„è·¯ç”±ã€‚é€šè¿‡ä¸å¤–éƒ¨è·¯ç”±å™¨è¿›è¡Œ BGP é…å¯¹ï¼ŒKube-router å¯ä»¥è½»æ¾åœ°åœ¨ Kubernetes pod ä¸é›†ç¾¤å¤–éƒ¨è¿è¡Œçš„æœåŠ¡ä¹‹é—´å»ºç«‹è¿æ¥ã€‚æ­¤å¤–ï¼ŒKube-router åˆ›å»ºæœåŠ¡æ—¶å‘ŠçŸ¥ cluster IPï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å•ä¸ª cluster IP å’Œæ ‡å‡†ç«¯å£ä»é›†ç¾¤å¤–éƒ¨è®¿é—®æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ç”± DigitalOcean å›¢é˜Ÿé¢†å¯¼çš„ç¤¾åŒºå·¥ä½œï¼ŒCilium ç°å·²é›†æˆ Kube-routerï¼Œæ•´åˆäº† BPF å’ŒåŸºäº BGP è·¯ç”±ã€‚æŸ¥çœ‹&lt;a href=&#34;http://docs.cilium.io/en/v1.2/kubernetes/install/kube-router/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ kube-router è¿è¡Œ BGP æŒ‡å—&lt;/a&gt;å»äº†è§£å¦‚ä½•å¹¶è¡Œè¿è¡Œ kube-router å’Œ Cilium ä»¥è¿è¡Œæ‹¥æœ‰ Cilium L3-L7 ç­–ç•¥å’Œè´Ÿè½½å‡è¡¡çš„ BGP ç½‘ç»œã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ”¯æŒ-istio-10&#34;&gt;æ”¯æŒ Istio 1.0&lt;/h2&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrvd6guj30e204lweo_hu_295215b7dd72fd5e.webp 400w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrvd6guj30e204lweo_hu_5990d3800b5f1889.webp 760w,
               /blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrvd6guj30e204lweo_hu_f8d5a369464da27a.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium1-2-dns-security-policies-eks-support-clustermesh-kube-router-integration/006tNbRwly1fuohrvd6guj30e204lweo_hu_295215b7dd72fd5e.webp&#34;
               width=&#34;506&#34;
               height=&#34;165&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Istio 1.0 å‘å¸ƒäº†å¿«ä¸€ä¸ªæœˆäº†ã€‚Cilium å·²ä¸ Istio å®Œç¾é›†æˆï¼Œå¯ä¸º Service Meshæ¶æ„æä¾›é«˜æ•ˆçš„æ•°æ®è½¬å‘ä»¥åŠL3/L4å’ŒL7å®‰å…¨æ€§ã€‚æˆ‘ä»¬åœ¨åšå®¢ ä¸­è¯¦ç»†ä»‹ç»äº†è¿™ä¸€ç‚¹&lt;a href=&#34;http://www.servicemesher.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio 1.0ï¼šCilium å¦‚ä½•é€šè¿‡ socket æ„ŸçŸ¥ BPF ç¨‹åºå¢å¼º Istio&lt;/a&gt;ã€‚Cilium 1.2 åŒ…å«äº†ä¸ Istio 1.0 é›†æˆçš„å‡ é¡¹æ”¹è¿›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯æ‰©å±•æ€§å’Œé«˜æ•ˆ&#34;&gt;å¯æ‰©å±•æ€§å’Œé«˜æ•ˆ&lt;/h2&gt;
&lt;p&gt;åŒæ ·ï¼Œé€šè¿‡åœ¨å„ç§ç¯å¢ƒä¸­å¤§é‡åˆ†æ Cilium æ€§èƒ½æŒ‡æ ‡å’Œå¹¶ä¼˜åŒ–è¿æ¥è·Ÿè¸ªå’Œå…¶ä»–å…³é”®æ•°æ®ç»“æ„çš„æ“ä½œï¼Œç»§ç»­å¤§åŠ›æ”¹è¿›å·²ç»å¾ˆå¥½çš„å¯æ‰©å±•æ€§å¹¶æé«˜ CPU æ•ˆç‡ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šï¼Œè¯·åœ¨&lt;a href=&#34;http://cilium.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack&lt;/a&gt;ä¸Šè·Ÿæˆ‘ä»¬è”ç³»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‡çº§è¯´æ˜&#34;&gt;å‡çº§è¯´æ˜&lt;/h2&gt;
&lt;p&gt;åŒæ ·ï¼Œè¯·æŒ‰ç…§&lt;a href=&#34;https://cilium.readthedocs.io/en/v1.2/install/upgrade/#upgrading-minor-versions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŒ‡å—å‡çº§&lt;/a&gt;å‡çº§ä½ çš„ Cilium deploymentã€‚éšæ„åœ¨&lt;a href=&#34;http://cilium.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Slack&lt;/a&gt;ä¸Šè”ç³»æˆ‘ä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‘å¸ƒ&#34;&gt;å‘å¸ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å®¹å™¨é•œåƒï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker.io/cilium/cilium:v1.2.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å¢å¼º Istioâ€”é€šè¿‡ Socket æ„ŸçŸ¥ BPF ç¨‹åº</title>
      <link>https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/</link>
      <pubDate>Mon, 13 Aug 2018 16:19:59 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/</guid>
      <description>&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu84zi0tigj30td0gk75e_hu_71f094d3f41c1538.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu84zi0tigj30td0gk75e_hu_aa099d17e2d6e296.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu84zi0tigj30td0gk75e_hu_ee14ed4a153826ce.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu84zi0tigj30td0gk75e_hu_71f094d3f41c1538.webp&#34;
               width=&#34;760&#34;
               height=&#34;429&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä¸ºç¿»è¯‘æ–‡ç« ï¼Œ&lt;a href=&#34;https://cilium.io/blog/2018/08/07/istio-10-cilium/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‚¹å‡»æŸ¥çœ‹åŸæ–‡&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;8 æœˆ 1 æ—¥ Istio 1.0 å‘å¸ƒï¼ŒCilium ç¤¾åŒºæ„Ÿè°¢æ‰€æœ‰ Istio è´¡çŒ®è€…ä¸ºæ­¤ä»˜å‡ºçš„å·¨å¤§åŠªåŠ›ã€‚æˆ‘ä»¬å¾ˆå¹¸è¿èƒ½å¤Ÿå‚ä¸ç¤¾åŒºæ´»åŠ¨ï¼Œä¸º Istio åšå‡ºè´¡çŒ®ï¼Œå¹¶å¸®åŠ©ä¸€äº›ç”¨æˆ·é€šè¿‡ Istio å’Œ Cilium è¿›è¡Œç”Ÿäº§éƒ¨ç½²ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£åœ¨æ·±å…¥äº†è§£æŠ€æœ¯ç»†èŠ‚ä¹‹å‰äº†è§£ Istio + Cilium çš„ç”¨æˆ·æ•…äº‹ï¼Œè¯·è€ƒè™‘é˜…è¯» HP FitStation å›¢é˜Ÿï¼ˆæœ€å¤§çš„ Cilium + Istio ç”¨æˆ·ä¹‹ä¸€ï¼‰å‘å¸ƒçš„ä»¥ä¸‹ Istio åšå®¢ï¼š&lt;a href=&#34;https://istio.io/blog/2018/hp/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ˜¯æƒ æ™® FitStation å¹³å°çš„æ¸¸æˆè§„åˆ™çš„æ”¹å˜è€…&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬åšå®¢å°†ä»‹ç» BPF å’Œ Cilium å¦‚ä½•å¢å¼º Istio çš„ä¸€äº›ç»†èŠ‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¼ºå®‰å…¨
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºä¸ºå¤šå®¹å™¨ pod æä¾›æœ€å°æƒé™&lt;/li&gt;
&lt;li&gt;é˜²æ­¢å—æŸçš„ sidecar ä»£ç†å’Œç»•è¿‡ sidecar åè®®&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ BPF å¼ºåˆ¶æ‰€æœ‰åº”ç”¨ç¨‹åºæµé‡ç»è¿‡ sidecar ä»£ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¼€å¯ Istio å¯¹å¤–éƒ¨æœåŠ¡çš„æ”¯æŒ
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºå’Œ kTLS æä¾› TLS é“¾æ¥åŠ å¯†çš„å¯è§†åŒ–å’Œæ§åˆ¶ç®¡ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½
&lt;ul&gt;
&lt;li&gt;é«˜æ•ˆç½‘ç»œå’Œ socket é‡å®šå‘åŠ é€Ÿ istio æ€§èƒ½&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;cilium-æ˜¯ä»€ä¹ˆ&#34;&gt;Cilium æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶ï¼Œç”¨äºé€æ˜ä¿æŠ¤åœ¨ä½¿ç”¨ Kubernetesã€Docker å’Œ Mesos ç­‰ Linux å®¹å™¨ç®¡ç†å¹³å°éƒ¨ç½²çš„åº”ç”¨ç¨‹åºæœåŠ¡ä¹‹é—´çš„ç½‘ç»œå’Œ API è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;Cilium çš„åŸºç¡€æ˜¯ä¸€ç§åä¸º BPF çš„æ–° Linux å†…æ ¸æŠ€æœ¯ï¼Œè¿™ä½¿å¾—èƒ½å¤Ÿåœ¨ Linux è‡ªèº«å†…åŠ¨æ€æ¤å…¥å¼ºå¤§çš„å®‰å…¨æ€§ï¼Œå¯è§æ€§å’Œç½‘ç»œæ§åˆ¶é€»è¾‘ã€‚é™¤äº†æä¾›ä¼ ç»Ÿçš„ç½‘ç»œçº§å®‰å…¨æ€§ä¹‹å¤–ï¼ŒBPF çš„çµæ´»æ€§è¿˜å¯ä»¥åœ¨ API å’Œè¿›ç¨‹çº§åˆ«ä¸Šå®ç°å®‰å…¨æ€§ï¼Œä»¥ä¿æŠ¤å®¹å™¨æˆ–å®¹å™¨å†…çš„é€šä¿¡ã€‚ç”±äº BPF åœ¨ Linux å†…æ ¸ä¸­è¿è¡Œï¼Œå› æ­¤æ— éœ€å¯¹åº”ç”¨ç¨‹åºä»£ç æˆ–å®¹å™¨é…ç½®è¿›è¡Œä»»ä½•æ›´æ”¹ä¾¿å¯ä»¥åº”ç”¨å’Œæ›´æ–° Cilium å®‰å…¨ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ Cilium çš„æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œè¯·å‚é˜…&lt;a href=&#34;http://docs.cilium.io/en/v1.1/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium ç®€ä»‹&lt;/a&gt;éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-æ˜¯ä»€ä¹ˆ&#34;&gt;Istio æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Istio æä¾›äº†ä¸€ç§é€šè¿‡è´Ÿè½½å‡è¡¡ã€æœåŠ¡é—´èº«ä»½éªŒè¯ã€ç›‘æ§ç­‰ä¸”æ²¡æœ‰ä¾µå…¥æ€§åˆ›å»ºéƒ¨ç½²æœåŠ¡ç½‘ç»œçš„ç®€ä¾¿æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡åœ¨æ•´ä¸ªç¯å¢ƒä¸­éƒ¨ç½²ç‰¹æ®Šçš„ sidecar ä»£ç†æ¥æ·»åŠ å¯¹æœåŠ¡çš„æ”¯æŒï¼Œè¯¥ä»£ç†æ‹¦æˆªå¾®æœåŠ¡ä¹‹é—´çš„æ‰€æœ‰ç½‘ç»œé€šä¿¡ï¼Œä½¿ç”¨ Istio çš„æ§åˆ¶å¹³é¢åŠŸèƒ½è¿›è¡Œé…ç½®å’Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853bzn1aj311o0rs426_hu_6163944a446a892.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853bzn1aj311o0rs426_hu_4f7966ab730bf4bb.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853bzn1aj311o0rs426_hu_56bd0cfbe94ddce1.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853bzn1aj311o0rs426_hu_6163944a446a892.webp&#34;
               width=&#34;760&#34;
               height=&#34;560&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥åœ¨&lt;a href=&#34;https://istio.io/zh/docs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ–‡æ¡£&lt;/a&gt;ä¸­é˜…è¯»æœ‰å…³ Istio æ¦‚å¿µå’Œæ¶æ„çš„æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-é«˜æ•ˆç½‘ç»œ&#34;&gt;Istio é«˜æ•ˆç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;Istio å’Œ Cilium ä¹‹é—´æœ€åŸºæœ¬çš„åä½œå½¢å¼æ˜¯ Cilium CNI æ’ä»¶é€šè¿‡å°†æ‰€æœ‰ sidecar ä»£ç†è¿æ¥åœ¨ä¸€èµ·å¹¶é€šè¿‡æä¾›ä»£ç†å’Œ Istio æ§åˆ¶å¹³é¢ä¹‹é—´çš„è¿æ¥ï¼Œä¸º Istio æä¾›ç½‘ç»œè¿æ¥ã€‚Cilium è¿˜ç¡®ä¿ Istio æ‰˜ç®¡æœåŠ¡å¯ä»¥ä¸ä¸å— Istio ç®¡ç†çš„ pod è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾è¯´æ˜äº† Istio æ§åˆ¶å¹³é¢ã€sidecar ä»£ç†å’Œ CNI æ’ä»¶å¦‚ä½•ç›¸äº’å åŠ ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-cilium--istio-networking-architecture&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://cilium.io/static/cilium_istio_networking-68a7e3c5272d030e8ca3a717cc348631-84ad3.png&#34; alt=&#34;Cilium &amp;#43; Istio networking architecture&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Cilium + Istio networking architecture
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰ Istio ç³»ç»Ÿç»„ä»¶éƒ½å—ç›Šäº Cilium åœ¨ Linux å†…æ ¸ä¸­åŸºäº BPF çš„é«˜æ•ˆç½‘ç»œåŠŸèƒ½ã€‚BPF æ˜¯ç½‘ç»œå’Œæ•°æ®åŒ…è¿‡æ»¤æŠ€æœ¯ï¼ˆå¦‚ iptables ç­‰ï¼‰çš„æ›¿ä»£æ–¹æ¡ˆã€‚æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹åšå®¢æ–‡ç« ä¸­æ‰¾åˆ°æœ‰å…³ BPF æ¨åŠ¨è¿™ä¸€è½¬å˜çš„åŸå› çš„æ›´å¤šä¿¡æ¯ï¼š&lt;a href=&#34;https://cilium.io/blog/2018/04/17/why-is-the-kernel-community-replacing-iptables/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸ºä»€ä¹ˆå†…æ ¸ç¤¾åŒºç”¨ BPF æ›¿æ¢ iptablesï¼Ÿ&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;socket-çº§åˆ«é‡å®šå‘åŠ é€Ÿ-istio-å’Œ-envoy&#34;&gt;Socket çº§åˆ«é‡å®šå‘åŠ é€Ÿ Istio å’Œ Envoy&lt;/h2&gt;
&lt;p&gt;Istio æœåŠ¡ç½‘æ ¼æ¶æ„è¦æ±‚å°†å‚ä¸æœåŠ¡ç½‘æ ¼çš„æ‰€æœ‰ pod çš„å‡ºç«™å’Œå…¥ç«™è¯·æ±‚çš„æ‰€æœ‰ç½‘ç»œæµé‡éƒ½è¦é‡å®šå‘åˆ° sidecar ä»£ç†ã€‚Sidecar ä»£ç†å°†ç»ˆæ­¢æ‰€æœ‰ TCP è¿æ¥å¹¶æ‰§è¡Œè¯¸å¦‚é¥æµ‹ã€é‡è¯•ã€è·¯ç”±ã€åŒå‘ TLS ä¹‹ç±»çš„æœåŠ¡å’Œä»£è¡¨æœåŠ¡çš„æˆæƒï¼Œå¹¶ä½¿ç”¨è¾…åŠ©æ‰€è°“çš„ä¸Šæ¸¸ TCP è¿æ¥æ¥åˆ°è¾¾ç›®çš„åœ°æœåŠ¡ï¼Œè¿™æ­£æ˜¯æœåŠ¡ä¹‹é—´æ”¯æŒåŒå‘ TLSï¼Œæ²¡æœ‰ä»£ç ä¾µå…¥æ€§åŸå› æ‰€åœ¨ã€‚ç„¶è€Œï¼Œå½“ä½¿ç”¨æ ‡å‡†çš„åŸºäº IP çš„å·¥å…·ï¼ˆå¦‚ iptablesï¼‰å®ç°é‡å®šå‘æ—¶ï¼Œè¿™ç§é‡å®šå‘å¯èƒ½ä¼šå¾ˆè´¹äº‹ï¼Œå› ä¸ºå¿…é¡»å¤šæ¬¡éå†æ•´ä¸ª TCP/IP å †æ ˆã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853qn3w1j30fi0bo0tx_hu_ef4986d5e8cc190f.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853qn3w1j30fi0bo0tx_hu_8eccb474fbb02b65.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853qn3w1j30fi0bo0tx_hu_11219970c88d7b39.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu853qn3w1j30fi0bo0tx_hu_ef4986d5e8cc190f.webp&#34;
               width=&#34;558&#34;
               height=&#34;420&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium å……åˆ†ä½¿ç”¨äº†ä¸€ä¸ªå« sockmap çš„ä»¤äººå…´å¥‹çš„ BPF åŠŸèƒ½ã€‚å®ƒå…è®¸è¿‡æ»¤å’Œé‡å®šå‘ï¼ŒåŸºäºå¥—æ¥å­—çº§åˆ«ï¼Œä½¿ Cilium å¯ä»¥ socket æ„ŸçŸ¥ã€‚æ­¤ socket æ˜¯åº”ç”¨ç¨‹åºç”¨äºå‘é€å’Œæ¥æ”¶ç½‘ç»œæµé‡çš„æ¥å£ã€‚è¿™å…è®¸åœ¨ç›¸åŒèŠ‚ç‚¹ä¸Šå®è´¨ä¸ŠçŸ­è·¯ TCP socketï¼Œä»è€Œä»¥å®Œå…¨é€æ˜çš„æ–¹å¼å¤§å¹…åŠ é€Ÿåº”ç”¨ç¨‹åºå’ŒæœåŠ¡ç½‘æ ¼çš„ sidecar ä»£ç†çš„é€šä¿¡é€Ÿåº¦ã€‚åº”ç”¨ç¨‹åºå’Œ sidecar ä»£ç†éƒ½ä¸éœ€è¦ä»¥ä»»ä½•æ–¹å¼è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£æœ‰å…³æ­¤ç”¨ä¾‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä½äºå¥¥æ–¯æ±€çš„ KubeCon 2018 ä¸Šçš„æ¼”ç¤ºæ–‡ç¨¿â€”â€”&lt;strong&gt;ä½¿ç”¨ CIlium åŠ é€Ÿ Envoyã€Istio å’Œ Linux å†…æ ¸ï¼ˆ&lt;a href=&#34;https://t.co/cx6CQhn1xl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å½•åƒ&lt;/a&gt;ã€&lt;a href=&#34;https://www.slideshare.net/ThomasGraf5/accelerating-envoy-and-istio-with-cilium-and-the-linux-kernel&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¹»ç¯ç‰‡&lt;/a&gt;ï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”¨-cilium-å¢å¼º-istio-å®‰å…¨æ€§&#34;&gt;ç”¨ Cilium å¢å¼º Istio å®‰å…¨æ€§&lt;/h2&gt;
&lt;p&gt;Cilium ä¸ Istio æ•´åˆï¼Œä»¥å¢å¼º Istio çš„å®‰å…¨æ€§ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ Istio æä¾›çš„å®‰å…¨å±æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒå‘ TLSï¼šå¦‚æœå‘é€è€…ç”± Istio æ§åˆ¶ï¼Œåˆ™èƒ½å¤ŸéªŒè¯å‘ä»¶äººçš„èº«ä»½ã€‚è¿™å¯ä»¥ä¿æŠ¤æœåŠ¡å…å—æ¥è‡ªéæ³•æºæœåŠ¡æ¬ºéª— IP åœ°å€çš„æ”»å‡»è¯·æ±‚ã€‚å®ƒè¿˜å¯ä»¥åœ¨ Istio ç®¡ç†çš„æ‰€æœ‰æœåŠ¡ä¹‹é—´å¯ç”¨åŸºäº TLS/SSL çš„åŠ å¯†ã€‚&lt;/li&gt;
&lt;li&gt;æˆæƒï¼šèƒ½å¤Ÿæˆæƒè¯·æ±‚ï¼ŒåŒ…æ‹¬è¿‡æ»¤å…ƒæ•°æ®ï¼ˆå¦‚ HTTP åè®®å­—æ®µï¼ŒIP å¯»å€å’Œèº«ä»½ä¿¡æ¯ï¼‰ä»¥åŠè°ƒç”¨å…¶ä»–æˆæƒæ’ä»¶ï¼ˆä¾‹å¦‚ï¼Œæ‰§è¡Œä»¤ç‰ŒéªŒè¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;level-1-ä¿æŠ¤ä¸å—æ”¯æŒçš„åè®®å’Œå—æŸçš„-sidecarcilium-10&#34;&gt;LEVEL 1: ä¿æŠ¤ä¸å—æ”¯æŒçš„åè®®å’Œå—æŸçš„ sidecarï¼ˆCilium 1.0ï¼‰&lt;/h2&gt;
&lt;p&gt;æ‰€éœ€çš„ç¬¬ä¸€ä¸ªåŸºæœ¬ä¿æŠ¤çº§åˆ«æ˜¯å°†å®‰å…¨ç­–ç•¥åº”ç”¨äº Istio ä¸æ”¯æŒçš„æ‰€æœ‰ç½‘ç»œåè®®ï¼ŒåŒ…æ‹¬ UDPã€ICMP å’Œæ‰€æœ‰ IPv6 æµé‡ã€‚ä»»ä½•æ­¤ç±»æµé‡éƒ½ä¼šç»•è¿‡ sidecar ä»£ç†ï¼Œä»è€Œé€šè¿‡ Istio å¼ºåˆ¶æ‰§è¡Œä»»ä½•æœ€ç»ˆå®‰å…¨ç­–ç•¥ã€‚æ— è®ºåè®®å¦‚ä½•ï¼ŒCilium å°† pod ä¹‹å¤–æ‰€æœ‰ç½‘ç»œæµé‡åº”ç”¨ L3/L4 å®‰å…¨ç­–ç•¥ã€‚å¦‚æœé‡åˆ°ä¸æ”¯æŒçš„åè®®ï¼Œåˆ™å°†ä¸¢å¼ƒè¯¥æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-slide&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://cilium.io/static/cilium_istio_security-36e68cf344d09a1df787a22e4035d045-84ad3.png&#34; alt=&#34;Slide&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Slide
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®‰å…¨åŒ–éIPv4/TCPåè®®&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Cilium åœ¨ pod ä¹‹å¤–æä¾›å®‰å…¨ç­–ç•¥ï¼Œå¯¹äºåè®®ä¸å—æ”¯æŒã€é‡å®šå‘æˆ–ç”±äºæŸäº›å…¶ä»–åŸå› è€Œå¤±è´¥ï¼Œå°†å®Œå…¨é˜»æ­¢æˆ–åº”ç”¨ç»†ç²’åº¦çš„å®‰å…¨è§„åˆ™åˆ°ä»»ä½•ç»•è¿‡ä»£ç†çš„æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é˜²æ­¢å—æŸçš„ sidecar&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;sidecar ä»£ç†æœ¬èº«ä¸å— Istio å®‰å…¨è§„åˆ™çš„çº¦æŸã€‚å—æŸçš„ sidecar å¯ä»¥ä¸å—é™åˆ¶åœ°è®¿é—®ç½‘ç»œã€‚å®ƒè¿˜å¯ä»¥æ“çºµè‡ªå·±çš„å®‰å…¨è§„åˆ™ä»¥å˜å¾—æ›´åŠ å®½æ¾ã€‚é™¤äº† Istio ä¹‹å¤–ï¼ŒCilium è¿˜å…è®¸å®šä¹‰æœåŠ¡çº§åˆ«å®‰å…¨ç­–ç•¥ï¼Œå¹¶ç¡®ä¿å—æŸçš„ sidecar ä»£ç†åªèƒ½ä»¥æœ€å°æƒé™è¿è¡Œã€‚&lt;/p&gt;
&lt;h2 id=&#34;level2-å®‰å…¨çš„å¤šå®¹å™¨-podæ­£åœ¨å¼€å‘ä¸­&#34;&gt;LEVEL2: å®‰å…¨çš„å¤šå®¹å™¨ Podï¼ˆæ­£åœ¨å¼€å‘ä¸­ï¼‰&lt;/h2&gt;
&lt;p&gt;Level 1 å®‰å…¨çº§åˆ«ä»¥ podã€service ä¸ºçº§åˆ«ä¿æŠ¤æœåŠ¡ç½‘æ ¼ã€‚å®ƒä¸æä¾›å®¹å™¨å†…éƒ¨çš„ä»»ä½•å®‰å…¨æ€§ï¼Œä¾‹å¦‚ç”¨äºåº”ç”¨å®¹å™¨å’Œ sidecar å®¹å™¨ä¹‹é—´çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;Level 2 å®‰å…¨çº§åˆ«é€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºåœ¨ socket çº§åˆ«æä¾›åˆ†æ®µï¼Œåœ¨åŒä¸€ä¸ª pod ä¸­å¼•å…¥å®¹å™¨å’Œè¿›ç¨‹ä¹‹é—´çš„åˆ†æ®µã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854newqhj312w0iijud_hu_62de84944e2ec5b0.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854newqhj312w0iijud_hu_e49e44afe6fee3ec.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854newqhj312w0iijud_hu_cfa2d6e1e468cc76.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854newqhj312w0iijud_hu_62de84944e2ec5b0.webp&#34;
               width=&#34;760&#34;
               height=&#34;362&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¼ºåˆ¶æ‰€æœ‰åº”ç”¨æµé‡æµç» sidecar: é€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç­–ç•¥ï¼ŒCilium å¯ä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„æ‰€æœ‰é€šä¿¡éƒ½å¿…é¡»é€šè¿‡ sidecar è¿›è¡Œå…¥ç«™å’Œå‡ºç«™è¿æ¥ã€‚ä¿è¯åº”ç”¨ç¨‹åºå®¹å™¨æœ¬èº«ä¸èƒ½ä» pod å¤–éƒ¨æ¥æ”¶è¿æ¥ï¼Œæˆ–è€…åœ¨ä¸é€šè¿‡ sidecar ä»£ç†çš„æƒ…å†µä¸‹å‘ pod å¤–éƒ¨å‘å‡ºè¯·æ±‚ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pod ä¸­çš„æœ€å°å®‰å…¨æƒé™ï¼šé€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºé”å®šå®¹å™¨å†…éƒ¨å’Œè¿›ç¨‹çº§åˆ«çš„é€šä¿¡ï¼Œå…¶ä¸­ä¸€ä¸ªå®¹å™¨ä¸­çš„å®‰å…¨æ¼æ´ä¸å†å¯¼è‡´æ•´ä¸ªå®¹å™¨è¢«æ³„éœ²ã€‚è¿™å°¤å…¶é‡è¦ï¼Œå› ä¸º sidecar å®¹å™¨å¯ä»¥ç›´æ¥è®¿é—® pod ä¸­çš„ä»»ä½•å…¶ä»–å®¹å™¨ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®æ½œåœ¨çš„æ•æ„Ÿä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœ‰è¶£çš„äº‹å®&#34;&gt;æœ‰è¶£çš„äº‹å®&lt;/h2&gt;
&lt;p&gt;æ”¯æŒ socket çš„ BPF ç¨‹åºä¸ä»…é™äºåŸºäº IP çš„ socketã€‚å®‰å…¨ç­–ç•¥ä¹Ÿå¯ä»¥æ‰©å±•åˆ°æ¶µç›– UNIX åŸŸ socketã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤–éƒ¨æœåŠ¡çš„-tls-å¯è§æ€§æ­£åœ¨å¼€å‘ä¸­&#34;&gt;å¤–éƒ¨æœåŠ¡çš„ TLS å¯è§æ€§ï¼ˆæ­£åœ¨å¼€å‘ä¸­ï¼‰&lt;/h2&gt;
&lt;p&gt;Istio ä¾èµ–äºå¯¹åº”ç”¨ç¨‹åºåè®®å±‚ï¼ˆå¦‚ HTTPï¼‰çš„å¯è§æ€§ï¼Œä»¥æä¾›è¯¸å¦‚åŸºäº URI çš„è·¯ç”±ï¼ŒåŸºäº HTTP å¤´çš„æˆæƒå’Œ API è¯·æ±‚çº§åˆ«é¥æµ‹å’Œè·Ÿè¸ªç­‰åŠŸèƒ½ã€‚é€šè¿‡å°†åŒå‘ TLS ä¸ Istio Citadel ç®¡ç†çš„è¯ä¹¦ç›¸äº’åº”ç”¨ï¼Œå¯ä»¥åœ¨æœªåŠ å¯†çš„æœåŠ¡ä¹‹é—´ä¿æŒåº”ç”¨ç¨‹åºæµé‡å¹¶åœ¨æºæœåŠ¡å™¨å’Œç›®æ ‡æœåŠ¡çš„ sidecar ä»£ç†ä¹‹é—´æ‰§è¡Œ TLS åŠ å¯†æ¥å®ç°æ­¤å¯è§æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854xy8csj312w0f2jsu_hu_62f72afe021d1464.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854xy8csj312w0f2jsu_hu_d033ad553a766dd2.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854xy8csj312w0f2jsu_hu_e5996cc445e86179.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu854xy8csj312w0f2jsu_hu_62f72afe021d1464.webp&#34;
               width=&#34;760&#34;
               height=&#34;294&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™é€‚ç”¨äºç½‘æ ¼å†…éƒ¨æœåŠ¡ä¹‹é—´çš„è¿æ¥ã€‚ä¸ç½‘æ ¼ä¹‹å¤–çš„æœåŠ¡çš„é€šä¿¡å‡ ä¹ç”±åº”ç”¨ç¨‹åºæœ¬èº«è¿›è¡Œ TLS åŠ å¯†ä¿è¯ï¼Œä»¥ä¾¿åœ¨ä¸å¯ä¿¡çš„å› ç‰¹ç½‘ä¸Šä¿æŠ¤é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu8555b0z3j312w0e8t9y_hu_c0486870e02593b.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu8555b0z3j312w0e8t9y_hu_9ecdd1827c1d6fa2.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu8555b0z3j312w0e8t9y_hu_27cd83443350ed87.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu8555b0z3j312w0e8t9y_hu_c0486870e02593b.webp&#34;
               width=&#34;760&#34;
               height=&#34;278&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Linux çš„ kTLSï¼ˆå†…æ ¸ TLSï¼‰å·¥ä½œåŸç†æœ€åˆæ˜¯ç”± Facebook çš„ Dave Watson æå‡ºã€‚å®ƒåŒ…æ‹¬å°†æ•°æ®çš„å¯¹ç§°åŠ å¯†ä»åº”ç”¨ç¨‹åºä¸­çš„ SSL åº“è¿ç§»åˆ° Linux å†…æ ¸ä¸­çš„ socket åŠŸèƒ½ã€‚è¿™é¡¹å·¥ä½œçš„æœ€åˆåŠ¨æœºæ˜¯çº¯ç²¹çš„æ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸ºä½¿ç”¨ kTLS æ¯” SSL åº“å¿« 3-4ï¼…ã€‚è¿™å¯¹äºç»è¿‡ SSL é™æ€æ•°æ®çš„æä¾›è€…æœ‰è¶³å¤Ÿçš„å…´è¶£å»ç»§ç»­ã€‚è¿™é¡¹å·¥ä½œå·²ç»åˆå¹¶ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æœ€æ–°çš„ Linux å†…æ ¸ä¸­ä½¿ç”¨ã€‚ç»“åˆåœ¨ Linux socket å±‚æ³¨å…¥çš„ BPF ç¨‹åºçš„åŠŸèƒ½ï¼ŒkTLS å®ç°äº†æ•°æ®çš„é€æ˜å¯è§æ€§ï¼Œå¦åˆ™æ­¤æ—¶å·²åŠ å¯†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855axcscj312w0gdgn4_hu_927cd6bf740f2422.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855axcscj312w0gdgn4_hu_9355a39962aa4ece.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855axcscj312w0gdgn4_hu_95808ae689e6ae6c.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855axcscj312w0gdgn4_hu_927cd6bf740f2422.webp&#34;
               width=&#34;760&#34;
               height=&#34;320&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä»åœ¨ç ”ç©¶è¿™ä¸ªåŠŸèƒ½ï¼Œä½†æœ‰ä¸€ä¸ªåˆå§‹çš„åŠŸèƒ½åŸå‹ï¼Œè¯æ˜äº†è·å¾—å¯è§æ€§å’Œæ§åˆ¶æ•°æ®çš„æ¦‚å¿µï¼Œè¿™äº›æ•°æ®é€šå¸¸æ˜¯åœ¨åº”ç”¨ç¨‹åºæœ¬èº«ä¸­è¿›è¡Œ TLS åŠ å¯†çš„ã€‚ä¸‹ä¸€æ­¥æ˜¯å°†æ­¤æ•°æ®æä¾›ç»™ sidecarï¼Œä»¥ä¾¿åœ¨ä¸å¤–éƒ¨æœåŠ¡çš„è¿æ¥ä¸Šé‡Šæ”¾ Istioã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855mb70uj312w0lm77l_hu_ba7bb26b0fc24cae.webp 400w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855mb70uj312w0lm77l_hu_d270b3e3c0998ab6.webp 760w,
               /blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855mb70uj312w0lm77l_hu_ea3fc7095451c57e.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-cilium-enhances-istio-with-socket-aware-bpf-programs/0069RVTdly1fu855mb70uj312w0lm77l_hu_ba7bb26b0fc24cae.webp&#34;
               width=&#34;760&#34;
               height=&#34;423&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;åœ¨æ²¡ä¾µå…¥åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹-ktls-æ˜¯å¦‚ä½•å®ç°é€æ˜åŒ–çš„&#34;&gt;åœ¨æ²¡ä¾µå…¥åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ kTLS æ˜¯å¦‚ä½•å®ç°é€æ˜åŒ–çš„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å…¬å¹³åœ°è¯´ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨çš„ SSL åº“å¿…é¡»æ„ŸçŸ¥ kTLSï¼Œå¹¶ä¸”ç”¨æˆ·å¿…é¡»é€‰æ‹©ç³»ç»Ÿçº§åˆ«çš„è¡Œä¸ºã€‚åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶å‡çº§ SSL ç‰ˆæœ¬å’Œå¯åŠ¨å¯è§†åŒ–ä¸€æ ·ç®€å•ï¼Œæ²¡æœ‰ä¾µå…¥åº”ç”¨ç¨‹åºã€‚ç”±äºå¯è§æ€§æ˜¯åœ¨ socket çº§åˆ«è·å¾—çš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€åº”ç”¨ç¨‹åºåœ¨æ’é˜Ÿåæ— æ³•å†æ›´æ”¹æ­¤æ•°æ®ã€‚å¦‚æœæ•°æ®ç”¨äºæˆæƒè¯·æ±‚ï¼Œåˆ™è¿™ä¸€ç‚¹è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¦‚è¦&#34;&gt;æ¦‚è¦&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¼º Istio å®‰å…¨
&lt;ul&gt;
&lt;li&gt;pod ä¸­æœ€å°æƒé™ï¼šé€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºé”å®šå®¹å™¨å†…éƒ¨å’Œè¿›ç¨‹çº§åˆ«çš„é€šä¿¡ï¼Œå…¶ä¸­ä¸€ä¸ªå®¹å™¨ä¸­çš„å®‰å…¨æ¼æ´ä¸å†å¯¼è‡´æ•´ä¸ªå®¹å™¨è¢«æ³„éœ²ã€‚&lt;/li&gt;
&lt;li&gt;å®‰å…¨åŒ–éIPv4/TCPåè®®ï¼šç›®å‰ï¼ŒIstioä»…æ”¯æŒTCPå’ŒIPv4ã€‚ä»»ä½•å…¶ä»–åè®®ï¼ˆå¦‚UDPæˆ–IPv6ï¼‰éƒ½å°†ç»•è¿‡sidecarä»£ç†å’Œä»»ä½•Istioå®‰å…¨è§„åˆ™ï¼ŒCiliumå°†é€šè¿‡å®Œå…¨é˜»æ­¢è¿™äº›åè®®æˆ–åº”ç”¨ç»†ç²’åº¦çš„å®‰å…¨è§„åˆ™æ¥ä»‹å…¥ã€‚&lt;/li&gt;
&lt;li&gt;é˜²æ­¢å—æŸçš„ sidecarï¼šsidecar ä»£ç†æœ¬èº«ä¸å— Istio å®‰å…¨è§„åˆ™çš„çº¦æŸã€‚å—æŸçš„ sidecar å¯ä»¥ä¸å—é™åˆ¶åœ°è®¿é—®ç½‘ç»œã€‚å®ƒè¿˜å¯ä»¥æ“çºµè‡ªå·±çš„å®‰å…¨è§„åˆ™ä»¥å˜å¾—æ›´åŠ å®½æ¾ã€‚é™¤äº† Istio ä¹‹å¤–ï¼ŒCilium è¿˜å…è®¸å®šä¹‰æœåŠ¡çº§åˆ«å®‰å…¨ç­–ç•¥ï¼Œå¹¶ç¡®ä¿å—æŸçš„è¾¹è½¦ä»£ç†åªèƒ½ä»¥æœ€å°çš„æƒé™è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å‰ç½®åº”ç”¨æµé‡ç»è¿‡ sidecarï¼šé€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç­–ç•¥ï¼ŒCilium å¯ä»¥ç¡®ä¿åº”ç”¨ç¨‹åºçš„æ‰€æœ‰é€šä¿¡éƒ½å¿…é¡»é€šè¿‡ sidecar è¿›è¡Œå…¥ç«™å’Œå‡ºç«™è¿æ¥ã€‚ä¿è¯åº”ç”¨ç¨‹åºå®¹å™¨æœ¬èº«ä¸èƒ½ä» pod å¤–éƒ¨æ¥æ”¶è¿æ¥ï¼Œæˆ–è€…åœ¨ä¸é€šè¿‡ sidecar ä»£ç†çš„æƒ…å†µä¸‹å‘ pod å¤–éƒ¨å‘å‡ºè¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨æœåŠ¡
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ SSL ä¸º Istio åŠ å¯†é“¾æ¥ï¼šä¸ç¾¤é›†å¤–éƒ¨æœåŠ¡çš„ TCP è¿æ¥é€šå¸¸æ˜¯ TLS åŠ å¯†çš„ï¼Œå¹¶ä¸” Istio æ— æ³•æ£€æŸ¥æ­¤ç±»è¿æ¥çš„ HTTP å¤´ã€‚é€šè¿‡åˆ©ç”¨ kTLS é›†æˆåˆ°å†…æ ¸ä¸­çš„ BPFï¼ŒCilium å°†èƒ½å¤Ÿæä¾›å¯¹ TLS åŠ å¯†æ•°æ®çš„å¯è§æ€§å’Œæ§åˆ¶ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ€§èƒ½
&lt;ul&gt;
&lt;li&gt;é«˜æ•ˆç½‘ç»œï¼šIstio éœ€è¦ä¸€ä¸ª CNI æ’ä»¶æ¥æä¾› pod ä¹‹é—´çš„ç½‘ç»œè¿æ¥ã€‚Cilium å®ç°äº† CNI æ’ä»¶æ¥å£ï¼Œå¹¶åˆ©ç”¨ BPF åœ¨ sidecar ä»£ç†å’Œ Istio æ§åˆ¶å¹³é¢ä¹‹é—´æä¾›é«˜æ•ˆçš„æ•°æ®è·¯å¾„ã€‚&lt;/li&gt;
&lt;li&gt;socket é‡å®šå‘åŠ é€Ÿ Istioï¼šé€šè¿‡ä½¿ç”¨ socket æ„ŸçŸ¥ BPF ç¨‹åºåœ¨ Linux socket çº§åˆ«æ‰§è¡Œæµé‡é‡å®šå‘ï¼ŒCilium å¯ä»¥åŠ é€Ÿæµé‡é‡å®šå‘åˆ° sidecar ä»£ç†ã€‚è¿™å…è®¸ç»•è¿‡å¾ˆè´¹äº‹çš„ TCP/IP å †æ ˆéå†è€Œä¸”å¯¹åº”ç”¨ç¨‹åºæˆ– sidecar ä»£ç æ²¡æœ‰ä¾µå…¥æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£æ›´å¤šä¿¡æ¯&#34;&gt;å¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£æ›´å¤šä¿¡æ¯ï¼š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://docs.cilium.io/en/stable/gettingstarted/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯•ç”¨å…¥é—¨æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://docs.cilium.io/en/stable/concepts/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº†è§£æœ‰å…³ Cilium æ¦‚å¿µçš„æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cilium.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥æˆ‘ä»¬çš„ Slack Channel&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>æ¢è®¨ Service Mesh ä¸­ä¸€ç§æ›´é«˜æ•ˆçš„ä»£ç†æ¨¡å¼</title>
      <link>https://cloudnativecn.com/blog/a-new-more-efficient-proxy-model/</link>
      <pubDate>Sun, 01 Jul 2018 12:33:23 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/a-new-more-efficient-proxy-model/</guid>
      <description>&lt;h2 id=&#34;èƒŒæ™¯å’Œæƒ³æ³•&#34;&gt;èƒŒæ™¯å’Œæƒ³æ³•&lt;/h2&gt;
&lt;p&gt;Service Mesh æä¾›äº†å¾®æœåŠ¡åŒ–å¼€å‘çš„æ–°æ€è·¯ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯æ„å»ºä¸€ä¸ªä»£ç†è½¬å‘ç½‘ç»œå¹¶ç»“åˆæ§åˆ¶å’Œè½¬å‘åˆ†ç¦»çš„åšæ³•æ¥å¯¹æˆåƒä¸Šä¸‡ä¸ªå¾®æœåŠ¡é—´åšæµé‡ã€ç­–ç•¥ã€å®‰å…¨ç­‰ç®¡ç†ï¼Œè€Œå¦ä¸€æ–¹é¢ Linux Kernel æä¾›ä¸€ç§è¿è¡Œæ—¶é«˜æ•ˆæ‰©å¯ç¼–ç¨‹çš„ç½‘ç»œæ³¨å…¥æœºåˆ¶ eBPFï¼Œå€Ÿæ­¤èƒ½å®ç° L47 å±‚ä»£ç†è½¬å‘ã€‚å‡è®¾å€ŸåŠ© eBPFï¼Œä½œä¸º Service Mesh çš„æ•°æ®è½¬å‘å±‚ï¼Œå¯¹æ¥ Pilotã€Mixer ç­‰æ§åˆ¶é¢ï¼Œå®ç°ç­–ç•¥ã€æµé‡å’Œå®‰å…¨ç®¡ç†ï¼Œæ˜¯ä¸æ˜¯ä¸€ç§æ›´é«˜æ•ˆçš„æ–¹å¼ï¼Ÿè¿™ä¼šæ¯” Envoy æ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œè™½ç„¶æ€§èƒ½æœªå¿…æ˜¯ Mesh é¦–è¦è€ƒè™‘çš„é—®é¢˜ï¼Œåæœç´¢å‘ç° Cilium æœç„¶åšäº†ç±»ä¼¼çš„å°è¯•ï¼Œè¯¦æƒ…è§ &lt;a href=&#34;http://docs.cilium.io/en/latest/gettingstarted/istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://docs.cilium.io/en/latest/gettingstarted/istio/&lt;/a&gt;ï¼Œä½†å¯¹æ¥çš„æ–¹å¼å¾ˆç‰¹åˆ«ï¼Œå¹¶ä¸åƒ Envoy ä¸€æ ·ï¼Œä¸ºæ¯ä¸€ä¸ª Pod éƒ¨ç½²ä¸€ä¸ª Envoy å®¹å™¨ï¼Œè€Œæ˜¯åœ¨å¤šä¸ª Pod å¤–éƒ¨ç½²ä¸€ä¸ª Ciliumï¼Œä»¥ Kubernetes Daemon Set æ¨¡å¼éƒ¨ç½²ï¼Œä¸ºå¤šä¸ª Pod è¿›è¡Œä»£ç†ï¼Œå¯¹æ§åˆ¶å™¨å±‚é¢çš„ Pilot åšäº†å®šåˆ¶ï¼Œéƒ¨ç½²é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sed -e &lt;span class=&#34;s1&#34;&gt;&amp;#39;s,docker\.io/istio/pilot:,docker.io/cilium/istio_pilot:,&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;      &amp;lt; &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ISTIO_HOME&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/install/kubernetes/istio.yaml &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;      kubectl create -f -
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Cilium éƒ¨ç½²äº†ä¸€ä¸ªâ€œä¹¦åº—â€é›†ç¾¤æœåŠ¡ä¸ºä¾‹å­æ¥è¯´æ˜ï¼Œå¦‚ä¸‹ï¼Œåœ¨ä¸‹å‘â€œè·¯ç”±ç­–ç•¥â€ä¹‹å‰æµé‡å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://raw.githubusercontent.com/servicemesher/website/master/content/blog/a-new-more-efficient-proxy-model/00704eQkgy1fsu96134y9j30cj09rt93.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ­£å¸¸æµé‡ä»ä¹¦é¡µåˆ°è¯¦æƒ…é¡µï¼Œåˆ°è¯„è®ºé¡µé¢&lt;/p&gt;
&lt;p&gt;é…ç½®ä¸€æ¡ istio è·¯ç”±ç­–ç•¥ï¼ŒæŠŠæµé‡å…¨éƒ¨å¯¼å‘ reviews-v1ï¼Œreviews-v2 æ²¡æœ‰æµé‡&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;config.istio.io/v1alpha2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RouteRule&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews-default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;precedence&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯¼æµåå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://raw.githubusercontent.com/servicemesher/website/master/content/blog/a-new-more-efficient-proxy-model/00704eQkgy1fsu96jwbo7j30jh0d8dgv.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¯è§ï¼ŒCilium èƒ½è¯†åˆ« service-name å’Œ labelsï¼Œå¹¶è¿›è¡Œå¯¼æµã€‚ç­–ç•¥ç›¸å½“çµæ´»ã€‚&lt;/p&gt;
&lt;p&gt;Cilium è¿˜åšäº†ä¸ªæ€§èƒ½æµ‹è¯•ï¼Œåœ¨ Pod - Proxy - Pod åœºæ™¯ä¸‹çš„è¯·æ±‚å»¶è¿Ÿå¯¹æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://raw.githubusercontent.com/servicemesher/website/master/content/blog/a-new-more-efficient-proxy-model/00704eQkgy1fsu96qkxthj30jg0ay0um.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium çš„å»¶è¿Ÿå…¨éƒ¨å°äºå½“å‰çš„ Envoyã€Nginxã€Haproxy ä»£ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»æœåŠ¡åŒ–-springcloud-æ¡†æ¶å¼€å§‹&#34;&gt;ä»æœåŠ¡åŒ– SpringCloud æ¡†æ¶å¼€å§‹&lt;/h2&gt;
&lt;p&gt;æˆ‘æ¯”è¾ƒèµåŒå¾®æœåŠ¡æ˜¯ä¸€ç§ SOA çš„è¡ç”Ÿå½¢æ€çš„è§‚ç‚¹ï¼Œå¾®æœåŠ¡å¹¶ä¸å®Œå…¨æ˜¯ä¸€ç§æ–°çš„ä¸œè¥¿ã€‚SpringCloud å°±æ˜¯ä¸€ç§å¾®æœåŠ¡åŒ–åº”ç”¨æ¡†æ¶ï¼Œç›®çš„åœ¨äºå¸®åŠ©åº”ç”¨å¿«é€Ÿè¿›è¡Œå¾®æœåŠ¡åŒ–å¼€å‘ï¼Œå®˜æ–¹å®šä½å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spring Cloud provides tools for developers to quickly build some of the common patterns in distributed systems (e.g. configuration management, service discovery, circuit breakers, intelligent routing, micro-proxy, control bus, one-time tokens, global locks, leadership election, distributed sessions, cluster state). Coordination of distributed systems leads to boiler plate patterns, and using Spring Cloud developers can quickly stand up services and applications that implement those patterns.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æä¾›äº†å¾®æœåŠ¡æ‰€éœ€çš„é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æœåŠ¡ç¯è·¯å‘ç°ã€æ™ºèƒ½è·¯ç”±ã€ä»£ç†ã€å…¨å±€é”ã€é›†ç¾¤é€‰ä¸»ã€åˆ†å¸ƒå¼ Sessionã€é›†ç¾¤çŠ¶æ€ç®¡ç†ç­‰åŸºç¡€èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–°æœåŠ¡åŒ–è½¬æŠ˜ç‚¹-service-mesh&#34;&gt;æ–°æœåŠ¡åŒ–è½¬æŠ˜ç‚¹ Service Mesh&lt;/h2&gt;
&lt;p&gt;è€Œ 2016 å¹´ï¼Œä¸¤ä¸ªä¸ä¸ºäººçŸ¥çš„å°é¡¹ç›® linked å’Œ Envoy ä¹Ÿè®¸æ²¡æœ‰æƒ³åˆ°è‡ªå·±åœ¨ä¸¤å¹´åçš„ä»Šå¤©æ‰¿è½½äº†ä¸‹ä¸€ä»£å¾®æœåŠ¡æ¡†æ¶çš„ä½¿å‘½ï¼šæ— ä¾µå…¥å¼å¾®æœåŠ¡æ¶æ„ï¼Œè¿™ç§æ¶æ„ç›®å‰æœ‰æ˜Ÿæ˜Ÿç‡åŸä¹‹åŠ¿å–ä»£ SpringCloud æ¨¡å¼æˆä¸ºè½¬æŠ˜ç‚¹ï¼Œæ–°æ¶æ„å®Œå…¨è§£è€¦å¾®æœåŠ¡æ¡†æ¶å’Œåº”ç”¨ï¼Œä½¿åº”ç”¨èŠ‚ç‚¹ä¸å†å…³å¿ƒæœåŠ¡æ³¨å†Œã€å‘ç°ã€è°ƒç”¨ç­‰é—®é¢˜ï¼Œåº”ç”¨åªç®¡æŠŠè¯·æ±‚å‘é€ç»™ä¸åº”ç”¨å…±éƒ¨ç½²çš„ä»£ç†è¿›ç¨‹ï¼Œè¿™ä¸ªä»£ç†è¿›ç¨‹å¯¹å†…å¤–æ‰¿æ¥åº”ç”¨æ‰€æœ‰çš„è¯·æ±‚ï¼Œå¹¶è‡ªèº«ç»„æˆä¸€ä¸ªç½‘ç»œï¼Œç›¸äº’é—´è°ƒç”¨ï¼Œæœ€ç»ˆæŠŠè¯·æ±‚è¿”å›ç»™åº”ç”¨ï¼Œè¿™æ„å‘³ç€åº”ç”¨åªå…³å¿ƒè‡ªèº«ä¸šåŠ¡å®ç°ï¼Œä¸å†å…³å¿ƒè¯·æ±‚æ˜¯å¦‚ä½•å‘é€çš„ï¼Œå‘é€åˆ°å“ªé‡Œçš„ï¼Œç»Ÿä¸€ç”±ä»£ç†è¿›ç¨‹è¿›è¡Œè½¬å‘ã€‚å¹¶ä¸”åº”ç”¨ä»£ç å¯ä»¥ç”¨ä»»ä½•è¯­è¨€å®ç°ï¼Œåœ¨ä»£ç å±‚é¢å’Œæ¡†æ¶å®Œå…¨è§£è€¦ï¼Œä¸åƒ SpringCloud åº”ç”¨è¿›ç¨‹éœ€è¦åŸºäºè¿™ä¸ªæ¡†æ¶è¿›è¡Œå¼€å‘ï¼Œè€Œæ˜¯å½»åº•åœ°ä»åº”ç”¨è¿›ç¨‹ä¸­åˆ†ç¦»ï¼Œè¿™ç§è§£è€¦ä¼¼ä¹ä¸€ä¸‹å­ä½¿æ•´ä½“ç³»ç»Ÿçš„å¤æ‚åº¦ä¸‹é™äº†ä¸€ä¸ªçº§åˆ«ã€‚æ¡†æ¶ä»åº”ç”¨ä»£ç ä¸­å®Œå…¨ä¸‹æ²‰åˆ°äº†å¦ä¸€ä¸ªä»£ç†è¿›ç¨‹ä¸­ï¼Œåº”ç”¨å’Œâ€œä»£ç†â€ä»…ä»¥æ ‡å‡†çš„åè®®äº¤äº’ï¼Œæ¢å¥è¯è¯´ï¼Œæ¡†æ¶ä»å‡½æ•°çº§åˆ«çš„æ¥å£å˜æˆäº†è¿›ç¨‹é—´é€šè®¯æ¥å£ã€‚è¿™ç§å½»åº•çš„è§£è€¦è®©åº”ç”¨æŠ›å¼€â€œåŒ…è¢±â€å˜å¾—è½»é‡ï¼Œè¿™åœ¨å¤æ‚ç³»ç»Ÿå’Œèµ„æºæ•æ„Ÿå‹ç³»ç»Ÿä¸­éå¸¸æœ‰å¥½å¤„ï¼Œæ¯”å¦‚åº”ç”¨å¯ä»¥ä½¿ç”¨ç›¸æ¯” Java å ç”¨èµ„æºçš„ golang è¯­è¨€ç¼–å†™ç¨‹åºï¼›æ¯”å¦‚æ”¹å˜ä¸šåŠ¡ä»£ç æ›´åŠ å®¹æ˜“ï¼Œä¹Ÿä¸ä¼šå› ä¸ºæ¡†æ¶æ”¹å˜å¯¼è‡´ä¸šåŠ¡ä»£ç æ”¹å˜ã€‚è¿›è€Œä¸å¦¨å†å¤§èƒ†æƒ³è±¡ä¸€ä¸‹ï¼Œæ›¾ç»æˆ‘ä»¬ä½¿ç”¨çš„ database library æ˜¯å¦ä¹Ÿå¯ä»¥ä»åº”ç”¨ä»£ç é‡Œå‰¥ç¦»å‡ºæ¥ä¸‹æ²‰åˆ°ä»£ç†è¿›ç¨‹å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;2016 å¹´ 9 æœˆï¼ŒLinked èƒŒåçš„åˆ›ä¸šå…¬å¸ Buoyant ç¬¬ä¸€æ¬¡åœ¨ SF Microservices æå‡ºäº†â€œService Meshâ€æ¦‚å¿µï¼Œå¹¶éšååœ¨ 2017 å¹´ 4 æœˆ William Morgan ç»™ Service Mesh åšäº†å®šä¹‰ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A service mesh is a dedicated infrastructure layer for handling service-to-service communication. Itâ€™s responsible for the reliable delivery of requests through the complex topology of services that comprise a modern, cloud native application. In practice, the service mesh is typically implemented as an array of lightweight network proxies that are deployed alongside application code, without the application needing to be aware.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;are deployed alongside application code, without the application needing to be aware&lt;/strong&gt; è¿™å¥è¯é“å‡ºäº† mesh çš„æ ¸å¿ƒï¼Œå³å¯¹åº”ç”¨æ— æ„ŸçŸ¥å’Œæ— ä¾µå…¥ã€‚å¾®æœåŠ¡æ¡†æ¶ä»åº”ç”¨ä»£ç é‡Œå‰¥ç¦»å‡ºæ¥ï¼Œä»å¼ºä¾èµ–å˜æˆå¼±ä¾èµ–ï¼Œç”šè‡³æ— ä¾èµ–ï¼Œåº”ç”¨æœ¬èº«ä¸å†å…³å¿ƒé›†ç¾¤çŠ¶æ€ã€è°ƒç”¨è·¯ç”±ã€å®‰å…¨ç­–ç•¥ç­‰ç­‰ï¼Œç”šè‡³å¯ä»¥è‡ªç”±å‡çº§ï¼Œæ¡†æ¶å‡çº§ä¸å†å½±å“åº”ç”¨è‡ªèº«ï¼Œä¸šåŠ¡è¿­ä»£å˜å¾—æ›´åŠ è¿…é€Ÿï¼Œè§£è€¦å¸¦æ¥äº†å·¨å¤§æ”¶ç›Šï¼Œæ¶æ„å˜å¾—æ›´åŠ ä¼˜é›…ã€‚&lt;/p&gt;
&lt;p&gt;Service Mesh çš„ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ä¸ºæ§åˆ¶ç»„ä»¶å’Œæ•°æ®ç»„ä»¶ï¼Œæ•°æ®ç»„ä»¶å’Œåº”ç”¨ä¸€èµ·éƒ¨ç½²ï¼Œæ¥ç®¡åº”ç”¨æ‰€æœ‰è¯·æ±‚ï¼Œåº”ç”¨åªéœ€è®¿é—®ç±»ä¼¼ http://127.0.0.1/service åœ°å€ï¼Œå‰©ä¸‹ä»£ç†è¿›ç¨‹ä¼šè½¬å‘è¯·æ±‚åˆ°å¯¹åº”çš„å¯¹ç«¯æœåŠ¡ï¼Œå¹¶å®ç°æœåŠ¡å‘ç°æ³¨å†Œã€æµé‡æ§åˆ¶ã€å®‰å…¨æ§åˆ¶ç­‰åŠŸèƒ½ã€‚æ‰€æœ‰ä»£ç†è¿›ç¨‹ç›¸äº’è¿é€šï¼Œç»„æˆäº†åƒä¸€ä¸ªæ ¼å­çš„ç½‘ç»œï¼Œå¹¶æ•´ä¸ªç½‘ç»œè¢«ä¸€ä¸ªæ§åˆ¶å™¨ç®¡ç†ï¼Œè€Œè¿™ä¸ªç½‘æ ¼å°±å«åš Meshã€‚Service Mesh çš„æ•°æ®å±‚ç»„ä»¶çš„ä¸»è¦å®ç°è€…æ˜¯ Linked å’Œ Envoyã€‚&lt;/p&gt;
&lt;p&gt;2017 å¹´ 5 æœˆ 24 æ—¥ï¼ŒGoogle å’Œ IBM é«˜è°ƒå‘å¸ƒäº†åŸºäº Service Mesh æ€æƒ³çš„æœåŠ¡åŒ–æ¡†æ¶äº§å“ Istioï¼Œå‡ºèº«åé—¨çš„ Istio ä¸€ä¸‹å­ç«äº†ï¼Œå¹¶ç»™å½“æ—¶å‡ºèº«è‰æ ¹çš„ Linked äº§å“æ‰¿é‡ä¸€å‡»ï¼ŒLinked ç¬é—´é™·å…¥äº†é»‘æš—ã€‚Istio æ•°æ®å±‚æ”¶ç¼–äº† Envoyï¼Œè‡ªå·±åšäº†æ§åˆ¶å±‚ï¼Œæä¾› Pilotã€Mixerã€Istio-Auth ä¸‰å¤§ç»„ä»¶ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Mixerï¼šæä¾›ç›‘æ§æ•°æ®ç®¡ç†ã€è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±ã€è°ƒç”¨è¿½è¸ªç­‰æµé‡ç®¡ç†ï¼Œæ˜¯æ§åˆ¶å™¨çš„æ ¸å¿ƒï¼Œå¹¶æä¾›åç«¯å¯¹æ¥å¹³å°ï¼Œå¦‚ k8sã€Mesos ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;Pilotï¼ˆé£è¡Œå‘˜ï¼‰: Mixer çš„æ‰§è¡Œæ¨¡å—ï¼Œè´Ÿè´£å¯¹ Envoy è¿›è¡Œè¿è¡Œæ—¶é…ç½®ã€‚&lt;/li&gt;
&lt;li&gt;Istio-Authï¼šæä¾›æœåŠ¡é—´ TLS å®‰å…¨é€šä¿¡ã€è§’è‰²é‰´æƒã€ç”¨æˆ·è®¤è¯ç­‰ AAA ç®¡ç†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Envoy ä¸åº”ç”¨éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œæä¾›æœåŠ¡é—´è¯·æ±‚é«˜æ•ˆè½¬å‘ï¼Œå¹¶æä¾›æ‰©å±•æ¥å£ä»¥å®ç°ä¸åŒçš„è½¬å‘ç­–ç•¥ï¼ŒåŒæ—¶ä¸ŠæŠ¥æµé‡ç›‘æ§æ•°æ®ï¼Œæä¾› HTTPã€gRPCã€TCP è½¬å‘èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://raw.githubusercontent.com/servicemesher/website/master/content/blog/a-new-more-efficient-proxy-model/00704eQkgy1fsu97qrffkj31900oqwid.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ Linked ä»…ä»…åªæœ‰æ•°æ®å±‚é¢ï¼Œæ˜¯ç¼ºä¹æ§åˆ¶é¢çš„ï¼Œè€Œ Istio ä¸€å¼€å§‹çš„å®šä½å°±å¾ˆæ¸…æ™°åœ°åŒ…æ‹¬äº†æ§åˆ¶å’Œæ•°æ®é¢ï¼Œåæ¥ Buoyant å…¬å¸å€Ÿé‰´ Istio çš„æ€æƒ³ï¼Œå¼€å‘äº†ä¸ Istio ç«äº‰çš„ Conduitï¼Œæ§åˆ¶é¢ç”¨ Rust å¼€å‘ï¼Œä»è¿™ä¸ªè§’åº¦è®²ï¼ŒGoogle ä¼¼ä¹çœ‹å¾—æ›´è¿œï¼ŒBuoyant æŒºæœ‰å±æœºæ„Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä»‹ç»å®Œ Service Meshï¼Œæ¥çœ‹çœ‹èƒ½å®ç°ä¸€ä¸ªç±»ä¼¼æ•°æ®è½¬å‘å±‚çš„ eBPF æ¡†æ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–°å†…æ ¸çš„ç½‘ç»œåˆ©å™¨-ebpf&#34;&gt;æ–°å†…æ ¸çš„ç½‘ç»œåˆ©å™¨ eBPF&lt;/h2&gt;
&lt;p&gt;eBPF(Extended Berkeley Packet Filter) æ˜¯ Kernel 3.18 ä¹‹åçš„ä¸€ä¸ªå†…æ ¸æ¨¡å—ï¼Œæä¾›äº†ä¸€ç§åœ¨ç½‘ç»œæ ˆçš„é’©å­èŠ‚ç‚¹å¤„åŠ¨æ€è¿è¡Œç”¨æˆ·ä»£ç çš„èƒ½åŠ›ï¼Œè¿™ç§åŠ¨æ€åŠ è½½æ— éœ€é‡å¯ Kernelï¼Œç”¨æˆ·ä½¿ç”¨ C è¯­è¨€ç¼–å†™ï¼Œç”± llvm ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†å› ä¸ºæ˜¯åœ¨å†…æ ¸æ€æ‰§è¡Œï¼ŒeBPF å¯¹ç”¨æˆ·ä»£ç éå¸¸ä¸¥æ ¼ï¼Œç”šè‡³æä¾›äº†ä¸€ä¸ªå« verifier çš„å®¡æ ¸æ¨¡å—å¯¹ç”¨æˆ·ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œç¡®ä¿ç”¨æˆ·ä»£ç ç¬¦åˆå†…æ ¸è¦æ±‚ï¼Œå¹¶åŒæ—¶èƒ½åœ¨çŸ­æ—¶é—´å†…æ‰§è¡Œå®Œæ¯•ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œåªè¦è®¾è®¡å·§å¦™ï¼Œä¹Ÿèƒ½å®ç°å¾ˆé«˜çº§çš„ç½‘ç»œåŠŸèƒ½ï¼ŒCilium çš„èƒ½åŠ›å’Œä»·å€¼å°±åœ¨æ­¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç¼–å†™ eBPF çš„é™åˆ¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ Kernel 4.16 å’Œ LLVM 6.0 ä¹‹å‰ä¸æ”¯æŒæ™®é€šå‡½æ•°è°ƒç”¨ï¼Œæ‰€æœ‰è°ƒç”¨å¿…é¡»ä¸ºå†…è”å‡½æ•°&lt;/li&gt;
&lt;li&gt;æœ€å¤§åªèƒ½æ‰§è¡Œ 4096 ä¸ª BPF æŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;ä¸æ”¯æŒå…±äº«åº“è°ƒç”¨ï¼ˆä½¿ç”¨ bfp/lib å®šä¹‰çš„åº“ï¼‰&lt;/li&gt;
&lt;li&gt;ä¸å…è®¸å…¨å±€å˜é‡ï¼Œä½†å¯ä»¥ä½¿ç”¨ &lt;code&gt;BPF_MAP_TYPE_PERCPU_ARRAY&lt;/code&gt; ä½œä¸ºå…¨å±€ map å­˜å‚¨çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶å¯ä»¥åœ¨å¤šä¸ª BPF ç¨‹åºé—´å…±äº«æ•°æ®&lt;/li&gt;
&lt;li&gt;ä¸å…è®¸ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡å’Œæ•°ç»„&lt;/li&gt;
&lt;li&gt;é™åˆ¶æ€§çš„ä½¿ç”¨å¾ªç¯ï¼ŒBPF verifier éªŒè¯ç¨‹åºä¼šæ£€æµ‹ä»£ç æ˜¯å¦æœ‰å¾ªç¯ï¼Œä½¿ç”¨ &lt;code&gt;#pragma unroll&lt;/code&gt; å’Œ &lt;code&gt;BPF_MAP_TYPE_PERCPU_ARRAY&lt;/code&gt; æœ€å¤§åªèƒ½æ”¯æŒ 32 æ¬¡è¿­ä»£&lt;/li&gt;
&lt;li&gt;æ ˆç©ºé—´é™åˆ¶å¤§å° 512 bytes&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†ç¼–å†™æ–¹ä¾¿ï¼Œå†…æ ¸ä¹Ÿæä¾›ä¸€äº›å¯ä»¥ä½¿ç”¨çš„ç»„ä»¶å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Helper Funcï¼šæä¾›ä¸€äº›ä»å†…æ ¸ä¸­è¯»å†™æ•°æ®æµçš„å‡½æ•°é›†&lt;/li&gt;
&lt;li&gt;Mapsï¼šå†…æ ¸ä¸­å­˜å‚¨ KV çš„ Map é›†ï¼Œç”¨äºå˜ç›¸å­˜å‚¨å…¨å±€å˜é‡&lt;/li&gt;
&lt;li&gt;Tail Calls å’Œ BPF to BPF Callsï¼šBPF ç¨‹åºè°ƒç”¨å¦ä¸€ä¸ª BPF ç¨‹åºï¼Œè¿™æ ·å°±èƒ½ä½¿åŠŸèƒ½æ¨¡å—åŒ–äº†&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶ä»–èƒ½åŠ›ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;JITï¼šå³æ—¶ç¿»è¯‘æ‰§è¡Œä»£ç èƒ½åŠ›&lt;/li&gt;
&lt;li&gt;Offloadsï¼šå…è®¸ç”¨æˆ·ä»£ç ä¸‹æ²‰åˆ°ç½‘å¡ä¸­æ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œè¦ç¼–å†™ä¸€ä¸ªé«˜çº§ BPF ç›¸å¯¹æ™®é€šå¼€å‘è¿˜æ˜¯æœ‰éš¾åº¦çš„ï¼Œä¸‹é¢ä»‹ç»ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸»è¦å®ç°å¯¹ç½‘å¡ä¸Šä¸‹è¡Œè¿›å‡ºæµé‡è¿›è¡Œç»Ÿè®¡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¼€å‘ç¯å¢ƒå‡†å¤‡&lt;/p&gt;
&lt;p&gt;å½“å‰ Ubuntu 17.04 ä»¥ä¸Šç‰ˆæœ¬ï¼ŒæŒ‰ç…§ç¼–è¯‘æ‰€ä¾èµ–çš„åŒ…&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ sudo apt-get install -y make gcc libssl-dev bc libelf-dev libcap-dev &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;clang gcc-multilib llvm libncurses5-dev git pkg-config libmnl bison flex &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;graphviz
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼–ç ä»£ç  tc-example.c å®ç°å¯¹è¿›å‡ºæµé‡ä¼ è¾“å­—èŠ‚è¿›è¡Œè®¡æ•°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#include &amp;lt;linux/bpf.h&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#include &amp;lt;linux/pkt_cls.h&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#include &amp;lt;stdint.h&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#include &amp;lt;iproute2/bpf_elf.h&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#ifndef __section&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# define __section(NAME)                  \&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   __attribute__&lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;section&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;NAME&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;, used&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#endif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#ifndef __inline&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# define __inline                         \&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   inline __attribute__&lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;always_inline&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#endif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#ifndef lock_xadd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# define lock_xadd(ptr, val)              \&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;o&#34;&gt;((&lt;/span&gt;void&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;__sync_fetch_and_add&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;ptr, val&lt;span class=&#34;o&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#endif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#ifndef BPF_FUNC&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# define BPF_FUNC(NAME, ...)              \&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;*NAME&lt;span class=&#34;o&#34;&gt;)(&lt;/span&gt;__VA_ARGS__&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;void *&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;BPF_FUNC_##NAME
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#endif&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;static void *BPF_FUNC&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;map_lookup_elem, void *map, const void *key&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;struct bpf_elf_map acc_map __section&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;maps&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    .type           &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; BPF_MAP_TYPE_ARRAY,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    .size_key       &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; sizeof&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;uint32_t&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    .size_value     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; sizeof&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;uint32_t&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    .pinning        &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; PIN_GLOBAL_NS,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    .max_elem       &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 2,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;static __inline int account_data&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;struct __sk_buff *skb, uint32_t dir&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    uint32_t *bytes&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nv&#34;&gt;bytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; map_lookup_elem&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;acc_map, &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;dir&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bytes&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            lock_xadd&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;bytes, skb-&amp;gt;len&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; TC_ACT_OK&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;__section&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ingress&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;int tc_ingress&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;struct __sk_buff *skb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; account_data&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;skb, 0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;__section&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;egress&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;int tc_egress&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;struct __sk_buff *skb&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; account_data&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;skb, 1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;char __license&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; __section&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;license&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;GPL&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	struct sk_buff - socket buffer, it&lt;span class=&#34;s1&#34;&gt;&amp;#39;s the primary struct for network.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *    See  https://elixir.bootlin.com/linux/latest/source/include/linux/skbuff.h)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@next: Next buffer in list
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@prev: Previous buffer in list
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@tstamp: Time we arrived/left
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@rbnode: RB tree node, alternative to next/prev for netem/tcp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@sk: Socket we are owned by
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@dev: Device we arrived on/are leaving by
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@cb: Control buffer. Free for use by every layer. Put private vars here
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@_skb_refdst: destination entry (with norefcount bit)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@sp: the security path, used for xfrm
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@len: Length of actual data
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@data_len: Data length
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@mac_len: Length of link layer header
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@hdr_len: writable header length of cloned skb
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@csum: Checksum (must include start/offset pair)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@csum_start: Offset from skb-&amp;gt;head where checksumming should start
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@csum_offset: Offset from csum_start where checksum should be stored
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@priority: Packet queueing priority
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@ignore_df: allow local fragmentation
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@cloned: Head may be cloned (check refcnt to be sure)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@ip_summed: Driver fed us an IP checksum
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@nohdr: Payload reference only, must not modify header
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@pkt_type: Packet class
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@fclone: skbuff clone status
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@ipvs_property: skbuff is owned by ipvs
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@tc_skip_classify: do not classify packet. set by IFB device
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@tc_at_ingress: used within tc_classify to distinguish in/egress
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@tc_redirected: packet was redirected by a tc action
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@tc_from_ingress: if tc_redirected, tc_at_ingress at time of redirect
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *	@peeked: this packet has been seen already, so stats have been
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt; *		done for it, don&amp;#39;&lt;/span&gt;t &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt; them again
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@nf_trace: netfilter packet trace flag
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@protocol: Packet protocol from driver
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@destructor: Destruct &lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@tcp_tsorted_anchor: list structure &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; TCP &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tp-&amp;gt;tsorted_sent_queue&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@_nfct: Associated connection, &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; any &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;with nfctinfo bits&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@nf_bridge: Saved data about a bridged frame - see br_netfilter.c
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@skb_iif: ifindex of device we arrived on
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@tc_index: Traffic control index
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@hash: the packet &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@queue_mapping: Queue mapping &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; multiqueue devices
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@xmit_more: More SKBs are pending &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; this queue
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@ndisc_nodetype: router &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;from link layer&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@ooo_okay: allow the mapping of a socket to a queue to be changed
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@l4_hash: indicate &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; is a canonical 4-tuple &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; over transport
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *		ports.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@sw_hash: indicates &lt;span class=&#34;nb&#34;&gt;hash&lt;/span&gt; was computed in software stack
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@wifi_acked_valid: wifi_acked was &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@wifi_acked: whether frame was acked on wifi or not
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@no_fcs:  Request NIC to treat last &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; bytes as Ethernet FCS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@csum_not_inet: use CRC32c to resolve CHECKSUM_PARTIAL
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@dst_pending_confirm: need to confirm neighbour
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  *	@napi_id: id of the NAPI struct this skb came from
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@secmark: security marking
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@mark: Generic packet mark
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@vlan_proto: vlan encapsulation protocol
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@vlan_tci: vlan tag control information
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@inner_protocol: Protocol &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;encapsulation&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@inner_transport_header: Inner transport layer header &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;encapsulation&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@inner_network_header: Network layer header &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;encapsulation&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@inner_mac_header: Link layer header &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;encapsulation&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@transport_header: Transport layer header
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@network_header: Network layer header
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@mac_header: Link layer header
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@tail: Tail pointer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@end: End pointer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@head: Head of buffer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@data: Data head pointer
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@truesize: Buffer size
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; *	@users: User count - see &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;datagram,tcp&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;.c
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼–è¯‘æˆ BPF å¯æ‰§è¡Œç¨‹åº&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ clang -O2 -Wall -target bpf -c tc-example.c -o tc-example.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŠ è½½æ‰§è¡Œç¨‹åºåˆ°ç½‘å¡&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tc qdisc add dev em1 clsact&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tc filter add dev em1 ingress bpf da obj tc-example.o sec ingress&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tc filter add dev em1 egress bpf da obj tc-example.o sec egress&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tc filter show dev em1 ingress&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter protocol all pref &lt;span class=&#34;m&#34;&gt;49152&lt;/span&gt; bpf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter protocol all pref &lt;span class=&#34;m&#34;&gt;49152&lt;/span&gt; bpf handle 0x1 tc-example.o:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;ingress&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; direct-action id &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; tag c5f7825e5dac396f
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tc filter show dev em1 egress&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter protocol all pref &lt;span class=&#34;m&#34;&gt;49152&lt;/span&gt; bpf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filter protocol all pref &lt;span class=&#34;m&#34;&gt;49152&lt;/span&gt; bpf handle 0x1 tc-example.o:&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;egress&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; direct-action id &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; tag b2fd5adc0f262714
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# mount | grep bpf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sysfs on /sys/fs/bpf &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; sysfs &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;rw,nosuid,nodev,noexec,relatime,seclabel&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;bpf on /sys/fs/bpf &lt;span class=&#34;nb&#34;&gt;type&lt;/span&gt; bpf &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;rw,relatime,mode&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0700&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# tree /sys/fs/bpf/&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/sys/fs/bpf/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-- ip -&amp;gt; /sys/fs/bpf/tc/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-- tc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;   +-- globals
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;       +-- acc_map
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-- xdp -&amp;gt; /sys/fs/bpf/tc/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; directories, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; file
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šå±•ç°äº†å¯¹å½“å‰ç½‘ç»œæ•°æ®åŒ…çš„æ“ä½œï¼Œè¿™ç§å¯ç¼–ç¨‹çš„èƒ½åŠ›å°±ç»™ä¸Šå±‚åº”ç”¨æä¾›äº†æ— é™çš„æƒ³è±¡ç©ºé—´äº†ï¼Œå…¶ä¸­ Cilium å°±æ˜¯åŸºäºå¯ç¼–ç¨‹ eBPF ä¹‹ä¸Šå¼€å‘äº† L47 å±‚ç½‘ç»œç®¡ç†æ¡†æ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºæœåŠ¡åŒ–è¯ç”Ÿçš„-cilium&#34;&gt;ä¸ºæœåŠ¡åŒ–è¯ç”Ÿçš„ Cilium&lt;/h2&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä»¥ eBPF ä¸ºåŸºç¡€çš„ç½‘ç»œæ¡†æ¶ï¼Œèƒ½åšåˆ° L47 å±‚çš„å®‰å…¨ç­–ç•¥ã€æµé‡æ§åˆ¶ï¼Œå¹¶ä¸”æ€§èƒ½é«˜ã€çµæ´»æ€§å¼ºï¼Œä¸»è¦è§£å†³å¾®æœåŠ¡çš„ä½¿ç”¨åœºæ™¯ï¼Œèƒ½ä¸ kubernetes é›†æˆï¼Œå®˜æ–¹è§£é‡Šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Cilium is open source software for transparently securing the network connectivity between application services deployed using Linux container management platforms like Docker and Kubernetes. The development of modern datacenter applications has shifted to a service-oriented architecture often referred to as microservices, wherein a large application is split into small independent services that communicate with each other via APIs using lightweight protocols like HTTP.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Cilium å°±å®šä½ä¸ºå¾®æœåŠ¡è§£å†³ç½‘ç»œç®¡ç†é—®é¢˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Microservices applications tend to be highly dynamic, with individual containers getting started or destroyed as the application scales out / in to adapt to load changes and during rolling updates that are deployed as part of continuous delivery. This shift toward highly dynamic microservices presents both a challenge and an opportunity in terms of securing connectivity between microservices.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¦è§£å†³å¾®æœåŠ¡æ¶æ„ä¸‹çš„ç½‘ç»œé—®é¢˜çš„æŒ‘æˆ˜å’Œæœºä¼šåœ¨äºè¦é€‚åº”å¾®æœåŠ¡å¿«é€Ÿå˜åŒ–èƒ½åŠ›ï¼Œå› ä¸ºå¾®æœåŠ¡æ‰©å®¹å’Œå‡çº§éå¸¸é¢‘ç¹ï¼Œä»è€Œç½‘ç»œå’Œå®‰å…¨ç®¡ç†ä¹Ÿéœ€è¦é€‚åº”è¿™ç§å˜é©ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Traditional Linux network security approaches (e.g., iptables) filter on IP address and TCP/UDP ports, but IP addresses frequently churn in dynamic microservices environments. The highly volatile life cycle of containers causes these approaches to struggle to scale side by side with the application as load balancing tables and access control lists carrying hundreds of thousands of rules that need to be updated with a continuously growing frequency.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è€Œä½¿ç”¨ä¼ ç»Ÿçš„ä»¥ IP Base çš„ç­–ç•¥æ¨¡å‹å·²ç»ä¸å†é€‚åº”å½“ä»Šä»¥å¾®æœåŠ¡ä¸ºæ¨¡å‹çš„æ¶æ„äº†ï¼Œå¾®æœåŠ¡çš„åº•å±‚ç½‘ç»œå˜åŒ–ä¼šéå¸¸çµæ´»å’Œè¿…é€Ÿï¼Œå¦‚äºŒå±‚çš„ç½‘ç»œ IP åœ°å€å¯ä»¥è¿…é€Ÿæ”¹å˜å’Œé”€æ¯ï¼Œä¼ ç»Ÿå®‰å…¨ç­–ç•¥å¦‚æœåŸºäº IP Policy æ¨¡å‹ä¼šäº§ç”Ÿæˆç™¾ä¸Šåƒæ¡è§„åˆ™ï¼Œå¹¶ä¸”è¿™äº›è§„åˆ™ä¼šè¢«é¢‘ç¹å˜æ›´ï¼Œå˜æ›´çš„æ€§èƒ½éå¸¸ä½ä¸‹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;By leveraging Linux BPF, Cilium retains the ability to transparently insert security visibility + enforcement, but does so in a way that is based on service / pod / container identity (in contrast to IP address identification in traditional systems) and can filter on application-layer (e.g. HTTP). As a result, Cilium not only makes it simple to apply security policies in a highly dynamic environment by decoupling security from addressing, but can also provide stronger security isolation by operating at the HTTP-layer in addition to providing traditional Layer 3 and Layer 4 segmentation.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;å› æ­¤ Cilium åˆ©ç”¨ BPF çš„èƒ½åŠ›ï¼Œèƒ½ä»¥ service / pod / container ä¸ºå¯¹è±¡è¿›è¡ŒåŠ¨æ€åœ°ç½‘ç»œå’Œå®‰å…¨ç­–ç•¥ç®¡ç†ï¼Œè§£è€¦æ§åˆ¶é¢çš„ç­–ç•¥ç®¡ç†å’Œä¸æ–­å˜åŒ–çš„ç½‘ç»œç¯å¢ƒï¼Œè¿˜åšåˆ° 7 å±‚èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä½“ Cilium æ¶æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://raw.githubusercontent.com/servicemesher/website/master/content/blog/a-new-more-efficient-proxy-model/00704eQkgy1fsu98qo3jgj318z143gos.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸Šå±‚å¯¹æ¥æ§åˆ¶ç¼–æ’é¢ï¼Œä¸‹å±‚è½¬æ¢æˆ BPF çš„ç¨‹åºæ³¨å…¥åˆ°å†…æ ¸ç½‘ç»œæ ˆæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å·²å®ç°çš„åŠŸèƒ½å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ”¯æŒ HTTP åè®®ï¼Œæ”¯æŒ methodã€pathã€hostã€headers åŒ¹é…çš„ç­–ç•¥&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Kafka çš„åè®®ï¼Œæ”¯æŒ Roleã€topic åŒ¹é…çš„ç­–ç•¥ç®¡ç†&lt;/li&gt;
&lt;li&gt;æ”¯æŒ IP/CIDRã€Labelã€Serviceã€Entities Base çš„ç­–ç•¥ç®¡ç†&lt;/li&gt;
&lt;li&gt;è´Ÿè½½å‡è¡¡&lt;/li&gt;
&lt;li&gt;ç›‘æ§å’Œæ•…éšœå®šä½ï¼Œæ”¯æŒå¯¹æ¥ Prometheus ç›‘æ§å¹³å°&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¯è§ Cilium åšå¾—å¾ˆé«˜çº§ï¼Œä¸ä»…ä»…æ”¯æŒäº† HTTPï¼Œè¿˜æ”¯æŒ Kafka åè®®ï¼Œç›¸ä¿¡æœªæ¥è¿˜ä¼šæ”¯æŒæ›´å¤šçš„åè®®ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œè™½ç„¶çœ‹ä¸Šå»ç›®å‰åªèƒ½åšåˆ°è½¬å‘å±‚ä¸šåŠ¡ï¼ˆä¸»è¦ä»¥ç½‘ç»œæ ˆ HOOK çš„æ–¹å¼ï¼‰ï¼Œå¯¹éœ€è¦æ–°å»ºç½‘ç»œè¿æ¥çš„ä¸šåŠ¡æœ‰é™åˆ¶ï¼Œä½†ç»“åˆä¸Šå±‚åº”ç”¨å®ç°ï¼Œåšåˆ°æ›¿æ¢ Envoy æ•°æ®å±‚è¿˜æ˜¯æœ‰å¯èƒ½çš„ï¼Œå°½æƒ…æœŸå¾…ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æœ¬æ–‡è½¬è½½è‡ªï¼š&lt;a href=&#34;http://yangjunsss.github.io/2018-05-12/%E6%8E%A2%E8%AE%A8%E4%B8%80%E7%A7%8D%E6%9B%B4%E9%AB%98%E6%95%88%E7%9A%84%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/?from=groupmessage&amp;amp;isappinstalled=0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¢è®¨ä¸€ç§æ›´é«˜æ•ˆçš„ä»£ç†æ¨¡å¼&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
