<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tetrate | äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰</title>
    <link>https://cloudnativecn.com/author/tetrate/</link>
      <atom:link href="https://cloudnativecn.com/author/tetrate/index.xml" rel="self" type="application/rss+xml" />
    <description>Tetrate</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language>
    <image>
      <url>https://cloudnativecn.com/author/tetrate/avatar_hu13307683757492787718.png</url>
      <title>Tetrate</title>
      <link>https://cloudnativecn.com/author/tetrate/</link>
    </image>
    
    <item>
      <title>Envoy Gateway 1.3 å‘å¸ƒï¼šå¢å¼ºå®‰å…¨æ€§ã€æµé‡ç®¡ç†å’Œè¿ç»´èƒ½åŠ›</title>
      <link>https://cloudnativecn.com/blog/envoy-gateway-1-3-release-highlights/</link>
      <pubDate>Thu, 06 Feb 2025 15:17:32 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/envoy-gateway-1-3-release-highlights/</guid>
      <description>&lt;p&gt;Envoy Gateway 1.3 ç‰ˆæœ¬åœ¨ &lt;strong&gt;å®‰å…¨æ€§ã€æµé‡ç®¡ç†å’Œè¿ç»´èƒ½åŠ›&lt;/strong&gt; æ–¹é¢è¿›è¡Œäº†é‡å¤§å¢å¼ºï¼Œå¹¶å¼•å…¥äº† &lt;strong&gt;API Key è®¤è¯&lt;/strong&gt;ã€&lt;strong&gt;æ”¯æŒ HTTPRoute é‡è¯•&lt;/strong&gt; ä»¥åŠ &lt;strong&gt;æ›´çµæ´»çš„åŸºç¡€è®¾æ–½ç®¡ç†&lt;/strong&gt; ç­‰å…³é”®æ”¹è¿›ã€‚è¯¦è§ &lt;a href=&#34;https://gateway.envoyproxy.io/news/releases/v1.3/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway 1.3 å‘å¸ƒå…¬å‘Š&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;12-åˆ°-13-ç‰ˆæœ¬çš„æ ¸å¿ƒå˜åŒ–&#34;&gt;1.2 åˆ° 1.3 ç‰ˆæœ¬çš„æ ¸å¿ƒå˜åŒ–&lt;/h2&gt;
&lt;p&gt;æœ¬æ¬¡å‘å¸ƒé‡ç‚¹æ›´æ–°åŒ…æ‹¬ &lt;strong&gt;å®‰å…¨ç‰¹æ€§å¢å¼º&lt;/strong&gt;ã€&lt;strong&gt;æµé‡ç®¡ç†ä¼˜åŒ–&lt;/strong&gt; ä»¥åŠ &lt;strong&gt;è¿ç»´ç®¡æ§æå‡&lt;/strong&gt;ã€‚æ­¤å¤–ï¼Œ1.3 ç‰ˆæœ¬è¿˜å¼•å…¥äº†ä¸€äº› &lt;strong&gt;é‡å¤§å˜æ›´&lt;/strong&gt;ï¼Œä»¥æå‡ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯é æ€§ï¼Œå¢å¼ºèº«ä»½è®¤è¯å’Œæµé‡ç®¡ç†èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ¬¡æ›´æ–°çš„è¯¦ç»†å†…å®¹åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;22 é¡¹æ–°ç‰¹æ€§&lt;/strong&gt;ï¼Œæ¶µç›–å®‰å…¨ã€æµé‡ç®¡ç†å’Œè¿ç»´ä¼˜åŒ–&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;26 é¡¹ Bug ä¿®å¤&lt;/strong&gt;ï¼Œæå‡ç¨³å®šæ€§å’Œå¯é æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡å°†æ€»ç»“ Envoy Gateway 1.3 ç‰ˆæœ¬æœ€é‡è¦çš„æ›´æ–°å†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸»è¦ç‰¹æ€§äº®ç‚¹&#34;&gt;ä¸»è¦ç‰¹æ€§äº®ç‚¹&lt;/h2&gt;
&lt;h3 id=&#34;1-å®‰å…¨æ€§å¢å¼ºè®¤è¯ä¸è®¿é—®ç®¡ç†&#34;&gt;1. å®‰å…¨æ€§ï¼šå¢å¼ºè®¤è¯ä¸è®¿é—®ç®¡ç†&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;API Key è®¤è¯&lt;/strong&gt;ï¼šSecurityPolicy API ç°æ”¯æŒ API Key è®¿é—®æ§åˆ¶ï¼Œç®€åŒ–ä»å…¶ä»– Gateway è§£å†³æ–¹æ¡ˆçš„è¿ç§»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨ç­–ç•¥å¢å¼º&lt;/strong&gt;ï¼šæ”¹è¿› &lt;strong&gt;å¤–éƒ¨è®¤è¯ï¼ˆext-authï¼‰&lt;/strong&gt; æœåŠ¡å™¨é›†æˆï¼Œå¹¶æ”¯æŒ JWKS é…ç½®çš„è‡ªå®šä¹‰ TLS è®¾ç½®&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®¢æˆ·ç«¯ IP è§£æä¼˜åŒ–&lt;/strong&gt;ï¼šæ”¯æŒä» &lt;code&gt;X-Forwarded-For (XFF)&lt;/code&gt; å¤´éƒ¨æå–çœŸå®å®¢æˆ·ç«¯ IP&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•æœåŠ¡é»˜è®¤ â€œfail-closedâ€ æœºåˆ¶&lt;/strong&gt;ï¼šå½“æ‰©å±•æœåŠ¡å™¨è¿”å›é”™è¯¯æ—¶ï¼Œå°†ç«‹å³ç”¨ &lt;code&gt;Internal Server Error&lt;/code&gt;ï¼ˆ500 çŠ¶æ€ç ï¼‰å“åº”å—å½±å“çš„è¯·æ±‚ï¼Œç¡®ä¿å®‰å…¨æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-æµé‡ç®¡ç†æ›´æ™ºèƒ½çš„è·¯ç”±ä¸æ§åˆ¶&#34;&gt;2. æµé‡ç®¡ç†ï¼šæ›´æ™ºèƒ½çš„è·¯ç”±ä¸æ§åˆ¶&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•åè®®æ”¯æŒ&lt;/strong&gt;ï¼šç°åœ¨æ”¯æŒåœ¨ &lt;code&gt;GRPCRoute&lt;/code&gt;ã€&lt;code&gt;TCPRoute&lt;/code&gt; å’Œ &lt;code&gt;UDPRoute&lt;/code&gt; API ä¸­è·¯ç”±è‡³ Backend èµ„æº&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å“åº”å‹ç¼©ï¼ˆResponse Compressionï¼‰&lt;/strong&gt;ï¼šBackendTrafficPolicy API ç°æ”¯æŒå¯¹å“åº”è¿›è¡Œå‹ç¼©ï¼Œå‡å°‘æµé‡å ç”¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;GEP-1731 å®æ–½&lt;/strong&gt;ï¼šå®ç°äº† &lt;strong&gt;Kubernetes Gateway API çš„ HTTPRoute é‡è¯•&lt;/strong&gt;ï¼Œæ”¯æŒé€šè¿‡ &lt;strong&gt;Gateway API&lt;/strong&gt;ï¼ˆè€Œé Envoy Gateway APIï¼‰å®šä¹‰è¯·æ±‚é‡è¯•ç­–ç•¥&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºåŠ¨æ€å…ƒæ•°æ®çš„é™æµï¼ˆDynamic Cost-Based Rate Limitingï¼‰&lt;/strong&gt;ï¼šé™æµ API ç°æ”¯æŒä» &lt;strong&gt;åŠ¨æ€å…ƒæ•°æ®ï¼ˆDynamic Metadataï¼‰&lt;/strong&gt; æå–æˆæœ¬å€¼ï¼Œå¯åŸºäºè¯·æ±‚çš„ä¸åŒæ¶ˆè€—é‡å¯¹å®¢æˆ·ç«¯è¿›è¡Œé™æµ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”¨æˆ·å®šä¹‰è·¯ç”±é¡ºåº&lt;/strong&gt;ï¼šEnvoyProxy CRD ç°æ”¯æŒ &lt;strong&gt;ä¿ç•™ç”¨æˆ·è‡ªå®šä¹‰çš„ HTTPRoute åŒ¹é…é¡ºåº&lt;/strong&gt;ï¼Œå¢å¼ºè·¯ç”±æ§åˆ¶çµæ´»æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;3-è¿è¥ç®¡ç†åŸºç¡€è®¾æ–½ä¼˜åŒ–&#34;&gt;3. è¿è¥ç®¡ç†ï¼šåŸºç¡€è®¾æ–½ä¼˜åŒ–&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HPAï¼ˆæ°´å¹³è‡ªåŠ¨æ‰©å±•ï¼‰å¢å¼º&lt;/strong&gt;ï¼šæä¾› &lt;strong&gt;EnvoyProxy HPA&lt;/strong&gt; å’Œ &lt;strong&gt;PDBï¼ˆPod Disruption Budgetï¼‰&lt;/strong&gt; çš„æ›´å¤šé…ç½®é€‰é¡¹&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ”¹è¿› IPv6 æ”¯æŒ&lt;/strong&gt;ï¼šä¼˜åŒ– &lt;strong&gt;åŒæ ˆï¼ˆDual-Stackï¼‰æ”¯æŒ&lt;/strong&gt;ï¼Œä¿®å¤ IPv6 ç›¸å…³é—®é¢˜&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¼˜é›…ç»ˆæ­¢ï¼ˆGraceful Terminationï¼‰&lt;/strong&gt;ï¼šåœ¨ç»ˆæ­¢è¿›ç¨‹æœŸé—´å¢å¼ºç«¯ç‚¹ç®¡ç†ï¼Œç¡®ä¿å¹³æ»‘ä¸‹çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4-å¯è§‚æµ‹æ€§ç›‘æ§ä¸æ§åˆ¶èƒ½åŠ›æå‡&#34;&gt;4. å¯è§‚æµ‹æ€§ï¼šç›‘æ§ä¸æ§åˆ¶èƒ½åŠ›æå‡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Tracing è¿½è¸ªä¼˜åŒ–&lt;/strong&gt;ï¼šæ”¹è¿›è¿½è¸ªé‡‡æ ·æ§åˆ¶ï¼Œæ”¯æŒ &lt;strong&gt;æŒ‰æ¯”ä¾‹ï¼ˆfraction-basedï¼‰å®šä¹‰é‡‡æ ·ç‡&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¢å¼ºæŒ‡æ ‡ï¼ˆMetricsï¼‰&lt;/strong&gt;ï¼šæ–°å¢ç›‘æ§ Envoy Gateway &lt;strong&gt;å´©æºƒï¼ˆPanicï¼‰&lt;/strong&gt; ç›¸å…³çš„æŒ‡æ ‡å’Œä»ªè¡¨ç›˜&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰©å±•å¤„ç†ï¼ˆExtension Processingï¼‰&lt;/strong&gt;ï¼šä¼˜åŒ–å¤–éƒ¨å¤„ç†å™¨ï¼ˆExternal Processorï¼‰çš„å±æ€§ç®¡ç†å’Œé…ç½®é€‰é¡¹&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;Envoy Gateway 1.3 ä¸ºå›¢é˜Ÿæä¾›äº†æ›´å¼ºå¤§çš„ &lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ã€&lt;strong&gt;æµé‡ç®¡ç†&lt;/strong&gt; å’Œ &lt;strong&gt;è¿ç»´èƒ½åŠ›&lt;/strong&gt;ï¼Œä¸»è¦æ›´æ–°åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;p&gt;âœ… &lt;strong&gt;å¢å¼ºèº«ä»½è®¤è¯æœºåˆ¶&lt;/strong&gt;ï¼ˆAPI Key è®¤è¯ã€JWKS TLS é…ç½®ç­‰ï¼‰&lt;/p&gt;
&lt;p&gt;âœ… &lt;strong&gt;ä¼˜åŒ–è·¯ç”±ä¸é™æµèƒ½åŠ›&lt;/strong&gt;ï¼ˆæ”¯æŒ GRPCRouteã€HTTPRoute é‡è¯•ã€åŠ¨æ€å…ƒæ•°æ®é™æµç­‰ï¼‰&lt;/p&gt;
&lt;p&gt;âœ… &lt;strong&gt;æé«˜ç”Ÿäº§ç¯å¢ƒè¿ç»´æ•ˆç‡&lt;/strong&gt;ï¼ˆHPA æ”¯æŒã€IPv6 å…¼å®¹ã€æ‰©å±•æœåŠ¡ fail-closed æœºåˆ¶ç­‰ï¼‰&lt;/p&gt;
&lt;p&gt;è¿™äº›æ”¹è¿›ä½¿ Envoy Gateway åœ¨ &lt;strong&gt;ç”Ÿäº§ç¯å¢ƒ&lt;/strong&gt; ä¸‹æ›´å…·å®‰å…¨æ€§ã€å¯æ‰©å±•æ€§å’Œç®¡ç†ä¾¿åˆ©æ€§ï¼Œä¸º Kubernetes ç”Ÿæ€ä¸­çš„æµé‡ç®¡ç†æä¾›æ›´ç¨³å®šã€æ›´å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆã€‚ğŸš€&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio ä¸­åŸºäºæ ‡å¤´çš„è·¯ç”±â€”â€”æ— éœ€æ ‡å¤´ä¼ æ’­</title>
      <link>https://cloudnativecn.com/blog/header-based-routing-in-istio-without-header-propagation/</link>
      <pubDate>Wed, 06 Mar 2024 12:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/header-based-routing-in-istio-without-header-propagation/</guid>
      <description>&lt;p&gt;Istio ä½¿ç”¨ Envoy ä»£ç†ä½œä¸º Pod sidecarï¼Œåº”ç”¨ç¨‹åºå°†ç½‘ç»œè´£ä»»ï¼ˆä¾‹å¦‚å…¥ç«™å’Œå‡ºç«™æµé‡ï¼‰å§”æ‰˜ç»™å®ƒï¼Œä½†æœ‰ä¸€ä¸ªè´£ä»»ä»ç„¶å±äºåº”ç”¨ç¨‹åºå®¹å™¨ï¼šæ ‡å¤´ä¼ æ’­ã€‚&lt;/p&gt;
&lt;p&gt;Envoy ä»£ç†æ— æ³•å°†å…¶å‘é€åˆ°åº”ç”¨ç¨‹åºçš„è¯·æ±‚ä¸åº”ç”¨ç¨‹åºå“åº”çš„è¯·æ±‚å…³è”èµ·æ¥ï¼Œå› æ­¤ Istio æ— æ³•è‡ªåŠ¨ä¼ æ’­æ ‡å¤´ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1å¦‚æœåº”ç”¨ç¨‹åºå®¹å™¨ä¸è½¬å‘å›æ ‡å¤´sidecar-æ— æ³•å°†è¯·æ±‚ä¸å“åº”å…³è”èµ·æ¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šå¦‚æœåº”ç”¨ç¨‹åºå®¹å™¨ä¸è½¬å‘å›æ ‡å¤´ï¼ŒSidecar æ— æ³•å°†è¯·æ±‚ä¸å“åº”å…³è”èµ·æ¥ã€‚&#34; srcset=&#34;
               /blog/header-based-routing-in-istio-without-header-propagation/f1_hu14663097096577958957.webp 400w,
               /blog/header-based-routing-in-istio-without-header-propagation/f1_hu1510165011670670968.webp 760w,
               /blog/header-based-routing-in-istio-without-header-propagation/f1_hu14673444050397104611.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/header-based-routing-in-istio-without-header-propagation/f1_hu14663097096577958957.webp&#34;
               width=&#34;760&#34;
               height=&#34;299&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šå¦‚æœåº”ç”¨ç¨‹åºå®¹å™¨ä¸è½¬å‘å›æ ‡å¤´ï¼ŒSidecar æ— æ³•å°†è¯·æ±‚ä¸å“åº”å…³è”èµ·æ¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒåŸºäºæ ‡å¤´çš„è·¯ç”±éœ€è¦åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å®ç°æ ‡å¤´è½¬å‘ã€‚ä¾‹å¦‚ï¼Œåœ¨ Istio çš„ Bookinfo åº”ç”¨ç¨‹åºä¸­ï¼Œ &lt;code&gt;productpage&lt;/code&gt; å¾®æœåŠ¡æ˜¯&lt;a href=&#34;https://github.com/istio/istio/blob/master/samples/bookinfo/src/productpage/productpage.py#L102&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™æ ·&lt;/a&gt;å®ç°çš„ã€‚è¿™è®©æˆ‘ä»¬æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¹³å°ç®¡ç†å‘˜å¦‚ä½•åœ¨ä¸ä¿®æ”¹åº”ç”¨ç¨‹åºå†…éƒ¨çš„æƒ…å†µä¸‹ä½¿ç”¨åŸºäºæ ‡å¤´çš„è·¯ç”±ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æ³³é“æ–¹æ³•&#34;&gt;æ³³é“æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ Bookinfo åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†æ ¹æ® &lt;code&gt;x-version&lt;/code&gt; æ ‡å¤´å¯¹è¯·æ±‚è·¯å¾„è¿›è¡Œåˆ†æ®µï¼Œå¦‚ä¸‹å›¾ 2 æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2æ ¹æ®-x-version-æ ‡å¤´åˆ†æ®µè¯·æ±‚è·¯å¾„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šæ ¹æ® x-version æ ‡å¤´åˆ†æ®µè¯·æ±‚è·¯å¾„ã€‚&#34; srcset=&#34;
               /blog/header-based-routing-in-istio-without-header-propagation/f2_hu13352547274196591875.webp 400w,
               /blog/header-based-routing-in-istio-without-header-propagation/f2_hu10331701654748029638.webp 760w,
               /blog/header-based-routing-in-istio-without-header-propagation/f2_hu7780059725850173668.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/header-based-routing-in-istio-without-header-propagation/f2_hu13352547274196591875.webp&#34;
               width=&#34;760&#34;
               height=&#34;457&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šæ ¹æ® x-version æ ‡å¤´åˆ†æ®µè¯·æ±‚è·¯å¾„ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰ &lt;code&gt;x-version&lt;/code&gt; æ ‡å¤´çš„è¯·æ±‚å¯èƒ½ä¼šè¢«è·¯ç”±åˆ°ä»»æ„åç«¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éƒ¨ç½²å·¥ä½œè´Ÿè½½&#34;&gt;éƒ¨ç½²å·¥ä½œè´Ÿè½½&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å°†ä½¿ç”¨ Istio çš„ Bookinfo &lt;a href=&#34;https://istio.io/latest/docs/examples/bookinfo/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¤ºä¾‹&lt;/a&gt; ï¼Œå¹¶å¯¹ç‰ˆæœ¬æ§åˆ¶åº”ç”¨ç¨‹åºè¿›è¡Œä¸€äº›ç»†å¾®çš„æ›´æ”¹ä½œä¸ºç¤ºä¾‹å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸‰ä¸ª productpage éƒ¨ç½²ï¼Œä»…æ›´æ”¹ &lt;code&gt;version&lt;/code&gt; æ ‡ç­¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;apps/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage-v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºå®ƒä»¬åˆ›å»ºæœåŠ¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œä¸º reviews åº”ç”¨ç¨‹åºåˆ›å»ºä¸‰ä¸ªéƒ¨ç½²ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;apps/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews-v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v{1,2,3}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;rating å’Œ details åº”ç”¨ç¨‹åºä¸åŸå§‹ç¤ºä¾‹ä¸­çš„å†…å®¹ç›¸åŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;éƒ¨ç½²-istio-é…ç½®&#34;&gt;éƒ¨ç½² Istio é…ç½®&lt;/h2&gt;
&lt;p&gt;è¿™å°±æ˜¯ Istio çš„è·¯ç”±åŠŸèƒ½å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚æ¯ä¸ªç‰ˆæœ¬çš„ &lt;code&gt;productpage&lt;/code&gt; çš„ &lt;code&gt;DestinationRule subsets&lt;/code&gt; å®šä¹‰ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DestinationRule&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;loadBalancer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;simple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RANDOM&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subsets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­æœ‰å‡ ä¸ª &lt;code&gt;VirtualService&lt;/code&gt; å®ç°äº†æ³³é“æ ‡å¤´é€»è¾‘çš„å‰åŠéƒ¨åˆ†ã€‚ä»¥ä¸‹è´Ÿè´£å‰ç¼€åŒ¹é…å¹¶ä½¿ç”¨ &lt;code&gt;delegate&lt;/code&gt; åŠŸèƒ½æ¥ä½¿ç”¨ç¬¬äºŒä¸ª &lt;code&gt;VirtualService&lt;/code&gt;ï¼Œå› æ­¤é…ç½®æ˜¯åŸå­çš„å¹¶ä¸” &lt;code&gt;mesh&lt;/code&gt; é¿å…å£°æ˜ç½‘å…³é€‰æ‹©å™¨ï¼ˆå‚è§ä¸‹é¢çš„å¼•ç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;VirtualService&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;bookinfo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gateways&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;bookinfo-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/login&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/logout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/api/v1/products&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;delegate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage-route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æŒ‡æ´¾ &lt;code&gt;productpage-route&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;VirtualService&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage-route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;productpage-v1-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;x-version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;productpage-v2-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;x-version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;productpage-v3-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;x-version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exact&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;productpage-default-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;withoutHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;x-version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;productpage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œåœ¨ &lt;code&gt;Reviews&lt;/code&gt; çº§åˆ«ï¼Œåœ¨ &lt;code&gt;httpMatchRequest&lt;/code&gt; ä¸­ä½¿ç”¨ &lt;code&gt;sourceLabels&lt;/code&gt; é…ç½®åˆ¶ä½œæ³³é“çš„ååŠéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªæˆ–å¤šä¸ªæ ‡ç­¾ï¼Œè¿™äº›æ ‡ç­¾çº¦æŸè§„åˆ™å¯¹å…·æœ‰ç»™å®šæ ‡ç­¾çš„æº (å®¢æˆ·æœº) å·¥ä½œè´Ÿè½½çš„é€‚ç”¨æ€§ã€‚å¦‚æœ VirtualService æœ‰ä¸€ä¸ªåœ¨é¡¶çº§ &lt;code&gt;gateways&lt;/code&gt; å­—æ®µä¸­æŒ‡å®šçš„ç½‘å…³åˆ—è¡¨ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»åŒ…å«è¯¥å­—æ®µé€‚ç”¨çš„ä¿ç•™ç½‘å…³ &lt;code&gt;mesh&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ¥æºï¼š&lt;/em&gt; &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/virtual-service/#HTTPMatchRequest&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;Istio è™šæ‹ŸæœåŠ¡æ–‡æ¡£&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯ &lt;code&gt;VirtualService&lt;/code&gt; ä½¿ç”¨è¯¥ &lt;code&gt;sourceLabels&lt;/code&gt; åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;VirtualService&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews-route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;reviews-v1-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;sourceLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;reviews-v2-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;sourceLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;reviews-v3-route&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;sourceLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;reviews&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åœ¨æ²¡æœ‰æ ‡å¤´ä¼ æ’­çš„æƒ…å†µä¸‹æµ‹è¯•æ ‡å¤´è·¯ç”±&#34;&gt;åœ¨æ²¡æœ‰æ ‡å¤´ä¼ æ’­çš„æƒ…å†µä¸‹æµ‹è¯•æ ‡å¤´è·¯ç”±&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œä»æ— æ ‡å¤´åœºæ™¯å¼€å§‹ï¼Œæ‚¨å¯ä»¥ä»æ‰€æœ‰é€šé“è·å¾—å“åº”ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; â€”â€”â€”â€”â€”Â»  ns:bookinfo â¯ for i in {1..5}; do curl -s localhost:8080/productpage | grep -A1 &amp;#34;Reviews served by&amp;#34;; done
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v2-955b74755-t4jkb&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v2-955b74755-t4jkb&amp;lt;/u&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæ£€æŸ¥ &lt;code&gt;x-version: v1&lt;/code&gt; header æ˜¯å¦æœ‰ä½œç”¨ã€‚æ‚¨å¯ä»¥çœ‹åˆ°å·¥ä½œè´Ÿè½½å‘å‡ºçš„æ‰€æœ‰å¯¹ &lt;code&gt;productpage-v1&lt;/code&gt; çš„è°ƒç”¨å‡ç”±  &lt;code&gt;reviews-v1&lt;/code&gt; ä¸“é—¨æä¾›æœåŠ¡ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; â€”â€”â€”â€”â€”Â»  ns:bookinfo â¯ for i in {1..10}; \
do curl -s localhost:8080/productpage -H &amp;#34;x-version: v1&amp;#34; \
| grep -A1 &amp;#34;Reviews served by&amp;#34;; done
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v1-5cf854487-hjtrg&amp;lt;/u&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½¿ç”¨ &lt;code&gt;v3&lt;/code&gt; æ ‡å¤´å€¼å®Œæˆæµ‹è¯•ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  â€”â€”â€”â€”â€”Â»  ns:bookinfo â¯ for i in {1..10}; \
do curl -s localhost:8080/productpage -H &amp;#34;x-version: v3&amp;#34; \
| grep -A1 &amp;#34;Reviews served by&amp;#34;; done
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
        &amp;lt;dt&amp;gt;Reviews served by:&amp;lt;/dt&amp;gt;
        &amp;lt;u&amp;gt;reviews-v3-797fc48bc9-wsg26&amp;lt;/u&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬åœ¨æ ‡å¤´ä¸Šä½¿ç”¨ &lt;code&gt;match&lt;/code&gt; ï¼Œåœ¨ Istio ä¸­ä½¿ç”¨ &lt;code&gt;subsets&lt;/code&gt; å’Œ &lt;code&gt;sourceLabels&lt;/code&gt; åŸºäºæ ‡å¤´è¿›è¡Œè·¯ç”±ï¼Œè€Œæ— éœ€æ ‡å¤´ä¼ æ’­ã€‚æ‚¨è¿˜å¯ä»¥æŸ¥çœ‹ &lt;code&gt;delegate&lt;/code&gt; åŠŸèƒ½ä»¥åŠ &lt;code&gt;withoutHeaders&lt;/code&gt; åŒ¹é…çš„ä½¿ç”¨æƒ…å†µã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å¦‚æœæ‚¨æ˜¯æœåŠ¡ç½‘æ ¼æ–°æ‰‹ï¼ŒTetrate&lt;a href=&#34;https://tetr8.io/academy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ Tetrate Academy&lt;/a&gt;æä¾›äº†ä¸€ç³»åˆ—å…è´¹åœ¨çº¿è¯¾ç¨‹ï¼Œå¯å¸®åŠ©æ‚¨å¿«é€Ÿç†Ÿæ‚‰ Istio å’Œ Envoyã€‚å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä½¿ç”¨ Istio è¿›è¡Œç”Ÿäº§çš„æœ€å¯é æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Subscription&lt;/a&gt;ã€‚Tetrate Istio è®¢é˜…æ‹¥æœ‰åœ¨é«˜åº¦ç›‘ç®¡å’Œä»»åŠ¡å…³é”®å‹ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ Istio å’Œ Envoy æ‰€éœ€çš„ä¸€åˆ‡ã€‚å®ƒåŒ…æ‹¬ &lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro&lt;/a&gt;ï¼Œè¿™æ˜¯ Istio å’Œ Envoy çš„ 100% ä¸Šæ¸¸å‘è¡Œç‰ˆï¼Œç»è¿‡ FIPS éªŒè¯å¹¶å‡†å¤‡å¥½ FedRAMPã€‚å¯¹äºéœ€è¦å¼€æº Istio å’Œ Envoy è€Œæ— éœ€ä¸“æœ‰ä¾›åº”å•†ä¾èµ–çš„å›¢é˜Ÿï¼ŒTetrate æä¾›å”¯ä¸€ 100% ä¸Šæ¸¸ Istio ä¼ä¸šæ”¯æŒäº§å“ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ Istio ä¸­æŒ‰è·¯å¾„é…ç½®å…¨å±€é€Ÿç‡é™åˆ¶</title>
      <link>https://cloudnativecn.com/blog/how-to-configure-global-rate-limits-by-path-in-istio/</link>
      <pubDate>Thu, 29 Feb 2024 20:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-to-configure-global-rate-limits-by-path-in-istio/</guid>
      <description>&lt;p&gt;æœ¬æ–‡æ˜¯ä¸ºé‚£äº›åˆšå¼€å§‹ä½¿ç”¨ Istio é€Ÿç‡é™åˆ¶åŠŸèƒ½ï¼Œå¸Œæœ›äº†è§£åŸºäºè¯·æ±‚è·¯å¾„çš„é€Ÿç‡é™åˆ¶å¦‚ä½•å·¥ä½œçš„äººè€Œå†™çš„ã€‚å®ƒæºäºæˆ‘çš„å®è·µï¼Œå¹¶æ¾„æ¸…äº†å…³äº&lt;code&gt;rate_limit&lt;/code&gt;æ“ä½œä¸­ AND/OR æ“ä½œçš„å›°æƒ‘ã€‚æˆ‘èŠ±äº†æ¯”é¢„æœŸæ›´å¤šçš„æ—¶é—´æ¥å¼„æ¸…æ¥šæˆ‘å°†åœ¨è¿™é‡Œä¸ºä½ æ€»ç»“çš„å†…å®¹ï¼Œä»¥ä¾¿ä½ åœ¨å‡ åˆ†é’Ÿå†…å­¦ä¹ ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºç¡€çŸ¥è¯†&#34;&gt;åŸºç¡€çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;Istio åœ¨ Envoy ä¹‹ä¸Šè¿è¡Œï¼Œè€Œæˆ‘ä»¬å°†è®¨è®ºçš„ä¸»è¦æŠ€æœ¯æ˜¯ Envoyã€‚Envoy æœ‰åœ¨ä»£ç†æœ¬èº«ä¸Šå®ç°çš„æœ¬åœ°é€Ÿç‡é™åˆ¶å’Œåœ¨ L4 æˆ– L7 ä¸Šè°ƒç”¨å¤–éƒ¨æœåŠ¡çš„å…¨å±€é€Ÿç‡é™åˆ¶çš„é€‰é¡¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤–éƒ¨é€Ÿç‡é™åˆ¶æœåŠ¡&#34;&gt;å¤–éƒ¨é€Ÿç‡é™åˆ¶æœåŠ¡&lt;/h2&gt;
&lt;p&gt;å¤–éƒ¨é€Ÿç‡é™åˆ¶æœåŠ¡ï¼ˆRLSï¼‰ä¸ Redis æ•°æ®åº“é…åˆä½¿ç”¨ï¼Œé€šè¿‡ gRPC ä¸ envoy å®ä¾‹è¿æ¥ã€‚è¯¥ RLS æ˜¯ç”± &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/rate_limit_filter#rate-limit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;filter&lt;/a&gt; åœ¨ HTTP è·¯ç”±è¿‡æ»¤å™¨ä¹‹å‰çš„ä¾¦å¬å™¨é“¾ä¸­æ·»åŠ è€Œè¢«è°ƒç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¤–éƒ¨è¿‡æ»¤å™¨å°†æè¿°ç¬¦ç»„ç»‡æˆåŸŸç»„ã€‚æ¯ä¸ªæè¿°ç¬¦éƒ½æ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç”±é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨å¡«å……ï¼Œå¹¶ä¼ é€’ç»™ RLS ä¾›å…¶åœ¨è§„åˆ™æ‰§è¡Œé€»è¾‘ä¸­ä½¿ç”¨ã€‚è¯·å‚é˜… &lt;a href=&#34;https://github.com/envoyproxy/ratelimit#overview&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/envoyproxy/ratelimit#overview&lt;/a&gt; è¿›è¡Œå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;RLS éœ€è¦ç”±é›†ç¾¤æ“ä½œå‘˜ï¼ˆä½ ï¼‰å®‰è£…å’Œç®¡ç†ï¼Œå¹¶ä¸”ä¸ä¼šéš Istio ä¸€èµ·æä¾›ï¼Œå°½ç®¡å¯ä»¥åœ¨ä½ å®‰è£…æ—¶ä» Istio åŒ…çš„ç¤ºä¾‹ç›®å½•ä¸­æ‰¾åˆ°å®ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;envoy-http-é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨&#34;&gt;Envoy HTTP é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨&lt;/h2&gt;
&lt;p&gt;Envoy çš„è®¾ç½®ç”±åº”ç”¨äºå…¥å£ç½‘å…³çš„ä¸¤ä¸ª Envoy é…ç½®ç»„æˆï¼Œä¸€ä¸ªåœ¨ä¾¦å¬å™¨ç»„ä»¶ä¸­æ·»åŠ é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨ï¼Œå¦ä¸€ä¸ªåœ¨åŠ¨æ€è·¯ç”±ç»„ä»¶ä¸­å®šä¹‰è™šæ‹Ÿä¸»æœºçº§åˆ«çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-envoy-http-é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Envoy HTTP é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨&#34; srcset=&#34;
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f1_hu2702124450085595978.webp 400w,
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f1_hu17267518848763078126.webp 760w,
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f1_hu18100369885456252054.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-to-configure-global-rate-limits-by-path-in-istio/f1_hu2702124450085595978.webp&#34;
               width=&#34;760&#34;
               height=&#34;603&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Envoy HTTP é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¸¦æœ‰é€Ÿç‡é™åˆ¶è¿‡æ»¤å™¨çš„ä¾¦å¬å™¨ç»„ä»¶ filter_chains.filters[] åœ¨è·¯ç”±å™¨ä¹‹å‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è™šæ‹Ÿä¸»æœºhttpbincom80çš„è·¯ç”±ç»„ä»¶ä¸­çš„é€Ÿç‡é™åˆ¶æ“ä½œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è™šæ‹Ÿä¸»æœºâ€œhttpbin.com:80â€çš„è·¯ç”±ç»„ä»¶ä¸­çš„é€Ÿç‡é™åˆ¶æ“ä½œ&#34; srcset=&#34;
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f2_hu913498364218129041.webp 400w,
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f2_hu4600014387462606906.webp 760w,
               /blog/how-to-configure-global-rate-limits-by-path-in-istio/f2_hu8730572533005153305.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-to-configure-global-rate-limits-by-path-in-istio/f2_hu913498364218129041.webp&#34;
               width=&#34;760&#34;
               height=&#34;730&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è™šæ‹Ÿä¸»æœºâ€œhttpbin.com:80â€çš„è·¯ç”±ç»„ä»¶ä¸­çš„é€Ÿç‡é™åˆ¶æ“ä½œ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ³¨æ„ï¼šä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä»ä»»ä½• envoy ä»£ç†ï¼ˆå½“ç„¶æ˜¯ç½‘å…³ï¼‰è·å–æ­¤è½¬å‚¨ï¼š&lt;/em&gt;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;k exec &amp;lt;POD&amp;gt; -c istio-proxy -- curl &amp;#39;localhost:15000/config_dump&amp;#39; &amp;gt; config_dump.json
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¾¦å¬å™¨è¿‡æ»¤å™¨é…ç½®äº†å¦‚ä½•åˆ°è¾¾ RLSã€å®ƒæ­£åœ¨ç›‘è§†çš„åŸŸä»¥åŠä¸€äº›å…¶ä»–è®¾ç½®ã€‚å½“æ»¡è¶³è·¯ç”±ä¸­å®šä¹‰çš„æ“ä½œæ—¶ï¼Œæ­¤è¿‡æ»¤å™¨å°†è®¿é—®åœ¨è·¯ç”±ä¸­å®šä¹‰çš„æ“ä½œï¼Œå¹¶è§¦å‘åˆ° RLS ä¸Šæ¸¸çš„ gRPC è°ƒç”¨ï¼Œå…¶ä¸­åŒ…æ‹¬åŸŸã€æè¿°ç¬¦é”®å’Œå€¼ï¼Œä»¥ä¾¿å®ƒè¿”å›ä¸€ä¸ªåˆ¤æ–­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-ä¸­æŒ‰è¯·æ±‚è·¯å¾„è®¾ç½®é€Ÿç‡é™åˆ¶çš„ç¤ºä¾‹&#34;&gt;Istio ä¸­æŒ‰è¯·æ±‚è·¯å¾„è®¾ç½®é€Ÿç‡é™åˆ¶çš„ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;ä½ éœ€è¦æŒ‰ç…§&lt;a href=&#34;https://istio.io/latest/docs/tasks/policy-enforcement/rate-limit/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤&lt;/a&gt;å¼€å§‹ã€‚èŠ±ç‚¹æ—¶é—´åˆ†æåŸºäºå‰æ–‡ä»‹ç»çš„é…ç½®ã€‚ä¾›ä½ å‚è€ƒï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ä½ ä¹Ÿå¯ä»¥åœ¨ Istio åŒ…çš„ç¤ºä¾‹ç›®å½•ä¸­è®¿é—®çš„ &lt;code&gt;httpbin&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é”™è¯¯çš„æ–¹æ³•&#34;&gt;é”™è¯¯çš„æ–¹æ³•&lt;/h3&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘å¸Œæœ›æ ¹æ®ä¸¤ä¸ªè·¯å¾„ &lt;code&gt;/delay&lt;/code&gt; å’Œ &lt;code&gt;/status&lt;/code&gt; è¿›è¡Œé€Ÿç‡é™åˆ¶ã€‚çœ‹èµ·æ¥å¾ˆå®¹æ˜“ï¼Œæ‰€ä»¥æˆ‘é…ç½®äº†æˆ‘çš„ Envoy Filter å’Œ RLS å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# EnvoyFilter é…ç½®è·¯ç”±æ“ä½œ&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;MERGE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rate_limits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;actions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;header_value_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;descriptor_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PATH&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;descriptor_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;yes&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;:path&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;safe_regex_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;google_re2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;regex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.*delay.*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;header_value_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;descriptor_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;PATH&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;descriptor_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;no
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;:path&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;safe_regex_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;google_re2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;regex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.*status.*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# RLS configmap&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config.yaml&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    domain: tetrate-ratelimit
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    descriptors:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      - key: PATH
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        value: &amp;#34;yes&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        rate_limit:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          unit: minute
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          requests_per_unit: 3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      - key: PATH
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        value: &amp;#34;no&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        rate_limit:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          unit: minute
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          requests_per_unit: 1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰äº†è¿™ä¸ªï¼Œæˆ‘æœŸæœ›é€šè¿‡è°ƒç”¨ä»¥ä¸‹å‘½ä»¤æ¥ä½¿å…¶å·¥ä½œï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl http://127.0.0.1:8080/delay/1 -H&amp;#34;host: httpbin.com&amp;#34; -v -o /dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½†æ˜¯ RLS ç”šè‡³æ²¡æœ‰æ³¨æ„åˆ°è¿™ä¸ªè°ƒç”¨ï¼Œæ‰€ä»¥é€Ÿç‡é™åˆ¶æ²¡æœ‰å‘ç”Ÿï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# k logs -n default -f ratelimit-57bf5688c-f8q5k
time=&amp;#34;2023-11-29T17:34:10Z&amp;#34; level=debug msg=&amp;#34;[gostats] Flush() called, all stats would be flushed&amp;#34;
time=&amp;#34;2023-11-29T17:34:20Z&amp;#34; level=debug msg=&amp;#34;[gostats] flushing counter ratelimit.go.mallocs: 460&amp;#34;
time=&amp;#34;2023-11-29T17:34:20Z&amp;#34; level=debug msg=&amp;#34;[gostats] flushing counter ratelimit.go.frees: 26&amp;#34;
time=&amp;#34;2023-11-29T17:34:20Z&amp;#34; level=debug msg=&amp;#34;[gostats] flushing counter ratelimit.go.totalAlloc: 15624&amp;#34;
time=&amp;#34;2023-11-29T17:34:20Z&amp;#34; level=debug msg=&amp;#34;[gostats] flushing gauge ratelimit.go.sys: 0&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;em&gt;ä¸ºäº†è®¾ç½®è°ƒè¯•æ¨¡å¼ï¼Œä½ å¯ä»¥ç¼–è¾‘ ratelimit-server éƒ¨ç½²çš„å®¹å™¨å‚æ•°ã€‚åœ¨é‚£é‡Œï¼Œä½ å°†æ‰¾åˆ°æ—¥å¿—çº§åˆ«æ ‡å¿—ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘å°è¯•äº†æ‰€æœ‰ç§ç±»çš„ç»„åˆåœ¨ &lt;code&gt;rate_limits.actions&lt;/code&gt; è®¾ç½®ä¸­ï¼Œä½¿ç”¨ &lt;code&gt;string_match&lt;/code&gt; å’Œ &lt;code&gt;prefix_match&lt;/code&gt; æ›¿ä»£äº† &lt;code&gt;safe_regex_match&lt;/code&gt;ï¼Œä½†æ²¡æœ‰æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;è¿˜å°è¯•ä½¿ç”¨å•ä¸ª &lt;code&gt;descriptor_key&lt;/code&gt;ï¼Œä¸åŒçš„å€¼ä»¥åŠç”šè‡³ä¸è®¾ç½®å®ƒå¹¶ä½¿ç”¨é»˜è®¤çš„ &lt;code&gt;header_match&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é¡¿æ‚Ÿæ—¶åˆ»&#34;&gt;é¡¿æ‚Ÿæ—¶åˆ»&lt;/h2&gt;
&lt;p&gt;æˆ‘å‘ç°è¿‡æ»¤å™¨æ²¡æœ‰å‘é€ä»»ä½•ä¸œè¥¿åˆ° RLSï¼Œå› ä¸ºå‰è€…åœ¨ä»»ä½•è¯·æ±‚ä¸Šéƒ½ä¿æŒæ²‰é»˜ã€‚ç„¶åï¼Œé€šè¿‡æ–‡æ¡£æˆ‘è¯»åˆ°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;å¦‚æœæ“ä½œä¸èƒ½æ·»åŠ æè¿°ç¬¦æ¡ç›®ï¼Œåˆ™ä¸ä¼šä¸ºé…ç½®ç”Ÿæˆæè¿°ç¬¦&amp;rdquo;ï¼Œè§&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#config-route-v3-ratelimit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶åï¼Œå‘èµ·è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;curl http://127.0.0.1:8080/status/delay -H&amp;#34;host: httpbin.com&amp;#34; -v -o /dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç»“æœå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;time=&amp;#34;2023-11-29T16:07:07Z&amp;#34; level=debug msg=&amp;#34;got descriptor: (PATH=yes),(PATH=no)&amp;#34;
time=&amp;#34;2023-11-29T16:07:07Z&amp;#34; level=debug msg=&amp;#34;starting get limit lookup&amp;#34;
time=&amp;#34;2023-11-29T16:07:07Z&amp;#34; level=debug msg=&amp;#34;looking up key: PATH_yes&amp;#34;
time=&amp;#34;2023-11-29T16:07:07Z&amp;#34; level=debug msg=&amp;#34;found rate limit: PATH_yes&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰€ä»¥ï¼Œåªæœ‰å½“æˆ‘çš„è·¯å¾„æ»¡è¶³ &lt;em&gt;ä¸¤ä¸ª&lt;/em&gt; &lt;code&gt;header_value_match&lt;/code&gt; æ—¶ï¼Œæè¿°ç¬¦æ‰ä¼šä¼ é€’ç»™ RLSã€‚æˆ‘çš„å½“å‰é…ç½®æ­£å¦‚ä¸€ä¸ª AND è¿ç®—ç¬¦ä¸€æ ·å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œä¸€åˆ‡éƒ½å½’ç»“ä¸ºï¼š&lt;em&gt;å¦‚ä½•åœ¨ rate_limit æ“ä½œä¸­è®¾ç½® OR é€»è¾‘è€Œä¸æ˜¯ ANDï¼Ÿ&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆ&#34;&gt;è§£å†³æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;åŸå§‹é…ç½®ç•¥æœ‰å˜åŒ–ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# EnvoyFilter é…ç½®è·¯ç”±æ“ä½œ   
        value:
          rate_limits:
            - actions: # ä»»ä½•æ“ä½œåœ¨æ­¤å¤„
              - header_value_match:
                  descriptor_key: &amp;#34;PATH_DELAY&amp;#34;
                  descriptor_value: &amp;#34;yes&amp;#34;
                  headers:
                    - name: &amp;#34;:path&amp;#34;
                      safe_regex_match:
                        google_re2: {}
                        regex: &amp;#34;.*delay.*&amp;#34;
            - actions:
              - header_value_match:
                  descriptor_key: &amp;#34;PATH_STATUS&amp;#34;
                  descriptor_value: &amp;#34;yes&amp;#34;
                  headers:
                    - name: &amp;#34;:path&amp;#34;
                      safe_regex_match:
                        google_re2: {}
                        regex: &amp;#34;.*status.*&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çœ‹èµ·æ¥åƒä¸€ä¸ªæœ‰æ•ˆçš„é…ç½®ï¼Œå°±åƒï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;â¯ curl http://127.0.0.1:8080/delay/1 -H&amp;#34;host: httpbin.com&amp;#34; -v -s -o /dev/null 
*   Trying 127.0.0.1:8080...
* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)
&amp;gt; GET /delay/1 HTTP/1.1
&amp;gt; Host: httpbin.com
&amp;gt; User-Agent: curl/7.81.0
&amp;gt; Accept: */*
&amp;gt; 
* Mark bundle as not supporting multiuse
&amp;lt; HTTP/1.1 200 OK
&amp;lt; server: istio-envoy
&amp;lt; date: Wed, 29 Nov 2023 20:17:02 GMT
&amp;lt; content-type: application/json
&amp;lt; content-length: 703
&amp;lt; access-control-allow-origin: *
&amp;lt; access-control-allow-credentials: true
&amp;lt; x-envoy-upstream-service-time: 1005
&amp;lt; 
{ [703 bytes data]
* Connection #0 to host 127.0.0.1 left intact

â¯ curl http://127.0.0.1:8080/delay/1 -H&amp;#34;host: httpbin.com&amp;#34; -v -s -o /dev/null 
*   Trying 127.0.0.1:8080...
* Connected to 127.0.0.1 (127.0.0.1) port 8080 (#0)
&amp;gt; GET /delay/1 HTTP/1.1
&amp;gt; Host: httpbin.com
&amp;gt; User-Agent: curl/7.81.0
&amp;gt; Accept: */*
&amp;gt; 
* Mark bundle as not supporting multiuse
&amp;lt; HTTP/1.1 429 Too Many Requests &amp;lt;---------- å‚è§
&amp;lt; x-envoy-ratelimited: true
&amp;lt; date: Wed, 29 Nov 2023 20:17:06 GMT
&amp;lt; server: istio-envoy
&amp;lt; content-length: 0
&amp;lt; 
* Connection #0 to host 127.0.0.1 left intact
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å’Œ RLS æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;time=&amp;#34;2023-11-29T16:33:57Z&amp;#34; level=debug msg=&amp;#34;starting cache lookup&amp;#34;
time=&amp;#34;2023-11-29T16:33:57Z&amp;#34; level=debug msg=&amp;#34;looking up cache key: tetrate-ratelimit_PATH_DELAY_yes_1701275580&amp;#34;
time=&amp;#34;2023-11-29T16:33:57Z&amp;#34; level=debug msg=&amp;#34;cache key: tetrate-ratelimit_PATH_DELAY_yes_1701275580 current: 1&amp;#34;
time=&amp;#34;2023-11-29T16:33:57Z&amp;#34; level=debug msg=&amp;#34;returning normal response&amp;#34;
time=&amp;#34;2023-11-29T16:33:57Z&amp;#34; level=debug msg=&amp;#34;[gostats] flushing time ratelimit_server.ShouldRateLimit.response_time: 0.000000&amp;#34;
time=&amp;#34;2023-11-29T16:33:59Z&amp;#34; level=debug msg=&amp;#34;got descriptor: (PATH_DELAY=yes)&amp;#34;
time=&amp;#34;2023-11-29T16:33:59Z&amp;#34; level=debug msg=&amp;#34;starting get limit lookup&amp;#34;
time=&amp;#34;2023-11-29T16:33:59Z&amp;#34; level=debug msg=&amp;#34;looking up key: PATH_DELAY_yes&amp;#34;
time=&amp;#34;2023-11-29T16:33:59Z&amp;#34; level=debug msg=&amp;#34;found rate limit: PATH_DELAY_yes&amp;#34;
time=&amp;#34;2023-11-29T16:33:59Z&amp;#34; level=debug msg=&amp;#34;applying limit: 1 requests per MINUTE, shadow_mode: false&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç›¸ä¿¡æˆ‘ï¼Œ&lt;code&gt;/status&lt;/code&gt; çš„é™åˆ¶ä¹Ÿæ˜¯å­˜åœ¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;AND/ORé€»è¾‘ç”¨äºé€Ÿç‡é™åˆ¶ &lt;code&gt;rate_limits&lt;/code&gt; é…ç½®åœ¨å…¶æ•°ç»„ä¸­æ”¯æŒå¤šä¸ªä½ç½®ï¼Œå› æ­¤ AND/OR é€»è¾‘æ“ä½œå–å†³äºåŠ¨ä½œæ˜¯å¦åµŒå¥—åˆ°ç›¸åŒçš„ &lt;code&gt;actions&lt;/code&gt; å­é›†ä¸­ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šå¯èƒ½æœ‰ä¸€ç§æ›´å®‰å…¨ã€æ›´æœ‰æ•ˆçš„è·¯å¾„åŒ¹é…æ–¹å¼ï¼Œè€Œä¸æ˜¯åƒè¿™ä¸ªä¾‹å­ä¸­é‚£æ ·æ‰“å¼€æ­£åˆ™è¡¨è¾¾å¼ã€‚å®ƒå¾ˆç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸“æ³¨äºä¸»é¢˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tetrate æ¨å‡ºé’ˆå¯¹ Amazon EKS è®¾è®¡çš„æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆ TSE</title>
      <link>https://cloudnativecn.com/blog/introducing-tetrate-service-express/</link>
      <pubDate>Thu, 13 Apr 2023 16:13:33 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/introducing-tetrate-service-express/</guid>
      <description>&lt;p&gt;Tetrate Service Express (TSE) æ˜¯ä¸€æ¬¾åŸºäºå¼€æºè½¯ä»¶çš„æœåŠ¡è¿æ¥ã€å®‰å…¨å’Œå¼¹æ€§è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œä¸“ä¸º Amazon EKS è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://tetrate.io/blog/introducing-tetrate-service-express/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Express ä»‹ç»&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå®ç°-amazon-eks-ä¸Šå®‰å…¨å’Œå¼¹æ€§çš„æœåŠ¡ç½‘æ ¼&#34;&gt;å¿«é€Ÿå®ç° Amazon EKS ä¸Šå®‰å…¨å’Œå¼¹æ€§çš„æœåŠ¡ç½‘æ ¼&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ Tetrate Service Express (TSE)ï¼Œè¿™æ˜¯ä¸€æ¬¾é’ˆå¯¹ Amazon EKS çš„æœåŠ¡è¿æ¥ã€å®‰å…¨å’Œå¼¹æ€§è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬åŸºäº Istio å’Œ Envoy ç­‰å¼€æºæœåŠ¡ç½‘æ ¼ç»„ä»¶æ„å»ºäº† TSEï¼Œå¹¶é’ˆå¯¹ AWS å¯¹ TSE è¿›è¡Œäº†ç®€åŒ–å®‰è£…ã€é…ç½®å’Œæ“ä½œçš„ä¼˜åŒ–ã€‚å¦‚æœæ‚¨çš„å›¢é˜Ÿæ­£åœ¨ AWS ä¸Šè¿›è¡ŒæœåŠ¡ç½‘æ ¼å®éªŒï¼Œå¹¶ä¸”éœ€è¦å¿«é€Ÿè¯æ˜æŠ•èµ„å›æŠ¥ç‡ï¼Œè€Œæ— éœ€æŒæ¡å¤æ‚çš„ Istio å’Œ AWS åŸºå…ƒï¼Œé‚£ä¹ˆ TSE å°±æ˜¯é€‚åˆæ‚¨çš„é€‰æ‹©ï¼å¦‚æœæ‚¨çš„å›¢é˜Ÿå·²ç»åœ¨å•ä¸ªé›†ç¾¤ä¸Šæ‹¥æœ‰äº†æœåŠ¡ç½‘æ ¼ï¼Œä½†å¸Œæœ›å°†ç½‘æ ¼æ‰©å±•åˆ°å¤šä¸ªé›†ç¾¤ç”šè‡³åŒºåŸŸï¼Œé‚£ä¹ˆ TSE ä¹Ÿå¯ä»¥å¸®åŠ©æ‚¨ã€‚äº‹å®ä¸Šï¼ŒTSE æ˜¯å”¯ä¸€ä¸€æ¬¾åŸºäºå¼€æºè½¯ä»¶å¹¶é’ˆå¯¹ AWS è¿›è¡Œä¼˜åŒ–çš„äº§å“ï¼Œé¢„å…ˆé›†æˆäº†æœ€å—æ¬¢è¿çš„ AWS æœåŠ¡ï¼Œå¯åœ¨å‡ åˆ†é’Ÿå†…è®©æ‚¨ä¸Šæ‰‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³å¿«é€Ÿäº†è§£ Tetrate Service Express çš„åŠŸèƒ½ï¼Œåœ¨&lt;a href=&#34;https://tetr8.io/tse&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;åŠ å…¥ç­‰å¾…åˆ—è¡¨ä»¥è·å–æ‚¨çš„è¯„ä¼°å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³æ·±å…¥äº†è§£ Tetrate Service Express çš„æ–°åŠŸèƒ½ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé€‰æ‹©-tetrate-service-express&#34;&gt;ä¸ºä»€ä¹ˆé€‰æ‹© Tetrate Service Express&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨çš„ç»„ç»‡æƒ³è¦åˆ›é€ æ›´å¥½çš„å®¢æˆ·ä½“éªŒã€æé«˜è¿è¥æ•ˆç‡æˆ–ä¿æŠ¤çŸ¥è¯†äº§æƒï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½å¿…é¡»æ„å»ºå’Œè¿è¡Œè½¯ä»¶â€”â€”æ›´é«˜è´¨é‡ã€æ›´å¿«é€Ÿçš„å‘å¸ƒã€æ›´å¥½çš„æ­£å¸¸è¿è¡Œæ—¶é—´ã€‚è€Œä¸”å¾ˆå¯èƒ½ï¼Œåº”ç”¨ç¨‹åºå¼€å‘å›¢é˜Ÿã€è¿è¥å›¢é˜Ÿå’Œå¹³å°å›¢é˜Ÿæ­£åœ¨å€ŸåŠ©ä¸¤ç§åˆ›æ–°è¶‹åŠ¿æ¥å®ç°è¿™äº›ç›®æ ‡ï¼šäº‘åŸºç¡€è®¾æ–½çš„çµæ´»æ€§å’Œå¾®æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨äº‘ä¸­æ„å»ºå¾®æœåŠ¡æ—¶ï¼Œè®¸å¤šå›¢é˜Ÿé€‰æ‹© Amazon EKS çš„ä¾¿åˆ©æ€§ã€‚ç„¶è€Œï¼Œéšç€ä»–ä»¬æ‰©å±• EKS å·¥ä½œè´Ÿè½½ï¼Œä»–ä»¬ä¼šå‘ç°è‡ªå·±é¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ä¿æŠ¤åˆ†å¸ƒåœ¨ AWS ä¸Šçš„å¾®æœåŠ¡ç»„ä»¶ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨æ›´æ–°æˆ–è´Ÿè½½ä¸‹å•ä¸ªç»„ä»¶å¤±è´¥æ—¶ä¿æŒå¯é æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å½“ä¸€åˆ‡éƒ½æ˜¯åŠ¨æ€çš„ï¼Œæ‰‹åŠ¨é…ç½®ä¸å†èµ·ä½œç”¨æ—¶ï¼Œå¦‚ä½•ç®¡ç†æœåŠ¡ä¹‹é—´çš„æµé‡ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¶Šæ¥è¶Šå¤šçš„å¹³å°è¿è¥å›¢é˜Ÿä¼šåœ¨å¾®æœåŠ¡ä¹‹ä¸Šåˆ›å»ºä¸€ä¸ªä¸“ç”¨çš„åŸºç¡€è®¾æ–½å±‚â€”â€”æœåŠ¡ç½‘æ ¼â€”â€”å®ƒæä¾›äº†è·¨å¾®æœåŠ¡ç»„ä»¶çš„æœåŠ¡å‘ç°ã€å®‰å…¨æ€§ã€è®¤è¯å’Œå¯è§‚æµ‹æ€§ã€‚Istio å’Œ Envoy æ˜¯æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢çš„å¼€æºæ ‡å‡†ï¼Œä½† Istio å’Œ Envoy åªæ˜¯éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä»¬ä¸ºè¿è¡Œ Amazon EKS çš„å›¢é˜Ÿæ·»åŠ äº†æ–°çš„æ“ä½œå¤æ‚æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-amazon-eks-ä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Amazon EKS ä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image_hu12424342188703243370.webp 400w,
               /blog/introducing-tetrate-service-express/image_hu15985461260611864805.webp 760w,
               /blog/introducing-tetrate-service-express/image_hu17189018586924368015.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/introducing-tetrate-service-express/image_hu12424342188703243370.webp&#34;
               width=&#34;760&#34;
               height=&#34;452&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Amazon EKS ä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Tetrate Service Express ä¸ºå¹³å°å›¢é˜Ÿæä¾›äº† Istio å’Œ Envoy ä¹‹ä¸Šçš„æœåŠ¡ç½‘æ ¼è‡ªåŠ¨åŒ–ã€‚å®ƒå¤„ç†åœ¨ Amazon EKS ä¸Šå®‰è£…å’Œé…ç½®å¼€æºç»„ä»¶ï¼Œä¸ AWS æœåŠ¡é›†æˆï¼Œå¹¶ä¸ºå¹³å°è¿è¥å•†æä¾›ç®¡ç†æ§åˆ¶å°ï¼Œä»¥å¿«é€Ÿé…ç½®æœåŠ¡ç½‘æ ¼ä»¥å®ç°å®‰å…¨ã€å¼¹æ€§å’Œå¯è§‚å¯Ÿæ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-tetrate-service-express-æä¾›äº†ä¸€ç§ä¸€è‡´çš„å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ç”¨äºåœ¨-amazon-eks-å†…éƒ¨å’Œè·¨-amazon-eks-è¿æ¥ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Tetrate Service Express æä¾›äº†ä¸€ç§ä¸€è‡´çš„ã€å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ï¼Œç”¨äºåœ¨ Amazon EKS å†…éƒ¨å’Œè·¨ Amazon EKS è¿æ¥ã€ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-1_hu17181388336199352394.webp 400w,
               /blog/introducing-tetrate-service-express/image-1_hu14866004398329106080.webp 760w,
               /blog/introducing-tetrate-service-express/image-1_hu8455775184270777202.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/introducing-tetrate-service-express/image-1_hu17181388336199352394.webp&#34;
               width=&#34;760&#34;
               height=&#34;427&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Tetrate Service Express æä¾›äº†ä¸€ç§ä¸€è‡´çš„ã€å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ï¼Œç”¨äºåœ¨ Amazon EKS å†…éƒ¨å’Œè·¨ Amazon EKS è¿æ¥ã€ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå®‰è£…-amazon-eks-å’Œé›†æˆ-aws-æœåŠ¡&#34;&gt;å¿«é€Ÿå®‰è£… Amazon EKS å’Œé›†æˆ AWS æœåŠ¡&lt;/h2&gt;
&lt;p&gt;è®© Istio åœ¨ EKS ä¸Šè¿è¡Œå¯èƒ½å˜å¾—æ›´åŠ å®¹æ˜“ï¼ˆä¾‹å¦‚ä½¿ç”¨&lt;a href=&#34;https://tetrate.io/blog/tid-add-on-for-eks/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro EKS add-on&lt;/a&gt;ï¼‰ï¼Œä½†åœ¨æ‚¨å¯ä»¥æ“ä½œåŠŸèƒ½æ€§æœåŠ¡ç½‘æ ¼ä¹‹å‰ï¼Œè¿˜éœ€è¦å®Œæˆæ›´å¤šçš„å·¥ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ç¡®ä¿æ‰€æœ‰æœåŠ¡ç½‘æ ¼ç»„ä»¶éƒ½å·²æ­£ç¡®å®‰è£…å’Œé…ç½®ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•å®šä¹‰ Istio å’Œ Envoy å‘¨å›´çš„ç½‘ç»œåŸºç¡€æ¶æ„ï¼Œä»¥å®ç°å®‰å…¨çš„è·¨é›†ç¾¤è¿æ¥å’Œå¯ç”¨æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•è§‚å¯Ÿå’Œæ’æŸ¥ç½‘æ ¼ä¸Šçš„æœåŠ¡ï¼Œä»¥ååŠ©æ‰©å±•å’Œä¼˜åŒ–ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TSE å¯ä»¥ä½¿ç”¨ Helm chart è½»æ¾å®‰è£…åœ¨ EKS ä¸Šï¼Œå¹¶ä¸ Route 53 å’Œ NLBï¼ˆæˆ–å…¶ä»– AWS è´Ÿè½½å¹³è¡¡å™¨ç±»å‹ï¼‰è½»æ¾é›†æˆï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¿«é€Ÿï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®šä½æœåŠ¡çš„è¾¹ç¼˜å’Œå…¥å£ç½‘å…³ï¼Œä»¥ç®¡ç†å’Œå®‰å…¨åœ°æ§åˆ¶å…¥å£å’Œå‡ºå£æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å†…ç½®èº«ä»½éªŒè¯ã€é€Ÿç‡é™åˆ¶ã€HA å’Œå®‰å…¨æ€§æä¾›åº”ç”¨ç¨‹åºçš„ APIã€‚&lt;/li&gt;
&lt;li&gt;è·å–æœåŠ¡å’Œåº”ç”¨ç¨‹åºçš„ MELTï¼ˆåº¦é‡ã€äº‹ä»¶ã€æ—¥å¿—ã€è·Ÿè¸ªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨-tetrate-service-express-å’Œç¤ºä¾‹é…ç½®å¼€å§‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨ Tetrate Service Express å’Œç¤ºä¾‹é…ç½®å¼€å§‹&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-2_hu17400090004472230268.webp 400w,
               /blog/introducing-tetrate-service-express/image-2_hu3674400469175298216.webp 760w,
               /blog/introducing-tetrate-service-express/image-2_hu5996741098174685329.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/introducing-tetrate-service-express/image-2_hu17400090004472230268.webp&#34;
               width=&#34;760&#34;
               height=&#34;372&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨ Tetrate Service Express å’Œç¤ºä¾‹é…ç½®å¼€å§‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;ä¸€æ­¥å¼æœåŠ¡é—´çš„-mtls-åŠ å¯†&#34;&gt;ä¸€æ­¥å¼æœåŠ¡é—´çš„ mTLS åŠ å¯†&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„ç¬¬ä¸€ä¸ªç”¨ä¾‹ä¹‹ä¸€æ˜¯ä½¿ç”¨ mTLS å¯ç”¨æœåŠ¡é—´åŠ å¯†ï¼Œä½†ä¸€æ—¦ä½ æ‰©å±•åˆ°å¤šä¸ªé›†ç¾¤ï¼Œäº‹æƒ…å°±ä¼šå¾ˆå¿«å˜å¾—å¤æ‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•åœ¨å„ä¸ªé›†ç¾¤ä¹‹é—´å»ºç«‹å’Œç®¡ç†å•ä¸ªä¿¡ä»»æ ¹ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨å…¨é¢æ”¯æŒé›¶ä¿¡ä»»å§¿æ€çš„æƒ…å†µä¸‹ï¼Œå¼ºåˆ¶æ‰§è¡Œ mTLSï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•å®šæœŸè½®æ¢è¯ä¹¦ï¼Œå¹¶åœ¨æ³„æ¼æˆ–æŸåè¯ä¹¦çš„æƒ…å†µä¸‹åšå‡ºå“åº”ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tetrate Service Express é€šè¿‡æä¾›ä»¥ä¸‹å†…å®¹ä½¿æœåŠ¡æ˜“äºåŠ å¯†å¹¶åº”ç”¨é›¶ä¿¡ä»»å§¿æ€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®çš„æ˜“äºä½¿ç”¨çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œå¯åœ¨æ‰€æœ‰ç¾¤é›†ä¸­è½®æ¢å’Œç®¡ç†è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç®¡ç†çº§åˆ«ä¸Šå®šä¹‰å¯¹æ‰€æœ‰æœåŠ¡çš„ mTLS éœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä»é»˜è®¤çš„æ‹’ç»æ‰€æœ‰å§¿æ€å¼€å§‹åˆ›å»ºç»†ç²’åº¦çš„è®¿é—®ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é»˜è®¤è®¾ç½®-mtls&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é»˜è®¤è®¾ç½® mTLS&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-3_hu2826961478554532585.webp 400w,
               /blog/introducing-tetrate-service-express/image-3_hu16640198066380769041.webp 760w,
               /blog/introducing-tetrate-service-express/image-3_hu7744296892663624883.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/introducing-tetrate-service-express/image-3_hu2826961478554532585.webp&#34;
               width=&#34;760&#34;
               height=&#34;372&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é»˜è®¤è®¾ç½® mTLS
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;é›†ç¾¤å’ŒåŒºåŸŸä¹‹é—´çš„æ˜“äºæ•…éšœè½¬ç§»è®¾ç½®&#34;&gt;é›†ç¾¤å’ŒåŒºåŸŸä¹‹é—´çš„æ˜“äºæ•…éšœè½¬ç§»è®¾ç½®&lt;/h2&gt;
&lt;p&gt;åœ¨å®šä¹‰åº”ç”¨ç¨‹åºåŸºç¡€æ¶æ„æ—¶ï¼Œè®¾ç½®æœåŠ¡çš„å†…éƒ¨é«˜å¯ç”¨æ€§å¯èƒ½æ˜¯æ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸åŒçš„åŒºåŸŸå†…ã€‚ä¸€äº›å¯èƒ½é‡åˆ°çš„é—®é¢˜åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•é…ç½® Route53ã€Amazon è´Ÿè½½å‡è¡¡å’Œå…¶ä»–è´Ÿè½½å‡è¡¡æœåŠ¡ï¼Œä»¥åœ¨ä¸åŒçš„é›†ç¾¤ä¹‹é—´å®ç°å¯é çš„ HAï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨æ²¡æœ‰ Hairpinning çš„æƒ…å†µä¸‹è®¾ç½®è·¨é›†ç¾¤é€šä¿¡å’Œå†…éƒ¨é«˜å¯ç”¨æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å½“æœåŠ¡å¤±è´¥æ—¶å¦‚ä½•è‡ªåŠ¨åŒ–ç½‘ç»œé…ç½®æ›´æ”¹ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tetrate Service Express é€šè¿‡æä¾›ä»¥ä¸‹åŠŸèƒ½ä½¿è·å–æœåŠ¡ HA æ˜“äºå®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æœåŠ¡å‘å¸ƒè¿›è¡Œè‡ªåŠ¨é…ç½®çš„å…¥å£ã€Amazon è´Ÿè½½å‡è¡¡å’Œ Route 53ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºå†…éƒ¨é«˜å¯ç”¨æ€§è‡ªåŠ¨é…ç½®å†…éƒ¨å’Œä¸œ/è¥¿ç½‘å…³ã€‚&lt;/li&gt;
&lt;li&gt;åŠ¨æ€é‡æ–°é…ç½®ç½‘ç»œè§„åˆ™ï¼Œä»¥åœ¨æœ€å°ä¸­æ–­çš„æƒ…å†µä¸‹åœ¨é›†ç¾¤ä¹‹é—´å’Œä¹‹é—´ä¼ è¾“æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-4_hu11564374604330602348.webp 400w,
               /blog/introducing-tetrate-service-express/image-4_hu13964579029511791011.webp 760w,
               /blog/introducing-tetrate-service-express/image-4_hu6644065256296841378.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/introducing-tetrate-service-express/image-4_hu11564374604330602348.webp&#34;
               width=&#34;760&#34;
               height=&#34;391&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ¥ä¸‹æ¥&#34;&gt;æ¥ä¸‹æ¥&lt;/h2&gt;
&lt;p&gt;è¿™åªæ˜¯æˆ‘ä»¬è¦ä» Tetrate Service Express ä¸­çªå‡ºæ˜¾ç¤ºçš„ä¸€äº›åŠŸèƒ½ã€‚Tetrate Service Express å°†åœ¨æœ¬æœˆæ™šäº›æ—¶å€™å‘å¸ƒæŠ€æœ¯é¢„è§ˆç‰ˆï¼Œä½†æ˜¯æ‚¨ç°åœ¨å¯ä»¥åŠ å…¥ç­‰å¾…åˆ—è¡¨ï¼Œä»¥åœ¨å‘å¸ƒæ—¶è·å–è¯„ä¼°å‰¯æœ¬ã€‚ä¸€æ—¦æ‚¨åŠ å…¥ç­‰å¾…åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†ä¸æ‚¨è”ç³»ï¼Œå‘æ‚¨æä¾›è®¿é—®è¯„ä¼°è½¯ä»¶ã€æ–°æ–‡æ¡£é—¨æˆ·ç½‘ç«™å’Œ Slack ç¤¾åŒºé¢‘é“çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜è®¡åˆ’æ¨å‡ºä¸€ç³»åˆ—é¢å¤–çš„åšå®¢ã€è§†é¢‘å’Œç½‘ç»œç ”è®¨ä¼šï¼Œä»¥å±•ç¤ºæ›´å¤š TSE çš„åŠŸèƒ½ã€‚ä¸‹ä¸€åœºç½‘ç»œç ”è®¨ä¼šå®šäº 5 æœˆä¸¾è¡Œï¼Œè¯·&lt;a href=&#34;https://app.livestorm.co/p/06a20bee-58b0-4976-977d-c2e4b16dbe68&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç«‹å³æ³¨å†Œ&lt;/a&gt;ã€‚æœ€åï¼Œè¯·ä¸è¦å¿˜è®°åœ¨&lt;a href=&#34;https://twitter.com/Tetrateio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Twitter&lt;/a&gt;æˆ–&lt;a href=&#34;https://www.linkedin.com/company/tetrate&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LinkedIn&lt;/a&gt;ä¸Šå…³æ³¨ Tetrateï¼Œä»¥ä¾¿åœ¨æ–°çš„ TSE å†…å®¹å¯ç”¨æ—¶è·å¾—å³æ—¶æ›´æ–°ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio ä¸­çš„å¤–éƒ¨æˆæƒè¿‡æ»¤å™¨ï¼šä½¿ç”¨ OPA å®ç°çµæ´»çš„æˆæƒç­–ç•¥</title>
      <link>https://cloudnativecn.com/blog/understanding-istio-and-open-policy-agent-opa/</link>
      <pubDate>Tue, 28 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/understanding-istio-and-open-policy-agent-opa/</guid>
      <description>&lt;p&gt;å®¢æˆ·å‘æˆ‘ä»¬è¯¢é—®æœåŠ¡ç½‘æ ¼å®è·µä¸­å…³äºå¼€æ”¾ç­–ç•¥ä»£ç† (OPA) å’ŒæœåŠ¡ç½‘æ ¼å¦‚ä½•ç»“åˆä½¿ç”¨çš„é—®é¢˜ã€‚æˆ‘ä»¬æ¢è®¨äº†å…³äºæœåŠ¡ç½‘æ ¼å’Œ OPA ç­–ç•¥çš„æœ€ä½³å®è·µï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•ç›¸äº’è¡¥å……çš„æƒ³æ³•ã€‚ä¸ºäº†æ„å»ºè®¨è®ºæ¡†æ¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† NIST çš„é›¶ä¿¡ä»»æ¶æ„æ ‡å‡†ã€‚åœ¨å³å°†å‘å¸ƒçš„ NIST æ ‡å‡†æ–‡æ¡£ç‰¹åˆ«å‡ºç‰ˆç‰© 800-207A ä¸­ï¼ŒåŸºäºèº«ä»½çš„åˆ†æ®µæ˜¯ä¸€ä¸ªä¸»è¦æ¦‚å¿µã€‚æœ€ä½æ ‡å‡†åŒ…æ‹¬äº”é¡¹ç­–ç•¥æ£€æŸ¥ï¼Œåº”åº”ç”¨äºè¿›å…¥çš„æ¯ä¸ªè¯·æ±‚ç³»ç»Ÿå’Œæ¯ä¸ªåç»­è·ƒç‚¹ã€‚æ‚¨å¯ä»¥è§‚çœ‹æˆ‘ä»¬åœ¨ä»Šå¹´çš„ CloudNativeSecurityCon ä¸Šä¸æ¥è‡ª NIST çš„ Ramaswami Chandramouli è¿›è¡Œçš„æ·±å…¥è®¨è®ºçš„&lt;a href=&#34;https://www.youtube.com/watch?v=s2lIaFhkA8c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨æœåŠ¡ç½‘æ ¼å®ç°åŸºäºèº«ä»½çš„åˆ†å‰²çš„äº”ä¸ªç­–ç•¥æ£€æŸ¥ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼ è¾“ä¸­åŠ å¯†&lt;/li&gt;
&lt;li&gt;æœåŠ¡èº«ä»½å’Œè®¤è¯&lt;/li&gt;
&lt;li&gt;æœåŠ¡åˆ°æœåŠ¡æˆæƒ&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆç”¨æˆ·èº«ä»½å’Œèº«ä»½éªŒè¯&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼ŒæœåŠ¡ç½‘æ ¼æ˜¯ä¸€ä¸ªä¸“ç”¨çš„åŸºç¡€è®¾æ–½å±‚ï¼Œä¸“é—¨ç”¨äºä¸ºå‰å››é¡¹æ£€æŸ¥å®æ–½ç­–ç•¥ï¼Œå¹¶åœ¨ç¬¬äº”é¡¹ä¸­å‘æŒ¥ä¸€å®šä½œç”¨ã€‚OPA çš„äº®ç‚¹åœ¨äºç¬¬äº”ç‚¹ï¼šæœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒã€‚&lt;/p&gt;
&lt;p&gt;Istio çš„ sidecar ä»£ç†å……å½“å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸ã€‚Envoy æ•°æ®å¹³é¢æ˜¯ä¸€ä¸ªé€šç”¨çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP)ï¼Œå¯ä»¥æ‹¦æˆªæ‰€æœ‰æµé‡å¹¶å¯ä»¥åœ¨åº”ç”¨å±‚åº”ç”¨ç­–ç•¥ã€‚å°±æ­¤è€Œè¨€ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‚è€ƒç›‘è§†å™¨ ( &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204B&lt;/a&gt; )ã€‚å°† Envoy ä½œä¸º PEPï¼Œæˆ‘ä»¬å¯ä»¥å°†å®‰å…¨é—®é¢˜ä»åº”ç”¨ç¨‹åºè½¬ç§»åˆ°ç½‘æ ¼ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç­–ç•¥&lt;strong&gt;æ£€æŸ¥ 1-2ï¼šä¼ è¾“ä¸­çš„åŠ å¯†å’ŒæœåŠ¡èº«ä»½ä¸è®¤è¯&lt;/strong&gt;ã€‚ä¸ºäº†æ»¡è¶³å‰ä¸¤ä¸ªç­–ç•¥æ£€æŸ¥ã€ä¼ è¾“ä¸­çš„åŠ å¯†ä»¥åŠæœåŠ¡èº«ä»½å’Œèº«ä»½éªŒè¯ï¼Œç½‘æ ¼ä¸ºç³»ç»Ÿä¸­çš„æ‰€æœ‰é€šä¿¡å®æ–½ mTLSã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 3ï¼šæœåŠ¡åˆ°æœåŠ¡æˆæƒã€‚&lt;/strong&gt; æœåŠ¡ç½‘æ ¼è¿˜æä¾›ç­–ç•¥ä¸‰ï¼Œå³æœåŠ¡åˆ°æœåŠ¡çš„æˆæƒã€‚OPA å¯ä»¥åœ¨è¿™é‡Œå¼€å§‹å‘æŒ¥ä½œç”¨ï¼Œä½†ç”±äº OPA æ˜¯é€šç”¨çš„ï¼Œå®ƒæ²¡æœ‰å›´ç»•æœåŠ¡é€šä¿¡çš„ DSLï¼Œå› æ­¤æ‚¨å¿…é¡»è‡ªå·±åˆ›å»ºå®ƒã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬è®¤ä¸ºç­–ç•¥å¾€å¾€æ›´è‡ªç„¶ï¼Œæ›´å®¹æ˜“ç”¨ä¸“ä¸ºå®ƒæ„å»ºçš„è¯­è¨€æ¥è¡¨è¾¾ã€‚æœåŠ¡ç½‘æ ¼ â€”â€” æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ Istio ä¹‹ä¸Šæ„å»ºçš„åº”ç”¨ç¨‹åºè¿æ¥å’Œå®‰å…¨å¹³å° &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt;â€”â€” å…·æœ‰å¯¹ç¼–å†™æœåŠ¡åˆ°æœåŠ¡ç­–ç•¥æœ‰æ„ä¹‰çš„åè¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 4ï¼šæœ€ç»ˆç”¨æˆ·èº«ä»½å’Œèº«ä»½éªŒè¯ã€‚&lt;/strong&gt; å¯¹äºç¬¬å››ä¸ªç­–ç•¥æ£€æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç³»ç»Ÿçš„æ¯ä¸€è·³éªŒè¯æœ€ç»ˆç”¨æˆ·èº«ä»½ã€‚æœåŠ¡ç½‘æ ¼æä¾›æ‰§è¡Œç‚¹æ¥è¿›è¡Œæ£€æŸ¥ï¼Œä½†æœ‰å…³ç”¨æˆ·èº«ä»½éªŒè¯çš„å®é™…å†³å®šæ—¢ä¸åœ¨æœåŠ¡ç½‘æ ¼é¢†åŸŸä¹Ÿä¸åœ¨ OPA èŒƒå›´å†…ã€‚ç›¸åï¼Œæˆ‘ä»¬éœ€è¦å§”æ‰˜ç»™å—ä¿¡ä»»çš„èº«ä»½æä¾›è€…æ¥åœ¨æ­¤å¤„åšå‡ºåˆ¤å†³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 5ï¼šæœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒã€‚&lt;/strong&gt; é›¶ä¿¡ä»»äº‘åŸç”Ÿè®¿é—®æ§åˆ¶çš„ç¬¬äº”ä¸ªç­–ç•¥æ£€æŸ¥æ˜¯ OPA å¯ä»¥å‘æŒ¥é‡è¦ä½œç”¨çš„åœ°æ–¹ã€‚æœåŠ¡ç½‘æ ¼æ²¡æœ‰æœ€ç»ˆç”¨æˆ·å’Œèµ„æºä¹‹é—´å…³ç³»çš„æ¨¡å‹ï¼Œå› æ­¤ä¸é€‚åˆç¼–å†™æœ‰å…³å®ƒçš„ç­–ç•¥ã€‚NIST çš„æŒ‡å—æ˜¯é€šè¿‡ OIDC ä¸ç°æœ‰ç³»ç»Ÿé›†æˆæˆ–åˆ©ç”¨ä¸“ç”¨æˆæƒåŸºç¡€è®¾æ–½ â€”â€” ä¾‹å¦‚ï¼ŒNIST çš„ä¸‹ä¸€ä»£è®¿é—®æ§åˆ¶ (NGAC) å’Œ Open Policy Agentã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä»¥åª’ä½“æµæœåŠ¡åŠå…¶æ’­æ”¾åˆ—è¡¨ä¸ºä¾‹ã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦æˆæƒæœ€ç»ˆç”¨æˆ·è®¿é—®æ•°ç™¾ä¸‡åˆ°æ•°åäº¿ä¸ªæ’­æ”¾åˆ—è¡¨ã€‚å°±åƒ OPA ä¸æ˜¯ç‰¹åˆ«é€‚åˆæœåŠ¡åˆ°æœåŠ¡çš„æˆæƒä¸€æ ·ï¼ŒIstio æˆæƒç­–ç•¥ä¹Ÿä¸é€‚åˆæœ€ç»ˆç”¨æˆ·åˆ°èµ„æºçš„æˆæƒï¼›ä½†æ˜¯ï¼ŒOPA é€‚åˆã€‚&lt;/p&gt;
&lt;p&gt;OPA ä¹Ÿéå¸¸é€‚åˆè¶…è¶Š NIST ZTA ç­–ç•¥æ¡†æ¶çš„æ­¥éª¤ï¼š&lt;strong&gt;å°†ç‰¹å®šäºä¸šåŠ¡çš„ç­–ç•¥åº”ç”¨äºè¯·æ±‚ã€‚&lt;/strong&gt; åœ¨æˆ‘ä»¬å®Œæˆé›¶ä¿¡ä»»çš„äº”é¡¹ç­–ç•¥æ£€æŸ¥ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å§”æ‰˜ OPA ä½œä¸ºè§„åˆ™å¼•æ“æ¥æ‰§è¡Œä¸šåŠ¡ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬å°†å¯¹æ­¤å‘è¡¨æ›´å¤šçœ‹æ³•ï¼Œå°¤å…¶æ˜¯åœ¨ SP 800-207A è¿›å…¥èµ·è‰è¿‡ç¨‹æ—¶ã€‚ä½†æ˜¯ï¼Œä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨ Cloud Native Security Con ä¸Šçš„è°ˆè¯å½•éŸ³å¯¹è¿™äº›é—®é¢˜è¿›è¡Œäº†æ›´æ·±å…¥çš„è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=s2lIaFhkA8c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ZTA åŸºäºèº«ä»½çš„åˆ†å‰² â€”â€”Zack Butcherã€Tetrate å’Œ Ramaswamy Chandramouliï¼ŒNIST&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=YdcVALVwwY4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èµåŠ©ä¸»é¢˜æ¼”è®²ï¼šä» Google åˆ° NIST â€” äº‘åŸç”Ÿå®‰å…¨çš„æœªæ¥ â€” Zack Butcherï¼ŒTetrate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Tetrate å¼€æºé¡¹ç›® Wazero ç®€ä»‹</title>
      <link>https://cloudnativecn.com/blog/introducing-wazero-from-tetrate/</link>
      <pubDate>Mon, 20 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/introducing-wazero-from-tetrate/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://tetrate.io/blog/introducing-wazero-from-tetrate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate åšå®¢&lt;/a&gt;ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»äº† wazeroï¼Œä¸€ä¸ªç”± Tetrate å¼€å‘çš„ç”¨ Go è¯­è¨€ç¼–å†™çš„ WebAssembly è¿è¡Œæ—¶ã€‚wazero å¯ä»¥è®©å¼€å‘è€…ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ä»£ç ï¼Œå¹¶åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œã€‚wazero æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¯ Goï¼Œæ— ä¾èµ–ï¼Œæ”¯æŒè·¨å¹³å°å’Œè·¨æ¶æ„&lt;/li&gt;
&lt;li&gt;éµå¾ª WebAssembly æ ¸å¿ƒè§„èŒƒ 1.0 å’Œ 2.0&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Go çš„ç‰¹æ€§ï¼Œå¦‚å¹¶å‘å®‰å…¨å’Œä¸Šä¸‹æ–‡ä¼ é€’&lt;/li&gt;
&lt;li&gt;æä¾›äº†ä¸°å¯Œçš„ç¼–ç¨‹æ¥å£å’Œå‘½ä»¤è¡Œå·¥å…·&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¼˜å¼‚ï¼Œè¶…è¿‡äº†å…¶ä»–åŒç±»è¿è¡Œæ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;WebAssemblyï¼Œä¹Ÿç§°ä¸º Wasmï¼Œæ˜¯ä¸€ç§ç¼–è¯‘ç”¨ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚ C æˆ– Rustï¼‰ç¼–å†™çš„ä»£ç å¹¶åœ¨ä¸åŒçš„è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ Web æµè§ˆå™¨æˆ–å¾®æœåŠ¡ï¼‰ä¸Šè¿è¡Œå®ƒçš„æ–¹æ³•ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºç¼–å†™æ’ä»¶ã€æ‰©å±•ä»¥åŠåœ¨å®‰å…¨æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œä»»æ„ç”¨æˆ·å®šä¹‰ä»£ç çš„ç»ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly ç»å¸¸è¢«è¯¯è®¤ä¸ºæ˜¯ä¸€ç§ä»…é™æµè§ˆå™¨çš„æŠ€æœ¯ï¼Œè€Œå®é™…ä¸Š Wasm æ˜¯ä¸€ç§è·¨å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ç”±ä»»ä½• WebAssembly è¿è¡Œæ—¶æ‰§è¡Œã€‚ä»å†å²ä¸Šçœ‹ï¼ŒGo ç¨‹åºå‘˜æ²¡æœ‰å¤ªå¤šå¥½çš„é€‰æ‹©ï¼Œä½†è¿™ç§æƒ…å†µå·²ç»æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† &lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt;ï¼Œå®ƒåœ¨ç”¨ Go ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„åŸºç¡€è®¾æ–½ä¸­å¾ˆé‡è¦ï¼Œå¹¶æ¶µç›–äº†å…¶æœ€å¼•äººæ³¨ç›®çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-go-ä¸­è¿è¡Œ-webassembly-çš„ç®€å²&#34;&gt;åœ¨ Go ä¸­è¿è¡Œ WebAssembly çš„ç®€å²&lt;/h2&gt;
&lt;p&gt;æœ€åˆï¼Œå¤§å¤šæ•° WebAssembly è¿è¡Œæ—¶æ˜¯ç”¨ C/C++ å’Œ Rust ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ã€‚è®¸å¤šäº‘åŸç”Ÿé¡¹ç›®ï¼ŒåŒ…æ‹¬ Dockerã€Istio å’Œ Kubernetes éƒ½æ˜¯ç”¨ Go ç¼–å†™çš„ã€‚ä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶å¯é€šè¿‡ç§°ä¸º CGO çš„æœºåˆ¶è·å¾—ã€‚ç„¶è€Œï¼ŒCGO ä¸æ˜¯ Goï¼Œé€šè¿‡é€‰æ‹© CGOï¼Œæ‚¨å°±æ”¾å¼ƒäº† Go è¿è¡Œæ—¶çš„è®¸å¤šæ€æ‰‹çº§åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹å¹¿æ³›å¹³å°äº¤å‰ç¼–è¯‘çš„ä¸€æµæ”¯æŒã€‚å›´ç»• CGO çš„å¤æ‚æ€§ï¼Œå°¤å…¶æ˜¯éšå«çš„æœ¬æœºåº“ï¼Œæ˜¯å°† wasm æ‰©å±•åˆ° Kubernetes è°ƒåº¦ç¨‹åºçš„è¯·æ±‚è¢«æ‹’ç»çš„åŸå› ã€‚æ€»ä¹‹ï¼ŒGo ç¼ºä¹åŸç”Ÿè¿è¡Œæ—¶å»¶è¿Ÿæˆ–é™åˆ¶äº†å°† WebAssembly å¼•å…¥æ ¸å¿ƒåŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æ˜¯ä¸º-go-å¼€å‘äººå‘˜ç¼–å†™çš„&#34;&gt;wazero æ˜¯ä¸º Go å¼€å‘äººå‘˜ç¼–å†™çš„&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt; æ˜¯å”¯ä¸€ç”¨ Go ç¼–å†™çš„&lt;strong&gt;é›¶ä¾èµ– WebAssembly è¿è¡Œæ—¶&lt;/strong&gt;ã€‚è¿™ä¸ªå¼€æºé¡¹ç›®æœ€åˆæ˜¯ç”± &lt;strong&gt;Takeshi Yoneda&lt;/strong&gt; ä½œä¸ºçˆ±å¥½å¼€å§‹çš„ã€‚2021 å¹´åº•ï¼ŒTetrate è®¤è¯†åˆ°å…¶æˆ˜ç•¥ä»·å€¼å¹¶æŠ•å…¥äº†å‡ åå…¨èŒå‘˜å·¥ï¼Œä»¥æœŸæœ‰æœä¸€æ—¥å‘å¸ƒ 1.0 ç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œï¼Œè¯¥å›¢é˜Ÿå­œå­œä¸å€¦åœ°å·¥ä½œä»¥æ”¯æŒå¤šç§å¹³å°ã€æ¶æ„å’Œç¼–ç¨‹æ¥å£ã€‚æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ wazero 1.0 å‘å¸ƒï¼&lt;/p&gt;
&lt;p&gt;Wazero æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨ã€ç¬¦åˆæ ‡å‡†ã€ä¸°å¯Œä¸”ç»è¿‡å®æˆ˜æ£€éªŒçš„ WebAssembly è¿è¡Œæ—¶ï¼Œå®ƒä¸ Go è¿è¡Œæ—¶çš„æœ€ä½³ç‰¹æ€§æ— ç¼é›†æˆï¼Œä¾‹å¦‚å®‰å…¨å¹¶å‘å’Œä¸Šä¸‹æ–‡ä¼ æ’­ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªé¢å‘ Go å¼€å‘äººå‘˜çš„ç¼–ç¨‹æ¥å£å’Œä¸€ä¸ªé¢å‘é‚£äº›åªæƒ³è¿è¡Œ Wasm çš„äººçš„ CLIã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„&#34;&gt;Wazero æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½æƒ³çŸ¥é“ wazero çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Œè€ƒè™‘åˆ° Go ä¸å…¶ä»–è¯­è¨€å…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ã€‚è¿™å…è®¸æ‚¨é€šè¿‡ CGO é€‰æ‹©å¤šä¸ªä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶ã€‚ä»¥ä¸‹æ˜¯è€ƒè™‘ Wazero çš„äº”ä¸ªç†ç”±ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³ Go æ”¯æŒ&lt;/strong&gt;ã€‚Wazero æ˜¯çº¯ Go è¯­è¨€ï¼Œä¸å¼•å…¥ä»»ä½•ä¾èµ–ï¼Œä½†æ”¯æŒæ›´è¿›ä¸€æ­¥ã€‚Wazero åŒ…æ‹¬æƒ¯ç”¨çš„ Go å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šä¸‹æ–‡é›†æˆã€‚è¿™å…è®¸æ‚¨é‡ç”¨ä¼ å…¥çš„æˆªæ­¢æ—¥æœŸï¼Œä¾‹å¦‚æ¥è‡ª gRPC è¯·æ±‚ä»¥é™åˆ¶åœ¨ wasm å‡½æ•°ä¸­èŠ±è´¹çš„æ—¶é—´ã€‚è¿è¡Œæ—¶æ˜¯ä¸“é—¨ä¸º Go è®¾è®¡çš„ï¼Œå› æ­¤åœ¨ Go å¼€å‘äººå‘˜å…³æ³¨çš„é—®é¢˜ï¼ˆä¾‹å¦‚ goroutine security /wazeroï¼‰æ–¹é¢&lt;a href=&#34;https://pkg.go.dev/github.com/tetratelabs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®°å½•å¾ˆå¥½&lt;/a&gt;ã€‚æ¯”å¦‚å¾ˆå¤šåº“å¯ä»¥åŒæ—¶ä½¿ç”¨ wazero è€Œä¸äº’ç›¸å†²çªï¼Œè¿™äº›éƒ½æ˜¯åœ¨ Go ä¸­æµ‹è¯•è¿‡çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;API å…¼å®¹æ€§&lt;/strong&gt;ã€‚WebAssembly è¿è¡Œæ—¶åµŒå…¥åœ¨é¡¹ç›®çš„åº•å±‚ä½ç½®ï¼Œå› æ­¤å…¼å®¹æ€§çš„å˜åŒ–å¯èƒ½ä¼šå¯¼è‡´ç‰ˆæœ¬é”å®šï¼Œå°¤å…¶æ˜¯åœ¨ä¸­é—´ä»¶ä¸­ã€‚Wazero æ˜¯å”¯ä¸€å·²çŸ¥çš„æä¾›è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„è¿è¡Œæ—¶ã€‚å‡½æ•°å¯ä»¥åˆ¶ä½œæˆ 1.1 ç‰ˆæœ¬ï¼Œå®ƒä»¬ä¸ä¼šç ´å 1.0 ç”¨æˆ·ã€‚Wazero æ‰¿è¯ºä¿æŒé›¶ä¾èµ–å¹¶ä¸ Go çš„å‰ä¸¤ä¸ªç‰ˆæœ¬ä¸€èµ·å·¥ä½œã€‚æ€»ä¹‹ï¼Œwazero çš„å…¼å®¹æ€§æ–¹æ³•æ˜¯æ¨¡ä»¿ Go æœ¬èº«ï¼Œä¸ºå…¶ç”¨æˆ·å¼•å…¥æœ€å°‘çš„ç»´æŠ¤é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³å°å…¼å®¹æ€§&lt;/strong&gt;ã€‚wazero å®Œå…¨æ”¯æŒ amd64ã€arm64ã€FreeBSDã€Linuxã€macOS å’Œ Windows åœ¨æœ€æ–°ä¸‰ä¸ªç‰ˆæœ¬çš„ Go ä¸Šçš„ä»»æ„ç»„åˆã€‚å®ƒè¿˜é€šè¿‡å…¶â€œè§£é‡Šå™¨è¿è¡Œæ—¶â€å°†å¯¹ Go çš„æ”¯æŒæ‰©å±•åˆ°å…¶ä»–å¹³å°ï¼Œå®ƒçš„æ‰§è¡Œé€Ÿåº¦æ¯”æœ¬æœºâ€œç¼–è¯‘å™¨è¿è¡Œæ—¶â€æ…¢ã€‚wazero åœ¨ Windows ä¸Šéå¸¸æ£’ï¼Œå› ä¸ºå®ƒä¸ä»…æ˜¯ä¸€æµçš„å¹³å°ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜åœ¨å‘å¸ƒæ—¶ç”Ÿæˆç­¾åçš„ MSI å®‰è£…ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åšå¦‚ç£çŸ³çš„æµ‹è¯•æ–¹æ³•&lt;/strong&gt;ã€‚Wazero é€šè¿‡å¤šé¡¹è§„èŒƒæµ‹è¯•æ¥æµ‹è¯•å¹³å°æ”¯æŒï¼ŒåŒ…æ‹¬ WebAssembly æ ¸å¿ƒè§„èŒƒçš„ 1.0 å’Œ 2.0 è‰æ¡ˆç‰ˆæœ¬ä»¥åŠç”¨äºæµ‹è¯• I/O åŠŸèƒ½çš„ WASI æµ‹è¯•å¥—ä»¶ã€‚æˆ‘ä»¬è¿˜è¿è¡Œç”± Zig å’Œ TinyGo ç¼–å†™çš„æ ‡å‡†åº“æµ‹è¯•ã€‚æœ€åï¼Œæˆ‘ä»¬è¿è¡ŒåŸºå‡†æµ‹è¯•å¹¶å¯¹æ¯ä¸ªæ›´æ”¹è¿›è¡Œâ€œæ¨¡ç³Šæµ‹è¯•â€ã€‚æ‰€æœ‰è¿™äº›éƒ½ä½¿å¾— wazero çš„é”™è¯¯æ˜“äºè¯†åˆ«å’Œä¿®å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ´»è·ƒçš„ç»ˆç«¯ç”¨æˆ·ç¤¾åŒºã€‚&lt;/strong&gt; wazero çš„ç¤¾åŒºåŒ…æ‹¬è®¸å¤šå…¬å¸çš„æå¼ºçš„å¼€å‘äººå‘˜ã€‚æˆ‘ä»¬æ¶‰åŠä¸€äº›ä¸ Go æ”¯æŒ WebAssembly æœ‰å…³çš„æ–¹é¢ï¼Œå¹¶ä¸º Go å’Œ TinyGo ç¼–è¯‘å™¨åšå‡ºè´¡çŒ®ã€‚è¯·æŸ¥çœ‹æˆ‘ä»¬çš„&lt;a href=&#34;https://wazero.io/community/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¤¾åŒº&lt;/a&gt;å’Œ&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨æˆ·&lt;/a&gt;é¡µé¢ï¼Œäº†è§£æ›´å¤šå…³äºæˆ‘ä»¬ä»¥åŠæ‚¨å¦‚ä½•èå…¥å…¶ä¸­çš„ä¿¡æ¯ï¼&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å°†-wazero-åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&#34;&gt;å°† wazero åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&lt;/h2&gt;
&lt;p&gt;Wazero æ˜¾ç„¶ä¹Ÿæ˜¯ä¸€ä¸ª Go åº“ï¼Œå…¶ä¸»è¦ç›®æ ‡æ˜¯è®©æ‚¨ä¸è¿è¡Œæ—¶ç¯å¢ƒæ— ç¼é›†æˆï¼Œå¹¶ä½¿ç”¨ WebAssembly æ‰©å±•æ‚¨çš„ Go åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³è¿è¡Œ&lt;a href=&#34;https://en.wikipedia.org/wiki/Cowsay&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»å…¸çš„ Unix ç¨‹åº cowsay&lt;/a&gt;ï¼ˆæœ€åˆæ˜¯ç”¨ Perl ç¼–å†™çš„ï¼‰ã€‚é‚£ä¹ˆæ‚¨å¯ä»¥è¾“å…¥ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;// Download the executable from:
// https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
//go:embed &amp;#34;cowsay.wasm&amp;#34;
var cowsay []byte

func main() {
	ctx := context.Background()
	r := wazero.NewRuntime(ctx)
	wasi_snapshot_preview1.MustInstantiate(ctx, r)
	r.InstantiateWithConfig(ctx, cowsay,
		wazero.NewModuleConfig().
			WithArgs(&amp;#34;cowsay&amp;#34;, // first arg is usually the executable name
				&amp;#34;wazero is awesome!&amp;#34;).
			WithStdout(os.Stdout))
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œå®ƒä¼šæ˜¾ç¤ºï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ä½¿ç”¨-wazero-cli-å…¥é—¨&#34;&gt;ä½¿ç”¨ wazero CLI å…¥é—¨&lt;/h2&gt;
&lt;p&gt;è¯¥é¡¹ç›®ç°åœ¨åŒ…æ‹¬ä¸€ä¸ª CLIï¼Œç”¨äºè¿è¡Œ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä»¬å‘ç°è®¸å¤šç”¨æˆ·æ— è®ºä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€éƒ½é€‰æ‹©å®ƒï¼Œå› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨è¿™ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤ä¸‹è½½å’Œå®‰è£… wazero CLIï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl https://wazero.io/install.sh | sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…åœ¨ Windows ä¸Šï¼Œæ‚¨å¯ä»¥&lt;a href=&#34;https://github.com/tetratelabs/wazero/releases/download/v1.0.0-rc.2/wazero_1.0.0-rc.2_windows_amd64.msi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½æœ‰ MSI ç­¾åçš„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œæ‚¨çš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ ./bin/wazero run someApp.wasm
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³åœ¨ CLI ä¸Šè¿è¡Œ cowsayï¼Œé‚£ä¹ˆåªéœ€é”®å…¥&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -LO https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
$ wazero run cowsay.wasm wazero is awesome!
 ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…ï¼Œä¹Ÿè®¸ä½ æ›´æƒ³ç© 1977 å¹´çš„ Infocom æ–‡æœ¬å†’é™©æ¸¸æˆ Zorkã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥ä» &lt;a href=&#34;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&lt;/a&gt; è·å–ä¸€ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -L https://github.com/evacchi/zork-1/releases/download/v0.0.1/zork-wasm-wasi.tgz | tar xzf -
$ wazero run -mount=.:/ zork.wasm
Welcome to Dungeon.			This version created 11-MAR-91.
You are in an open field west of a big white house with a boarded
front door.
There is a small mailbox here.
&amp;gt;open mailbox
Opening the mailbox reveals:
  A leaflet.
&amp;gt;read leaflet
Taken.
		    Welcome to Dungeon!

   Dungeon is a game of adventure, danger, and low cunning.  In it
you will explore some of the most amazing territory ever seen by mortal
man.  Hardened adventurers have run screaming from the terrors contained
within.

   In Dungeon, the intrepid explorer delves into the forgotten secrets
of a lost labyrinth deep in the bowels of the earth, searching for
vast treasures long hidden from prying eyes, treasures guarded by
fearsome monsters and diabolical traps!

   No DECsystem should be without one!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°½æƒ…ç©å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„è¯&#34;&gt;æœ€åçš„è¯&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé‡å¤§å‘å¸ƒï¼Œä½†æˆ‘ä»¬æ‰åˆšåˆšå¼€å§‹ï¼&lt;strong&gt;æœ‰è®¸å¤šå€¼å¾—æœŸå¾…çš„äº‹æƒ…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly è§„èŒƒæ­£åœ¨ä¸æ–­æ›´æ–°ï¼Œæˆ‘ä»¬å°†å¯†åˆ‡å…³æ³¨å®ƒï¼šä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/tail-call/blob/main/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tail call proposal&lt;/a&gt; åˆšåˆšè¿›å…¥ç¬¬ 4 é˜¶æ®µï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/gc/blob/master/proposals/gc/Overview.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GC proposal&lt;/a&gt; åˆ™æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Javaï¼‰çš„æ”¯æŒè€…ï¼Œæœ€è¿‘è¿›å…¥äº†ç¬¬ 3 é˜¶æ®µã€‚Wazero å°†ç»§ç»­é€šè¿‡æ‰€æœ‰æµ‹è¯•ï¼Œéšç€ WebAssembly çš„å‘å±•è€Œå‘å±•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¸Œæœ›ä½œä¸ºæ‚¨ WebAssembly è¿è¡Œæ—¶çš„æˆ˜ç•¥æ€§é€‰æ‹©ã€‚æ‚¨å¯ä»¥æœŸå¾…æŒç»­è‡´åŠ›äºæ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å’Œå¯æ‰©å±•æ€§ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æˆ‘ä»¬å³å°†æ¨å‡ºçš„ä½çº§æ–‡ä»¶ç³»ç»Ÿæ’ä»¶ã€‚å®ƒæ”¯æŒæ¯” Go çš„ fs.FS æ›´å¤šçš„åŠŸèƒ½ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚åˆ›å»ºç›®å½•å’Œæ–‡ä»¶ã€‚è¯¥è®¾è®¡æ”¯æŒè‡ªå®šä¹‰å®¡è®¡å’Œè®¿é—®æ§åˆ¶ï¼Œå¹¶å¯ç”¨äºç¬¬ä¸‰æ–¹ä¸»æœºå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœæ‚¨åœ¨ 3 æœˆ 23 æ—¥å’Œ 24 æ—¥å‚åŠ å·´å¡ç½—é‚£çš„ Wasm I/O æ´»åŠ¨ï¼Œå°±æœ‰æœºä¼šè®¤è¯†æˆ‘ä»¬å›¢é˜Ÿçš„ä¸€éƒ¨åˆ†ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨åœ¨ä¼šè®®ç»“æŸåç•™åœ¨é‚£é‡Œï¼Œæˆ–è€…æ‚¨åªæ˜¯åœ¨é‚£ä¸ªæ™šä¸Šåœ¨åŸå¸‚é‡Œï¼Œ&lt;strong&gt;åœ¨ 3 æœˆ 24 æ—¥æ˜ŸæœŸäº”&lt;/strong&gt;ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆé«˜å…´&lt;a href=&#34;https://www.eventbrite.com/e/wazero-10-launch-party-tickets-585204150367&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‚€è¯·æ‚¨å‚åŠ  wazero 1.0 è‡ªå·±çš„å®˜æ–¹å‘å¸ƒæ´¾å¯¹&lt;/a&gt;ã€‚æˆ‘ä»¬å°†æä¾›å°åƒï¼Œé¥®æ–™å’Œè®¸å¤šç¤¾åŒºè´¡çŒ®è€…ï¼Œä»–ä»¬å°†å±•ç¤ºä»–ä»¬å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬æ‰€é’Ÿçˆ±çš„ WebAssembly è¿è¡Œæ—¶ï¼ä¸€ä½å¹¸è¿çš„å‚ä¼šè€…å°†æœ‰æœºä¼šæŒ‰ä¸‹ 1.0 çš„å‘å¸ƒæŒ‰é’®ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆå…´å¥‹åœ°çœ‹åˆ°æ‚¨å°†å¦‚ä½•ä½¿ç”¨ Wazero æ„å»ºé¡¹ç›®ã€‚&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥æˆ‘ä»¬ä¸æ–­å¢é•¿çš„ç¤¾åŒºç”¨æˆ·åˆ—è¡¨&lt;/a&gt;ï¼Œå¹¶è®©æˆ‘ä»¬çŸ¥é“æ‚¨æ­£åœ¨åˆ›é€ ä»€ä¹ˆï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼å®‰å…¨æ€§ä¼˜åŒ–æœ€ä½³å®è·µ</title>
      <link>https://cloudnativecn.com/blog/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/</link>
      <pubDate>Wed, 01 Feb 2023 11:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/</guid>
      <description>&lt;p&gt;è¿™æ˜¯ &lt;a href=&#34;https://tetrate.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—æ–‡ç« &lt;/a&gt; ä¸­çš„ç¬¬ä¸‰ç¯‡ï¼Œæ‘˜è‡ª Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å³å°†å‡ºç‰ˆçš„æ–°ä¹¦ Istio in Productionã€‚&lt;/p&gt;
&lt;p&gt;Istio å°±åƒä¸€ç»„ä¹é«˜ç§¯æœ¨ï¼šå®ƒå…·æœ‰è®¸å¤šåŠŸèƒ½ï¼Œå¯ä»¥æŒ‰ç…§æ‚¨æƒ³è¦çš„ä»»ä½•æ–¹å¼è¿›è¡Œç»„è£…ã€‚å‡ºç°çš„ç»“æ„å–å†³äºæ‚¨å¦‚ä½•ç»„è£…é›¶ä»¶ã€‚åœ¨ &lt;a href=&#34;../service-mesh-deployment-best-practices-for-security-and-high-availability/&#34;&gt;ä¸Šä¸€ç¯‡ä¸­&lt;/a&gt;ï¼Œæˆ‘ä»¬æè¿°äº†ä¸€ç§è¿è¡Œæ—¶æ‹“æ‰‘ç»“æ„ï¼Œç”¨äºæ„å»ºå¥å£®ã€æœ‰å¼¹æ€§ä¸”å¯é çš„åŸºç¡€æ¶æ„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æè¿°ä¸€ç»„ç½‘æ ¼é…ç½®ï¼Œä»¥å¸®åŠ©åœ¨è¿è¡Œæ—¶å®ç°ç¨³å¥æ€§ã€å¼¹æ€§ã€å¯é æ€§å’Œå®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Istio åœ¨å…¶æ‰€è°“çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-root_namespace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ¹å‘½åç©ºé—´&lt;/a&gt; ä¸­æ”¯æŒå…¨å±€é»˜è®¤é…ç½® â€”â€” é»˜è®¤åœ¨ &lt;code&gt;istio-system&lt;/code&gt;ã€‚åœ¨æ ¹å‘½åç©ºé—´ä¸­å‘å¸ƒçš„é…ç½®é»˜è®¤é€‚ç”¨äºæ‰€æœ‰æœåŠ¡ï¼Œä½†åœ¨æœ¬åœ°å‘½åç©ºé—´ä¸­å‘å¸ƒçš„ä»»ä½•é…ç½®éƒ½ä¼šè¦†ç›–å®ƒã€‚å› æ­¤ï¼Œä¸€äº›é…ç½®åº”è¯¥åœ¨æ ¹å‘½åç©ºé—´ä¸­å‘å¸ƒï¼Œå¹¶ä¸”ä¸å…è®¸åœ¨å…¶ä»–ä»»ä½•åœ°æ–¹å‘å¸ƒï¼ˆä¾‹å¦‚ç”¨äºåœ¨ä¼ è¾“ä¸­å¼ºåˆ¶åŠ å¯†çš„ PeerAuthentication ç­–ç•¥ï¼‰ã€‚å…¶ä»–é…ç½®åº”è¯¥åœ¨æ¯ä¸ªæœåŠ¡è‡ªå·±çš„å‘½åç©ºé—´ä¸­ç¼–å†™ï¼ˆä¾‹å¦‚ VirtualService æ§åˆ¶å®ƒçš„å¼¹æ€§è®¾ç½®ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°çš„æœ€æˆåŠŸçš„ç½‘æ ¼é‡‡ç”¨å°†ç½‘æ ¼æœ¬èº«éšè—åœ¨å¦ä¸€ä¸ªç•Œé¢åé¢ï¼šä¾‹å¦‚ Helm æ¨¡æ¿ã€Terraform æˆ–æ›´é«˜çº§çš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge (TSB)&lt;/a&gt;ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯åªå…¬å¼€åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜åº”è¯¥é…ç½®çš„ä¸€å°éƒ¨åˆ†ç½‘æ ¼åŠŸèƒ½ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨ä»–ä»¬ç†è§£çš„è¯­è¨€ï¼ˆä¾‹å¦‚ï¼ŒTSB å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://docs.tetrate.io/service-bridge/1.6.x/en-us/quickstart/apps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¸¦æ³¨é‡Šçš„ OpenAPI è§„èŒƒ&lt;/a&gt; è¿›è¡Œé…ç½®ï¼‰ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬é€šå¸¸åªå‘åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å…¬å¼€æµé‡è®¾ç½®å’Œæˆæƒã€‚èº«ä»½éªŒè¯å’Œé¥æµ‹ç”±å„è‡ªçš„å›¢é˜Ÿæˆ–ä»£è¡¨ä»–ä»¬çš„å¹³å°å›¢é˜Ÿé›†ä¸­æ§åˆ¶ã€‚&lt;a href=&#34;https://tetrate.io/blog/nist-standards-for-zero-trust-the-sp-800-204-series/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP800-204 ç³»åˆ—&lt;/a&gt;ï¼Œå°¤å…¶æ˜¯ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204a/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204A&lt;/a&gt; å’Œ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204B&lt;/a&gt;ã€‚Istio é¡¹ç›®ç«™ç‚¹ä¹Ÿæœ‰ä¸€ç»„ &lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœ€ä½³å®è·µ&lt;/a&gt;ï¼Œä¹Ÿå€¼å¾—æ”¶è—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å‘½åçº¦å®š&#34;&gt;æœåŠ¡ç½‘æ ¼å‘½åçº¦å®š&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šä¸º Istio èµ„æºå¼€å‘å’Œç»´æŠ¤ä¸€è‡´çš„å‘½åæ–¹æ¡ˆï¼Œæœ€å¥½åŸºäºå®ƒä»¬é…ç½®çš„æœåŠ¡æˆ–ä¸»æœºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šä¸ºè·¨é›†ç¾¤çš„å›¢é˜Ÿä¿æŒä¸€è‡´çš„åç§°ã€‚å‘½åç©ºé—´åº”è¯¥ç”±ä¸€ä¸ªå›¢é˜Ÿæ‹¥æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;Istio èµ„æºåº”è¯¥æ ¹æ®å®ƒä»¬é…ç½®çš„æœåŠ¡æˆ–ä¸»æœºæ¥å‘½åï¼š&lt;code&gt;ServiceEntry&lt;/code&gt; æ·»åŠ  &lt;code&gt;api.example.com&lt;/code&gt; åˆ°ç½‘æ ¼çš„åº”è¯¥å‘½åä¸º &lt;code&gt;external-api-example-com&lt;/code&gt;ï¼›æœåŠ¡çš„ &lt;code&gt;DestinationRule&lt;/code&gt;ã€&lt;code&gt;VirtualService&lt;/code&gt;ã€&lt;code&gt;PeerAuthentication&lt;/code&gt; å’Œ &lt;code&gt;Authorization&lt;/code&gt; ç­–ç•¥ä¹Ÿéƒ½åº”è¯¥æœ‰ç›¸åŒçš„åç§°ã€‚PCI å‘½åç©ºé—´ä¸­çš„å†…éƒ¨æœåŠ¡ Paymentsï¼ˆåº”ç”¨ç¨‹åºä»£ç ä¸­çš„ hostname &lt;code&gt;payments.pci&lt;/code&gt;ï¼‰åº”è¯¥è¢«å‘½åä¸º &lt;code&gt;payment-pci&lt;/code&gt;ï¼Œå…¶æ‰€æœ‰çš„ç½‘æ ¼é…ç½®åç§°ä¹Ÿåº”è¯¥åŒ¹é…ã€‚è¿™äº›å‘½åæ–¹æ¡ˆå¹¶ä¸æ˜¯ç¡¬æ€§è§„å®šï¼Œä½†ä½ åº”è¯¥åœ¨ä½ çš„ç»„ç»‡å†…å»ºç«‹å¹¶åšæŒä¸€ä¸ªä¸€è‡´çš„æƒ¯ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›èµ„æºåº”è¯¥å…¨éƒ¨å‘å¸ƒåœ¨å®ƒä»¬é…ç½®çš„æœåŠ¡çš„å‘½åç©ºé—´ä¸­ï¼Œæˆ–è€…å‘å¸ƒåœ¨ &lt;code&gt;istio-system&lt;/code&gt; å‘½åç©ºé—´ä¸­ä»¥è¿›è¡Œç½‘æ ¼èŒƒå›´çš„é…ç½®ã€‚å¤–éƒ¨æœåŠ¡é€šå¸¸å‘å¸ƒåˆ° &lt;code&gt;istio-system&lt;/code&gt; ä¸­å¹¶ç”±ä¸­å¿ƒå›¢é˜Ÿï¼ˆå¹³å°æˆ–å®‰å…¨å›¢é˜Ÿï¼‰ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å»ºè®®è·¨é›†ç¾¤çš„å›¢é˜Ÿä½¿ç”¨ä¸€è‡´çš„åç§°ï¼šæ— è®ºé›†ç¾¤ç§Ÿæˆ·æ¨¡å‹å¦‚ä½•ï¼Œå‘½åç©ºé—´éƒ½åº”ç”±å•ä¸ªå›¢é˜Ÿæ‹¥æœ‰ï¼ˆè¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å…¨å±€è®¾ç½®&#34;&gt;æœåŠ¡ç½‘æ ¼å…¨å±€è®¾ç½®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;é…ç½®å¯è§æ€§&lt;/strong&gt;ã€‚Istio æœ‰ä¸€ä¸ªé…ç½®å¯è§æ€§çš„æƒ³æ³•ï¼šé…ç½®å¯ä»¥é»˜è®¤åº”ç”¨äºæ•´ä¸ªé›†ç¾¤ï¼Œæˆ–è€…å®ƒå¯ä»¥åªåº”ç”¨äºæœ¬åœ°å‘½åç©ºé—´ï¼Œç”šè‡³å¯ä»¥åªåº”ç”¨äºå•ä¸ªæœåŠ¡ï¼ˆé€‰æ‹©å¯¹æ•´ä¸ªé›†ç¾¤å¯è§ï¼Œæˆ–è€…åªæ˜¯ç‰¹å®šçš„å‘½åç©ºé—´ï¼‰ã€‚ä¸ºäº†æ€§èƒ½å’Œå®‰å…¨ï¼Œæ‚¨åº”è¯¥å°†è¯¥å­—æ®µé»˜è®¤ä¸º &lt;code&gt;exportTo&lt;/code&gt; æœ¬åœ°åç§°ç©ºé—´ï¼ˆâ€œ.â€ï¼‰ã€‚æ‚¨åº”è¯¥åœ¨å®‰è£…æ—¶ä¸º &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;Services&lt;/em&gt;&lt;/a&gt;ã€&lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_virtual_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;VirtualServices&lt;/em&gt;&lt;/a&gt; å’Œ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_destination_rule_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;DestinationRules&lt;/em&gt;&lt;/a&gt; è®¾ç½®è¿™ä¸ªé»˜è®¤å€¼ã€‚æŸ¥çœ‹ Istio çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¨å±€é…ç½®&lt;/a&gt; æ¥é…ç½®è¿™äº›é»˜è®¤å€¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;install.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IstioOperator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;controlplane&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# profile: default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meshConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultServiceExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# only the namespace the resource is published in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultVirtualServiceExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# equivalent, just different YAML syntax&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultDestinationRuleExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 1ï¼šé»˜è®¤å…¨å±€è®¾ç½®&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¯ä¸ªå‘½åç©ºé—´çš„ Sidecar èµ„æºé…ç½®&lt;/strong&gt;ã€‚Istio çš„ &lt;code&gt;Sidecar&lt;/code&gt; ï¼ˆAPIï¼‰èµ„æºæ§åˆ¶ Istio å°†å“ªäº›é…ç½®å‘é€åˆ°æ¯ä¸ªå‘½åç©ºé—´ä¸­çš„ Sidecarã€‚ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½å’Œæœ€ä½å¼€é”€ï¼Œæ‚¨åº”è¯¥ä¸ºæ¯ä¸ªå‘½åç©ºé—´ç®¡ç†ä¸€ä¸ªé…ç½®ï¼Œå¹¶ç®¡ç† egress éƒ¨åˆ†ä»¥ä»…åŒ…æ‹¬æœåŠ¡å¿…é¡»ä¸ä¹‹é€šä¿¡çš„ä¸»æœºã€‚è¿™å°†å¯¼è‡´ Istio å‘è¯¥å‘½åç©ºé—´ä¸­çš„ Envoy å®ä¾‹å‘é€æ›´å°‘çš„é…ç½®ï¼Œä»è€Œå‡å°‘å®ƒä»¬çš„å†…å­˜å’Œ CPU æ¶ˆè€—ã€‚ç»“åˆä»…æ³¨å†Œè¡¨å‡ºç«™æµé‡ç­–ç•¥ï¼ˆè§ä¸‹ä¸€æ¡ï¼‰ï¼ŒSidecar èµ„æºè¿˜å¯ä»¥å¸®åŠ©é™åˆ¶æ”»å‡»è€…é€šè¿‡ Envoy çš„è¡¨é¢åŒºåŸŸï¼Œå› ä¸ºä¸åœ¨ Sidecar çš„ egress éƒ¨åˆ†çš„ä¸»æœºå°†æ˜¯è¯¥ Envoy å®ä¾‹çš„ &amp;ldquo;å‡ºç«™æµé‡&amp;rdquo;ã€‚è¿™æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªè¶³å¤Ÿçš„å®‰å…¨ç­–ç•¥ï¼ˆè§ä¸‹é¢çš„å®‰å…¨éƒ¨åˆ†ï¼‰ï¼Œè€Œæ˜¯å¢åŠ äº†ä¸€ä¸ªæ”»å‡»è€…å¿…é¡»ç©¿è¶Šçš„é¢å¤–é˜²å¾¡å±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼–å†™æ˜ç¡®çš„å‡ºç«™ï¼ˆegressï¼‰æµé‡ç­–ç•¥&lt;/strong&gt;ã€‚Istio æä¾›äº†ä¸€äº›é€‰é¡¹æ¥é…ç½®å®ƒå¦‚ä½•å¤„ç†ç½‘æ ¼ä¸­çš„æœåŠ¡ï¼Œè¯¥æœåŠ¡è¯•å›¾ä¸ Istio æœªçŸ¥çš„ç«¯ç‚¹è¿›è¡Œé€šä¿¡ï¼š&lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-OutboundTrafficPolicy-Mode&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Outbound Traffic Policy&lt;/a&gt;ã€‚Istio å¯ä»¥å…è®¸æ‰€æœ‰æµé‡ï¼Œä¹Ÿå¯ä»¥å°†æµé‡é™åˆ¶åœ¨ç½‘æ ¼å·²çŸ¥çš„æœåŠ¡ä¸Šã€‚ä½ åº”è¯¥åœ¨å®‰è£…æ—¶é…ç½® Istioï¼Œåªå…è®¸è¿æ¥åˆ°æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡ã€‚æ­¤å¤–ï¼Œä½ åº”è¯¥å°†æ‰€æœ‰éœ€è¦ä¸ä¹‹é€šä¿¡çš„å¤–éƒ¨æœåŠ¡å»ºæ¨¡ä¸º Mesh ä¸­çš„ ServiceEntriesï¼ˆä¾‹å¦‚ï¼ŒSaaS æœåŠ¡çš„ DNS è§£æç­‰ï¼‰ï¼Œä½¿ç”¨ DestinationRules æ¥é…ç½®ä¸å®ƒä»¬é€šä¿¡çš„ TLSã€‚è¿™äº›å¤–éƒ¨æœåŠ¡åº”è¯¥ç”±å®‰å…¨å›¢é˜Ÿé›†ä¸­ç®¡ç†ï¼Œæˆ–è€…ç”±å¹³å°å›¢é˜Ÿä»£è¡¨ä»–ä»¬ç®¡ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿è¡Œæ—¶æµé‡ç®¡ç†é…ç½®&#34;&gt;è¿è¡Œæ—¶æµé‡ç®¡ç†é…ç½®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæœåŠ¡ä½¿ç”¨ä¸€è‡´çš„å…¨å±€åç§°ï¼Œå¹¶ä½¿ç”¨ Istio å°†å®ƒä»¬æ˜ å°„åˆ°æœ¬åœ°å®ä¾‹&lt;/strong&gt;ã€‚æ‚¨åº”è¯¥ä½¿ç”¨ä¸€è‡´çš„å…¨å±€åç§°æ¥è®¿é—®æœåŠ¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Istio å°†è¿™äº›å…¨å±€åç§°æ˜ å°„åˆ°æœ¬åœ°å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;payments.tetrate.internal&lt;/code&gt; å¯ä»¥è¢«æ‰€æœ‰å†…éƒ¨åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œè€Œ Istio å¯ä»¥ç”¨æ¥å°†è¯¥åç§°æ˜ å°„åˆ°æœåŠ¡å®ä¾‹ï¼Œä¾‹å¦‚â€œåœ¨ &lt;code&gt;us-east-2&lt;/code&gt; Kubernetes é›†ç¾¤ä¸­çš„ &lt;code&gt;payments.default.svc.cluster.local&lt;/code&gt; æœåŠ¡â€ã€‚è¿™ç§å…¨å±€å‘½åæ–¹æ¡ˆä½¿å¼€å‘äººå‘˜å¯ä»¥åƒ SaaS ä¸€æ ·è€ƒè™‘æ‰€æœ‰æœåŠ¡ï¼Œè€Œæ— éœ€ä»”ç»†è€ƒè™‘è¿è¡Œæ—¶æ‹“æ‰‘çš„ç»†èŠ‚ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°æ‰§è¡Œæ•…éšœè½¬ç§»ã€é‡‘ä¸é›€å’Œè·¨é›†ç¾¤è·¯ç”±ç­‰æ“ä½œï¼Œä½œä¸ºæ‚¨çš„ç½‘æ ¼ä½¿ç”¨æˆç†Ÿæˆ–ç»„ç»‡éœ€æ±‚æ¼”å˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœ¨æ ¹é…ç½®ä¸­å®šä¹‰ç²—ç•¥çš„é»˜è®¤å¼¹æ€§è®¾ç½®&lt;/strong&gt;ã€‚æ‚¨åº”è¯¥ä¸ºç½‘æ ¼ä¸­çš„æ‰€æœ‰æœåŠ¡å®šä¹‰ç²—ç•¥çš„è¶…æ—¶ã€é‡è¯•ã€ç†”æ–­å’Œå¼‚å¸¸å€¼æ£€æµ‹è®¾ç½®ã€‚æ‚¨å¯ä»¥åœ¨æ ¹é…ç½®å‘½åç©ºé—´ä¸­ä½¿ç”¨ &lt;code&gt;VirtualService&lt;/code&gt; æ¥å®ç°æ­¤ç›®çš„ã€‚å„ä¸ªå›¢é˜Ÿåº”åœ¨å…¶æœ¬åœ°å‘½åç©ºé—´ä¸­æŒ‡å®šè‡ªå·±çš„åç§°ä»¥è¦†ç›–é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºåº”ç”¨ç¨‹åºå›¢é˜Ÿæä¾›ç®€åŒ–çš„â€œä½ / ä¸­ / é«˜â€å¼¹æ€§è®¾ç½®&lt;/strong&gt;ã€‚å°†ç½‘æ ¼çš„åº•å±‚ API éšè—åœ¨æ›´é«˜çº§åˆ«æ¥å£åé¢çš„ç³»ç»Ÿä¸­ï¼Œä¸ºé…ç½®é»˜è®¤æ–­è·¯å’Œå¼‚å¸¸å€¼æ£€æµ‹è®¾ç½®çš„åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æä¾›ç®€åŒ–çš„â€œä½ / ä¸­ / é«˜â€æ—‹é’®å¾ˆæœ‰ä»·å€¼ï¼Œå› ä¸ºå¾ˆå¤šé¢†åŸŸå®¹æ˜“é…ç½®é”™è¯¯ï¼Œå¯¼è‡´è¯¥åº”ç”¨ç¨‹åºæ€§èƒ½ä¸ä½³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿è¡Œæ—¶å®‰å…¨é…ç½®&#34;&gt;è¿è¡Œæ—¶å®‰å…¨é…ç½®&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹å®‰å…¨å»ºè®®æ¥è‡ªæˆ‘ä»¬ä¸ºå¾®æœåŠ¡åº”ç”¨ç¨‹åºå»ºç«‹ç¾å›½å®‰å…¨æ ‡å‡†çš„å·¥ä½œï¼Œè¯¥æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰åœ¨ &lt;a href=&#34;https://tetrate.io/blog/nist-standards-for-zero-trust-the-sp-800-204-series/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204 ç³»åˆ—&lt;/a&gt; ä¸­å‘å¸ƒã€‚&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„ç»¼åˆæŒ‡å—&lt;/a&gt; ä¸­é˜…è¯» NIST é’ˆå¯¹å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å®‰å…¨å»ºè®®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€å°æ§åˆ¶&lt;/strong&gt;ã€‚è¿è¡Œæ—¶çš„é›¶ä¿¡ä»»è‡³å°‘éœ€è¦ä»¥ä¸‹äº”ä¸ªæ§åˆ¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ å¯†ä¼ è¾“ä¸­çš„æ‰€æœ‰å†…å®¹&lt;/strong&gt;ï¼šæä¾›æ¶ˆæ¯çœŸå®æ€§å’Œçªƒå¬ä¿æŠ¤ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204ï¼ŒÂ§MS-SS-4&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æœåŠ¡åˆ°æœåŠ¡çš„é€šä¿¡&lt;/strong&gt;ï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½åº”éªŒè¯ä¸ä¹‹é€šä¿¡çš„åº”ç”¨ç¨‹åºçš„èº«ä»½ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Aï¼ŒÂ§SM-DR16ï¼›SP 800-204Bï¼ŒÂ§APE-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆæƒæœåŠ¡åˆ°æœåŠ¡è®¿é—®&lt;/strong&gt;ï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½åº”ä½¿ç”¨å…¶è¿è¡Œæ—¶èº«ä»½æˆæƒä¸ä¹‹é€šä¿¡çš„åº”ç”¨ç¨‹åºï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§SAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æœ€ç»ˆç”¨æˆ·èº«ä»½&lt;/strong&gt;ï¼šæ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»åœ¨æœåŠ¡è°ƒç”¨å›¾ä¸­çš„æ¯ä¸ªè·ƒç‚¹è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§EAUN-SR-1ï¼ŒÂ§EUAZ-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆæƒæœ€ç»ˆç”¨æˆ·è®¿é—®èµ„æº&lt;/strong&gt;ï¼šå¯¹æ¯ç§èµ„æºçš„æ¯æ¬¡è®¿é—®éƒ½åº”è·å¾—æˆæƒï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨å‰é—¨è®¿é—®ä¸€æ¬¡ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§EAUZ-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Istio æä¾›ä¼ è¾“ä¸­çš„åŠ å¯†ï¼ˆæˆ‘ä»¬åœ¨ä¸Šé¢è®¨è®ºäº†å…¨å±€å¯ç”¨ï¼‰ï¼Œä»¥åŠå¯éªŒè¯çš„æœåŠ¡èº«ä»½ (&lt;a href=&#34;https://tetrate.io/blog/why-would-you-need-spire-for-authentication-with-istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt; ) å’ŒæœåŠ¡åˆ°æœåŠ¡çš„è®¿é—®æ§åˆ¶ (Istio &lt;code&gt;AuthorizationPolicy&lt;/code&gt;)ã€‚æ­¤å¤–ï¼Œå®ƒå¯ä»¥é…ç½®ä¸ºä»£è¡¨åº”ç”¨ç¨‹åºï¼ˆJWTã€OIDC ä»¤ç‰Œï¼‰éªŒè¯æŸäº›å½¢å¼çš„æœ€ç»ˆç”¨æˆ·èº«ä»½ï¼Œæœ€å Istio æ”¯æŒå¯æ’æ‹”æˆæƒç³»ç»Ÿï¼ˆEnvoy çš„ &lt;code&gt;ext_authz&lt;/code&gt;ï¼‰ä»¥å¼ºåˆ¶æœ€ç»ˆç”¨æˆ·è®¿é—®èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®‰è£…é™åˆ¶æ€§é»˜è®¤æˆæƒç­–ç•¥&lt;/strong&gt;ã€‚æ ¹æ® &lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/security/#use-default-deny-patterns&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æœ€ä½³å®è·µ&lt;/a&gt;ï¼Œæ‚¨åº”è¯¥å®‰è£…ä¸€ä¸ªä¸å…è®¸æµé‡çš„é»˜è®¤æˆæƒç­–ç•¥ï¼Œä¸ºæ¯ä¸ªæœåŠ¡å‘å¸ƒå¯¹è±¡åˆ›å»º &lt;code&gt;AuthorizationPolicy&lt;/code&gt; å¯¹è±¡ä»¥ç®¡ç†å…è®¸å®ƒä»¬ä¸ä¹‹é€šä¿¡çš„å¯¹è±¡ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒSAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚æœ‰åŠ©äºå®ç°è¿™ä¸€ç›®æ ‡çš„ä¸¤ä¸ªæˆæƒç­–ç•¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;security.istio.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AuthorizationPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deny-all-audit&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AUDIT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 2ï¼š&lt;code&gt;IstioAuthorizationPolicy&lt;/code&gt;ä¼šæ‹’ç»æ‰€æœ‰æµé‡ï¼Œå¹¶å®¡è®¡è®°å½•å®ƒã€‚æ‚¨å¯èƒ½ä¼šè¿è¡Œè¿™æ ·çš„ç­–ç•¥å‡ å‘¨ï¼Œä»¥äº†è§£åœ¨å¯ç”¨å¼ºåˆ¶æ‰§è¡Œä¹‹å‰æ‚¨éœ€è¦çš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;security.istio.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AuthorizationPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deny-all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;{&lt;span class=&#34;nt&#34;&gt;} # or action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ALLOW&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 3ï¼šæ‹’ç»æ‰€æœ‰æµé‡çš„ Istio AuthorizationPolicyã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå…è®¸ä½†å…·æœ‰ç©ºè§„åˆ™é›†çš„ç­–ç•¥ï¼Œè¿™ä¸ç©ºä¸»ä½“ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é»˜è®¤æƒ…å†µä¸‹éœ€è¦ mTLS è¿›è¡ŒæœåŠ¡åˆ°æœåŠ¡é€šä¿¡&lt;/strong&gt;ã€‚é€šè¿‡åœ¨ç”±å®‰å…¨æˆ–å¹³å°å›¢é˜Ÿç®¡ç†çš„æ ¹å‘½åç©ºé—´ä¸­é…ç½® &lt;code&gt;PeerAuthentication&lt;/code&gt; èµ„æºï¼Œåº”å°†ä¼ è¾“ä¸­çš„åŠ å¯†è®¾ç½®ä¸ºä¸¥æ ¼ï¼ˆå³ &lt;a href=&#34;https://tetrate.io/blog/how-istios-mtls-traffic-encryption-works-as-part-of-a-zero-trust-security-posture/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éœ€è¦ mTLS æ‰èƒ½ä¸æœåŠ¡é€šä¿¡&lt;/a&gt;ï¼‰ã€‚ç½‘æ ¼å¤–éƒ¨çš„æœåŠ¡è°ƒç”¨ç½‘æ ¼ä¸­çš„åº”ç”¨ç¨‹åºåº”è¯¥é€šè¿‡åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³è¿›è¡Œé€šä¿¡ï¼Œå®ƒå¯ä»¥å‘å¤–éƒ¨æœåŠ¡æä¾›ç®€å•çš„ TLSï¼ˆç”šè‡³æ˜æ–‡ï¼‰ï¼Œå› ä¸ºå®ƒä¸å¤ªå¯èƒ½æœ‰è¯ä¹¦æ¥å¯¹ç½‘æ ¼æ‰§è¡Œ mTLSã€‚ç½‘æ ¼å†…éƒ¨çš„æœåŠ¡å‘¼å‡ºåº”é…ç½®ä¸ºä½¿ç”¨ç®€å•çš„ TLS æˆ–æ˜æ–‡ï¼Œå¹¶å¸¦æœ‰ç”¨äºå¤–éƒ¨æœåŠ¡çš„ DestinationRule çš„æ˜æ–‡ (&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204A, Â§SM-DR8&lt;/a&gt; )ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TLS é…ç½®é»˜è®¤å€¼&lt;/strong&gt;ã€‚Istio å¼€ç®±å³ç”¨ï¼Œå…·æœ‰è‰¯å¥½çš„ TLS è®¾ç½®ï¼ˆ&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#mutual-tls-authentication&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TLS æœ€ä½ç‰ˆæœ¬ 1.2ï¼Œå…·æœ‰ä¸€ç»„æœ‰é™çš„å¯†ç å¥—ä»¶&lt;/a&gt;ï¼‰ï¼Œä½†æ‚¨å¯èƒ½éœ€è¦æ ¹æ®æ‚¨çš„ç¯å¢ƒå¯¹å…¶è¿›è¡Œè°ƒæ•´ï¼ˆä¾‹å¦‚ï¼Œåœ¨ &lt;a href=&#34;https://www.fedramp.gov/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FedRAMP&lt;/a&gt; ç¯å¢ƒä¸­éµå®ˆ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/fips/140/3/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FIPS 140-3&lt;/a&gt; ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Envoy æ”¯æŒé€šè¿‡é…ç½® &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/gateway/#ServerTLSSettings-cipher_suites&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘å…³&lt;/a&gt; ä¸ºæ¯ä¸ªæœåŠ¡é…ç½®æœ€ä½ TLS ç‰ˆæœ¬å’Œä¸€ç»„å—æ”¯æŒçš„å¯†ç å¥—ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬å»ºè®®å°† &lt;strong&gt;TLS 1.3 ä½œä¸ºæœ€ä½ç‰ˆæœ¬&lt;/strong&gt; æ‰§è¡Œï¼ˆå¦‚æœæ‚¨åªæ‰§è¡Œ mTLS Envoy-to-Envoyï¼‰ï¼Œå¹¶ä¸ºéœ€è¦è¾ƒæ—§æˆ–å®‰å…¨æ€§è¾ƒä½çš„ TLS é…ç½®çš„å¤–éƒ¨æµé‡ä½¿ç”¨ç½‘å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è¿è¡Œæ—¶èº«ä»½ï¼Œä»¥ä¿ƒè¿›è¡¨è¾¾æ€§å¼ºã€ç»†ç²’åº¦çš„æˆæƒç­–ç•¥å¹¶é™åˆ¶æš´éœ²äºæ”»å‡»&lt;/strong&gt;ã€‚ä¸ºæ‚¨æ­£åœ¨éƒ¨ç½²çš„æ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è¿è¡Œæ—¶æ ‡è¯†ã€‚åœ¨ Kubernetes ä¸­ï¼Œä¸è¦åœ¨æ¯ä¸ªå‘½åç©ºé—´ä¸­ä½¿ç”¨é»˜è®¤çš„ Kubernetes æœåŠ¡å¸æˆ·ï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªå‘½åç©ºé—´ä¸­çš„æ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æœåŠ¡å¸æˆ·ã€‚æˆæƒç­–ç•¥åªèƒ½åœ¨èº«ä»½çš„ç²’åº¦ä¸Šè½»æ¾ç®¡ç†ã€‚å½“å¤šä¸ªè¿è¡Œæ—¶ç»„ä»¶å…±äº«ç›¸åŒçš„èº«ä»½æ—¶ï¼Œå¾ˆéš¾ç®¡ç†ä¸€ä¸ªè®¿é—®æ§åˆ¶ç­–ç•¥æ¥è¡¨è¾¾æ‚¨çš„é¢„æœŸè®¿é—®æƒé™ï¼ŒåŒæ—¶ä¸å…è®¸ä½¿ç”¨å…±äº«èº«ä»½çš„æŸäº›ç»„ä»¶è¿›è¡Œè¿‡äºå¹¿æ³›çš„è®¿é—®ã€‚è¿™å¯¼è‡´æ›´å¤§çš„è¡¨é¢ç§¯æš´éœ²ç»™å¯èƒ½å±åŠç³»ç»Ÿçš„ä¸€ä¸ªç»„ä»¶çš„æ”»å‡»è€…ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204A Â§SM-DR11ï¼ŒÂ§SM-DR18&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°†æœåŠ¡åˆ°æœåŠ¡çš„é€šä¿¡é™åˆ¶åœ¨æœ¬åœ°å‘½åç©ºé—´&lt;/strong&gt;ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡é—´é€šä¿¡åº”é™åˆ¶åœ¨æœ¬åœ°åç§°ç©ºé—´å†…ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸èƒ½å†™ä¸ºæ ¹é…ç½®å‘½åç©ºé—´ä¸­çš„å•ä¸ª AuthorizationPolicyã€‚ç›¸åï¼Œå¯ä»¥å°†ä»…å…è®¸åœ¨æœ¬åœ°å‘½åç©ºé—´ä¸­è®¿é—®çš„é»˜è®¤ AuthorizationPolicy æ¨¡æ¿åŒ–ä¸ºé»˜è®¤å€¼ï¼Œå¹¶ä¸”åº”å…è®¸åº”ç”¨ç¨‹åºå›¢é˜Ÿç¼–å†™ä»–ä»¬è‡ªå·±çš„æ›´ä¸“ä¸šï¼ˆå—é™ï¼‰çš„ç­–ç•¥ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP800-204Bï¼ŒÂ§SAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›ä»æˆ‘ä»¬å¤šå¹´å¸®åŠ©å®¢æˆ·æ„å»ºæˆåŠŸçš„æœåŠ¡ç½‘æ ¼å®è·µçš„ç»éªŒä¸­è·å¾—çš„è¿™äº›æœ€ä½³å®è·µå°†æœ‰åŠ©äºä¿ƒè¿›æ‚¨çš„éƒ¨ç½²ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·æŸ¥çœ‹æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—ä¸­çš„å…¶ä»–å¸–å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34;&gt;ç¬¬ 1 éƒ¨åˆ†ï¼šå¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloudnativecn.com/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/&#34;&gt;ç¬¬ 2 éƒ¨åˆ†ï¼šæœåŠ¡ç½‘æ ¼å®‰å…¨æ€§å’Œé«˜å¯ç”¨æ€§éƒ¨ç½²æœ€ä½³å®è·µ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚éœ€å…¨é¢äº†è§£ NIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ï¼Œè¯· &lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½æˆ‘ä»¬çš„å…è´¹æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¥ä¸‹æ¥å¤šç§Ÿæˆ·çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µ&#34;&gt;æ¥ä¸‹æ¥ï¼šå¤šç§Ÿæˆ·çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µ&lt;/h3&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å…³äºæœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæˆ‘ä»¬çœ‹åˆ°å®¢æˆ·æ­£åœ¨åŠªåŠ›è§£å†³çš„å¸¸è§ç§Ÿèµå†³ç­–ç‚¹ï¼Œå¹¶é‡ç‚¹å…³æ³¨ç½‘æ ¼å¦‚ä½•å¸®åŠ©ä¿ƒè¿›è¿™äº›å†³ç­–ã€‚æˆ‘ä»¬å°†æ¶µç›–çš„ä¸»é¢˜åŒ…æ‹¬ Kubernetes é›†ç¾¤æ‰€æœ‰æƒã€å‘½åç©ºé—´æ‰€æœ‰æƒã€é…ç½®æ‰€æœ‰æƒï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æœåŠ¡ç½‘æ ¼åº”ç”¨ç¨‹åºç½‘å…³æ¥ç¼“è§£ä¸­æ–­ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼å®‰å…¨æ€§å’Œé«˜å¯ç”¨æ€§éƒ¨ç½²æœ€ä½³å®è·µ</title>
      <link>https://cloudnativecn.com/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/</link>
      <pubDate>Mon, 30 Jan 2023 11:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/</guid>
      <description>&lt;p&gt;è¿™æ˜¯ &lt;a href=&#34;https://tetrate.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—æ–‡ç« &lt;/a&gt; ä¸­çš„ç¬¬äºŒç¯‡ï¼Œæ‘˜è‡ª Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å³å°†å‡ºç‰ˆçš„ä¹¦ç± Istio in Productionã€‚&lt;/p&gt;
&lt;p&gt;å½“æ¶‰åŠåˆ°åœ¨å¤šé›†ç¾¤çš„åŸºç¡€è®¾æ–½ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼æ—¶ï¼Œæœ‰ä¸€äº›å¯ç§»åŠ¨çš„éƒ¨åˆ†ã€‚è¿™é‡Œä¸»è¦æƒ³å¼ºè°ƒçš„æ˜¯æ§åˆ¶å¹³é¢åº”è¯¥å¦‚ä½•éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºé™„è¿‘ï¼Œå…¥å£åº”è¯¥å¦‚ä½•éƒ¨ç½²ä»¥ä¿ƒè¿›å®‰å…¨æ€§å’Œæ•æ·æ€§ï¼Œå¦‚ä½•ä½¿ç”¨ Envoy ä¿ƒè¿›è·¨é›†ç¾¤è´Ÿè½½å‡è¡¡ï¼Œä»¥åŠç½‘æ ¼å†…éƒ¨å¦‚ä½•ä½¿ç”¨è¯ä¹¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢ä¸æ•…éšœåŸŸä¿æŒä¸€è‡´&#34;&gt;ä½¿æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢ä¸æ•…éšœåŸŸä¿æŒä¸€è‡´&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šå›´ç»•æ•…éšœåŸŸéƒ¨ç½²æ¾æ•£è€¦åˆçš„æ§åˆ¶å¹³é¢ä»¥å®ç°é«˜å¯ç”¨æ€§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ„å»ºé«˜å¯ç”¨æ€§ç³»ç»Ÿå¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œè€Œä¸”é€šå¸¸æˆæœ¬å¾ˆé«˜ã€‚æˆ‘ä»¬çŸ¥é“çš„ä¸€ç§ç»è¿‡éªŒè¯çš„æŠ€æœ¯æ˜¯å›´ç»•æ•…éšœåŸŸæ„å»ºã€‚æ•…éšœåŸŸæ˜¯å½“å…³é”®ç³»ç»Ÿå‘ç”Ÿæ•…éšœæ—¶å—å½±å“çš„åŸºç¡€æ¶æ„éƒ¨åˆ†ã€‚æˆ‘ä»¬æ„å»ºå¯é ç³»ç»Ÿçš„åŸºæœ¬æ–¹æ³•æ˜¯å°†ç³»ç»Ÿè·¨è¶Šçš„æ•…éšœåŸŸåˆ†ç»„ä¸ºå¤šä¸ªç‹¬ç«‹çš„å­¤å²›ã€‚æœ€ç»ˆç³»ç»Ÿçš„æ•´ä½“å¯é æ€§å–å†³äºæˆ‘ä»¬å¯ä»¥ä½¿å­¤å²›çš„ç‹¬ç«‹ç¨‹åº¦ã€‚å®é™…ä¸Šï¼Œæ€»æ˜¯å­˜åœ¨ä¸€äº›ç›¸äº’ä¾èµ–æ€§ï¼Œå°†å…¶æœ€å°åŒ–æ€»æ˜¯æˆæœ¬ä¸å¯ç”¨æ€§çš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ²¡æœ‰è€¦åˆæ•…éšœåŸŸçš„æƒ…å†µä¸‹åˆ›å»ºéš”ç¦»å­¤å²›çš„æœ€ç®€å•æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªå­¤å²›ä¸­è¿è¡Œå…³é”®æœåŠ¡çš„ç‹¬ç«‹å‰¯æœ¬ã€‚æˆ‘ä»¬å¯ä»¥è¯´è¿™äº›å‰¯æœ¬æ˜¯ç­’ä»“çš„æœ¬åœ°å‰¯æœ¬ â€”â€” å®ƒä»¬å…±äº«ç›¸åŒçš„æ•…éšœåŸŸã€‚åœ¨äº‘åŸç”Ÿæ¶æ„ä¸­ï¼ŒKubernetes é›†ç¾¤å½¢æˆäº†æœ€è‡ªç„¶çš„ç­’ä»“è¾¹ç•Œã€‚Istio æ˜¯ä¸€é¡¹å…³é”®æœåŠ¡ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºé›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éƒ¨ç½² Istio ä½¿å…¶æ•…éšœåŸŸä¸æ‚¨çš„åº”ç”¨ç¨‹åºçš„æ•…éšœåŸŸä¿æŒä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæˆ‘ä»¬ç¡®ä¿ Istio æ§åˆ¶å¹³é¢å®ä¾‹æ˜¯æ¾æ•£è€¦åˆçš„ï¼Œä¸éœ€è¦ç›´æ¥ä¸å…¶ä»–é›†ç¾¤é€šä¿¡ï¼Œä»è€Œæœ€å¤§é™åº¦åœ°å‡å°‘å…¶ä¸å­¤å²›å¤–éƒ¨çš„é€šä¿¡ã€‚æœ‰å…³å¦‚ä½•å®ç°æ­¤ç›®çš„çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„å¤šé›†ç¾¤éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³éš”ç¦»æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æµé‡&#34;&gt;ä½¿ç”¨åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³éš”ç¦»æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æµé‡&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä»æ¯ä¸ªåº”ç”¨ç¨‹åºæˆ–åº”ç”¨ç¨‹åºå›¢é˜Ÿçš„ç½‘å…³ï¼ˆåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ï¼‰å¼€å§‹ï¼Œä»¥å¸®åŠ©ç¼“è§£å…±äº«ä¸­æ–­ã€‚éšç€æ—¶é—´çš„æ¨ç§»æ‚¨æ“ä½œç»éªŒçš„å¢åŠ ï¼Œå°†åº”ç”¨ç¨‹åºå…¥å£åˆå¹¶åˆ°å…±äº«ç½‘å…³ä»¥ä¼˜åŒ–æˆæœ¬ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è™½ç„¶ Istio é»˜è®¤é™„å¸¦å…±äº« &lt;code&gt;istio-ingressgateway&lt;/code&gt;ï¼Œä½†æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨å…±äº«ç½‘å…³ã€‚å¤§å¤šæ•°é‡‡ç”¨ç½‘æ ¼çš„å›¢é˜Ÿéƒ½éœ€è¦æ—¶é—´æ¥æ„å»ºå®æ–½å…±äº«ç½‘å…³æ¨¡å‹æ‰€éœ€çš„å®¡æŸ¥å®è·µå’Œæ“ä½œï¼Œè€Œæ²¡æœ‰å…±äº«ä¸­æ–­çš„é£é™©ã€‚ç‰¹åˆ«æ˜¯åœ¨ Istio å®æ–½çš„æ—©æœŸï¼Œæˆ‘ä»¬å»ºè®®æ¯ä¸ªå›¢é˜Ÿéƒ¨ç½²ä¸€ä¸ª Envoy ç½‘å…³ã€‚æˆ‘ä»¬ç§°è¿™äº›ä¸ºåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ã€‚éšç€æ‚¨è·å¾—æ“ä½œç»éªŒï¼Œæ‚¨å¯ä»¥å¼€å§‹å°†åº”ç”¨ç¨‹åºåˆå¹¶åˆ°å…±äº«ç½‘å…³ä¸Šä»¥ä¼˜åŒ–æˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨å…±äº«ç½‘å…³æ¨¡å‹å®ç°æ¯ä¸ªå›¢é˜Ÿéš”ç¦»çš„æ·å¾„æ˜¯ä¸ºæ¯ä¸ªå›¢é˜Ÿåˆ†é…ä¸€ä¸ªå•ç‹¬çš„ä¸»æœºåã€‚æŒ‰ä¸»æœºåéš”ç¦»çš„å›¢é˜Ÿå¯ä»¥æ›´å®‰å…¨åœ°é…ç½®å…±äº«ç½‘å…³å®ä¾‹ã€‚ç„¶è€Œï¼Œå…¶ä»–å…±åŒå‘½è¿çš„ä¸­æ–­é£é™©ä»ç„¶å­˜åœ¨ï¼Œä¾‹å¦‚å…¥å£ä»£ç†éƒ¨ç½²çš„é”™è¯¯é…ç½®ã€å˜ˆæ‚çš„é‚»å±…æ¶ˆè€—èµ„æºå’Œå¢åŠ æ‰€æœ‰åº”ç”¨ç¨‹åºçš„å»¶è¿Ÿç­‰ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œæ¯ä¸ªå›¢é˜Ÿä¸€ä¸ªç½‘å…³çš„æ–¹æ³•ä¼šäº§ç”Ÿæœ€å¿«çš„å½±å“ï¼Œå¹¶ä¸”å¤±è´¥çš„æœºä¼šæœ€å°‘ï¼Œå¹¶ä¸”æ€»ä½“æˆæœ¬ç›¸å¯¹è¾ƒä½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœŸæœ›æˆç†Ÿéƒ¨ç½²çš„æœ€ç»ˆçŠ¶æ€æ˜¯ 80-20 çš„æ¯”ä¾‹ï¼šå¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†é€šè¿‡å…±äº«ç½‘å…³æ¥æ”¶æµé‡ï¼Œè€Œä¸€å°éƒ¨åˆ†é«˜åº¦å…³é”®æˆ–æ•æ„Ÿçš„åº”ç”¨ç¨‹åºå°†ä¿ç•™ä¸“ç”¨ç½‘å…³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´åˆ†é…å…¥å£æµé‡&#34;&gt;ä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´åˆ†é…å…¥å£æµé‡&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ä¸ºå®¢æˆ·ç«¯æä¾›å•ä¸€åœ°å€ï¼Œä»¥ä¾›å®¢æˆ·ç«¯ä½¿ç”¨å¹¶å°†æµé‡åˆ†é…åˆ°è·¨å¤šä¸ªé›†ç¾¤çš„åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1åŸºäº-envoy-çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šåŸºäº Envoy çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚&#34; srcset=&#34;
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu1708383524639542651.webp 400w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu3886386895485961367.webp 760w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu2437522503309907271.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu1708383524639542651.webp&#34;
               width=&#34;744&#34;
               height=&#34;680&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šåŸºäº Envoy çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»å¸¸çœ‹åˆ°å®¢æˆ·éœ€è¦è·¨å¤šä¸ªé›†ç¾¤åˆ†é…å…¥å£æµé‡ã€‚ä¾‹å¦‚ï¼Œä»–ä»¬å¯èƒ½å¸Œæœ›å¯ç”¨è“ / ç»¿åŸºç¡€è®¾æ–½å‡çº§ï¼Œä»¥ä¿ƒè¿›è·¨åŒºåŸŸæ•…éšœè½¬ç§»ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨ Envoy çš„ L7 åŠŸèƒ½å°†æµé‡ä»å•ä½“è¿ç§»åˆ°å¾®æœåŠ¡æ¥å®ç°æ‰¼æ€æ¨¡å¼ã€‚æˆ‘ä»¬ç§°è¿™äº›ä¸ºåº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®ç°è¿™ä¸ªç”¨ä¾‹ï¼Œæˆ‘ä»¬å°†éƒ¨ç½² Envoyâ€”â€” åœ¨ä¸“ç”¨çš„ Kubernetes é›†ç¾¤ä¸­æˆ–ä½œä¸ºä¸€ç»„è™šæ‹Ÿæœº â€”â€” æ¥æ¥æ”¶å¤–éƒ¨æµé‡ã€‚è¿™äº› Envoy å®ä¾‹å°†é€šè¿‡å…¶ Kubernetes å…¥å£æˆ– VM VIP å°†æµé‡è½¬å‘åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºã€‚è¿™ä¸ ingress-per-team æ–¹æ³•ååŒå·¥ä½œï¼šå¤šé›†ç¾¤ç½‘å…³ä¸ºå®¢æˆ·ç«¯æä¾›ä¸€ä¸ªå•ä¸€åœ°å€ä»¥ä¾›ä½¿ç”¨ï¼Œæ ¹æ®æ‚¨çš„åŸºç¡€è®¾æ–½éœ€è¦æä¾›å°½å¯èƒ½å¤šçš„åº”ç”¨ç¨‹åºç½‘å…³å’Œé›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶æ­¤ç½‘å…³ç¡®å®å­˜åœ¨å…±äº«æ•…éšœåŸŸï¼Œä½†å…¶é…ç½®è¿œæ¯”æ¯ä¸ªåº”ç”¨ç¨‹åºä¸€ä¸ªå…¥å£ç½‘å…³çš„é…ç½®ç®€å•ã€‚å› æ­¤ï¼Œä½œä¸ºå…±äº«åŸºç¡€æ¶æ„è¿è¡Œèµ·æ¥æ›´å®¹æ˜“ï¼Œä¹Ÿæ›´å®‰å…¨ã€‚æ¯ä¸ªé›†ç¾¤éƒ½æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³çš„å…±äº«åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³æ˜¯ä¸€ç§å¼ºå¤§è€Œçµæ´»çš„æ¨¡å‹ï¼Œç”¨äºåœ¨ç½‘æ ¼ä¸Šéƒ¨ç½²å’Œæ“ä½œåº”ç”¨ç¨‹åºï¼Œè¿˜å¯ä»¥æ›´è½»æ¾åœ°æ“ä½œåº•å±‚åŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯ä¹¦å’Œå…¬é’¥åŸºç¡€è®¾æ–½-pki-çš„å»ºè®®&#34;&gt;è¯ä¹¦å’Œå…¬é’¥åŸºç¡€è®¾æ–½ (PKI) çš„å»ºè®®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä»æ‚¨ç°æœ‰çš„ä¼ä¸šæ ¹ç›®å½•ä¸ºç½‘æ ¼ mTLS åˆ›å»ºä¸€ä¸ªä¸­é—´ç­¾åè¯ä¹¦ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Istio ä½¿ç”¨å¸¸è§„ X.509 è¯ä¹¦è¿›è¡Œèº«ä»½éªŒè¯å¹¶åœ¨ç½‘æ ¼ä¸­å¯ç”¨ä¼ è¾“åŠ å¯†ã€‚æˆ‘ä»¬å»ºè®®ä¸ºç°æœ‰ä¼ä¸šæ ¹ç›®å½•ä¸­çš„æ‰€æœ‰ç½‘æ ¼ mTLS åˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ã€‚å¦‚æœæ¯ä¸ªç¯å¢ƒéƒ½æœ‰ä¸€ä¸ªæ ¹ï¼Œè¯·ä¸ºæ¯ä¸ªç¯å¢ƒåˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ã€‚ä½¿ç”¨è¯¥ç½‘æ ¼ä¸­é—´é¢å‘è¯ä¹¦ä¸ºæ¯ä¸ª Istio å®‰è£…åˆ›å»ºä¸€ä¸ªç­¾åè¯ä¹¦ã€‚æˆ‘ä»¬å»ºè®®åˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ï¼Œä»¥ä¾¿åœ¨ä»»ä½•ç‰¹å®šç¯å¢ƒä¸­ç½‘æ ¼çš„æ•´ä¸ª PKI æ˜¯ä¸€æ£µæ ‘ï¼Œå¦‚æœéœ€è¦å¯ä»¥ä¸€èµ·å¤±æ•ˆã€‚æˆæœ¬æ˜¯ä¸€äº›é¢å¤–çš„è¯ä¹¦ç®¡ç†ï¼Œä¸æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ç›¸æ¯”ï¼Œåœ¨ç®¡ç†ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦çš„ç”Ÿå‘½å‘¨æœŸæ—¶éœ€è¦æ›´åŠ å°å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2-tetrate-æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰-pki-é›†æˆçš„æ–¹æ³•åœ¨ç¯å¢ƒå¦‚-prodä¸­ä¸º-istio-ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª-istio-æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦å¹¶è®©-istio-åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰-pod-é¢å‘å·¥ä½œè´Ÿè½½å¶è¯ä¹¦&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2. Tetrate æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰ PKI é›†æˆçš„æ–¹æ³•ï¼šåœ¨ç¯å¢ƒï¼ˆå¦‚ prodï¼‰ä¸­ä¸º Istio ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ï¼Œä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦ï¼Œå¹¶è®© Istio åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod é¢å‘å·¥ä½œè´Ÿè½½ï¼ˆå¶ï¼‰è¯ä¹¦ã€‚&#34; srcset=&#34;
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu15867137933514742888.webp 400w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu12791977229644659399.webp 760w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu3942461111112940657.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu15867137933514742888.webp&#34;
               width=&#34;760&#34;
               height=&#34;459&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2. Tetrate æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰ PKI é›†æˆçš„æ–¹æ³•ï¼šåœ¨ç¯å¢ƒï¼ˆå¦‚ prodï¼‰ä¸­ä¸º Istio ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ï¼Œä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦ï¼Œå¹¶è®© Istio åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod é¢å‘å·¥ä½œè´Ÿè½½ï¼ˆå¶ï¼‰è¯ä¹¦ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Istio ç›‘è§†æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹æ—¶é‡æ–°åŠ è½½å…¶ç­¾åè¯ä¹¦ã€‚å› æ­¤ï¼Œåªè¦ä½ æœ‰ä¸€ä¸ªæ‰¹å‡†çš„æœºåˆ¶æ¥å°†ç§˜å¯†åŠ è½½åˆ° &lt;em&gt;istiod&lt;/em&gt; pod çš„æ–‡ä»¶ç³»ç»Ÿä¸­ â€”â€” æ¯”å¦‚ &lt;em&gt;cert-manager&lt;/em&gt;ã€Vault çš„ &lt;em&gt;init-agent&lt;/em&gt; æˆ– sidecarï¼Œæˆ–è€…åªæ˜¯å­˜å‚¨åœ¨åŠ å¯† &lt;em&gt;etcd&lt;/em&gt; ä¸­çš„æ™®é€šæ—§ Kubernetes Secretâ€”â€” é›†æˆ Istio è¿›å…¥æ‚¨çš„ PKI åº”è¯¥å¾ˆå®¹æ˜“ã€‚æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦çš„è½®æ¢åº”ç”±æ‚¨çš„ PKI è‡ªåŠ¨æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Istio ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„å¯†ç å­¦åº“ï¼šIstio çš„å†…éƒ¨ CA ä½¿ç”¨ Golang çš„å¯†ç å­¦å¥—ä»¶ï¼ŒEnvoyï¼ˆsidecar å’Œ ingressï¼‰ä½¿ç”¨ BoringSSL è¿›è¡Œè¯ä¹¦éªŒè¯å’Œä¼ è¾“ä¸­çš„åŠ å¯†ã€‚é€šè¿‡ Tetrate çš„å¼€æº Istio å‘è¡Œç‰ˆ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro&lt;/a&gt; ï¼Œç»è¿‡ FIPS éªŒè¯çš„æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢æ„å»ºä¹Ÿä½œä¸º &lt;a href=&#34;https://tetr8.io/tis&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio è®¢é˜…&lt;/a&gt; çš„ä¸€éƒ¨åˆ†æä¾›ï¼Œå› æ­¤æ‚¨å¯èƒ½æœŸæœ›çš„æ‰€æœ‰ X.509 çº¦æŸï¼ˆåŸºæœ¬çº¦æŸï¼Œå¦‚ CA å’Œæ·±åº¦ï¼Œå¼€ç®±å³ç”¨åœ°æ”¯æŒå’Œå¼ºåˆ¶æ‰§è¡Œå‘½åçº¦æŸã€ç­–ç•¥çº¦æŸç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨æçŸ­å¯¿å‘½çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä»¥è½»æ¾åŠé”€&#34;&gt;ä½¿ç”¨æçŸ­å¯¿å‘½çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä»¥è½»æ¾åŠé”€&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä½¿ç”¨ Istio æ¥è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ï¼Œä»¥ä¾¿è®¾ç½®æçŸ­çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTL å˜å¾—åˆ‡å®å¯è¡Œï¼Œä»è€Œä½¿ &lt;a href=&#34;https://csrc.nist.gov/glossary/term/certificate_revocation_list&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯ä¹¦æ’¤é”€åˆ—è¡¨ï¼ˆCRLï¼‰&lt;/a&gt; ä¿æŒç®€çŸ­ä¸”æ˜“äºç®¡ç†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¯ä¹¦é¢å‘å’Œè½®æ¢ï¼ˆIstio ä¸ºæ‚¨è‡ªåŠ¨æ‰§è¡Œï¼‰ä¹‹åï¼ŒPKI ä¸­æœ€å¤§çš„æŒ‘æˆ˜æ˜¯è¯ä¹¦åŠé”€ã€‚è¯ä¹¦åŠé”€æ˜¯é€šè¿‡è¯ä¹¦åŠé”€åˆ—è¡¨å®ç°çš„ï¼Œé€šå¸¸ CRL å…·æœ‰ 24 å°æ—¶çš„å¼ºåˆ¶æ‰§è¡Œ SLAï¼šæ·»åŠ åˆ°åˆ—è¡¨ä¸­çš„è¯ä¹¦åœ¨åŠé”€åæœ€å¤š 24 å°æ—¶å†…å¯èƒ½ä¼šè¢«åŸºç¡€è®¾æ–½è§†ä¸ºæœ‰æ•ˆã€‚æ­¤å¤–ï¼Œç”±äºåŠé”€çš„è¯ä¹¦å¿…é¡»åœ¨å…¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ (TTL) å†…ä¿ç•™åœ¨åˆ—è¡¨ä¸­ï¼Œå› æ­¤åŠé”€åˆ—è¡¨ä¼šå˜å¾—åºå¤§è€Œç¬¨æ‹™ã€‚&lt;/p&gt;
&lt;p&gt;Istio æä¾›çš„ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ï¼Œä»¥ä¾¿è®¾ç½®æçŸ­çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTL æ˜¯åˆ‡å®å¯è¡Œçš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio é™„å¸¦ 24 å°æ—¶çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTLã€‚è¿™è¶³å¤ŸçŸ­ï¼Œå¤§å¤šæ•°å®‰å…¨ç»„ç»‡å¯ä»¥é€‰æ‹©è®©å—æŸçš„è¯ä¹¦è¿‡æœŸï¼Œè€Œä¸æ˜¯æ˜ç¡®åœ°æ’¤é”€å®ƒä»¬ã€‚è€Œä¸”ï¼Œå½“æ‚¨å‘ CRL æ·»åŠ è¯ä¹¦æ—¶ï¼Œå®ƒåªéœ€è¦åœ¨é‚£é‡Œåœç•™å¾ˆçŸ­çš„æ—¶é—´ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åœ¨ CRL ä¸Šä¿ç•™è¿‡æœŸçš„è¯ä¹¦ï¼‰ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç½‘æ ¼æœ‰åŠ©äºè§£å†³å¤§å¤šæ•°ç»„ç»‡é¢ä¸´çš„æœ€ç—›è‹¦çš„ PKI é—®é¢˜ï¼šå®ƒé¢å‘å’ŒåŠé”€çŸ­æœŸè¯ä¹¦ï¼Œè¿™æ„å‘³ç€åŠé”€åˆ—è¡¨å¯ä»¥åœ¨éœ€è¦æ—¶ä¿æŒç®€çŸ­ä¸”æ˜“äºç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šç”±äºç½‘æ ¼ä½¿ç”¨ mTLS è¯ä¹¦ä½œä¸ºèº«ä»½ï¼ŒIstio å°† Envoy é…ç½®ä¸ºè‡ªåŠ¨ä¸¢å¼ƒå·²å»ºç«‹çš„è¿æ¥ï¼Œä»¥å¼ºåˆ¶å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨ä»»ä½•ä¸€æ–¹è½®æ¢è¯ä¹¦æ—¶é‡æ–°éªŒè¯å½¼æ­¤ã€‚è¿™æ˜¯ Istio å®ç°ä¸­çš„è®¾è®¡å†³ç­–ï¼Œé€šå¸¸é€šè¿‡ Istio çš„å¼¹æ€§åŠŸèƒ½å¯¹åº”ç”¨ç¨‹åºéšè—ï¼šå¯¹åº”ç”¨ç¨‹åºé€æ˜çš„è‡ªåŠ¨é‡è¯•é‡æ–°å»ºç«‹è¿æ¥ã€‚åœ¨ç½‘æ ¼ä¸­è®¾ç½®è¾ƒçŸ­çš„è¯ä¹¦ TTL ä¼šå¼ºåˆ¶è¿™äº›é‡æ–°è¿æ¥æ›´é¢‘ç¹åœ°å‘ç”Ÿã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§è¡Œä¸ºå¶å°”ä¼šä¸­æ–­ä¸€äº›æœŸæœ›é•¿æœŸ TCP è¿æ¥çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿›ä¸€æ­¥çš„è¯ä¹¦æ¨è&#34;&gt;è¿›ä¸€æ­¥çš„è¯ä¹¦æ¨è&lt;/h3&gt;
&lt;p&gt;æ‚¨åº”è¯¥ä¸æ‚¨çš„å®‰å…¨å›¢é˜Ÿåè°ƒï¼Œä¸ºæ‚¨çš„ç½‘æ ¼é¢å‘çš„è¯ä¹¦å»ºç«‹é€‚å½“çš„çº¦æŸã€‚æˆ‘ä»¬æ¨èçš„ä¸€äº›å¸¸è§çº¦æŸå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯ä¹¦ç”Ÿå‘½å‘¨æœŸ (TTL)&lt;/strong&gt;ã€‚è¯·æ³¨æ„ï¼Œåªè¦è¯ä¹¦æ˜¯ä»åŒä¸€ä¸ªæ ¹é¢å‘çš„ï¼ŒIstio å°±æ”¯æŒæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦å’Œå·¥ä½œè´Ÿè½½è¯ä¹¦çš„é›¶åœæœºè½®æ¢ã€‚æˆ‘ä»¬å»ºè®®æ¯ä¸ªçº§åˆ«çš„è¯ä¹¦ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ 1-3 å¹´&lt;/li&gt;
&lt;li&gt;æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ 3 ä¸ªæœˆ&lt;/li&gt;
&lt;li&gt;å·¥ä½œè´Ÿè½½è¯ä¹¦éœ€è¦ 12-24 å°æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Istio è‡ªåŠ¨å¤„ç†å·¥ä½œè´Ÿè½½è¯ä¹¦çš„è½®æ¢ã€‚è¿™äº›è¯ä¹¦ä¸Šçš„çŸ­ TTLï¼ˆå°‘äº 24 å°æ—¶ï¼‰æœ‰åŠ©äºé™åˆ¶å¯èƒ½è¢«ç›—çš„å‡­æ®è¿›è¡Œæ—¶é—´é™åˆ¶æ”»å‡»ï¼Œè¿˜å¯ä»¥å‡å°‘å¯¹ CRL çš„éœ€æ±‚ã€‚æ§åˆ¶å¹³é¢è¯ä¹¦åº”æŒ‰ä¸€ä¸ªæœˆçš„åç§»è½®æ¢ä»¥ç¡®ä¿å¹³ç¨³è¿‡æ¸¡ â€”â€” æ¢å¥è¯è¯´ï¼Œåœ¨ 3 ä¸ªæœˆçš„ TTL åˆ°æœŸå‰ 1 ä¸ªæœˆè½®æ¢æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ã€‚ç±»ä¼¼åœ°ï¼Œå½“ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦è¿˜å‰©ä¸€åŠåˆ°ä¸‰åˆ†ä¹‹ä¸€çš„ç”Ÿå‘½å‘¨æœŸæ—¶è½®æ¢ï¼ˆä¸€å¹´ TTL æå‰ 3-4 ä¸ªæœˆï¼Œä¸‰å¹´ TTL æå‰ 6-8 ä¸ªæœˆï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸºç¡€ï¼ˆCA å’Œæ·±åº¦ï¼‰&lt;/strong&gt;ã€‚æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦åº”è¯¥åªèƒ½é¢å‘å¶è¯ä¹¦ï¼šç”¨äºå·¥ä½œè´Ÿè½½è¯†åˆ«çš„éç­¾åè¯ä¹¦ã€‚å› æ­¤ï¼Œåº”é…ç½®æ·±åº¦é™åˆ¶ä»¥é˜²æ­¢æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦é¢å‘ä»»ä½•å…¶ä»–ç­¾åè¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦éœ€è¦åˆ›å»ºæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ï¼Œå› æ­¤å®ƒåº”è¯¥é…ç½®ä¸€ä¸ªæ·±åº¦ï¼Œä»¥ä¾¿èƒ½å¤Ÿ&lt;strong&gt;åœ¨å®ƒä¸‹é¢åˆ›å»ºä¸€ä¸ªçº§åˆ«çš„ç­¾åè¯ä¹¦ï¼Œè€Œä¸æ˜¯æ›´å¤š&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åç§°çº¦æŸ&lt;/strong&gt;ã€‚Istio é¢å‘çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä¸ä¼šå¡«å…… X.509 ä¸»ä½“åç§° (SN) å­—æ®µï¼›ç½‘æ ¼èº«ä»½éªŒè¯ä¾èµ–äºä½œä¸ºä¸»ä½“å¤‡ç”¨åç§° (SAN) å­—æ®µæºå¸¦çš„ SPIFFE èº«ä»½ã€‚é˜…è¯» &lt;a href=&#34;https://github.com/spiffe/spiffe/blob/main/standards/X509-SVID.md#4-constraints-and-usage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE è§„èŒƒä»¥è·å–æœ‰å…³éªŒè¯å’Œèº«ä»½éªŒè¯å·¥ä½œçš„ä¿¡æ¯&lt;/a&gt;ï¼Œä»¥åŠ Istio çš„ &lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#istio-identity&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡æ¡£&lt;/a&gt; ä»¥äº†è§£ Istio å¦‚ä½•æ ¹æ® SPIFFE å¯¹èº«ä»½è¿›è¡Œç¼–ç ã€‚åœ¨ä¸ºç½‘æ ¼ä¸­é—´å’Œæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ç¼–å†™åç§°çº¦æŸæ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯†é’¥ç”¨æ³•&lt;/strong&gt;ã€‚ &lt;code&gt;keyCertSign&lt;/code&gt; å¿…é¡»ä¸ºç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦å’Œæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦è®¾ç½®ï¼Œä½†åº”ä¸ºå·¥ä½œè´Ÿè½½è¯ä¹¦ç¦ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œç½‘æ ¼ä¸­é—´å’Œæ§åˆ¶å¹³é¢è¯ä¹¦æ˜¯ç­¾åè¯ä¹¦ï¼Œè€Œå·¥ä½œè´Ÿè½½è¯ä¹¦ä¸æ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ® SPIFFE çš„å»ºè®®ï¼Œä¸åº”å°†ç­¾åè¯ä¹¦ç”¨äºä¼ è¾“ä¸­çš„åŠ å¯†ï¼Œå¹¶ä¸”åº”é…ç½®å¯†é’¥ä½¿ç”¨ä»¥é˜²æ­¢å®ƒï¼ˆé€šè¿‡åŠ å¯†çº¦æŸï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰©å±•å¯†é’¥ç”¨æ³•&lt;/strong&gt;ã€‚è™½ç„¶æ­¤å¤„æ²¡æœ‰å…·ä½“è¦æ±‚ï¼Œä½† SPIFFE X.509 SVID è§„èŒƒè¯´æ˜ &lt;code&gt;id-kp-serverAuth&lt;/code&gt; å’Œ &lt;code&gt;id-kp-clientAuth&lt;/code&gt; åº”é’ˆå¯¹å¶ï¼ˆå·¥ä½œè´Ÿè½½ï¼‰è¯ä¹¦è¿›è¡Œé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;SPIFFE è§„èŒƒè¿˜æ¨èäº† &lt;a href=&#34;https://github.com/spiffe/spiffe/blob/main/standards/X509-SVID.md#4-constraints-and-usage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å„ç§è¯ä¹¦çº¦æŸ&lt;/a&gt;ï¼Œå°½ç®¡å…¶ä¸­å¤§éƒ¨åˆ†ä¸Šé¢å·²ç»çº¦æŸäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›ä»å¤šå¹´å¸®åŠ©æˆ‘ä»¬çš„å®¢æˆ·å……åˆ†åˆ©ç”¨æœåŠ¡ç½‘æ ¼çš„ç»éªŒä¸­æ”¶é›†çš„è¿™äº›æœ€ä½³å®è·µå°†æœ‰åŠ©äºä¿ƒè¿›æ‚¨çš„éƒ¨ç½²ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34;&gt;å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥&lt;/a&gt; è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼šæœåŠ¡ç½‘æ ¼è¿è¡Œæ—¶é…ç½®å»ºè®®ã€‚åœ¨æˆ‘ä»¬çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è°ˆè®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘½åçº¦å®š&lt;/li&gt;
&lt;li&gt;å…¨å±€è®¾ç½®&lt;/li&gt;
&lt;li&gt;æµé‡ç®¡ç†&lt;/li&gt;
&lt;li&gt;å®‰å…¨&lt;/li&gt;
&lt;li&gt;é¥æµ‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•¬è¯·å…³æ³¨ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥</title>
      <link>https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/</link>
      <pubDate>Thu, 05 Jan 2023 14:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/</guid>
      <description>&lt;p&gt;æœ¬æ–‡æ˜¯ Tetrate å³å°†å‡ºç‰ˆçš„ã€ŠIstio in Productionã€‹ä¸€ä¹¦ä¸­æ‘˜å½•çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œä½œè€…æ˜¯ Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcherã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥åˆ°è®¸å¤šå®æ–½ç½‘æ ¼çš„ä¼ä¸šçš„é—®é¢˜ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯â€œæˆ‘è¿˜éœ€è¦å“ªäº›æ§åˆ¶ï¼Œè€Œç½‘æ ¼æä¾›å“ªäº›æ§åˆ¶ï¼Ÿâ€æ¢å¥è¯è¯´ï¼Œä»–ä»¬æƒ³çŸ¥é“ç½‘æ ¼å¦‚ä½•é€‚åº”ç°æœ‰çš„å®‰å…¨æ¨¡å‹ã€‚æˆ‘ä»¬å‘ç°ï¼Œç½‘æ ¼æœ€é€‚åˆä½œä¸ºä¸€ç»„å®‰å…¨æ§åˆ¶çš„å†…åœˆï¼Œè¿™äº›æ§åˆ¶ä»ç‰©ç†ç½‘ç»œåˆ°åº”ç”¨æœ¬èº«çš„æ¯ä¸€å±‚éƒ½è¢«å®æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹&#34;&gt;æœåŠ¡ç½‘æ ¼ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°ç½‘æ ¼çš„ Sidecar ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹ï¼ˆ&lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204Bï¼šä½¿ç”¨æœåŠ¡ç½‘æ ¼çš„åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶&lt;/a&gt;ï¼‰ã€‚ç”±äºå®ƒæ‹¦æˆªäº†æ‰€æœ‰è¿›å‡ºåº”ç”¨ç¨‹åºçš„æµé‡ï¼ŒSidecar ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„ä½ç½®æ¥å®ç°å„ç§ç­–ç•¥ã€‚æˆ‘ä»¬å¯ä»¥å®ç°ä¼ ç»Ÿçš„å®‰å…¨ç­–ç•¥ï¼Œå¦‚åŸºäºåº”ç”¨ç¨‹åºæ ‡è¯†è€Œéç½‘ç»œä½ç½®çš„æ›´é«˜ä¿è¯çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„æˆæƒã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥å®æ–½ä¹‹å‰ä¸åˆ‡å®é™…æˆ–éœ€è¦ä¸åº”ç”¨ç¨‹åºæ·±åº¦å‚ä¸çš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œç½‘æ ¼å…è®¸æ‚¨ç¼–å†™ä»¥ä¸‹ç­–ç•¥ï¼šâ€œåç«¯å¯ä»¥ä»æ•°æ®åº“è¯»å–ï¼ˆä½¿ç”¨åº”ç”¨çº§èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒï¼‰ï¼Œä½†å‰ææ˜¯è¯·æ±‚å…·æœ‰æœ‰æ•ˆçš„æœ€ç»ˆç”¨æˆ·å‡­è¯å¹¶å…·æœ‰è¯»å–èŒƒå›´ï¼ˆä½¿ç”¨æœ€ç»ˆç”¨æˆ·èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒï¼‰ã€‚â€&lt;/p&gt;
&lt;p&gt;è™½ç„¶æœåŠ¡ç½‘æ ¼æä¾›äº†ä¸€ä¸ªå¼ºå¤§ï¼ŒåŠ¨æ€å’Œä¸€è‡´çš„å®‰å…¨åŸºçº¿ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸Šæ„å»ºåº”ç”¨ç¨‹åºå®‰å…¨æ¨¡å‹ï¼Œä½†ç½‘æ ¼æœ¬èº«æ°¸è¿œæ— æ³•æä¾›åº”ç”¨ç¨‹åºæ‰€éœ€çš„ 100% è¿è¡Œæ—¶å®‰å…¨ã€‚ä¾‹å¦‚ï¼Œç”±äº Sidecar ä½äºç”¨æˆ·ç©ºé—´ä¸­ï¼Œç½‘æ ¼åœ¨å‡è½»è®¸å¤šç±»å‹çš„ç½‘ç»œæ‹’ç»æœåŠ¡æ”»å‡»æ–¹é¢ä¸å¦‚ä¼ ç»Ÿé˜²ç«å¢™æœºåˆ¶ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºåŒæ ·çš„åŸå› ï¼Œç½‘æ ¼åœ¨å‡è½»è®¸å¤šåº”ç”¨çº§æ‹’ç»æœåŠ¡æ”»å‡»æ–¹é¢æ¯”ä¼ ç»ŸåŸºç¡€è®¾æ–½æ›´æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ä¸­é—´å±‚&#34;&gt;ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ä¸­é—´å±‚&lt;/h2&gt;
&lt;p&gt;ç½‘æ ¼ä½œä¸ºåŸºç¡€æ¶æ„çš„å¼ºå¤§ä¸­é—´å±‚ï¼šä½äºç‰©ç†ç½‘ç»œå’Œæ‰€å®æ–½çš„ L3/L4 æ§åˆ¶ä¹‹ä¸Šï¼Œä½†ä½äºåº”ç”¨ç¨‹åºä¹‹ä¸‹ã€‚è¿™å…è®¸æ›´è„†å¼±å’Œæ›´éš¾ä»¥æ”¹å˜çš„æ¾æ•£é…ç½® â€”â€” å…è®¸æ›´é«˜å±‚çš„æ›´å¤§æ•æ·æ€§ â€”â€” å› ä¸ºæ§åˆ¶ä½“ç³»åœ¨æ›´é«˜å±‚è¢«è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1å¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šå¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨ã€‚&#34; srcset=&#34;
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_hu5741568312191706807.webp 400w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_hu8876237653921869217.webp 760w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_hu6771484415775242092.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_hu5741568312191706807.webp&#34;
               width=&#34;760&#34;
               height=&#34;629&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šå¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç½‘æ ¼æä¾›çš„ä¸»è¦å®‰å…¨åŠŸèƒ½æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½œä¸º X.509 è¯ä¹¦çš„&lt;strong&gt;è¿è¡Œæ—¶èº«ä»½&lt;/strong&gt;ï¼Œç”¨äºåœ¨ä¼ è¾“æœŸé—´åŠ å¯†ï¼Œä»¥åŠæœåŠ¡ä¹‹é—´é€šä¿¡çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥æ‰§è¡Œç‚¹&lt;/strong&gt;ï¼Œç”¨äºåœ¨ç½‘æ ¼ä¸­çš„æ‰€æœ‰åº”ç”¨ç¨‹åºä¸Šå®æ–½ä¸€è‡´çš„æœ€ç»ˆç”¨æˆ·èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡èº«ä»½å’Œæœ€ç»ˆç”¨æˆ·èº«ä»½çš„&lt;strong&gt;è¿è¡Œæ—¶ç­–ç•¥æ‰§è¡Œ&lt;/strong&gt;ï¼ˆä¾‹å¦‚ï¼Œâ€œA åªèƒ½ä½¿ç”¨å…·æœ‰è¯»å–èŒƒå›´çš„æœ‰æ•ˆæœ€ç»ˆç”¨æˆ·å‡­è¯ä¸ B è¿›è¡Œé€šä¿¡â€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€Ÿç‡é™åˆ¶å’Œå¼¹æ€§åŠŸèƒ½&lt;/strong&gt;ï¼Œç”¨äºå‡è½»å¸¸è§çš„åº”ç”¨çº§æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå¹¶ä¿æŠ¤å…å—å¸¸è§çš„çº§è”æ•…éšœæ¨¡å¼çš„å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WAF&lt;/strong&gt; å’Œå…¶ä»–&lt;strong&gt;æ·±å±‚åŒ…æ£€æµ‹&lt;/strong&gt;åŠŸèƒ½ï¼Œç”¨äºå†…éƒ¨æµé‡ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨è¾¹ç¼˜ã€‚&lt;/li&gt;
&lt;li&gt;æ¥è‡ªç½‘æ ¼ä¸­æ‰€æœ‰åº”ç”¨ç¨‹åºçš„&lt;strong&gt;ä¸€è‡´çš„æ“ä½œé¥æµ‹&lt;/strong&gt;ï¼Œå¯ç”¨äºç†è§£ã€å®æ–½å’Œå®¡æ ¸å®‰å…¨ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰åŠ¨æ€è¿è¡Œæ—¶æ›´æ–°çš„&lt;strong&gt;ç­–ç•¥å³ä»£ç &lt;/strong&gt;ï¼ˆPolicy-as-codeï¼‰æ¨¡å‹ï¼Œç‹¬ç«‹äºåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼ä½œä¸ºåˆ†å±‚é˜²å¾¡çš„ä¸€éƒ¨åˆ†&#34;&gt;æœåŠ¡ç½‘æ ¼ä½œä¸ºåˆ†å±‚é˜²å¾¡çš„ä¸€éƒ¨åˆ†&lt;/h2&gt;
&lt;p&gt;è€ƒè™‘åˆ°ç½‘æ ¼çš„å®‰å…¨åŠŸèƒ½ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œç»„ç»‡é‡‡ç”¨å®ƒä½œä¸ºåˆ†å±‚é˜²å¾¡æ–¹æ³•çš„ä¸€éƒ¨åˆ†æ˜¯æœ€åˆç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2æ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šæ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘ã€‚&#34; srcset=&#34;
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu11741995221483951268.webp 400w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu167157080159797835.webp 760w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu10775568603085548571.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu11741995221483951268.webp&#34;
               width=&#34;760&#34;
               height=&#34;395&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šæ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;l3-å±‚çš„æ•æ·æ€§ç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥ä»¥åŠ-l7-çš„ç»†ç²’åº¦æ§åˆ¶&#34;&gt;L3 å±‚çš„æ•æ·æ€§ï¼šç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥ä»¥åŠ L7 çš„ç»†ç²’åº¦æ§åˆ¶&lt;/h2&gt;
&lt;p&gt;åœ¨è¾¹ç¼˜çš„ L3 æ§åˆ¶ï¼ˆå¦‚é˜²ç«å¢™ï¼‰åœ¨ç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥æ–¹é¢ä»ç„¶æœ‰æ•ˆï¼Œä½†é€šå¸¸ä¼šå‡æ…¢åº”ç”¨ç¨‹åºå¼€å‘æ•æ·æ€§ã€‚ç”±äºç½‘æ ¼æä¾›äº†ç»†ç²’åº¦çš„æœåŠ¡é—´æˆæƒï¼Œæ‰€ä»¥å¯ä»¥åœ¨ L3 ä¸Šè®¾ç½®æ›´å¹¿æ³›çš„ç­–ç•¥ï¼Œä¸ºå¹³å°ã€å®‰å…¨å’Œåº”ç”¨ç¨‹åºå›¢é˜Ÿæä¾›æ›´å¤šæ•æ·æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®æ–½å¯¹å¤–éƒ¨æœåŠ¡çš„è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚ç½‘æ ¼çš„å‡ºå£ä»£ç†ç‰¹åˆ«é€‚ç”¨äºå®æ–½åº”ç”¨ç¨‹åºåˆ°å¤–éƒ¨æœåŠ¡çš„æ§åˆ¶ï¼Œè€Œåªæœ‰å‡ºå£ä»£ç†æœ¬èº«è¢«å¤–å‡ºé˜²ç«å¢™ allow-listedï¼šè¿™ä¸ºå¹³å°æˆ–å®‰å…¨å›¢é˜Ÿåœ¨ç®¡ç†å“ªäº›åº”ç”¨ç¨‹åºå…è®¸ä¸ä¼ä¸šåŸºç¡€æ¶æ„ä¹‹å¤–çš„é€šä¿¡æä¾›äº†å¾ˆå¤šæ•æ·æ€§ï¼ŒåŒæ—¶ä¿æŒç°æœ‰çš„åŸºäºå‘¨ç•Œçš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åŠ å¯†å’ŒåŠ¨æ€è®¿é—®æ§åˆ¶ä»£æ›¿â€œå¯è¾¾æ€§å³æˆæƒâ€&lt;/strong&gt;ã€‚ç½‘æ ¼å¯ä»¥å¼€å§‹æœ‰æ•ˆåœ°å–ä»£ VPN å’ŒåŸºäº IPSec çš„ç½‘ç»œâ€œå¯è¾¾æ€§å³æˆæƒâ€æ¨¡å¼ï¼Œæä¾›ä¼ è¾“ä¸­çš„åŠ å¯†ï¼Œä»¥åŠæ¯ä¸ªåº”ç”¨è€Œä¸æ˜¯æ¯ä¸ªä¸»æœºçš„è®¤è¯å’Œæˆæƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;l4-å±‚çš„æ”¹è¿›æ›´æ‰å¹³å’Œæ˜“äºç®¡ç†çš„ç½‘ç»œå¾®åˆ†æ®µ&#34;&gt;L4 å±‚çš„æ”¹è¿›ï¼šæ›´æ‰å¹³å’Œæ˜“äºç®¡ç†çš„ç½‘ç»œå¾®åˆ†æ®µ&lt;/h2&gt;
&lt;p&gt;å¾®åˆ†æ®µä¹‹ç±»çš„æ§åˆ¶å¯ä»¥é€šè¿‡ç½‘æ ¼è¿›ä¸€æ­¥æ”¹è¿›ï¼šå°½ç®¡æˆ‘ä»¬å¯èƒ½å…è®¸æ•´ä¸ªï¼ˆå°ï¼‰å­ç½‘åœ¨åŸºäºåˆ†æ®µçš„ç­–ç•¥ä¸­è¿›è¡Œé€šä¿¡ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç½‘æ ¼æŒ‰æ–¹æ³•å’ŒåŠ¨è¯å¯¹å•ç‹¬çš„æœåŠ¡é—´é€šä¿¡è¿›è¡Œæ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¡¥å……ç°æœ‰çš„å¾®åˆ†æ®µåŒæ—¶å±•å¹³ç½‘ç»œ&lt;/strong&gt;ã€‚é€šè¿‡æä¾›ç»†ç²’åº¦çš„æœåŠ¡é—´æ§åˆ¶ï¼Œç½‘æ ¼å¾€å¾€ä¼šè¡¥å……ç°æœ‰çš„å¾®åˆ†æ®µç­–ç•¥ï¼ŒåŒæ—¶ä½¿å¾—ç»„ç»‡æ›´å®¹æ˜“ç®¡ç†çš„è¾ƒå¹³çš„ç½‘ç»œå¾—ä»¥é‡‡ç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨äº‘ç¯å¢ƒä¸­ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨å·¥ä½œè´Ÿè½½èº«ä»½å¯ç”¨ä¼ è¾“æœŸé—´çš„åŠ å¯†ï¼ˆmTLSï¼‰å’ŒæœåŠ¡çº§åˆ«è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚ä¼ è¾“å±‚å‡ ä¹æ€»æ˜¯å¤„ç†åŠ å¯†ä¼ è¾“ï¼Œç½‘æ ¼é€šè¿‡æ ¹æ® SPIFFE è§„èŒƒå‘å¸ƒå’Œè½®æ¢çŸ­æœŸï¼ˆ&amp;lt;24 å°æ—¶ï¼‰å·¥ä½œè´Ÿè½½èº«ä»½è¯ä¹¦æ¥ä¸ºåº”ç”¨ç¨‹åºå®ç°æ­¤åŠŸèƒ½ï¼Œä»è€Œå…è®¸ä¼ è¾“æœŸé—´çš„åŠ å¯†ä»¥åŠæœåŠ¡çº§åˆ«çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;l7-å±‚çš„å¢å¼ºæ— å¤„ä¸åœ¨çš„è¾¹ç¼˜å’Œè®¿é—®æ§åˆ¶&#34;&gt;L7 å±‚çš„å¢å¼ºï¼šæ— å¤„ä¸åœ¨çš„è¾¹ç¼˜å’Œè®¿é—®æ§åˆ¶&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæ‰€æœ‰æµé‡æä¾›è¾¹ç¼˜æ§åˆ¶&lt;/strong&gt;ã€‚L7 æ§åˆ¶ï¼Œå¦‚ Web åº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWAFï¼‰ä»¥åŠâ€œAPI ç½‘å…³åŠŸèƒ½â€ï¼ˆå¦‚æµé‡é™åˆ¶ï¼‰å‡ ä¹æ€»æ˜¯åœ¨è¾¹ç¼˜å®æ–½ã€‚ç½‘æ ¼å¯ä»¥é€šè¿‡ä¸ºç½‘æ ¼ä¸­æ‰€æœ‰æµé‡ï¼ˆåŒ…æ‹¬å†…éƒ¨çš„â€œä¸œè¥¿â€é€šä¿¡ï¼‰å¯ç”¨ç›¸åŒçš„åŠŸèƒ½æ¥å¢å¼ºè¿™äº›ç°æœ‰éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç®€åŒ–åº”ç”¨ç¨‹åºçš„è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚é™¤äº†ä½¿è¾¹ç¼˜æ§åˆ¶æ— å¤„ä¸åœ¨ä¹‹å¤–ï¼Œç½‘æ ¼è¿˜å¯ä»¥åœ¨åº”ç”¨ç¨‹åºçœ‹åˆ°è¯·æ±‚ä¹‹å‰æ‰§è¡Œç«¯ç”¨æˆ·èº«ä»½éªŒè¯å’Œç²—ç²’åº¦æˆæƒï¼Œä»è€Œå¤§å¤§ç®€åŒ–åº”ç”¨ç¨‹åºæœ¬èº«å¿…é¡»æ‰§è¡Œçš„è®¿é—®æ§åˆ¶ã€‚åœ¨æœªæ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¶Šæ¥è¶Šå¤šçš„è®¿é—®æ§åˆ¶åŠŸèƒ½ä»åº”ç”¨ç¨‹åºè¿ç§»åˆ°ç½‘æ ¼ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“å’Œå±•æœ›&#34;&gt;æ€»ç»“å’Œå±•æœ›&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬è®¤ä¸ºï¼ŒæœåŠ¡ç½‘æ ¼æœ€é€‚åˆä½œä¸ºç°æœ‰å®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡åœ¨ä¼ ç»Ÿå®‰å…¨æ§åˆ¶ä¹‹ä¸Šæ·»åŠ æ›´ç»†ç²’åº¦çš„å®‰å…¨ç­–ç•¥æ¥å®ç°ã€‚ä½œä¸ºä¸€ä¸ªé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹ï¼Œç½‘æ ¼åœ¨æ›´æ”¹æœ€å›°éš¾çš„è¾ƒä½å±‚æä¾›äº†æ›´æ¾æ•£çš„ç­–ç•¥ï¼Œå°†æ•æ·æ€§æ¨å‘å †æ ˆçš„é¡¶éƒ¨ï¼Œå…¶ä¸­æ›´å¤šçš„ä¸Šä¸‹æ–‡å…è®¸åœ¨æ›´é«˜å±‚å®ç°æ›´ç‰¹å®šçš„æ§åˆ¶ã€‚è¿™ç§å¼ºå¤§çš„å®‰å…¨å±‚å¯¹äºå¤§å¤šæ•°ç»„ç»‡æ¥è¯´éƒ½æ˜¯é‡‡ç”¨åˆ†å±‚é˜²å¾¡æ·±åº¦æ–¹æ³•çš„æœ€ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¥ä¸‹æ¥æœåŠ¡ç½‘æ ¼éƒ¨ç½²æœ€ä½³å®è·µ&#34;&gt;æ¥ä¸‹æ¥ï¼šæœåŠ¡ç½‘æ ¼éƒ¨ç½²æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—åšå®¢æ–‡ç« çš„ä¸‹ä¸€ç¯‡å°†è®¨è®ºéƒ¨ç½²æ‹“æ‰‘ã€‚åœ¨å¤šä¸ªé›†ç¾¤çš„çœŸå®åŸºç¡€æ¶æ„ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼æ—¶å­˜åœ¨ä¸€äº›ç§»åŠ¨éƒ¨åˆ†ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°ç ”ç©¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ§åˆ¶å¹³é¢åº”å¦‚ä½•éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºé™„è¿‘ã€‚&lt;/li&gt;
&lt;li&gt;åº”è¯¥å¦‚ä½•éƒ¨ç½²å…¥å£ï¼Œä»¥ä¿ƒè¿›å®‰å…¨å’Œæ•æ·æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚ä½•ä½¿ç”¨ Envoy ä¿ƒè¿›è·¨é›†ç¾¤çš„è´Ÿè½½å¹³è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;è¯ä¹¦åœ¨ç½‘æ ¼ä¸­åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰æœåŠ¡ç½‘æ ¼å’Œ Kubernetes å®‰å…¨æ€§ï¼Œæˆ‘ä»¬åœ¨ &lt;a href=&#34;https://tetr8.io/academy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Academy&lt;/a&gt; æä¾›äº†ä¸€ç³»åˆ—å…è´¹åœ¨çº¿è¯¾ç¨‹ï¼Œå¯ä»¥è®©æ‚¨å¿«é€Ÿäº†è§£ Istio å’Œ Envoyã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ç§å¿«é€Ÿå°† Istio æŠ•å…¥ç”Ÿäº§çš„æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distribution (TID)&lt;/a&gt;ã€‚TID æ˜¯ Tetrate çš„å¼ºåŒ–ã€å®Œå…¨ä¸Šæ¸¸çš„ Istio å‘è¡Œç‰ˆï¼Œå…·æœ‰ç»è¿‡ FIPS éªŒè¯çš„æ„å»ºå’Œæ”¯æŒã€‚è¿™æ˜¯å¼€å§‹ä½¿ç”¨ Istio çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºæ‚¨çŸ¥é“æ‚¨æœ‰ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„å‘è¡Œç‰ˆï¼Œæœ‰ä¸€ä¸ªæ”¯æŒæ‚¨çš„ä¸“å®¶å›¢é˜Ÿï¼Œå¹¶ä¸”å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥é€‰æ‹©å¿«é€Ÿè·å¾— FIPS åˆè§„æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å¯åŠ¨å¹¶è¿è¡Œ Istioï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´ç®€å•çš„æ–¹æ³•æ¥ç®¡ç†å’Œä¿æŠ¤æ‚¨çš„æœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ Istio ä¸­å¯ç”¨çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ Tetrate Service Bridge çš„ç”¨æ­¦ä¹‹åœ°ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://tetr8.io/tsb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨è¿™é‡Œ&lt;/a&gt;è¯¦ç»†äº†è§£ Tetrate Service Bridge å¦‚ä½•ä½¿æœåŠ¡ç½‘æ ¼æ›´å®‰å…¨ã€æ›´æ˜“äºç®¡ç†å’Œå¼¹æ€§ï¼Œæˆ–&lt;a href=&#34;https://tetr8.io/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬è¿›è¡Œå¿«é€Ÿæ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åœ¨ç”Ÿäº§ä¸­å¤§è§„æ¨¡è‡ªåŠ¨åŒ– Istio CA è½®æ¢</title>
      <link>https://cloudnativecn.com/blog/automate-istio-ca-rotation-in-production-at-scale/</link>
      <pubDate>Tue, 20 Dec 2022 14:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/automate-istio-ca-rotation-in-production-at-scale/</guid>
      <description>&lt;p&gt;Istio çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€æ˜¯é€šè¿‡ç®¡ç†ç½‘æ ¼ä¸­æœåŠ¡çš„èº«ä»½æ¥ä¿ƒè¿›é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„ã€‚ä¸ºäº†åœ¨ç½‘æ ¼ä¸­æ£€ç´¢ç”¨äº mTLS é€šä¿¡çš„æœ‰æ•ˆè¯ä¹¦ï¼Œå„ä¸ªå·¥ä½œè´Ÿè½½å‘ &lt;em&gt;istiod&lt;/em&gt; å‘å‡ºè¯ä¹¦ç­¾åè¯·æ±‚ (CSR)ã€‚Istiod åè¿‡æ¥éªŒè¯è¯·æ±‚å¹¶ä½¿ç”¨è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç­¾ç½² CSR ä»¥ç”Ÿæˆè¯ä¹¦&lt;/a&gt;ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio ä¸ºæ­¤ç›®çš„ä½¿ç”¨è‡ªå·±çš„è‡ªç­¾å CAï¼Œä½†æœ€ä½³å®è·µæ˜¯é€šè¿‡ä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºä¸€ä¸ªä¸­é—´ CAï¼Œ&lt;a href=&#34;https://cloudnativecn.com/blog/istio-trust/&#34;&gt;å°† Istio é›†æˆåˆ°æ‚¨ç°æœ‰çš„ PKI ä¸­&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨ç®¡ç†å¤šä¸ªé›†ç¾¤ï¼Œè¿™æ„å‘³ç€é¢å‘å¤šä¸ªä¸­é—´ CAï¼Œæ¯ä¸ªä¸­é—´ CA éƒ½åº”è®¾ç½®ä¸ºåœ¨å‡ ä¸ªæœˆæˆ–æ›´çŸ­çš„æ—¶é—´å†…åˆ°æœŸã€‚ç®¡ç†è¿™äº› CA çš„ç”Ÿå‘½å‘¨æœŸè‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»¬å¿…é¡»åœ¨è¿‡æœŸæˆ–åäº‹å‘ç”Ÿä¹‹å‰è¿›è¡Œè½®æ¢ã€‚æœ¬æ–‡å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ç®€åŒ–æ­¤ CA ç®¡ç†ä»¥&lt;strong&gt;é™ä½é£é™©&lt;/strong&gt;å¹¶&lt;strong&gt;æé«˜ç³»ç»Ÿçš„æ•´ä½“ç¨³å®šæ€§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è½®æ¢ CA æ—¶çš„ä¸€ä¸ªå…³é”®æ­¥éª¤æ˜¯ç¡®ä¿å®é™…ä½¿ç”¨æ–°çš„ CAã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio ä»…åœ¨å¯åŠ¨æ—¶åŠ è½½å…¶ CAã€‚ä½†æ˜¯ï¼ŒIstio å¯ä»¥é…ç½®ä¸ºç›‘è§†æ›´æ”¹å¹¶åœ¨æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAã€‚æœ¬æ•™ç¨‹å–è‡ªæˆ‘ä»¬ä¸ç®¡ç†å¤§é‡ Istio éƒ¨ç½²çš„ä¼ä¸šå®¢æˆ·åˆä½œå¼€å‘çš„ç”Ÿäº§æ‰‹å†Œï¼Œå°†å±•ç¤ºå¦‚ä½•é…ç½® Istio ä»¥è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAã€‚æˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•é…ç½® &lt;a href=&#34;https://cert-manager.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cert-manager&lt;/a&gt; ä»¥åœ¨ Istio çš„ä¸­é—´ CA åˆ°æœŸå‰å®šæœŸè‡ªåŠ¨è½®æ¢ï¼Œä»¥&lt;strong&gt;æé«˜åœ¨å¤šä¸ªé›†ç¾¤ä¸Šç®¡ç† CA çš„æ“ä½œæ•ˆç‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;å¯¹äºæœ¬æ•™ç¨‹ï¼Œæ‚¨è‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ Kubernetes é›†ç¾¤ã€‚åƒ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;minikube&lt;/a&gt; æˆ–ç±»ä¼¼çš„ç®€åŒ–çš„ Kubernetes å®‰è£…é€‚ç”¨äºæ¼”ç¤ºç›®çš„ï¼›&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cert-manager.io/docs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istioctl&lt;/a&gt; v1.14.2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼›&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cert-manager.io/docs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cert-manager&lt;/a&gt; v1.7.2 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä»»åŠ¡-aå®‰è£…å’Œé…ç½®-cert-manager-ä»¥è‡ªåŠ¨è½®æ¢-istio-çš„-ca&#34;&gt;ä»»åŠ¡ Aï¼šå®‰è£…å’Œé…ç½® cert-manager ä»¥è‡ªåŠ¨è½®æ¢ Istio çš„ CA&lt;/h2&gt;
&lt;h3 id=&#34;æ­¥éª¤-a1å®‰è£…è¯ä¹¦ç®¡ç†å™¨&#34;&gt;æ­¥éª¤ A1ï¼šå®‰è£…è¯ä¹¦ç®¡ç†å™¨&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å°†åœ¨æ‚¨çš„é›†ç¾¤ä¸­å®‰è£… cert-managerã€‚è¦å®‰è£…æ›´æ–°ç‰ˆæœ¬çš„è¯ä¹¦ç®¡ç†å™¨ï¼Œè¯·æ›´æ”¹ GitHub URLã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.10.1/cert-manager.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-a2é…ç½®-ca&#34;&gt;æ­¥éª¤ A2ï¼šé…ç½® CA&lt;/h3&gt;
&lt;p&gt;å‡ºäºæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªè‡ªç­¾å CAï¼Œä½†&lt;strong&gt;ä¸è¦åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è‡ªç­¾å CA&lt;/strong&gt;ã€‚å‡ºäºç”Ÿäº§ç›®çš„ï¼Œæ‚¨åº”è¯¥ &lt;a href=&#34;https://tetrate.io/blog/istio-trust/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† cert-manager é…ç½®ä¸ºä½¿ç”¨ç°æœ‰çš„ PKI&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Issuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  selfSigned: {}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 21600h # 900d
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: certmanager-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  subject:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    organizations:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      - cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: Issuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  ca:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    secretName: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-a3ä¸º-istio-é…ç½®ä¸­é—´-ca&#34;&gt;æ­¥éª¤ A3ï¼šä¸º Istio é…ç½®ä¸­é—´ CA&lt;/h3&gt;
&lt;p&gt;è®¾ç½®ä¸­é—´ CA Istio å°†ç”¨äºç­¾ç½²å·¥ä½œè´Ÿè½½è¯ä¹¦ï¼Œè®¾ç½®ä¸ºæ¯ 60 å¤©ï¼ˆ1440 å°æ—¶ï¼‰è¯ä¹¦è½®æ¢ä¸€æ¬¡ï¼Œå¹¶åœ¨ 15 å¤©ï¼ˆ360 å°æ—¶ï¼‰åˆ°æœŸå‰æ›´æ–°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create namespace istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 1440h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  renewBefore: 360h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  usages:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - digital signature
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - key encipherment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - cert sign
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  dnsNames:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šCert-manager å°†è¯ä¹¦å’Œå¯†é’¥å…¬å¼€ä¸º &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/secret/#secret-types&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;kubernetes.io/tls&lt;/code&gt; Secret&lt;/a&gt;ã€‚Istio å¯ä»¥ä½¿ç”¨ä» &lt;a href=&#34;https://istio.io/latest/news/releases/1.14.x/announcing-1.14.2/#changes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;1.14.2 ç‰ˆæœ¬&lt;/a&gt;å¼€å§‹çš„ &lt;code&gt;kubernetes.io/tls&lt;/code&gt; ç±»å‹çš„ Secretã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»»åŠ¡-bå®‰è£…å’Œé…ç½®-istio-ä»¥è‡ªåŠ¨æ›´æ–°å…¶-ca&#34;&gt;ä»»åŠ¡ Bï¼šå®‰è£…å’Œé…ç½® Istio ä»¥è‡ªåŠ¨æ›´æ–°å…¶ CA&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt; å®‰è£… Istioã€‚ä»¥ä¸‹ IstioOperator é…ç½®è®¾ç½®ç¯å¢ƒå˜é‡&lt;code&gt;AUTO_RELOAD_PLUGIN_CERTS=true&lt;/code&gt; ä»¥ä½¿ Istio åœ¨æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl operator init
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | istioctl apply --skip-confirmation -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: install.istio.io/v1alpha1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: IstioOperator
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: demo-istio-install
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  profile: demo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  components:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    pilot:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      k8s:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        env:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        - name: AUTO_RELOAD_PLUGIN_CERTS
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;          value: &amp;#34;true&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä»»åŠ¡-cé…ç½®å’ŒéªŒè¯-istio-çš„ä¸­é—´-ca-è½®æ¢&#34;&gt;ä»»åŠ¡ Cï¼šé…ç½®å’ŒéªŒè¯ Istio çš„ä¸­é—´ CA è½®æ¢&lt;/h2&gt;
&lt;h3 id=&#34;æ­¥éª¤-c1é…ç½®è½®æ¢ä¸­é—´-ca&#34;&gt;æ­¥éª¤ C1ï¼šé…ç½®è½®æ¢ä¸­é—´ CA&lt;/h3&gt;
&lt;p&gt;å‡è®¾éœ€æ±‚å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦å°† CA è½®æ¢å‘¨æœŸä» 60 å¤©ï¼ˆ1440 å°æ—¶ï¼‰ç¼©çŸ­åˆ° 30 å¤©ï¼ˆ720 å°æ—¶ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 720h 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  renewBefore: 360h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  usages:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - digital signature
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - key encipherment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - cert sign
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  dnsNames:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-c2éªŒè¯æ–°çš„ä¸­é—´-ca-æ˜¯å¦å·²é‡æ–°åŠ è½½&#34;&gt;æ­¥éª¤ C2ï¼šéªŒè¯æ–°çš„ä¸­é—´ CA æ˜¯å¦å·²é‡æ–°åŠ è½½&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—åº”è¯¥ä¼šæ˜¾ç¤º CA æ›´æ”¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl logs -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -n istio-system -f
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨åº”è¯¥åœ¨æ—¥å¿—è¾“å‡ºä¸­çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;2022-08-11T20:18:41.493247Z	info	Update Istiod cacerts
2022-08-11T20:18:41.493483Z	info	Using kubernetes.io/tls secret type for signing ca files
2022-08-11T20:18:41.716843Z	info	Istiod has detected the newly added intermediate CA and updated its key and certs accordingly
2022-08-11T20:18:41.717170Z	info	x509 cert - Issuer: &amp;#34;CN=istiod.istio-system.svc&amp;#34;, Subject: &amp;#34;&amp;#34;, SN: 1c43c1686425ee2e63f2db90bd3cf17f, NotBefore: &amp;#34;2022-08-11T20:16:41Z&amp;#34;, NotAfter: &amp;#34;2032-08-08T20:18:41Z&amp;#34;
2022-08-11T20:18:41.717220Z	info	x509 cert - Issuer: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, Subject: &amp;#34;CN=istiod.istio-system.svc&amp;#34;, SN: c172b51eeb4a2891fe66f30babb42bb0, NotBefore: &amp;#34;2022-08-11T20:17:25Z&amp;#34;, NotAfter: &amp;#34;2022-08-13T20:17:25Z&amp;#34;
2022-08-11T20:18:41.717254Z	info	x509 cert - Issuer: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, Subject: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, SN: ea1760f2dcf9806a8c997c4bc4b2fb30, NotBefore: &amp;#34;2022-08-11T20:13:33Z&amp;#34;, NotAfter: &amp;#34;2025-01-27T20:13:33Z&amp;#34;
2022-08-11T20:18:41.717256Z	info	Istiod certificates are reloaded
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä½¿ç”¨ cert-manager æ¥è‡ªåŠ¨åŒ– Istio CA è½®æ¢å¯ä»¥è½»æ¾é«˜æ•ˆåœ°å¤„ç†å…³é”®æ“ä½œåŠŸèƒ½ã€‚å°† Istio é…ç½®ä¸ºè‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CA æ— éœ€æ‰‹åŠ¨é‡å¯ Istioï¼Œä»è€Œæ¶ˆé™¤äº†æ½œåœ¨çš„äººä¸ºé”™è¯¯æ¥æºã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œå¯ç”¨äºå®æ–½é›¶ä¿¡ä»»å®‰å…¨å®è·µå¹¶å¤§è§„æ¨¡æé«˜ä¸šåŠ¡æ•æ·æ€§å’Œè¿ç»­æ€§ã€‚ä¸ºæœåŠ¡ç½‘æ ¼å»ºç«‹æœ‰æ•ˆçš„è¿è¥å®è·µå¯¹äºåˆ©ç”¨è¿™ç§åŠ›é‡è‡³å…³é‡è¦ã€‚ä½œä¸º Istio å’Œ Envoy çš„åˆ›å§‹äººå’Œæ ¸å¿ƒè´¡çŒ®è€…ï¼Œæˆ‘ä»¬ Tetrate æ¯å¤©éƒ½åœ¨å¸®åŠ©æˆ‘ä»¬çš„å®¢æˆ·åšåˆ°è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å°† Istio çº³å…¥ä¿¡ä»»é“¾ï¼šä½¿ç”¨ç°æœ‰ PKI ä½œä¸ºä¿¡ä»»æ ¹</title>
      <link>https://cloudnativecn.com/blog/istio-trust/</link>
      <pubDate>Tue, 20 Dec 2022 11:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/istio-trust/</guid>
      <description>&lt;p&gt;å½“æˆ‘ä»¬ä¸æƒ³è¦ä½¿ç”¨ Istio çš„å®¢æˆ·æˆ–ç”¨æˆ·äº¤æµæ—¶ï¼Œè¿™ä¸€ä¸ªé—®é¢˜æ—¶é•¿ä¼šå‡ºç°â€”â€”Istio ä¸­çš„è¯ä¹¦ä¿¡ä»»å¦‚ä½•å·¥ä½œçš„ï¼ŸIstio æœ‰è‡ªå·±çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œè€Œæˆ‘ä»¬ä¹Ÿæœ‰è‡ªå·±çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œå¦‚ä½•ç¡®ä¿å®ƒä»¬ç›¸äº’ä¿¡ä»»ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œé€šè¿‡ä¸­é—´ç­¾åè¯ä¹¦å°† Istio çº³å…¥åˆ°æ‚¨ç°æœ‰çš„ä¿¡ä»»é“¾ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨ä½¿ç”¨ Istio ä½œä¸ºæ¼”ç¤ºæˆ–å¼€ç®±å³ç”¨ï¼Œå®ƒå°†æ‹¥æœ‰è‡ªå·±çš„è‡ªç­¾åè¯ä¹¦ â€”â€” å®ƒæ˜¯è‡ªå·±çš„æ ¹è¯ä¹¦ã€‚å¯¹äºåœ¨å¤šä¸ªé›†ç¾¤ä¸­è¿è¡Œ Istio çš„ç”¨æˆ·æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ç—›ç‚¹ï¼šä»–ä»¬æ— æ„ä¸­åˆ›å»ºäº†ä¸¤ä¸ªäº’ä¸ä¸ä¿¡ä»»çš„å­¤å²›ï¼Œå› æ­¤æ²¡æœ‰å®‰å…¨é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯å¦‚ä½•é€šè¿‡è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKI çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç®€è¿°&#34;&gt;ç®€è¿°&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ç®€çŸ­çš„ç‰ˆæœ¬ï¼šæ‚¨åº”è¯¥é€šè¿‡ä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºä¸€ä¸ªä¸­é—´ç­¾åè¯ä¹¦æ¥è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKIï¼ˆå¹¶ä¸”æ¯ä¸ªé›†ç¾¤åº”è¯¥æœ‰ä¸€ä¸ª Istio éƒ¨ç½²ï¼‰ã€‚ç„¶åä½ ä¼šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ç”¨è·¨ Istio éƒ¨ç½²çš„é€šä¿¡&lt;/li&gt;
&lt;li&gt;å…è®¸ç»†ç²’åº¦çš„è¯ä¹¦æ’¤é”€ï¼Œè€Œæ— éœ€åŒæ—¶åœ¨æ•´ä¸ªåŸºç¡€æ¶æ„ä¸­å¼ºåˆ¶ä½¿ç”¨æ–°è¯ä¹¦ï¼ˆå¦‚æœè¿™å¬èµ·æ¥åƒæ˜¯ç­‰å¾…å‘ç”Ÿçš„é‡å¤§ä¸­æ–­ï¼Œé‚£ä¹ˆæ‚¨æ˜¯å¯¹çš„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨ç­¾åè¯ä¹¦çš„è½»æ¾è½®æ¢ã€‚æ‚¨éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸­é—´ä»¶å¹¶ä½¿ç”¨æ–°è¯ä¹¦é‡æ–°å¯åŠ¨ Istioã€‚å› ä¸ºå®ƒåœ¨åŒä¸€ä¸ªä¿¡ä»»æ ¹ä¸­ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½ç»§ç»­å·¥ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Istio å¿…é¡»é€‚åº”æ‚¨ç°æœ‰çš„æ¶æ„ï¼Œä»¥åœ¨ç»„ç»‡å†…å®ç°å¢é‡é‡‡ç”¨ â€”â€” ä½¿ç½‘æ ¼é€‚åº”æ‚¨çš„ç»„ç»‡ï¼Œè€Œä¸æ˜¯è®©ç»„ç»‡æ¥é€‚åº”ç½‘æ ¼ã€‚ä»äº†è§£å¯¹ä¸­é—´è¯ä¹¦ç­¾åå¯†é’¥çš„éœ€æ±‚å¼€å§‹ï¼Œå°†ä¸ºæ‚¨çš„æˆåŠŸåšå¥½å‡†å¤‡ï¼Œå¹¶ä½¿ä»»ä½•åŸºç¡€æ¶æ„æˆ–ç¯å¢ƒæ›´æ”¹æ›´åŠ é¡ºåˆ©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯¦è¿°&#34;&gt;è¯¦è¿°&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¯ä¹¦éªŒè¯çš„è¿‡ç¨‹ã€‚åœ¨åŸºæœ¬è¯ä¹¦ä¸­ï¼Œè¯ä¹¦æ£€æŸ¥ä»ä¿¡ä»»æ ¹å¼€å§‹ï¼Œå‘ä¸‹å»¶ä¼¸åˆ°ç‰¹å®šèº«ä»½ï¼ˆå¶å­ï¼‰ã€‚è¯ä¹¦è·¯å¾„éªŒè¯ç®—æ³•æ˜¯æˆ‘ä»¬ç¡®ä¿è¯ä¹¦å¯ä¿¡çš„æ–¹å¼ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ TLS ç­‰å®‰å…¨åè®®è¿æ¥åˆ°å¦ä¸€å°æœºå™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå‘æˆ‘ä»¬æä¾›éƒ¨åˆ†æˆ–å…¨éƒ¨è¯ä¹¦é“¾ä»¥è¯æ˜å…¶èº«ä»½ã€‚å¦‚æœé“¾ä¸­çš„è¯ä¹¦è¢«ç¡®å®šä¸ºæ— æ•ˆï¼Œåˆ™è¯ä¹¦é“¾å°†è¢«æ‹’ç»ä¸”ä¸ä¼šå»ºç«‹ä¿¡ä»»ã€‚å¦‚æœæˆ‘ä»¬é¡ºåˆ©åˆ°è¾¾é“¾çš„æœ«ç«¯ï¼Œåˆ™è·¯å¾„ï¼ˆä»¥åŠè¯ä¹¦ï¼‰æ˜¯æœ‰æ•ˆçš„ã€‚æˆåŠŸï¼æˆ‘ä»¬å¯ä»¥ä¿¡ä»»æœåŠ¡å™¨ï¼&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¸¦æœ‰å¶è¯ä¹¦ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾æˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶æˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¸¦æœ‰å¶è¯ä¹¦ã€ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾ã€‚æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾ï¼Œæˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†ï¼›åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f1_hu12484447986505957912.webp 400w,
               /blog/istio-trust/f1_hu14221522728201107513.webp 760w,
               /blog/istio-trust/f1_hu900158926134756303.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/istio-trust/f1_hu12484447986505957912.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¸¦æœ‰å¶è¯ä¹¦ã€ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾ã€‚æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾ï¼Œæˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†ï¼›åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“ TLS æ¡æ‰‹æ—¶ï¼Œè·¯å¾„éªŒè¯ç®—æ³•ä¸å…³å¿ƒæœ‰å¤šå°‘è¯ä¹¦é“¾é©»ç•™åœ¨æˆ‘ä»¬çš„ä¿¡ä»»åŒ…ä¸­ã€‚åŸºäºæˆ‘ä»¬å¸¦æ¥çš„å’Œä»–ä»¬æä¾›çš„è¯ä¹¦ï¼Œå®ƒåªå…³å¿ƒæˆ‘ä»¬èƒ½å¦æ„å»ºä¸€æ¡ä»æœåŠ¡å™¨çš„å¶èŠ‚ç‚¹åˆ°æˆ‘ä»¬çš„æ†ç»‘åŒ…ä¸­çš„ä¿¡ä»»æ ¹çš„é“¾ã€‚ä¸Šé¢çš„ç¤ºä¾‹æ˜¾ç¤ºéªŒè¯å‘ç”Ÿåœ¨è¯ä¹¦äº¤æ¢ä¸­ï¼Œè¿™è¶³ä»¥è®©å¶å­åœ¨è¯ä¹¦é¢å‘æœºæ„ä¸­æ‰¾åˆ°å®ƒçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ Istio æ—¶ï¼Œæ‚¨å°†æ‹¥æœ‰å¤šä¸ªå¶èŠ‚ç‚¹å’Œä¸­é—´èŠ‚ç‚¹ï¼Œä½†&lt;strong&gt;åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å…·æœ‰æ ¹ä¸‰ä¸ªä¸­é—´ç­¾å-ca-å’Œå››ä¸ªå¶è¯ä¹¦ç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘çš„-pki-è¯ä¹¦æ ‘&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å…·æœ‰æ ¹ã€ä¸‰ä¸ªä¸­é—´ç­¾å CA å’Œå››ä¸ªå¶è¯ä¹¦ï¼ˆç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘ï¼‰çš„ PKI è¯ä¹¦æ ‘ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f2_hu9467875276380172070.webp 400w,
               /blog/istio-trust/f2_hu9139830443257586408.webp 760w,
               /blog/istio-trust/f2_hu3745526770017836219.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/istio-trust/f2_hu9467875276380172070.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å…·æœ‰æ ¹ã€ä¸‰ä¸ªä¸­é—´ç­¾å CA å’Œå››ä¸ªå¶è¯ä¹¦ï¼ˆç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘ï¼‰çš„ PKI è¯ä¹¦æ ‘ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦åœ¨ç°æœ‰ PKI ä¸­å»ºç«‹ä¿¡ä»»ï¼Œå› ä¸ºæœ‰ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦å¥½å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥åœ¨ Istio éƒ¨ç½²ä¹‹é—´çš„äº¤å‰é€šä¿¡&lt;/li&gt;
&lt;li&gt;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&lt;/li&gt;
&lt;li&gt;è½»æ¾è½®æ¢è¯ä¹¦&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è·¨-istio-éƒ¨ç½²çš„é€šä¿¡&#34;&gt;è·¨ Istio éƒ¨ç½²çš„é€šä¿¡&lt;/h3&gt;
&lt;p&gt;å¯¹äº Istioï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç¡®ä¿è·¨éƒ¨ç½²çš„é€šä¿¡ â€”â€” ç®€å•çš„æ–¹æ³•å’Œå›°éš¾çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å›°éš¾çš„æ–¹æ³•æ¶‰åŠ Istio è¿ç»´äººå‘˜é‡‡å–è€—æ—¶ã€å¤æ‚ä¸”æ˜‚è´µçš„æ­¥éª¤æ¥ç¡®ä¿ä¸¤ä¸ªæ ¹åŒæ—¶åœ¨å¦ä¸€ä¸ªçš„è¯ä¹¦é¢å‘æœºæ„ (CA) æ†ç»‘åŒ…ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨-ca-æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†åˆ™æ¥è‡ªæ¯ä¸ª-citadel-çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨ CA æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»ã€‚å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™æ¥è‡ªæ¯ä¸ª Citadel çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f3_hu1193476171751369487.webp 400w,
               /blog/istio-trust/f3_hu7531835841719424587.webp 760w,
               /blog/istio-trust/f3_hu3088374252620333170.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/istio-trust/f3_hu1193476171751369487.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨ CA æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»ã€‚å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™æ¥è‡ªæ¯ä¸ª Citadel çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç®€å•çš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªéƒ¨ç½²ä½¿ç”¨å•ç‹¬çš„ä¸­é—´ç­¾åè¯ä¹¦éƒ¨ç½² Istioï¼Œæ‰€æœ‰è¿™äº›è¯ä¹¦éƒ½å…±äº«ç›¸åŒçš„æ ¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å½“-citadel-ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹-pki-çš„ä¸­é—´è¯ä¹¦æ—¶æœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„-pki-æ ‘ä½†ä¸­é—´-ca-è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„-citadel-å®ä¾‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å½“ Citadel ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹ PKI çš„ä¸­é—´è¯ä¹¦æ—¶ï¼Œæœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„ PKI æ ‘ï¼Œä½†ä¸­é—´ CA è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„ Citadel å®ä¾‹ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f4_hu8657295824174883243.webp 400w,
               /blog/istio-trust/f4_hu4373984214119558952.webp 760w,
               /blog/istio-trust/f4_hu8389756125244656942.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/istio-trust/f4_hu8657295824174883243.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å½“ Citadel ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹ PKI çš„ä¸­é—´è¯ä¹¦æ—¶ï¼Œæœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„ PKI æ ‘ï¼Œä½†ä¸­é—´ CA è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„ Citadel å®ä¾‹ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“æ¶‰åŠåˆ°ç»†ç²’åº¦æ’¤é”€å’Œè¯ä¹¦è½®æ¢æ—¶ï¼Œè¿™ä¸€å†³å®šçš„è¿é”ååº”æ˜¯å·¨å¤§çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&#34;&gt;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&lt;/h3&gt;
&lt;p&gt;æ’¤é”€è¯ä¹¦ä¼šå°†è¯ä¹¦æ ‡è®°ä¸ºä¸å†å—ä¿¡ä»»ã€‚å½“è¯ä¹¦è·¯å¾„éªŒè¯ç®—æ³•ä»å¶èŠ‚ç‚¹èµ°åˆ°æ ¹èŠ‚ç‚¹æ—¶ï¼Œä¼šå¯¹æ¯ä¸ªè¯ä¹¦è¿›è¡ŒåŠé”€çŠ¶æ€æ£€æŸ¥ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿæ’¤é”€å¯¹å•ä¸ªç»„ä»¶æˆ–æ•´ä¸ªéƒ¨ç½²éƒ¨åˆ†çš„ä¿¡ä»»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„-pki-æ ‘æˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´-ca-å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„ PKI æ ‘ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´ CA å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆã€‚&#34; srcset=&#34;
               /blog/istio-trust/f5_hu4878184108245645887.webp 400w,
               /blog/istio-trust/f5_hu2713590172270882959.webp 760w,
               /blog/istio-trust/f5_hu10084502630071455927.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/istio-trust/f5_hu4878184108245645887.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„ PKI æ ‘ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´ CA å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºå¦‚æœç­¾åå¯†é’¥è¢«æ³„éœ²ï¼Œæ¶æ„è¡Œä¸ºè€…å¯èƒ½ä¼šé€šè¿‡å‡ºç¤ºæ‚¨çš„å®¢æˆ·è®¤ä¸ºæ˜¯æœ‰æ•ˆè¯ä¹¦æ¥å†’å……æ‚¨çš„æœåŠ¡å™¨ã€‚è¿™åœ¨ Istio ä¸­æ›´ä¸ºé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨è¯ä¹¦æ¥è¯†åˆ«å½¼æ­¤çš„å·¥ä½œè´Ÿè½½ â€”â€” æ”»å‡»è€…å¯ä»¥ä¼ªè£…æˆæ‚¨ç½‘æ ¼ä¸­çš„ä»»ä½•æœåŠ¡ï¼&lt;/p&gt;
&lt;p&gt;é€šå¸¸ï¼Œå¤„ç†æ’¤é”€æ˜¯ç®¡ç†ä»»ä½• PKI ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ã€‚Istio å¸®åŠ©é™ä½è¿™ç§é£é™©çš„æ–¹æ³•ä¹‹ä¸€æ˜¯é¢å‘éå¸¸çŸ­æš‚çš„è¯ä¹¦ã€‚å…¸å‹çš„åŠé”€åˆ—è¡¨æœ€å¤šå¯èƒ½éœ€è¦ 24 å°æ—¶æ‰èƒ½åœ¨æ•´ä¸ªç»„ç»‡ä¸­ä¼ æ’­ã€‚Istio é¢å‘çš„è¯ä¹¦æœ‰æ•ˆæœŸå°‘äº 12 å°æ—¶ï¼Œå› æ­¤å‡ ä¹ä¸éœ€è¦æ’¤é”€ Istio é¢å‘çš„èº«ä»½è¯ä¹¦ã€‚æ‚¨åªéœ€è¦æ‹…å¿ƒä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºçš„ç­¾åè¯ä¹¦ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½»æ¾è½®æ¢è¯ä¹¦&#34;&gt;è½»æ¾è½®æ¢è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;ä¸åŠé”€ä¸€æ ·ï¼Œä¸­é—´è¯ä¹¦çš„è½®æ¢æ›´å®¹æ˜“ã€‚ä¼˜ç‚¹åŒ…æ‹¬ï¼Œå¦‚æœæ‚¨èƒ½å¤ŸæŒ‰é›†ç¾¤è½®æ¢è¯ä¹¦è€Œä¸æ˜¯åœ¨æ ¹èŠ‚ç‚¹è½®æ¢è¯ä¹¦ï¼Œæ‚¨å°†ä½“éªŒåˆ°æ›´å°‘çš„åœæœºæ—¶é—´ï¼ˆä»¥åŠç›¸å…³çš„å¤æ‚æ€§ï¼Œå³åœ¨ä»»ä½•åœ°æ–¹å‘å¸ƒä¸€ä¸ªå¸¦æœ‰æ–°æ ¹çš„æ›´æ–°çš„ CA åŒ…ï¼‰ã€‚è€Œä¸”ï¼Œå°±åƒä»»ä½•å¥½çš„ PKI ä¸€æ ·ï¼Œè¿™å¯ä»¥è®©æ‚¨ä½¿æ ¹ç¦»çº¿å¹¶å®‰å…¨åœ°å­˜å‚¨èµ·æ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç”¨ç®€å•çš„æ–¹æ³•æ¥åšï¼å°† Istio å¼•å…¥æ‚¨ç°æœ‰çš„ä¿¡ä»»æ ¹ä¸­ï¼Œä»¥é¿å…ç—›è‹¦å’Œå¿ƒç—›ã€‚ä¸­é—´ç­¾åè¯ä¹¦çš„å­˜åœ¨æ˜¯ä¸ºäº†è®©é‡‡ç”¨ Istio æ›´å®¹æ˜“ã€æ›´å®‰å…¨ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ Hashicorp Vault ä½œä¸ºä¸€ç§æ›´å®‰å…¨çš„æ–¹å¼æ¥å­˜å‚¨ Istio è¯ä¹¦</title>
      <link>https://cloudnativecn.com/blog/how-to-use-hashicorp-vault-as-a-more-secure-way-to-store-istio-certificates/</link>
      <pubDate>Mon, 19 Dec 2022 13:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-to-use-hashicorp-vault-as-a-more-secure-way-to-store-istio-certificates/</guid>
      <description>&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨ Hashicorp Vault ä½œä¸ºä¸€ç§æ¯”ä½¿ç”¨ Kubernetes &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/secret&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Secret&lt;/a&gt; æ›´å®‰å…¨çš„æ–¹å¼æ¥å­˜å‚¨ Istio è¯ä¹¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSecret ä½¿ç”¨ base64 ç¼–ç å­˜å‚¨åœ¨ &lt;em&gt;etcd&lt;/em&gt; ä¸­ã€‚åœ¨å®‰å…¨ç­–ç•¥ä¸¥æ ¼çš„ç¯å¢ƒä¸­ï¼Œè¿™å¯èƒ½æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„æªæ–½æ¥ä¿æŠ¤å®ƒä»¬ã€‚ä¸€ç§æ­¤ç±»è§£å†³æ–¹æ¡ˆæ¶‰åŠå°†æœºå¯†å­˜å‚¨åœ¨å¤–éƒ¨æœºå¯†å­˜å‚¨æä¾›ç¨‹åºä¸­ï¼Œä¾‹å¦‚ &lt;a href=&#34;https://www.vaultproject.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HashiCorp Vault&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Vault å¯ä»¥æ‰˜ç®¡åœ¨ Kubernetes é›†ç¾¤å†…éƒ¨å’Œå¤–éƒ¨ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä½¿ç”¨æ‰˜ç®¡åœ¨ Kubernetes å¤–éƒ¨çš„ Vaultï¼Œä»¥ä¾¿å®ƒå¯ä»¥åŒæ—¶ä¸ºå¤šä¸ªé›†ç¾¤æä¾›ç§˜å¯†ã€‚è¯¥è®¾ç½®ä¹Ÿéå¸¸é€‚åˆæ¢ç´¢ Istio çš„&lt;a href=&#34;https://istio.io/latest/docs/setup/install/multicluster&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤šé›†ç¾¤åŠŸèƒ½&lt;/a&gt;ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå…±äº«çš„ä¿¡ä»»åŸŸã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯ä¹¦å’Œç§é’¥ææ–™æ³¨å…¥å®é™…çš„ Istio æ§åˆ¶å¹³é¢ Podï¼Œä»¥ä¾¿å®ƒä»¬ä½¿ç”¨å¤–éƒ¨ CA è¯ä¹¦è¿›è¡Œå¼•å¯¼ã€‚è¿™é¿å…äº†ä¾èµ– Secret æ¥å¼•å¯¼ Istio æ§åˆ¶å¹³é¢ã€‚è¯¥æŠ€æœ¯ä¹Ÿå®Œå…¨é€‚ç”¨äºå…¥å£å’Œå‡ºå£è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³å¦‚ä½•åœ¨ Istio ä¸­ä½¿ç”¨å’Œç®¡ç†è¯ä¹¦çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§å®˜æ–¹æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/concepts/security/#pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èº«ä»½å’Œè¯ä¹¦ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/tasks/security/cert-management/plugin-ca-cert&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ’å…¥ CA è¯ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/tasks/security/cert-management/custom-ca-k8s&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Kubernetes CSR çš„è‡ªå®šä¹‰ CA é›†æˆ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰å…³åŸºäºå®é™…ç”Ÿäº§ç»éªŒçš„æœ€ä½³å®è·µï¼Œå¦è¯·æŸ¥çœ‹ä»¥ä¸‹ &lt;a href=&#34;https://tetrate.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate&lt;/a&gt; çš„åšå®¢æ–‡ç« ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://cloudnativecn.com/blog/istio-trust/&#34;&gt;åœ¨ Istio ä¸­æ„å»ºè¯ä¹¦ä¿¡ä»»é“¾ï¼šå°†ç°æœ‰ PKI ä½œä¸ºä¿¡ä»»æ ¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloudnativecn.com/blog/automate-istio-ca-rotation-in-production-at-scale&#34;&gt;åœ¨ç”Ÿäº§ä¸­å¤§è§„æ¨¡è‡ªåŠ¨åŒ– Istio CA è½®æ¢&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ç¯‡åšæ–‡é™„å¸¦çš„ä»£ç å¯ä»¥åœ¨ä»¥ä¸‹å­˜å‚¨åº“ä¸­æ‰¾åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/tetratelabs/istio-vault-ext-certs&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;istiod-è¯ä¹¦å¤„ç†&#34;&gt;&lt;strong&gt;Istiod è¯ä¹¦å¤„ç†&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;å°½ç®¡ä¸Šè¿°åšæ–‡ä¸­è§£é‡Šäº†ä¸€äº›å†³ç­–é€»è¾‘ï¼Œä½†ä¹Ÿå€¼å¾—å‚è€ƒ&lt;a href=&#34;https://github.com/istio/istio/blob/master/pilot/pkg/bootstrap/istio_ca.go&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æºä»£ç &lt;/a&gt;ä»¥æŸ¥æ‰¾ä¸€äº›æœªè®°å½•çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Istio çš„æºç  &lt;code&gt;istio/pilot/pkg/bootstrap/istio_ca.go&lt;/code&gt; æ–‡ä»¶ä¸­ï¼Œä½ å°†çœ‹åˆ°ï¼šä¸ºäº†å‘åå…¼å®¹ï¼ŒIstio ä¿ç•™äº†å¯¹ç”¨äºè‡ªç­¾åè¯ä¹¦ &lt;code&gt;cacerts&lt;/code&gt; Secret çš„æ”¯æŒã€‚å®ƒå®‰è£…åœ¨ç›¸åŒçš„ä½ç½®ï¼Œå¦‚æœå‘ç°äº†å°±ä¼šè¢«ä½¿ç”¨â€”â€”åˆ›å»ºç§˜å¯†å°±è¶³å¤Ÿäº†ï¼Œä¸éœ€è¦é¢å¤–çš„é€‰é¡¹ã€‚åœ¨æ—§å®‰è£…ç¨‹åºä¸­ï¼Œ&lt;code&gt;LocalCertDir&lt;/code&gt; è¢«ç¡¬ç¼–ç åˆ° &lt;code&gt;/etc/cacerts&lt;/code&gt; å¹¶ä½¿ç”¨ &lt;code&gt;cacerts&lt;/code&gt;  Secret å®‰è£…ã€‚å·²åˆ é™¤å¯¹ç­¾ç½²å…¶ä»–æ ¹ CA çš„æ”¯æŒâ€”â€”å¤ªå±é™©ï¼Œæ²¡æœ‰æ˜ç¡®çš„ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤é…ç½®ï¼Œç”¨äºå‘åå…¼å®¹ Citadelï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;istio-system&lt;/code&gt; ä¸­å­˜åœ¨ &lt;code&gt;cacerts&lt;/code&gt; ç§˜å¯†ï¼Œå°†è¢«æŒ‚è½½ã€‚å®ƒå¯èƒ½åŒ…å«ä¸€ä¸ªå¯é€‰çš„ &lt;code&gt;root-cert.pem&lt;/code&gt;ï¼Œ
å¸¦æœ‰é¢å¤–çš„æ ¹å’Œå¯é€‰çš„ &lt;code&gt;{ca-key, ca-cert, cert-chain}.pem&lt;/code&gt; ç”±ç”¨æˆ·æä¾›çš„æ ¹ CAã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæœªæ‰¾åˆ°ç”¨æˆ·æä¾›çš„æ ¹ CAï¼Œåˆ™ä½¿ç”¨ &lt;code&gt;istio-ca-secret&lt;/code&gt; Secretï¼Œä»¥åŠ &lt;code&gt;ca-cert.pem&lt;/code&gt; å’Œ &lt;code&gt;ca-key.pem&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸¤è€…å‡æœªæ‰¾åˆ°ï¼Œå°†åˆ›å»º &lt;code&gt;istio-ca-secret&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¸¦æœ‰ &lt;code&gt;caTLSRootCert&lt;/code&gt; æ–‡ä»¶çš„ &lt;code&gt;istio-security&lt;/code&gt; ConfigMap å°†ç”¨äºæ ¹è¯ä¹¦ï¼Œå¹¶åœ¨éœ€è¦æ—¶åˆ›å»ºã€‚è¯¥ ConfigMap ç”±èŠ‚ç‚¹ä»£ç†ä½¿ç”¨ï¼Œä¸å†å¯èƒ½åœ¨ sds-agent ä¸­ä½¿ç”¨ï¼Œä½†æˆ‘ä»¬ä»ä¿ç•™å®ƒä»¥å‘åå…¼å®¹ã€‚å°†ä¸ node-agent ä¸€èµ·åˆ é™¤ã€‚sds-agent ä½¿ç”¨ K8S root ç›´æ¥è°ƒç”¨ &lt;code&gt;NewCitadelClient&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†æŒ‡ç¤º Istio ä»å…¶ä»–åœ°æ–¹è·å–è¯ä¹¦ï¼Œè€Œä¸æ˜¯æ ‡å‡† Kubernetes Secretï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ &lt;em&gt;istio-pilot&lt;/em&gt;ï¼ˆåˆå istiod æˆ– Istio æ§åˆ¶å¹³é¢ï¼‰çš„ç¯å¢ƒå˜é‡ï¼ˆ&lt;a href=&#34;https://istio.io/latest/docs/reference/commands/pilot-discovery&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§æ­¤æ–‡æ¡£&lt;/a&gt;ï¼‰ï¼Œä» Kubernetes Pod ä¸­çš„å¦ä¸€ä¸ªä½ç½®è·å–è¯ä¹¦ã€‚è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º &lt;code&gt;vault-agent-init&lt;/code&gt; æ³¨å…¥å®¹å™¨å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æŒ‚è½½å· &lt;code&gt;/vault/secrets&lt;/code&gt; ï¼Œä»¥æ”¾ç½®ä»å¤–éƒ¨ Vault æœåŠ¡å™¨æ‹‰å‡ºçš„è¯ä¹¦å’Œç§é’¥ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å˜é‡åç§°&lt;/th&gt;
          &lt;th&gt;ç±»å‹&lt;/th&gt;
          &lt;th&gt;é»˜è®¤å€¼&lt;/th&gt;
          &lt;th&gt;æè¿°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;ROOT_CA_DIR&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;å­—ç¬¦ä¸²&lt;/td&gt;
          &lt;td&gt;&lt;code&gt;/etc/cacerts&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;æœ¬åœ°æˆ–å®‰è£…çš„ CA æ ¹ç›®å½•çš„ä½ç½®&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;pod-å†…çš„-vault-agent-init-å®¹å™¨æ³¨è§£&#34;&gt;Pod å†…çš„ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨æ³¨è§£&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å°†åˆ©ç”¨ Vault æ³¨å…¥å™¨æ³¨è§£æ¥æŒ‡ç¤º Sidecar æå–å“ªäº›æ•°æ®ä»¥åŠåœ¨è¿™æ ·åšæ—¶ä½¿ç”¨ä»€ä¹ˆ Vault è§’è‰²ã€‚æˆ‘ä»¬è¿˜ç¡®ä¿å®¹å™¨åœ¨æˆ‘ä»¬å®é™…çš„ä¸»å®¹å™¨ä¹‹å‰è¿è¡Œï¼Œå› æ­¤åè€…å¯ä»¥è·å–è¯ä¹¦å’Œå¯†é’¥ææ–™ä»¥æ­£ç¡®å¼•å¯¼è‡ªèº«ã€‚&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/platform/k8s/injector/annotations&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;åˆ—ä¸¾å¹¶è®°å½•äº† Vault æ³¨è§£ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ç›¸å…³æ³¨é‡Šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;é»˜è®¤å€¼&lt;/strong&gt;&lt;/th&gt;
          &lt;th&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;false&lt;/td&gt;
          &lt;td&gt;é…ç½®æ˜¯å¦ä¸º Pod æ˜¾å¼å¯ç”¨æˆ–ç¦ç”¨æ³¨å…¥ã€‚è¿™åº”è¯¥è®¾ç½®ä¸º true æˆ– falseã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-init-first&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;false&lt;/td&gt;
          &lt;td&gt;å¦‚æœä¸º trueï¼Œåˆ™å°† Pod é…ç½®ä¸ºé¦–å…ˆè¿è¡Œ Vault Agent init å®¹å™¨ï¼ˆå¦‚æœä¸º falseï¼Œåˆ™æœ€åè¿è¡Œï¼‰ã€‚å½“å…¶ä»– init å®¹å™¨éœ€è¦é¢„å¡«å……çš„ç§˜å¯†æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚è¿™åº”è¯¥è®¾ç½®ä¸º true æˆ– falseã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/role&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;â€“&lt;/td&gt;
          &lt;td&gt;é…ç½® Vault ä»£ç†è‡ªåŠ¨éªŒè¯æ–¹æ³•ä½¿ç”¨çš„ Vault è§’è‰²ã€‚&lt;code&gt;vault.hashicorp.com/agent-configmap&lt;/code&gt; æœªè®¾ç½®æ—¶éœ€è¦ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/auth-path&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;â€“&lt;/td&gt;
          &lt;td&gt;é…ç½® Kubernetes èº«ä»½éªŒè¯æ–¹æ³•çš„èº«ä»½éªŒè¯è·¯å¾„ã€‚é»˜è®¤ä¸º &lt;code&gt;auth/kubernetes&lt;/code&gt;ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;â€“&lt;/td&gt;
          &lt;td&gt;é…ç½® Vault ä»£ç†ä»¥ä»å®¹å™¨æ‰€éœ€çš„ Vault ä¸­æ£€ç´¢ç§˜å¯†ã€‚Secret çš„åç§°æ˜¯ &lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt; ä¹‹åçš„ä»»æ„å”¯ä¸€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &lt;code&gt;vault.hashicorp.com/agent-inject-secret-foobar&lt;/code&gt; è¯¥å€¼æ˜¯ secret æ‰€åœ¨çš„ Vault ä¸­çš„è·¯å¾„ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject-template-&lt;/code&gt;&lt;/td&gt;
          &lt;td&gt;â€“&lt;/td&gt;
          &lt;td&gt;é…ç½® Vault Agent åº”è¯¥ç”¨äºå‘ˆç°ç§˜å¯†çš„æ¨¡æ¿ã€‚æ¨¡æ¿çš„åç§°æ˜¯ v&lt;code&gt;ault.hashicorp.com/agent-inject-template-&lt;/code&gt; ä¹‹åçš„ä»»ä½•å”¯ä¸€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &lt;code&gt;vault.hashicorp.com/agent-inject-template-foobar&lt;/code&gt;ã€‚è¿™åº”è¯¥æ˜ å°„åˆ° &lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt; ä¸­æä¾›çš„ç›¸åŒå”¯ä¸€å€¼ã€‚å¦‚æœæœªæä¾›ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„é€šç”¨æ¨¡æ¿ã€‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;vault-server-considerations&#34;&gt;Vault æœåŠ¡å™¨æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;p&gt;Vault æ”¯æŒå¤šç§å®¢æˆ·ç«¯éªŒè¯è‡ªå·±çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†åˆ©ç”¨ &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/a&gt;ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å°†åˆ©ç”¨ Kubernetes ServiceAccount JWT ä»¤ç‰ŒéªŒè¯ã€‚è¯·æ³¨æ„ï¼Œè‡ª Kubernetes 1.24 ä»¥æ¥ï¼Œä¸å†è‡ªåŠ¨ç”Ÿæˆ ServiceAccount ä»¤ç‰Œã€‚æ‚¨ä»ç„¶å¯ä»¥æ‰‹åŠ¨åˆ›å»ºè¿™äº› API ä»¤ç‰Œï¼Œå¦‚&lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„æ‰€è¿°&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºè¯ä¹¦å’Œç§é’¥ææ–™çš„å­˜å‚¨ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PKI ç§˜å¯†å¼•æ“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/kv&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;KV ç§˜å¯†å¼•æ“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› ä¸º PKI ç§˜å¯†å¼•æ“ä¸æä¾›ç²¾ç®€çš„ API æ¥æ£€ç´¢æˆ‘ä»¬éœ€è¦çš„è¯ä¹¦å’Œç§é’¥ï¼Œå¹¶ä¸”å› ä¸º PKI ç§˜å¯†å¼•æ“ä¼šä¸ºæ¯æ¬¡è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œæ¯æ¬¡ &lt;em&gt;istiod&lt;/em&gt; é‡å¯ï¼‰ç”Ÿæˆä¸€ä¸ªæ–°çš„ä¸­é—´è¯ä¹¦ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é€šç”¨çš„ KV ç§˜å¯†å¼•æ“ï¼Œå°†æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å€¼å­˜å‚¨åœ¨ä¸€ä¸ªç®€å•çš„é”®å€¼æ•°æ®ç»“æ„ä¸­ã€‚æˆ‘ä»¬å‡è®¾ä¸­é—´è¯ä¹¦çš„æ›´æ–°æ˜¯é€šè¿‡ä¸€äº›æœåŠ¡é—¨æˆ·æˆ– CI/CD è¿‡ç¨‹åœ¨å¤–éƒ¨å¤„ç†çš„ï¼Œè¿™äº›è¿‡ç¨‹ä¹Ÿå°†æ›´æ–°çš„ä¸­é—´è¯ä¹¦å­˜å‚¨åœ¨ Vault æœåŠ¡å™¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;Istio çš„æ§åˆ¶å¹³é¢ Pod éœ€è¦ä»¥ä¸‹æ–‡ä»¶æ‰èƒ½åœ¨ CA ä¸­æ­£ç¡®å¼•å¯¼å…¶æ„å»ºï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;Key&lt;/th&gt;
          &lt;th&gt;å€¼ï¼ˆPEM ç¼–ç ï¼‰&lt;/th&gt;
          &lt;th&gt;ç»†èŠ‚&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;ca-key.pem&lt;/td&gt;
          &lt;td&gt;ç§é’¥&lt;/td&gt;
          &lt;td&gt;ä¸­é—´è¯ä¹¦çš„ç§é’¥ï¼Œç”¨ä½œ &lt;em&gt;istiod&lt;/em&gt; çš„æ ¹ CAã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ca-cert.pem&lt;/td&gt;
          &lt;td&gt;CA å…¬å…±è¯ä¹¦&lt;/td&gt;
          &lt;td&gt;ä¸­é—´è¯ä¹¦ï¼Œç”¨ä½œ &lt;em&gt;istiod&lt;/em&gt; çš„æ ¹ CAã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;root-cert.pem&lt;/td&gt;
          &lt;td&gt;CA æ ¹è¯ä¹¦&lt;/td&gt;
          &lt;td&gt;æˆ‘ä»¬æ–°ç”Ÿæˆçš„ä¸­é—´è¯ä¹¦çš„ä¿¡ä»»æ ¹ã€‚&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;cert-chain.pem&lt;/td&gt;
          &lt;td&gt;å®Œæ•´çš„è¯ä¹¦é“¾&lt;/td&gt;
          &lt;td&gt;ä¸­é—´è¯ä¹¦åœ¨é¡¶éƒ¨ï¼Œæ ¹è¯ä¹¦åœ¨åº•éƒ¨ã€‚&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;è®¾ç½®&#34;&gt;è®¾ç½®&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¦éµå¾ªæœ¬åœ°è®¾ç½®ï¼Œåˆ™å®‰è£…è½¯ä»¶çš„å…ˆå†³æ¡ä»¶åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;kubectl&lt;/em&gt; ä¸ Kubernetes é›†ç¾¤äº¤äº’ï¼ˆ&lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/#kubectl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;em&gt;helm&lt;/em&gt; å®‰è£… Vault injector å’Œ Istio chartï¼ˆ&lt;a href=&#34;https://helm.sh/docs/intro/install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;ç”¨äºé…ç½® Vault æœåŠ¡å™¨çš„ &lt;em&gt;vault cli&lt;/em&gt; å·¥å…·ï¼ˆ&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/getting-started/getting-started-install#install-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è¦æœ¬åœ°æ¼”ç¤ºç¯å¢ƒï¼Œè¯·æŒ‰ç…§&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/local-setup.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;çš„è¯´æ˜è¿›è¡Œæ“ä½œï¼Œè¯¥è¯´æ˜ä½¿ç”¨ &lt;code&gt;docker-compose&lt;/code&gt; å¯åŠ¨ä¸€ä¸ª Vault æœåŠ¡å™¨å’Œä¸¤ä¸ªç‹¬ç«‹çš„ k3s é›†ç¾¤ã€‚å¦‚æœæ‚¨ä½¿ç”¨è‡ªå·±çš„ Kubernetes é›†ç¾¤å’Œå¤–éƒ¨æ‰˜ç®¡çš„ Vault å®ä¾‹ï¼Œè¯·è·³è‡³ä¸‹ä¸€èŠ‚ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;docker-compose&lt;/em&gt; å¯åŠ¨æœ¬åœ°ç¯å¢ƒï¼ˆ&lt;a href=&#34;https://github.com/docker/compose/releases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†å–å¾—è¿›å±•ï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®æ‚¨çš„ç¯å¢ƒè®¾ç½®ä»¥ä¸‹ shell å˜é‡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;K8S_API_SERVER_1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;K8S_API_SERVER_2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;vault-kubernetes-èº«ä»½éªŒè¯åç«¯&#34;&gt;&lt;strong&gt;Vault Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚åœ¨æœ‰å…³ &lt;a href=&#34;#vault-server-considerations&#34;&gt;Vault æœåŠ¡å™¨æ³¨æ„äº‹é¡¹&lt;/a&gt;çš„ä»‹ç»éƒ¨åˆ†ä¸­æåˆ°çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/a&gt;ã€‚ç”±äº &lt;em&gt;istiod&lt;/em&gt; å°†ä» Vault æœåŠ¡å™¨è·å–è¯ä¹¦å’Œç§é’¥ææ–™ï¼Œè®©æˆ‘ä»¬ä»åœ¨ä¸¤ä¸ªé›†ç¾¤ä¸­åˆ›å»ºç›¸åº”çš„æœåŠ¡è´¦æˆ·å¼€å§‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml create ns istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml create ns istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml apply -f istio-sa.yml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml apply -f istio-sa.yml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ServiceAccountã€Secret å’Œ ClusterRoleBinding å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# istio-sa.yaml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ServiceAccount&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# added for istio helm installation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app.kubernetes.io/managed-by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Helm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# added for istio helm installation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta.helm.sh/release-name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta.helm.sh/release-namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Secret&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kubernetes.io/service-account.name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/service-account-token&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterRoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;role-tokenreview-binding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterRole&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;system:auth-delegator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ServiceAccount&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼š&lt;em&gt;æˆ‘ä»¬åœ¨ istiod ServiceAccount ä¸Šæ·»åŠ äº† Helm æ ‡ç­¾å’Œæ³¨è§£ï¼Œä»¥å…ä¸ç¨åçš„ Istio Helm éƒ¨ç½²å‘ç”Ÿå†²çªã€‚&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ä¸¤ä¸ªé›†ç¾¤ä¸­åˆ›å»º ServiceAccount åï¼Œè®©æˆ‘ä»¬å°†å®ƒä»¬çš„ Secret ä»¤ç‰Œå’Œ ca.cert å€¼å­˜å‚¨åœ¨ output æ–‡ä»¶å¤¹ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir -p ./output
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml get secret -n istio-system istiod -o go-template&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{{ .data.token }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/istiod1.jwt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml config view --raw --minify --flatten -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.clusters[].cluster.certificate-authority-data}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/k8sapi-cert1.pem
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml get secret -n istio-system istiod -o go-template&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{{ .data.token }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/istiod2.jwt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml config view --raw --minify --flatten -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.clusters[].cluster.certificate-authority-data}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/k8sapi-cert2.pem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…³äº Kubernetes API è¯ä¹¦å’Œ istiod ServiceAccount JWT ä»¤ç‰Œçš„è¯¦ç»†å†…å®¹çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/output&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æ‰¾åˆ°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿæ›´æ·±å…¥åœ°æè¿°äº† Vault çš„äº¤äº’è¿‡ç¨‹ï¼Œå³é€šè¿‡ REST API è°ƒç”¨æ¥éªŒè¯å’Œè·å–ç§˜å¯†ã€‚åœ¨è°ƒè¯•æƒé™æ‹’ç»çš„é—®é¢˜æ—¶ï¼Œè¿™äº›å¯ä»¥æ´¾ä¸Šç”¨åœºã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ ¹æ®åˆšåˆšæ£€ç´¢åˆ°çš„ Kubernetes CA è¯ä¹¦å’Œ JWT ä»¤ç‰Œåˆ›å»ºå¿…è¦çš„ Vault èº«ä»½éªŒè¯é…ç½®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_ADDR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;http://localhost:8200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login root
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault auth &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster1 kubernetes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault auth &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster2 kubernetes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster1/config &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$K8S_API_SERVER_1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@output/k8sapi-cert1.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;token_reviewer_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;cat output/istiod1.jwt&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;disable_local_ca_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster2/config &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$K8S_API_SERVER_2&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@output/k8sapi-cert2.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;token_reviewer_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;cat output/istiod2.jwt&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;disable_local_ca_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ &lt;em&gt;docker-compose&lt;/em&gt; æä¾›çš„ç¯å¢ƒï¼Œåˆ™ &lt;code&gt;VAULT_ADDR&lt;/code&gt; è®¾ç½®ä¸º localhostã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;vault-kv-secret-ä¸­çš„-istio-è¯ä¹¦å’Œç§é’¥&#34;&gt;&lt;em&gt;Vault kv&lt;/em&gt; Secret ä¸­çš„ Istio è¯ä¹¦å’Œç§é’¥&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„è‡ªç­¾åæ ¹è¯ä¹¦å¹¶ä¸ºæˆ‘ä»¬çš„ä¸¤ä¸ªé›†ç¾¤ç”Ÿæˆä¸­é—´è¯ä¹¦ã€‚æˆ‘ä»¬å°†åœ¨&lt;a href=&#34;https://github.com/istio/istio/tree/master/tools/certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ä½¿ç”¨ä¸Šæ¸¸ Istio æä¾›çš„è¾…åŠ© &lt;em&gt;Makefile&lt;/em&gt; è„šæœ¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; certs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk root-ca
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk istiod-cluster1-cacerts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk istiod-cluster2-cacerts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰å…³å®é™…å†…å®¹å’Œæ­£åœ¨è®¾ç½®çš„ X509v3 æ‰©å±•çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;ã€‚æ‚¨å¯ä»¥é€šè¿‡&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/certs-gen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;çš„ &lt;em&gt;Makefile&lt;/em&gt;æ–‡æ¡£å’Œç›¸åº”çš„ &lt;em&gt;Makefile&lt;/em&gt; è¦†ç›–å€¼å¾®è°ƒè¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å°†ç”Ÿæˆçš„è¯ä¹¦å’Œç§é’¥æ·»åŠ åˆ° Vault &lt;em&gt;kv&lt;/em&gt; secret ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_ADDR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;http://localhost:8200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login root
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; -path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster1-secrets kv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; -path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster2-secrets kv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault kv put kubernetes-cluster1-secrets/istiod-service/certs &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/ca-key.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/ca-cert.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;cert_chain&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/cert-chain.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;root_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/root-cert.pem
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault kv put kubernetes-cluster2-secrets/istiod-service/certs &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/ca-key.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/ca-cert.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;cert_chain&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/cert-chain.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;root_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/root-cert.pem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡é™åˆ¶å¯¹æ¯ä¸ªé›†ç¾¤çš„è¿™äº›è¯ä¹¦å’Œç§é’¥çš„è®¿é—®ï¼Œç»‘å®šåˆ°åŸºäº Kubernetes &lt;em&gt;istiod&lt;/em&gt; ServiceAccount çš„èº«ä»½éªŒè¯åç«¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;path &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  capabilities = [&amp;#34;read&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; vault policy write istiod-certs-cluster1 -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;path &amp;#34;kubernetes-cluster2-secrets/istiod-service/certs&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  capabilities = [&amp;#34;read&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; vault policy write istiod-certs-cluster2 -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster1/role/istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_names&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_namespaces&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istio-system &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod-certs-cluster1 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ttl&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24h
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster2/role/istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_names&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_namespaces&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istio-system &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod-certs-cluster2  &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ttl&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24h
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;éƒ¨ç½²-vault-inject-å’Œ-istio-helm-charts&#34;&gt;éƒ¨ç½² &lt;em&gt;vault-inject&lt;/em&gt; å’Œ Istio Helm Charts&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†éƒ¨ç½² Vault æ³¨å…¥å™¨ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨å®˜æ–¹ Vault &lt;a href=&#34;https://github.com/hashicorp/vault-helm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helm chart&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add hashicorp https://helm.releases.hashicorp.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml create ns vault
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml create ns vault
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n vault vault-inject hashicorp/vault --set &lt;span class=&#34;s2&#34;&gt;&amp;#34;injector.externalVaultAddr=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n vault vault-inject hashicorp/vault --set &lt;span class=&#34;s2&#34;&gt;&amp;#34;injector.externalVaultAddr=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml -n vault get pods
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml -n vault get pods
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;NAME                                           READY   STATUS    RESTARTS   AGE
vault-inject-agent-injector-5776975795-9vt9w   1/1     Running   0          92s
NAME                                           READY   STATUS    RESTARTS   AGE
vault-inject-agent-injector-5776975795-9vjnx   1/1     Running   0          91s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¦å®‰è£… Istioï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Tetrate Istio Distro &lt;a href=&#34;https://github.com/tetratelabs/helm-charts&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helm chart&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add tetratelabs https://tetratelabs.github.io/helm-charts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n istio-system istio-base tetratelabs/base
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n istio-system istio-base tetratelabs/base
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n istio-system istio-istiod tetratelabs/istiod --values&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./cluster1-values.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n istio-system istio-istiod tetratelabs/istiod --values&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./cluster2-values.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml -n istio-system get pods
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml -n istio-system get pods
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨å¤šä¸ª Istio Helm chart å€¼è¦†ç›–æ¥æˆ‘ä»¬é¢„æœŸçš„ç›®æ ‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ä¸€ä¸ª pilot Pod ç¯å¢ƒå˜é‡ &lt;code&gt;ROOT_CA_DIR&lt;/code&gt; æ¥å‘Šè¯‰ &lt;em&gt;istiod&lt;/em&gt; ä»å“ªé‡Œè·å–è¯ä¹¦å’Œç§é’¥&lt;/li&gt;
&lt;li&gt;å‘Šè¯‰ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨åœ¨ &lt;em&gt;istiod&lt;/em&gt; å®¹å™¨ä¹‹å‰è¿è¡Œï¼Œå› æ­¤ç§˜å¯†å®‰è£…åœ¨ &lt;code&gt;/vault/secrets&lt;/code&gt; çš„å·ä¸­å¯ç”¨&lt;/li&gt;
&lt;li&gt;æŒ‡ç¤º Vault æ³¨å…¥å™¨ä»æ­£ç¡®çš„ä½ç½®å’Œæ•°æ®å¯†é’¥è·å–æœºå¯†&lt;/li&gt;
&lt;li&gt;è¿™æ ·åšæ—¶æ‰¿æ‹… Vault &lt;em&gt;istiod&lt;/em&gt; è§’è‰²&lt;/li&gt;
&lt;li&gt;è¦†ç›–é»˜è®¤çš„ Kubernetes auth-pathï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¤šä¸ªé›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;pilot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ROOT_CA_DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/vault/secrets&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;podAnnotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-init-first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-ca-key.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-ca-key.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.ca_key }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-ca-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-ca-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.ca_cert }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-root-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-root-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.root_cert }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-cert-chain.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-cert-chain.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.cert_chain }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/role&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;istiod&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/auth-path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;auth/kubernetes-cluster1&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“æˆ‘ä»¬æŸ¥çœ‹ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨æ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ã€‚æˆ‘ä»¬çš„æ§åˆ¶å¹³é¢å·²ç»æ­£ç¡®åœ°è·å–äº† Vault æ³¨å…¥çš„ç§˜å¯†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml logs -n istio-system -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -c vault-agent-init --tail&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;==&amp;gt; Vault agent started! Log data will stream in below:

  ==&amp;gt; Vault agent configuration:

                      Cgo: disabled
                Log Level: info
                  Version: Vault v1.12.0, built 2022-10-10T18:14:33Z
              Version Sha: 558abfa75702b5dab4c98e86b802fb9aef43b0eb

  2022-11-18T11:01:21.398Z [INFO]  sink.file: creating file sink
  2022-11-18T11:01:21.398Z [INFO]  sink.file: file sink configured: path=/home/vault/.vault-token mode=-rw-r-----
  2022-11-18T11:01:21.398Z [INFO]  template.server: starting template server
  2022-11-18T11:01:21.398Z [INFO]  sink.server: starting sink server
  2022-11-18T11:01:21.398Z [INFO]  auth.handler: starting auth handler
  2022-11-18T11:01:21.398Z [INFO]  auth.handler: authenticating
  2022-11-18T11:01:21.398Z [INFO] (runner) creating new runner (dry: false, once: false)
  2022-11-18T11:01:21.398Z [INFO] (runner) creating watcher
  2022-11-18T11:01:21.402Z [INFO]  auth.handler: authentication successful, sending token to sinks
  2022-11-18T11:01:21.402Z [INFO]  auth.handler: starting renewal process
  2022-11-18T11:01:21.402Z [INFO]  sink.file: token written: path=/home/vault/.vault-token
  2022-11-18T11:01:21.402Z [INFO]  sink.server: sink server stopped
  2022-11-18T11:01:21.402Z [INFO]  sinks finished, exiting
  2022-11-18T11:01:21.402Z [INFO]  template.server: template server received new token
  2022-11-18T11:01:21.402Z [INFO] (runner) stopping
  2022-11-18T11:01:21.402Z [INFO] (runner) creating new runner (dry: false, once: false)
  2022-11-18T11:01:21.402Z [INFO] (runner) creating watcher
  2022-11-18T11:01:21.402Z [INFO] (runner) starting
  2022-11-18T11:01:21.403Z [INFO]  auth.handler: renewed auth token
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/root-cert.pem&amp;#34;
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/ca-cert.pem&amp;#34;
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/cert-chain.pem&amp;#34;
  2022-11-18T11:01:21.516Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/ca-key.pem&amp;#34;
  2022-11-18T11:01:21.516Z [INFO] (runner) stopping
  2022-11-18T11:01:21.516Z [INFO]  template.server: template server stopped
  2022-11-18T11:01:21.516Z [INFO] (runner) received finish
  2022-11-18T11:01:21.516Z [INFO]  auth.handler: shutdown triggered, stopping lifetime watcher
  2022-11-18T11:01:21.516Z [INFO]  auth.handler: auth handler stopped
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å½“æˆ‘ä»¬æŸ¥çœ‹ &lt;code&gt;discovery&lt;/code&gt; å®¹å™¨æ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml logs -n istio-system -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -c discovery --tail&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; info	Using istiod file format for signing ca files
  info	Use plugged-in cert at /vault/secrets/ca-key.pem
  info	x509 cert - Issuer: &amp;#34;CN=Intermediate CA,O=Istio,L=istiod-cluster1&amp;#34;, Subject: &amp;#34;&amp;#34;, SN: 39f67569f10d36a1fc91e9d82156b07d, NotBefore: &amp;#34;2022-11-18T11:11:59Z&amp;#34;, NotAfter: &amp;#34;2032-11-15T11:13:59Z&amp;#34;
  info	x509 cert - Issuer: &amp;#34;CN=Root CA,O=Istio&amp;#34;, Subject: &amp;#34;CN=Intermediate CA,O=Istio,L=istiod-cluster1&amp;#34;, SN: dedf298a147681d6, NotBefore: &amp;#34;2022-11-17T22:01:54Z&amp;#34;, NotAfter: &amp;#34;2024-11-16T22:01:54Z&amp;#34;
  info	x509 cert - Issuer: &amp;#34;CN=Root CA,O=Istio&amp;#34;, Subject: &amp;#34;CN=Root CA,O=Istio&amp;#34;, SN: f5bcd7e89bdb6248, NotBefore: &amp;#34;2022-11-17T22:01:52Z&amp;#34;, NotAfter: &amp;#34;2032-11-14T22:01:52Z&amp;#34;
  info	Istiod certificates are reloaded
  info	spiffe	Added 1 certs to trust domain cluster.local in peer cert verifier
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ Istio æ§åˆ¶å¹³é¢å·²ç»æ­£ç¡®åœ°è·å–äº†æˆ‘ä»¬çš„ Vault æ³¨å…¥è¯ä¹¦å’Œç§é’¥ã€‚ä»»åŠ¡å®Œæˆï¼&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨å¤–éƒ¨ Vault å­˜å‚¨çš„è¯ä¹¦å’Œç§é’¥æˆåŠŸå¼•å¯¼äº† Istio æ§åˆ¶å¹³é¢ã€‚å®ç°è¿™ä¸€ç›®æ ‡çš„æ­¥éª¤åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†è¯ä¹¦å’Œç§é’¥å­˜å‚¨åœ¨æ¯ä¸ªé›†ç¾¤ä¸“ç”¨çš„ Vault ç§˜å¯†å®‰è£…è·¯å¾„ä¸­&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªé›†ç¾¤è®¾ç½® Kubernetes Vault èº«ä»½éªŒè¯åç«¯ï¼Œé“¾æ¥åˆ°æ­£ç¡®çš„ ServiceAccount&lt;/li&gt;
&lt;li&gt;å®šä¹‰é€‚å½“çš„è§’è‰²å’Œç­–ç•¥ä»¥å…è®¸ä» &lt;em&gt;istiod&lt;/em&gt; ServiceAccount è®¿é—® Vault æœºå¯†&lt;/li&gt;
&lt;li&gt;å°† Istio Pilot å¼•å¯¼ç¨‹åºå‚æ•°è°ƒæ•´ä¸ºï¼š
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ &lt;em&gt;vault-agent-init&lt;/em&gt; sidecar&lt;/li&gt;
&lt;li&gt;è·å–åŒ…å«æˆ‘ä»¬çš„è¯ä¹¦å’Œç§é’¥çš„æ­£ç¡® Vault æœºå¯†&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ­£ç¡®çš„è§’è‰²å’Œèº«ä»½éªŒè¯åç«¯æ¥è¿™æ ·åš&lt;/li&gt;
&lt;li&gt;ä»æ­£ç¡®çš„ vault secret å®‰è£…è·¯å¾„ä¸­è·å–è¯ä¹¦å’Œç§é’¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æŠ€æœ¯æ¥æ³¨å…¥&lt;em&gt;å…¥å£ç½‘å…³&lt;/em&gt;å’Œ&lt;em&gt;å‡ºå£ç½‘å…³&lt;/em&gt;è¯ä¹¦ã€‚åˆ›å»º Istio &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/gateway/#ServerTLSSettings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway&lt;/a&gt; å¯¹è±¡æ—¶ï¼Œè¯·ç¡®ä¿å°† &lt;em&gt;serverCertificate&lt;/em&gt;ã€&lt;em&gt;privateKey&lt;/em&gt; å’Œ &lt;em&gt;caCertificates&lt;/em&gt; æŒ‡å‘ &lt;code&gt;/vault/secrets&lt;/code&gt; æŒ‚è½½å·ä¸­çš„æ­£ç¡®æ–‡ä»¶ã€‚æˆ‘ä»¬å°†æŠŠå®ƒä½œä¸ºç»ƒä¹ ç•™ç»™è¯»è€…ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡å°†è¯ä¹¦æ³¨å…¥ç»‘å®šåˆ° Kubernetes ServiceAccountï¼Œæˆ‘ä»¬ç°åœ¨å·²å°†è¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†å§”æ‰˜ç»™å¤–éƒ¨ç§˜å¯† Vault å®ä¾‹ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸“ç”¨è§’è‰²å’Œå†™å…¥/æ›´æ–°ç­–ç•¥åˆ›å»ºæœåŠ¡é—¨æˆ·æˆ– CI/CD ç®¡é“ç­‰å¤–éƒ¨æµç¨‹ï¼Œä»¥æä¾›å¿…è¦çš„è¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†å®‰å…¨æ€§ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes å®‰å…¨çš„ 6 å¤§é›¶ä¿¡ä»»åŸåˆ™</title>
      <link>https://cloudnativecn.com/blog/the-top-6-zero-trust-principles-for-kubernetes-security/</link>
      <pubDate>Tue, 13 Dec 2022 13:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/the-top-6-zero-trust-principles-for-kubernetes-security/</guid>
      <description>&lt;p&gt;ä¼ ç»Ÿçš„ç½‘ç»œå®‰å…¨ä¾èµ–äºå›´ç»•å¯ä¿¡å†…éƒ¨ç½‘ç»œçš„å¼ºå¤§é˜²å¾¡è¾¹ç•Œï¼Œä»¥å°†ä¸è‰¯è¡Œä¸ºè€…æ‹’ä¹‹é—¨å¤–ï¼Œå°†æ•æ„Ÿæ•°æ®æ‹’ä¹‹é—¨å¤–ã€‚åœ¨æ—¥ç›Šå¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œç»´æŠ¤å¼ºå¤§çš„è¾¹ç•Œè¶Šæ¥è¶Šå›°éš¾ã€‚&lt;/p&gt;
&lt;p&gt;é›¶ä¿¡ä»»å®‰å…¨æ­£åœ¨æˆä¸ºä¼ä¸šä¿æŠ¤å…¶ä¼ ç»Ÿå’Œç°ä»£äº‘åŸç”Ÿåº”ç”¨ç¨‹åºçš„é¦–é€‰æ–¹æ³•ã€‚é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„é¢ è¦†äº†è¾¹ç•Œå®‰å…¨çš„å‡è®¾ã€‚åœ¨é›¶ä¿¡ä»»ç½‘ç»œä¸­ï¼Œæ¯ä¸ªèµ„æºéƒ½åœ¨å†…éƒ¨å—åˆ°ä¿æŠ¤ï¼Œå°±å¥½åƒå®ƒæš´éœ²åœ¨å¼€æ”¾çš„äº’è”ç½‘ä¸­ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¸ºè¡Œä¸šå’Œç¾å›½è”é‚¦æ”¿åºœå»ºç«‹é›¶ä¿¡ä»»å®‰å…¨æŒ‡å—ï¼Œç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ (NIST) åœ¨ä¸€ç³»åˆ—å‡ºç‰ˆç‰©ä¸­å»ºç«‹äº†é›¶ä¿¡ä»»å®‰å…¨æŒ‡å—ï¼Œä» SP 800-207 å¼€å§‹ï¼Œä»‹ç»ä¸€èˆ¬çš„é›¶ä¿¡ä»»æ¶æ„åŠå…¶é…å¥—&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204 å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ç³»åˆ—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ NIST çš„æ ¸å¿ƒé›¶ä¿¡ä»»æ¶æ„åŸåˆ™ä»¥åŠå»ºè®®åœ¨å®è·µä¸­åº”ç”¨å®ƒä»¬çš„ Kubernetes å’Œ Istio å‚è€ƒæ¶æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›¶ä¿¡ä»»ç½‘ç»œçš„å…­é¡¹åŸåˆ™&#34;&gt;é›¶ä¿¡ä»»ç½‘ç»œçš„å…­é¡¹åŸåˆ™&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— è®ºç½‘ç»œä½ç½®å¦‚ä½•ï¼Œæ‰€æœ‰é€šä¿¡éƒ½åº”è¯¥æ˜¯å®‰å…¨çš„&lt;/strong&gt;ã€‚ç½‘ç»œä½ç½®å’Œå¯è¾¾æ€§å¹¶ä¸æ„å‘³ç€ä¿¡ä»»ã€‚ä¼ä¸šæ‹¥æœ‰æˆ–å…¶ä»–ä¸“ç”¨ç½‘ç»œå†…éƒ¨çš„è®¿é—®è¯·æ±‚å¿…é¡»æ»¡è¶³ä¸æ¥è‡ªä»»ä½•å…¶ä»–ä½ç½®çš„é€šä¿¡ç›¸åŒçš„å®‰å…¨è¦æ±‚ã€‚é›¶ä¿¡ä»»ç³»ç»Ÿçš„ä¸€ä¸ªæ ‡å‡†æ˜¯ï¼Œæ‚¨å¯ä»¥å°†å®ƒæš´éœ²åœ¨å¼€æ”¾çš„äº’è”ç½‘ä¸Šï¼Œå¹¶ä¸”å®ƒä»ç„¶æ˜¯å®‰å…¨çš„ï¼Œæ²¡æœ‰æœªç»æˆæƒçš„ç³»ç»Ÿã€æ•°æ®æˆ–é€šä¿¡è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰é€šä¿¡éƒ½åº”åŠ å¯†&lt;/strong&gt;ã€‚çº¿è·¯ä¸Šçš„åŠ å¯†å¯é˜²æ­¢çªƒå¬ï¼Œå¹¶ç¡®ä¿æ¶ˆæ¯çœŸå®ä¸”æœªè¢«ç¯¡æ”¹ã€‚è¿™æ„å‘³ç€è‡³å°‘ä¸ºæ‰€æœ‰é€šä¿¡å®æ–½ TLSï¼Œå°†&lt;a href=&#34;https://tetr8.io/3Na982k&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mTLS å’Œç›¸å…³çš„å®‰å…¨å·¥ä½œè´Ÿè½½èº«ä»½ä½œä¸ºæœåŠ¡é—´é€šä¿¡çš„æœ€ä½³å®è·µ&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹æ¯ä¸ªèµ„æºçš„è®¿é—®éƒ½åº”è¯¥æ ¹æ®åŠ¨æ€ç­–ç•¥è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒ&lt;/strong&gt;ã€‚åœ¨å…è®¸ä»»ä½•è®¿é—®ä¹‹å‰ï¼Œå¯¹æœåŠ¡èº«ä»½å’Œæœ€ç»ˆç”¨æˆ·å‡­æ®è¿›è¡ŒåŠ¨æ€èº«ä»½éªŒè¯å’Œæˆæƒã€‚è®¿é—®è¯·æ±‚çš„åŠ¨æ€ä¸Šä¸‹æ–‡åº”è¯¥æ˜¯è®¿é—®å†³ç­–çš„ä¸€éƒ¨åˆ†ã€‚è¿™å¯èƒ½åŒ…æ‹¬è¡Œä¸ºå±æ€§ï¼Œå¦‚ä¸è§‚å¯Ÿåˆ°çš„ä½¿ç”¨æ¨¡å¼çš„åå·®æˆ–è¯·æ±‚èµ„äº§çš„çŠ¶æ€ï¼Œå¦‚å®‰è£…çš„è½¯ä»¶ç‰ˆæœ¬ã€ç½‘ç»œä½ç½®å’Œè¯·æ±‚çš„æ—¶é—´ / æ—¥æœŸã€‚æˆäºˆè®¿é—®æƒé™æ—¶ï¼Œåº”ä»¥æ‰€éœ€çš„æœ€ä½æƒé™æˆäºˆå®ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹èµ„æºçš„è®¿é—®åº”è¯¥åœ¨ç©ºé—´ä¸Šæœ‰ç•Œ&lt;/strong&gt;ã€‚å›´ç»•èµ„æºçš„ä¿¡ä»»èŒƒå›´åº”å°½å¯èƒ½å° â€”â€” ç†æƒ³æƒ…å†µä¸‹ä¸ºé›¶ã€‚è®¿é—®åº”è¯¥ç”±æ¯ä¸ªèƒ½å¤Ÿæ£€ç´¢å’Œæ‰§è¡Œè®¿é—®å†³ç­–çš„èµ„æºå‰é¢çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP) è¿›è¡Œè°ƒè§£ã€‚è¿™åº”è¯¥é€‚ç”¨äºæ‰€æœ‰å…¥ç«™ã€å‡ºç«™å’ŒæœåŠ¡åˆ°æœåŠ¡çš„è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”åŠæ—¶é™åˆ¶å¯¹èµ„æºçš„è®¿é—®&lt;/strong&gt;ã€‚èº«ä»½éªŒè¯å’Œæˆæƒç»‘å®šåˆ°ä¸€ä¸ªçŸ­æš‚çš„ä¼šè¯ï¼Œä¹‹åå®ƒä»¬å¿…é¡»é‡æ–°å»ºç«‹ã€‚è¿™å¯ç¡®ä¿é¢‘ç¹åšå‡ºè®¿é—®å†³ç­–ï¼Œå¹¶ä½¿ç”¨æœ€æ–°çš„å¯ç”¨ä¸Šä¸‹æ–‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹èµ„æºçš„è®¿é—®åº”è¯¥æ˜¯å¯è§‚å¯Ÿçš„&lt;/strong&gt;ã€‚åº”æ”¶é›†å¹¶ä½¿ç”¨å°½å¯èƒ½å¤šçš„ä¿¡æ¯æ¥æ”¹å–„å®‰å…¨æ€åŠ¿ã€‚è¿™å…è®¸æŒç»­ç›‘æ§æ‰€æœ‰èµ„äº§çš„å®Œæ•´æ€§å’Œå®‰å…¨çŠ¶å†µï¼Œå¹¶æŒç»­ç¡®ä¿ç­–ç•¥æ‰§è¡Œã€‚æ­¤å¤–ï¼Œåº”åé¦ˆä»è§‚å¯Ÿä¸­è·å¾—çš„è§è§£ä»¥æ”¹è¿›æ”¿ç­–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å®‰å…¨æ€§æ›´å¥½&#34;&gt;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å®‰å…¨æ€§æ›´å¥½&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå¯è¾¾æ€§ä¸æ˜¯æˆæƒ&lt;/strong&gt;ã€‚ä¸è¾¹ç•Œå®‰å…¨æ€§ä¸åŒï¼Œå¯¹æœåŠ¡çš„è®¿é—®ä¸ä¼šä»…ä»…å› ä¸ºè¯¥æœåŠ¡å¯è®¿é—®è€Œè¢«æˆäºˆã€‚å®ƒä¹Ÿå¿…é¡»ç»è¿‡æ˜ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘¨è¾¹çªç ´å£çš„æœ‰é™çˆ†ç‚¸åŠå¾„å¯é˜²æ­¢æ”»å‡»è€…æ¨ªå‘ç§»åŠ¨&lt;/strong&gt;ã€‚ç»è¿‡èº«ä»½éªŒè¯å’Œæˆæƒçš„å·¥ä½œè´Ÿè½½å…å—è¾¹ç•Œç ´åã€‚åŠæ—¶é™åˆ¶å‡­è¯æ³„éœ²çš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»†ç²’åº¦ç­–ç•¥&lt;/strong&gt;ã€‚ç©ºé—´è¾¹ç•Œå…è®¸é«˜ç²’åº¦çš„ç­–ç•¥æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢‘ç¹çš„æ”¿ç­–è¯„ä¼°&lt;/strong&gt;ã€‚é€šè¿‡åœ¨çŸ­æœŸä¼šè¯ä¸Šæ‰§è¡ŒåŠ¨æ€ç­–ç•¥æ¥åŠæ—¶ç»‘å®šå¯ç¡®ä¿æˆæƒåŸºäºæœ€æ–°çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨ã€çœŸå®çš„é€šä¿¡&lt;/strong&gt;ã€‚åŠ å¯†å’Œå¼ºå¤§çš„å·¥ä½œè´Ÿè½½èº«ä»½é™åˆ¶äº†ä¾¦å¯Ÿå¹¶æä¾›äº†é€šä¿¡çš„çœŸå®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨çŠ¶å†µå’Œåˆè§„æ€§çš„å®æ—¶å’Œå¯å®¡è®¡ä¿è¯&lt;/strong&gt;ã€‚ç»†ç²’åº¦çš„å¯è§‚å¯Ÿæ€§å…è®¸å®æ—¶ä¿è¯å’Œæ”¿ç­–å®æ–½çš„äº‹åå®¡è®¡ä»¥åŠæ•…éšœæ’é™¤å’Œåˆ†ææ‰€éœ€çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¦‚ä½•ä½¿ç”¨-istio-åœ¨-kubernetes-ä¸­å®ç°é›¶ä¿¡ä»»å®‰å…¨ç°ä»£å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å‚è€ƒæ¶æ„&#34;&gt;å¦‚ä½•ä½¿ç”¨ Istio åœ¨ Kubernetes ä¸­å®ç°é›¶ä¿¡ä»»å®‰å…¨ï¼šç°ä»£å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å‚è€ƒæ¶æ„&lt;/h2&gt;
&lt;p&gt;ä½œä¸º NIST çš„ä¸€èˆ¬é›¶ä¿¡ä»»æ¶æ„æ ‡å‡†çš„è¡¥å……ï¼ŒNIST è¿˜å‘å¸ƒäº†å¦‚ä½•å°†é›¶ä¿¡ä»»åŸåˆ™ä¸“é—¨åº”ç”¨äºå¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„æ ‡å‡†ã€‚è¿™äº›æ ‡å‡†ç”± Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å…±åŒç¼–å†™ï¼Œå¹¶ç¼–å…¥&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST çš„ SP 800-204 ç³»åˆ—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¯¥æ ‡å‡†ä¸­ï¼ŒNIST å»ºç«‹äº†ä¸€ä¸ªç”± Kubernetes ç»„æˆçš„å‚è€ƒå¹³å°ï¼Œç”¨äºç¼–æ’å’Œèµ„æºç®¡ç†ï¼Œå¹¶ä½¿ç”¨ Istio æœåŠ¡ç½‘æ ¼æä¾›æ ¸å¿ƒå®‰å…¨åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-å®‰å…¨æ¼æ´&#34;&gt;Kubernetes å®‰å…¨æ¼æ´&lt;/h2&gt;
&lt;p&gt;ç”±äº Kubernetes ä¸»è¦ä¸“æ³¨äºç¼–æ’ã€èµ„æºç®¡ç†å’ŒåŸºæœ¬è¿æ¥ï¼Œå› æ­¤å®ƒå°†é›¶ä¿¡ä»»ç½‘ç»œå®‰å…¨é—®é¢˜ç•™ç»™å…¶ä»–æ–¹è§£å†³ã€‚Kubernetes ä¸­çš„ä¸»è¦ç½‘ç»œå®‰å…¨æ¼æ´æ˜¯ï¼ˆNIST SP 800-204Bï¼ŒÂ§2.1.1ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤æƒ…å†µä¸‹ä¸å®‰å…¨çš„é€šä¿¡&lt;/li&gt;
&lt;li&gt;ç¼ºå°‘åœ¨ pod ä¹‹é—´å¼ºåˆ¶æ‰§è¡Œ TLS æ‰€éœ€çš„å†…ç½®è¯ä¹¦ç®¡ç†æœºåˆ¶&lt;/li&gt;
&lt;li&gt;ç¼ºä¹èº«ä»½å’Œè®¿é—®ç®¡ç†æœºåˆ¶&lt;/li&gt;
&lt;li&gt;åœ¨ OSI L3 è€Œé L7 è¿è¡Œçš„é˜²ç«å¢™ç­–ç•¥ï¼Œå› æ­¤æ— æ³•çª¥è§†æ•°æ®åŒ…æˆ–åšå‡ºå…ƒæ•°æ®é©±åŠ¨çš„å†³ç­–&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å¡«è¡¥äº†-kubernetes-çš„å®‰å…¨æ¼æ´å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸&#34;&gt;æœåŠ¡ç½‘æ ¼å¡«è¡¥äº† Kubernetes çš„å®‰å…¨æ¼æ´ï¼šå¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å¢å¼º Kubernetes çš„å®‰å…¨æ€§ï¼ŒIstio å……å½“ NIST å‚è€ƒæ¶æ„ä¸­çš„å®‰å…¨å†…æ ¸ã€‚Istio æ»¡è¶³å‚è€ƒç›‘è§†å™¨çš„ä¸‰ä¸ªè¦æ±‚ï¼ˆNIST SP 800-204Bï¼ŒÂ§5.1ï¼‰ã€‚Istio æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯æ—è·¯&lt;/li&gt;
&lt;li&gt;é˜²æ­¢ä¿®æ”¹&lt;/li&gt;
&lt;li&gt;éªŒè¯å’Œæµ‹è¯•æ˜¯æ­£ç¡®çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Envoy æ•°æ®å¹³é¢é€šè¿‡æ¯ä¸ªæœåŠ¡å‰é¢ä»¥åŠæ¯ä¸ªå…¥å£å’Œå‡ºå£ç½‘å…³çš„ä¸å¯ç»•è¿‡çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP) æä¾›å‚è€ƒç›‘è§†å™¨ã€‚æœåŠ¡ç½‘æ ¼ä»£ç ç‹¬ç«‹äºåº”ç”¨ç¨‹åºï¼Œå› æ­¤å®ƒçš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥ç‹¬ç«‹ç®¡ç†ï¼Œå¹¶ä¸”ä¸èƒ½åœ¨è¿è¡Œæ—¶ä¿®æ”¹ã€‚è€Œä¸”ï¼Œç½‘æ ¼æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªä¸¥æ ¼æ§åˆ¶çš„å…ƒç´ ï¼Œå¯ä»¥é€šè¿‡æ›´å¤šçš„çœ¼ç›å’Œæ›´ä»”ç»†çš„æ£€æŸ¥æ¥å¼ºåŒ–ï¼ˆNIST SP 800-204Bï¼ŒÂ§5.1ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸”ï¼Œä½œä¸ºä¸“ç”¨çš„åŸºç¡€æ¶æ„å±‚ï¼ŒIstio æä¾›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§£å†³&lt;strong&gt;æ¨ªåˆ‡åº”ç”¨ç¨‹åºé—®é¢˜çš„&lt;/strong&gt;ç»Ÿä¸€æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿè§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ’ä»¶&lt;/strong&gt;å’Œæ„å»ºè‡ªå®šä¹‰æ’ä»¶çš„æ¡†æ¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–&lt;/strong&gt;æ“ä½œå¤æ‚æ€§ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜“äºç®¡ç†&lt;/strong&gt;ç¬¬ä¸‰æ–¹å¼€å‘äººå‘˜å’Œé›†æˆå•†ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½&lt;/strong&gt;å¼€å‘å’Œè¿è¥æˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¦ä»è”é‚¦å®‰å…¨æ ‡å‡†çš„åˆè‘—è€…é‚£é‡Œäº†è§£æœ‰å…³&lt;strong&gt;å¦‚ä½•å®æ–½é›¶ä¿¡ä»»æ¶æ„çš„æ›´å¤šä¿¡æ¯ï¼Œ&lt;/strong&gt;&lt;a href=&#34;https://tetr8.io/zta-wp&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·é˜…è¯» Zack Butcher çš„é›¶ä¿¡ä»»æ¶æ„ç™½çš®ä¹¦&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ NIST å®‰å…¨å»ºè®®çš„æ·±å…¥æŒ‡å—ä»¥åŠ Tetrate å¦‚ä½•å¸®åŠ©æ‚¨å®æ–½è¯¥æ ‡å‡†ï¼Œè¯·æŸ¥çœ‹&lt;a href=&#34;https://tetr8.io/3Ccg6Qt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate çš„å¾®æœåŠ¡è”é‚¦å®‰å…¨è¦æ±‚æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä½¿ç”¨ Istio æŠ•å…¥ç”Ÿäº§çš„æœ€å¿«æ–¹å¼ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„å¼€æº&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro (TID)&lt;/a&gt;ã€‚TID æ˜¯ç»è¿‡å®¡æŸ¥çš„ Istio ä¸Šæ¸¸å‘è¡Œç‰ˆ â€”â€”Istio çš„å¼ºåŒ–æ˜ åƒï¼Œå…·æœ‰æŒç»­æ”¯æŒï¼Œæ›´æ˜“äºå®‰è£…ã€ç®¡ç†å’Œå‡çº§ã€‚å¯¹äºåœ¨è”é‚¦ç›‘ç®¡ç¯å¢ƒä¸­è¿è¥çš„ç»„ç»‡ï¼ŒTetrate Istio Distro æ˜¯å”¯ä¸€&lt;a href=&#34;https://istio.tetratelabs.io/fips-request/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…·æœ‰å¯ç”¨ FIPS éªŒè¯æ„å»º&lt;/a&gt;çš„ Istio å‘è¡Œç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨éœ€è¦ä¸€ç§ç»Ÿä¸€ä¸”ä¸€è‡´çš„æ–¹å¼æ¥ä¿æŠ¤å’Œç®¡ç†ä¸€ç³»åˆ—åº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge (TSB)&lt;/a&gt;ï¼Œè¿™æ˜¯æˆ‘ä»¬åŸºäº Istio å’Œ Envoy æ„å»ºçš„å…¨é¢çš„è¾¹ç¼˜åˆ°å·¥ä½œè´Ÿè½½åº”ç”¨ç¨‹åºè¿æ¥å¹³å°ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é›¶ä¿¡ä»» Kubernetes å®‰å…¨çš„ä¸‰å¤§ mTLS æœ€ä½³å®è·µ</title>
      <link>https://cloudnativecn.com/blog/top-3-mtls-best-practices-for-zero-trust-kubernetes-security/</link>
      <pubDate>Tue, 13 Dec 2022 10:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/top-3-mtls-best-practices-for-zero-trust-kubernetes-security/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes&lt;/a&gt; æ˜¯ç¼–æ’ç°ä»£äº‘åŸç”Ÿå·¥ä½œè´Ÿè½½çš„äº‹å®æ ‡å‡†ã€‚ä½†æ˜¯ï¼Œå®ƒä¸æä¾›å¼€ç®±å³ç”¨çš„å®‰å…¨é€šä¿¡ã€‚è¿™æ„å‘³ç€æ¯ä¸ªéœ€è¦å®æ–½ä¼ è¾“ä¸­åŠ å¯†ä»¥å¯¹å…¶ Kubernetes éƒ¨ç½²&lt;a href=&#34;https://tetr8.io/3FCXsDn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‡‡ç”¨é›¶ä¿¡ä»»å®‰å…¨æ€åŠ¿çš„&lt;/a&gt;äººéƒ½éœ€è¦è‡ªå·±è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šæ˜“äºç†è§£çš„æ–¹æ³•å¯ä»¥å®ç°ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»åœ¨ Kubernetes ä¸­å®ç°åŒå‘ TLSï¼ˆmTLSï¼‰çš„ä¸‰å¤§æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-mtlsä¸ºä»€ä¹ˆå¯¹å®‰å…¨æ¥è¯´å¾ˆé‡è¦&#34;&gt;ä»€ä¹ˆæ˜¯ mTLSï¼Œä¸ºä»€ä¹ˆå¯¹å®‰å…¨æ¥è¯´å¾ˆé‡è¦ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆSSL çš„åç»§è€…ï¼‰æ˜¯éƒ¨ç½²æœ€å¹¿æ³›çš„å®‰å…¨é€šä¿¡æ ‡å‡†ï¼Œåœ¨ HTTPS ä¸­æœ€ä¸ºæ˜æ˜¾ã€‚TLS éå¸¸é€‚åˆåœ¨éœ€è¦å‘å®¢æˆ·ç«¯è¯æ˜å…¶èº«ä»½çš„æœåŠ¡å™¨ä¹‹é—´å»ºç«‹æ—¢ä¿å¯†ï¼ˆé˜²çªƒå¬ï¼‰åˆçœŸå®ï¼ˆé˜²ç¯¡æ”¹ï¼‰çš„å®‰å…¨é€šä¿¡ã€‚ä½†æ˜¯ï¼Œåœ¨åŒæ–¹éƒ½éœ€è¦å‘å¯¹æ–¹è¯æ˜èº«ä»½çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚åœ¨ Kubernetes åº”ç”¨ç¨‹åºä¸­çš„å¾®æœåŠ¡ä¹‹é—´ï¼‰ï¼ŒTLS æ˜¯ä¸å¤Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯åŒå‘ TLS (mTLS) çš„ç”¨æ­¦ä¹‹åœ°ã€‚mTLS æ˜¯ TLSï¼Œä½†åŒæ–¹åœ¨å»ºç«‹å®‰å…¨é€šä¿¡é€šé“ä¹‹å‰å‘å¯¹æ–¹è¯æ˜è‡ªå·±çš„èº«ä»½ã€‚è¿™æ˜¯ Kubernetes ä¸­å®‰å…¨é€šä¿¡æ‰€éœ€çš„å¿…è¦éƒ¨åˆ†ã€‚mTLS æä¾›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨çº¿åŠ å¯†ä»¥ç¡®ä¿æœºå¯†æ€§å’Œé˜²ç¯¡æ”¹&lt;/li&gt;
&lt;li&gt;ç›¸äº’çš„ã€åŠ å¯†çš„å®‰å…¨èº«ä»½è¯æ˜ä»¥ç¡®ä¿çœŸå®æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦æ·±å…¥äº†è§£ mTLS çš„å·¥ä½œåŸç†ï¼Œè¯·å‚é˜…æˆ‘ä»¬å…³äº &lt;a href=&#34;https://tetr8.io/3NEcL0Q&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mTLS çš„æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mtls-çš„å›°éš¾éƒ¨åˆ†è¯æ˜èº«ä»½&#34;&gt;mTLS çš„å›°éš¾éƒ¨åˆ†ï¼šè¯æ˜èº«ä»½&lt;/h2&gt;
&lt;p&gt;å›°éš¾çš„éƒ¨åˆ†æ˜¯ä¸ºæœåŠ¡å»ºç«‹ä¸€ä¸ªå®‰å…¨æœºåˆ¶æ¥å‘å½¼æ­¤è¯æ˜å®ƒä»¬çš„èº«ä»½ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¸¸è§„ TLSï¼Œè¿‡å»å¾ˆéš¾ç®¡ç†å‘å…¶å®¢æˆ·ç«¯è¯æ˜æœåŠ¡å™¨èº«ä»½çš„è¯ä¹¦ã€‚&lt;a href=&#34;https://letsencrypt.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éšç€ Let&amp;rsquo;s Encrypt&lt;/a&gt; å’Œ &lt;a href=&#34;https://en.wikipedia.org/wiki/Automatic_Certificate_Management_Environment&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ACME åè®®&lt;/a&gt;çš„å‡ºç°ï¼Œè¿™å˜å¾—å®¹æ˜“å¤šäº†ã€‚ç„¶è€Œï¼Œåœ¨åƒ Kubernetes è¿™æ ·çš„åŠ¨æ€ï¼ˆå¹¶ä¸”ä¸»è¦æ˜¯ç§æœ‰çš„ï¼‰ç¯å¢ƒä¸­ç®¡ç†æœåŠ¡èº«ä»½å’Œè¯ä¹¦æ›´åŠ å›°éš¾ï¼Œå› ä¸ºæœ‰è®¸å¤šé€šå¸¸æ˜¯çŸ­æš‚çš„æœåŠ¡éœ€è¦å¼ºå¤§çš„ã€å¯è¯æ˜çš„èº«ä»½ï¼Œä½†å®é™…ä¸Šä¸èƒ½ä½¿ç”¨å…¬å…± ACME æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ¨å‡ºè‡ªå·±çš„è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸åˆ‡å®é™…ä¸”æœ‰é£é™©çš„ã€‚æ­£ç¡®ç®¡ç† mTLS è¯ä¹¦å¾ˆå›°éš¾ï¼Œé”™è¯¯çš„åæœå¾ˆä¸¥é‡ã€‚æ‚¨éœ€è¦ä¸€ç§å¯ä¿¡èµ–çš„ã€ç»è¿‡éªŒè¯çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼›è¿™å°±æ˜¯æœåŠ¡ç½‘æ ¼çš„ç”¨æ­¦ä¹‹åœ°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨æœåŠ¡ç½‘æ ¼nist-å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&#34;&gt;ä½¿ç”¨æœåŠ¡ç½‘æ ¼ï¼ŒNIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&lt;/h2&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&lt;/a&gt;ä¸­ï¼Œç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ (NIST) å»ºè®®ä½¿ç”¨æœåŠ¡ç½‘æ ¼ä½œä¸ºä¸“ç”¨åŸºç¡€è®¾æ–½å±‚æ¥æä¾›æ ¸å¿ƒç½‘ç»œå®‰å…¨åŠŸèƒ½ã€‚è¿™äº›æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€æ˜¯æ”¯æŒ mTLS çš„å¼ºå¤§æœåŠ¡èº«ä»½å’Œè¯ä¹¦ç®¡ç†ã€‚è€Œä¸”ï¼ŒIstioâ€”â€”&lt;a href=&#34;https://tetr8.io/3UsARgY&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨æœ€å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼&lt;/a&gt;â€”â€” ä¸ºæ‚¨æä¾›å¼€ç®±å³ç”¨çš„ mTLS æ”¯æŒã€‚Istio é€æ˜åœ°æä¾›åŸºç¡€è®¾æ–½ â€”â€” åŒ…æ‹¬å®‰å…¨å‘½åã€å¼ºå¤§çš„æœåŠ¡èº«ä»½å’Œè¯ä¹¦ç®¡ç† â€”â€” ç”¨äº Kubernetes å·¥ä½œè´Ÿè½½ä¹‹é—´çš„å®‰å…¨é€šä¿¡ä»¥åŠä¸å¤–ç•Œçš„è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è¯¦ç»†äº†è§£ NIST çš„å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ä»¥åŠ Tetrate å¦‚ä½•å¸®åŠ©æ»¡è¶³è¿™äº›æ ‡å‡†ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/3Ccg6Qt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate çš„å¾®æœåŠ¡è”é‚¦å®‰å…¨è¦æ±‚æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µä¸€ä¸è¦ä½¿ç”¨è‡ªç­¾åè¯ä¹¦&#34;&gt;æœ€ä½³å®è·µä¸€ï¼šä¸è¦ä½¿ç”¨è‡ªç­¾åè¯ä¹¦&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ Istio å°†ä¸ºæ‚¨å®æ–½ mTLSï¼Œä½†å®ƒé»˜è®¤ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œå› æ­¤æ‚¨å¯ä»¥ç«‹å³çœ‹åˆ°ç½‘æ ¼å·¥ä½œï¼Œåªéœ€æœ€å°‘çš„é…ç½®ã€‚è¿™ä½¿å¾—åˆå§‹ç”¨æˆ·ä½“éªŒå˜å¾—ç®€å•ï¼Œä½†å®ƒå¹¶éä¸é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚NIST çš„æŒ‡å—ï¼ˆNIST SP 800-204Aï¼ŒSM-DR12ï¼‰æ˜¯å®Œå…¨ç¦ç”¨ç”Ÿæˆè‡ªç­¾åè¯ä¹¦çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µäºŒå°†-istio-çš„ä¿¡ä»»æ ¹æ¤äºç°æœ‰-pki&#34;&gt;æœ€ä½³å®è·µäºŒï¼šå°† Istio çš„ä¿¡ä»»æ ¹æ¤äºç°æœ‰ PKI&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸åº”è¯¥ä½¿ç”¨ Istio çš„é»˜è®¤è‡ªç­¾åè¯ä¹¦ï¼Œè¿˜æœ‰ä»€ä¹ˆé€‰æ‹©ï¼Ÿç®€çŸ­çš„å›ç­”æ˜¯ï¼Œæ‚¨åº”è¯¥ &lt;a href=&#34;https://tetr8.io/3DDcAOJ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† Istio çš„ä¿¡ä»»æ ¹æ¤äºæ‚¨ç°æœ‰çš„å…¬é’¥åŸºç¡€è®¾æ–½ (PKI) ä¸­&lt;/a&gt;ã€‚è¿™å°†é€šè¿‡ç¡®ä¿å®ƒä»¬éƒ½å…·æœ‰ç›¸åŒçš„ä¿¡ä»»æ ¹æ¥å®ç°è·¨å…¶ä»–é›†ç¾¤ä¸­çš„ Istio éƒ¨ç½²çš„é€šä¿¡ã€‚è§‚çœ‹æˆ‘ä»¬å…³äº &lt;a href=&#34;https://www.youtube.com/watch?v=4b3H7isIAnQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Istio çš„å¤–éƒ¨ CA çš„è§†é¢‘ï¼Œäº†è§£æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µä¸‰ä½¿ç”¨ä¸­é—´è¯ä¹¦&#34;&gt;æœ€ä½³å®è·µä¸‰ï¼šä½¿ç”¨ä¸­é—´è¯ä¹¦&lt;/h2&gt;
&lt;p&gt;ç¡®åˆ‡åœ°è¯´ï¼Œæ‚¨å¦‚ä½•è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKIï¼ŸTetrate çš„åˆ›å§‹å·¥ç¨‹å¸ˆå’Œ NIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†çš„åˆè‘—è€… Zack Butcher &lt;a href=&#34;https://tetr8.io/3DDcAOJ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨æ­¤å¤„æä¾›äº†æ‰€æœ‰è¯¦ç»†ä¿¡æ¯&lt;/a&gt;ã€‚ä½†æ˜¯ï¼Œç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬çš„å»ºè®®æ˜¯ä½¿ç”¨æ‚¨ç»„ç»‡çš„æ ¹è¯ä¹¦é¢å‘æœºæ„é¢å‘çš„ä¸­é—´è¯ä¹¦ã€‚è¿™å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…è®¸ç»†ç²’åº¦çš„è¯ä¹¦æ’¤é”€ï¼Œè€Œæ— éœ€åŒæ—¶åœ¨æ•´ä¸ªåŸºç¡€æ¶æ„ä¸­å¼ºåˆ¶ä½¿ç”¨æ–°è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨ç­¾åè¯ä¹¦çš„è½»æ¾è½®æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰å…³å¦‚ä½•è‡ªåŠ¨åŒ– Istio è¯ä¹¦é¢å‘æœºæ„ (CA) è½®æ¢çš„åˆ†æ­¥è¯´æ˜ï¼Œè¯·å‚é˜…æˆ‘ä»¬å…³äº &lt;a href=&#34;https://tetrate.io/blog/automate-istio-ca-rotation-in-production-at-scale/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨å¤§è§„æ¨¡ç”Ÿäº§ä¸­è‡ªåŠ¨åŒ– Istio CA è½®æ¢çš„&lt;/a&gt;æ–‡ç« ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰æœåŠ¡ç½‘æ ¼å’Œ Kubernetes å®‰å…¨æ€§ï¼Œæˆ‘ä»¬åœ¨ &lt;a href=&#34;https://tetr8.io/academy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Academy&lt;/a&gt; æä¾›ä¸€ç³»åˆ—å…è´¹åœ¨çº¿è¯¾ç¨‹ï¼Œå¯ä»¥è®©æ‚¨å¿«é€Ÿäº†è§£ Istio å’Œ Envoyã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ç§å¿«é€Ÿå°† Istio æŠ•å…¥ç”Ÿäº§çš„æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distribution (TID)&lt;/a&gt;ã€‚TID æ˜¯ Tetrate çš„å¼ºåŒ–ã€å®Œå…¨ä¸Šæ¸¸çš„ Istio å‘è¡Œç‰ˆï¼Œå…·æœ‰ç»è¿‡ FIPS éªŒè¯çš„æ„å»ºå’Œæ”¯æŒã€‚è¿™æ˜¯å¼€å§‹ä½¿ç”¨ Istio çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºæ‚¨çŸ¥é“æ‚¨æœ‰ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„å‘è¡Œç‰ˆï¼Œæœ‰ä¸€ä¸ªæ”¯æŒæ‚¨çš„ä¸“å®¶å›¢é˜Ÿï¼Œå¹¶ä¸”å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥é€‰æ‹©å¿«é€Ÿè·å¾— FIPS åˆè§„æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å¯åŠ¨å¹¶è¿è¡Œ Istioï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´ç®€å•çš„æ–¹æ³•æ¥ç®¡ç†å’Œä¿æŠ¤æ‚¨çš„æœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ Istio ä¸­å¯ç”¨çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ Tetrate Service Bridge çš„ç”¨æ­¦ä¹‹åœ°ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://tetr8.io/tsb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨è¿™é‡Œ&lt;/a&gt;è¯¦ç»†äº†è§£ Tetrate Service Bridge å¦‚ä½•ä½¿æœåŠ¡ç½‘æ ¼æ›´å®‰å…¨ã€æ›´æ˜“äºç®¡ç†å’Œå¼¹æ€§ï¼Œæˆ–&lt;a href=&#34;https://tetr8.io/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬è¿›è¡Œå¿«é€Ÿæ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¤šèµ„æº&#34;&gt;æ›´å¤šèµ„æº&lt;/h2&gt;
&lt;p&gt;è§‚çœ‹æˆ‘ä»¬çš„è§†é¢‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=4b3H7isIAnQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Istio çš„å¤–éƒ¨ CA&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=nYJJ57WCkxE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio Ingress Gateway ä¸­çš„ SSL è¯ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=o8AnLk4Da7M&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ç”¨äºæ··åˆäº‘å’Œé—ç•™å·¥ä½œè´Ÿè½½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=mHR7rR83KjM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•å°† VM å·¥ä½œè´Ÿè½½è¿æ¥åˆ°ç½‘æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=E_D4bjvX8Xw&amp;amp;t=2s&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate å¦‚ä½•å¸®åŠ©ç¾å›½å›½é˜²éƒ¨å°† Istio ç”¨äºé›¶ä¿¡ä»»æ¶æ„&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>
