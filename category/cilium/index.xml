<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cilium | äº‘åŸç”Ÿç¤¾åŒºï¼ˆä¸­å›½ï¼‰</title>
    <link>https://cloudnativecn.com/category/cilium/</link>
      <atom:link href="https://cloudnativecn.com/category/cilium/index.xml" rel="self" type="application/rss+xml" />
    <description>Cilium</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Wed, 05 Feb 2025 15:22:42 +0800</lastBuildDate>
    <image>
      <url>https://cloudnativecn.com/media/sharing.png</url>
      <title>Cilium</title>
      <link>https://cloudnativecn.com/category/cilium/</link>
    </image>
    
    <item>
      <title>Cilium v1.17.0 å‘å¸ƒï¼Œæ–°ç‰¹æ€§ä¸€è§ˆ</title>
      <link>https://cloudnativecn.com/blog/cilium-1-17-0-release-highlights/</link>
      <pubDate>Wed, 05 Feb 2025 15:22:42 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-1-17-0-release-highlights/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/cilium/cilium/releases/tag/v1.17.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium v1.17.0&lt;/a&gt; å¸¦æ¥äº†è®¸å¤šæ–°çš„å¢å¼ºå’Œæ”¹è¿›ï¼Œä»¥ä¸‹æ˜¯æœ¬æ¬¡æ›´æ–°çš„ä¸»è¦äº®ç‚¹ï¼š&lt;/p&gt;
&lt;h2 id=&#34;-ç½‘ç»œnetworking&#34;&gt;ğŸš  ç½‘ç»œï¼ˆNetworkingï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸš¦ æœåŠ¡è´¨é‡ï¼ˆQuality of Serviceï¼‰&lt;/strong&gt;ï¼šå¯ä¸º Pod æ ‡æ³¨ &lt;code&gt;Guaranteed&lt;/code&gt;ã€&lt;code&gt;Burstable&lt;/code&gt; æˆ– &lt;code&gt;BestEffort&lt;/code&gt; å‡ºç«™æµé‡ä¼˜å…ˆçº§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŒ å¤šé›†ç¾¤æœåŠ¡ APIï¼ˆMulti-Cluster Service APIï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨ Kubernetes MCS åœ¨ Cilium Cluster Mesh ä¸­ç®¡ç†å…¨å±€æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ”€ åŸºäº L4 åè®®çš„è´Ÿè½½å‡è¡¡ï¼ˆLoad Balance based on L4 Protocolï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåŒºåˆ† TCP å’Œ UDP è´Ÿè½½å‡è¡¡ï¼Œä½¿ç›¸åŒç«¯å£çš„å¤šä¸ªæœåŠ¡èƒ½å¤Ÿåˆ†å‘åˆ°ä¸åŒçš„åç«¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ¥² æ¯ä¸ªæœåŠ¡çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼ˆPer-Service LB Algorithmsï¼‰&lt;/strong&gt;ï¼šå¯ä¸ºå•ä¸ªæœåŠ¡é€‰æ‹© &lt;code&gt;maglev&lt;/code&gt; æˆ– &lt;code&gt;random&lt;/code&gt; è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â›” æœåŠ¡æ¥æºèŒƒå›´çš„æ‹’ç»åˆ—è¡¨ï¼ˆDeny lists for Service source rangesï¼‰&lt;/strong&gt;ï¼šæ§åˆ¶ Kubernetes &lt;code&gt;loadBalancerSourceRanges&lt;/code&gt; æ˜¯å¦ä½œä¸ºå…è®¸æˆ–æ‹’ç»åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸŠ æ›´å¥½çš„ IPAM æ§åˆ¶ï¼ˆBetter control over IPAMï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåŸºäº AWS æ ‡ç­¾çš„é™æ€ IP åˆ†é…ï¼Œå¤šæ± æ¨¡å¼å¯æ”¯æŒå•ä¸ª IP èŒƒå›´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ› ï¸ åŠ¨æ€ MTU æ£€æµ‹ï¼ˆDynamic MTU detectionï¼‰&lt;/strong&gt;ï¼šCilium ç°åœ¨å¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æµ‹å¹¶è°ƒæ•´ MTUï¼Œæ— éœ€é‡å¯ä»£ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-å®‰å…¨security&#34;&gt;ğŸ’‚ï¸ å®‰å…¨ï¼ˆSecurityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸš€ æ”¹è¿›ç½‘ç»œç­–ç•¥æ€§èƒ½ï¼ˆImproved network policy performanceï¼‰&lt;/strong&gt;ï¼šé™ä½è®¡ç®—å¤æ‚ç½‘ç»œç­–ç•¥ç»„åˆçš„æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ—‚ï¸ ä¼˜å…ˆå¤„ç†å…³é”®ç½‘ç»œç­–ç•¥ï¼ˆPrioritize critical network policiesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒ Kubernetes &lt;code&gt;priorityNamespaces&lt;/code&gt;ï¼Œåœ¨ä½¿ç”¨ CiliumEndpointSlices æ—¶ä¼˜å…ˆä¼ æ’­å…³é”®å‘½åç©ºé—´çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“‹ ç½‘ç»œç­–ç•¥éªŒè¯ï¼ˆValidate Network Policiesï¼‰&lt;/strong&gt;ï¼šåœ¨åˆ›å»ºç½‘ç»œç­–ç•¥æ—¶å¯è·å¾—æ›´å¥½çš„åé¦ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ·ï¸ é€šè¿‡æ ‡ç­¾é€‰æ‹© CIDRGroupsï¼ˆSelect CIDRGroups by Labelï¼‰&lt;/strong&gt;ï¼šå¯ä¸º CIDRGroups æ·»åŠ æ ‡ç­¾ï¼Œå¹¶ç”¨äºç½‘ç»œç­–ç•¥é€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ›ï¸ æ‰©å±• ToServices ç”¨äºé›†ç¾¤å†…æœåŠ¡ï¼ˆExtend ToServices for in-cluster servicesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒå¸¦é€‰æ‹©å™¨çš„æœåŠ¡é€šè¿‡ &lt;code&gt;ToServices&lt;/code&gt; ç½‘ç»œç­–ç•¥è¿›è¡Œé€‰æ‹©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸš§ æ”¯æŒ hostNetwork çš„ FQDN è¿‡æ»¤ï¼ˆFQDN Filtering for hostNetworkï¼‰&lt;/strong&gt;ï¼šå¯ä½¿ç”¨ &lt;code&gt;CiliumClusterwideNetworkPolicy&lt;/code&gt; é…ç½®é›†ç¾¤èŠ‚ç‚¹çš„ DNS è¯·æ±‚çš„ L7 è¿‡æ»¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“¶ ç«¯å£èŒƒå›´ä¸Šçš„ HTTP ç­–ç•¥ï¼ˆHTTP policies on port rangesï¼‰&lt;/strong&gt;ï¼šæ”¯æŒåœ¨å•ä¸ªç­–ç•¥ä¸­é‡å®šå‘å¤šä¸ªç«¯å£åˆ° Envoy è¿›è¡Œ L7 è¿‡æ»¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-æœåŠ¡ç½‘æ ¼--gateway-apiservice-mesh--gateway-api&#34;&gt;ğŸ•¸ï¸ æœåŠ¡ç½‘æ ¼ &amp;amp; Gateway APIï¼ˆService Mesh &amp;amp; Gateway APIï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â›©ï¸ Gateway API 1.2.1&lt;/strong&gt;ï¼šæ”¯æŒæœ€æ–°çš„ Gateway API v1.2.1ï¼ŒåŒ…æ‹¬ HTTP é‡è¯•å’Œé•œåƒæµé‡æ¯”ä¾‹æ§åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“ é™æ€ç½‘å…³åœ°å€ï¼ˆStatic Gateway Addressingï¼‰&lt;/strong&gt;ï¼šæ”¯æŒé™æ€æŒ‡å®šç½‘å…³åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ” æ”¹è¿› Envoy TLS å¤„ç†ï¼ˆImproved Envoy TLS handlingï¼‰&lt;/strong&gt;ï¼šä½¿ç”¨ SDS ç®¡ç† Envoy çš„ TLS å¯è§æ€§å¯†é’¥ï¼Œæé«˜ç­–ç•¥è®¡ç®—é€Ÿåº¦å’Œå¯†é’¥è®¿é—®æ•ˆç‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-å¯è§‚æµ‹æ€§observability&#34;&gt;ğŸ‘ï¸ å¯è§‚æµ‹æ€§ï¼ˆObservabilityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸ” åŠ¨æ€ Hubble æŒ‡æ ‡ï¼ˆDynamic Hubble Metricsï¼‰&lt;/strong&gt;ï¼šæ”¯æŒ &lt;code&gt;hubble-metrics-config&lt;/code&gt; ConfigMap é…ç½® Hubble æŒ‡æ ‡ï¼Œä¼˜åŒ–ç½‘ç»œå¯è§‚æµ‹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ›¤ï¸ é€šè¿‡ Prometheus ç›‘æ§å¯ç”¨çš„åŠŸèƒ½ï¼ˆTrack enabled features using Prometheusï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;cilium-agent&lt;/code&gt; å’Œ &lt;code&gt;cilium-operator&lt;/code&gt; ç»„ä»¶ç°å¯æš´éœ² Prometheus æŒ‡æ ‡ï¼Œæ˜¾ç¤ºå·²å¯ç”¨çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“Š æ›´å¤šæ–°æŒ‡æ ‡ï¼ˆMany new metricsï¼‰&lt;/strong&gt;ï¼šå¢å¼º BGPã€ç½‘ç»œè¿æ¥ã€ç½‘ç»œç­–ç•¥ã€Pod ç®¡ç†å’Œ Cilium ç»„ä»¶çŠ¶æ€çš„ç›‘æ§æŒ‡æ ‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-è§„æ¨¡scale&#34;&gt;ğŸŒ… è§„æ¨¡ï¼ˆScaleï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ğŸ“ˆ æ”¹è¿›é›†ç¾¤è¿æ¥æ€§æ£€æŸ¥ï¼ˆBetter cluster connectivity checkingï¼‰&lt;/strong&gt;ï¼š&lt;code&gt;cilium-health&lt;/code&gt; ç»„ä»¶é’ˆå¯¹å¤§è§„æ¨¡é›†ç¾¤è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä»¥æé«˜ç½‘ç»œå¥åº·æ£€æŸ¥çš„å¯é æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â³ é€Ÿç‡é™åˆ¶ç›‘æ§äº‹ä»¶ï¼ˆRate-limit monitor eventsï¼‰&lt;/strong&gt;ï¼šä¼˜åŒ– eBPF äº‹ä»¶å¤„ç†ï¼Œé™ä½ CPU è´Ÿè½½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ğŸ‘¥ åŒå†™èº«ä»½æ¨¡å¼ï¼ˆDouble-Write Identity modeï¼‰&lt;/strong&gt;ï¼šæ–°å¢å®‰å…¨èº«ä»½åˆ†é…æ¨¡å¼ï¼Œç®€åŒ– CRD å’Œ KVStore ä¹‹é—´çš„è¿ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;âš–ï¸ æ›´å¥½çš„è§„æ¨¡æµ‹è¯•ï¼ˆBetter scale testingï¼‰&lt;/strong&gt;ï¼šæœ¬æ¬¡å‘å¸ƒåŒ…å«å®šæœŸè‡ªåŠ¨åŒ–å¤§è§„æ¨¡æµ‹è¯•ï¼Œå¢å¼ºç½‘ç»œç­–ç•¥çš„ç¨³å®šæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;-ç¤¾åŒºcommunity&#34;&gt;ğŸ¡ ç¤¾åŒºï¼ˆCommunityï¼‰&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;â¤ï¸ Cilium åœ¨ç”Ÿäº§ç¯å¢ƒçš„ç”¨æˆ·æ¡ˆä¾‹&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cncf.io/case-studies/seznam/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Seznam&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/alibaba/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Alibaba Cloud&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/syseleven/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SysEleven&lt;/a&gt;ã€&lt;a href=&#34;https://www.cncf.io/case-studies/qingcloud/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;QingCloud&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=Ennjmo9TFaM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ECCO&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=YNDp7Id7Bbs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Reddit&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=vOSiVeBXYpM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Confluent&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=2KlVTx611bk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SamsungAds&lt;/a&gt;ã€&lt;a href=&#34;https://www.youtube.com/watch?v=M0PincxlHpI&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sony&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium_Annual_Report_2024.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å¹´åº¦æŠ¥å‘Š 2024&lt;/a&gt;&lt;/strong&gt;ï¼šæ€»ç»“äº†ç¤¾åŒºçš„å¹´åº¦äº®ç‚¹ï¼Œå¹¶å¼ºè°ƒäº† Kubernetes ç½‘ç»œçš„å…³é”®å‘å±•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¤¾åŒºæ´»åŠ¨&lt;/strong&gt;ï¼š
&lt;ul&gt;
&lt;li&gt;Cilium ç¤¾åŒºåœ¨ &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/co-located-events/cilium-ebpf-day/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium + eBPF Day&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/cilium/dev-summits/tree/main/2024-NA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium Developer Summit&lt;/a&gt; è¿›è¡Œçº¿ä¸‹èšä¼šã€‚&lt;/li&gt;
&lt;li&gt;æ¬¢è¿å‚åŠ å³å°†åˆ°æ¥çš„ &lt;a href=&#34;https://events.linuxfoundation.org/kubecon-cloudnativecon-europe/co-located-events/ciliumcon/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CiliumCon&lt;/a&gt; å’Œ &lt;a href=&#34;https://docs.google.com/forms/d/e/1FAIpQLSd8E1dtCYiwqcw1MemQU3RDKlIQNBi2dRVMVGqDPgSow9mKjA/viewform?usp=header&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium Developer Summit&lt;/a&gt;ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>è§£å¯† Kubernetes ç½‘ç»œï¼šè·Ÿéšæ•°æ®åŒ…çš„å¥‡å¦™æ—…ç¨‹</title>
      <link>https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/</link>
      <pubDate>Fri, 08 Mar 2024 12:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/</guid>
      <description>&lt;p&gt;æœ€è¿‘å¯¹äºç†è§£ Kubernetes ä¸­çš„ç½‘ç»œæœ‰å¾ˆå¤§çš„å…´è¶£ã€‚æœ¬æ–‡æ˜¯æˆ‘å¯¹è¿™ä¸ªè¯é¢˜çš„è´¡çŒ®ã€‚æˆ‘ä¼šå°½åŠ›ç”¨ç›´è§‚çš„æ–¹å¼è§£é‡Šï¼Œå¹¶å°†æŠ€æœ¯éƒ¨åˆ†ç¿»è¯‘æˆæ˜“æ‡‚çš„è¯­è¨€ï¼Œä»¥ä¾¿ä»»ä½•äººéƒ½èƒ½ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;æœ€å¥½çš„å­¦ä¹ ç½‘ç»œçš„æ–¹å¼æ˜¯é€šè¿‡â€œè¿½è¸ªæ•°æ®åŒ…â€æˆ–â€œæ•°æ®åŒ…çš„ç”Ÿå‘½å‘¨æœŸâ€ã€‚åŸºæœ¬ä¸Šï¼Œä½ è¦è·Ÿéšæ•°æ®åŒ…ä»å‘é€è€…åˆ°æ¥æ”¶è€…çš„æ—…ç¨‹ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥åœä¸‹æ¥ã€‚æˆ‘ä»¥å‰å°±ç”¨ &lt;a href=&#34;https://www.dbi-services.com/blog/exploration-of-calico-in-minikube/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Calico å®ç°çš„ Pod åˆ°å¦ä¸€ä¸ª Pod çš„é€šä¿¡&lt;/a&gt; è¿›è¡Œäº†è¿™æ ·çš„æ“ä½œã€‚è¿™æ¬¡æˆ‘å°†ä½¿ç”¨å¦ä¸€ä¸ªå®¹å™¨ç½‘ç»œæ¥å£ (CNI) å«åš &lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium&lt;/a&gt;ï¼Œå®ƒåŸºäº eBPFï¼ˆäº†è§£å¿«é€Ÿå’Œçµæ´»çš„è·¯ç”±ï¼‰ï¼Œå¹¶å¸¦æœ‰è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½å’Œå·¥å…·ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-ä¸­çš„ä¼ ç»Ÿç½‘ç»œ&#34;&gt;Kubernetes ä¸­çš„ä¼ ç»Ÿç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å°†ä»å¤´å¼€å§‹ã€‚æˆ‘ä¼šå‡è®¾ä½ å¯¹ç½‘ç»œä¸€æ— æ‰€çŸ¥ã€‚ä¹Ÿè®¸ä½ å·²ç»çŸ¥é“ IP åœ°å€æ˜¯ä»€ä¹ˆï¼ŸIP åœ°å€æ˜¯è®¡ç®—æœºç½‘ç»œæ¥å£çš„æ•°å­—åœ°å€ã€‚è¿™å°±æ˜¯ä½ çš„è®¡ç®—æœºå¯ä»¥è¿æ¥åˆ°ä½ çš„ Wi-Fi ç½‘ç»œå¹¶è®©ä½ è®¿é—®äº’è”ç½‘çš„æ–¹å¼ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç¬”è®°æœ¬ç”µè„‘ï¼Œä½ çš„ Wi-Fi ç½‘ç»œæ¥å£æœ‰ä¸€ä¸ª IP åœ°å€ã€‚è¿™ä¸ªç½‘ç»œæ¥å£è¿˜æœ‰å¦ä¸€ä¸ªç”±ç¡¬ä»¶æä¾›å•†çƒ§å½•çš„å”¯ä¸€åœ°å€ã€‚è¿™ä¸ªåœ°å€ç§°ä¸ºä»‹è´¨è®¿é—®æ§åˆ¶ (MAC) åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;IP åœ°å€å±äºä¸€ä¸ªç»„ï¼ˆIP å­ç½‘ï¼‰ã€‚ä¸ºäº†çŸ¥é“å®ƒå±äºå“ªä¸ªç»„ï¼Œå®ƒä½¿ç”¨ä¸€ç§ç§°ä¸ºå­ç½‘æ©ç çš„ä¸œè¥¿ã€‚å½“å­ç½‘æ©ç åº”ç”¨åˆ° IP åœ°å€æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¯¹äºå±äºåŒä¸€ç»„çš„æ¯ä¸ª IP åœ°å€æ¥è¯´ï¼Œè¿™ä¸ªç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚è¿™å°±åƒä½ æ‰€åœ¨çš„ç¤¾åŒºä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ç”¨ä¸‹é¢çš„å›¾æ¥åšç±»æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä¼ ç»Ÿç½‘ç»œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä¼ ç»Ÿç½‘ç»œ&#34; srcset=&#34;
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu6861543970302074284.webp 400w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu1390651422904168173.webp 760w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu8198011195257205095.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/f1_hu6861543970302074284.webp&#34;
               width=&#34;760&#34;
               height=&#34;362&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä¼ ç»Ÿç½‘ç»œ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ¿å­æ˜¯ä¸€å°è®¡ç®—æœºã€æœåŠ¡å™¨æˆ–è™šæ‹Ÿæœºã€‚å®ƒçš„å¤§å°å¯ä»¥ä¸åŒï¼Œæ ¹æ®å®ƒçš„ CPU å’Œå†…å­˜ï¼Œä½†ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„å¤§å°ã€‚ä¸€æ ‹æˆ¿å­æœ‰ä¸€æ‰‡é—¨ï¼Œè¿™å°±æ˜¯ä½ çš„ç½‘ç»œæ¥å£ã€‚é—¨ä¸Šçš„åºåˆ—å·æ˜¯ä½ çš„ MAC åœ°å€ï¼Œæˆ¿å­ä¸Šçš„æ•°å­—ï¼ˆé€šå¸¸æ˜¯é’‰åœ¨é—¨ä¸Šçš„ï¼‰æ˜¯ä½ çš„ IP åœ°å€ã€‚åªæœ‰åœ¨ä½ æ¢é—¨æ—¶ï¼Œä½ çš„åºåˆ—å·æ‰ä¼šæ”¹å˜ã€‚ç„¶è€Œï¼Œä½ çš„æˆ¿å­å·ç æ˜¯ç”±ä½ çš„ç¤¾åŒºçš„å»ºç­‘å¸ˆåˆ†é…çš„ï¼Œå¦‚æœæœ‰é‡æ–°åˆ†é…æˆ–è®¾è®¡æ›´æ”¹ï¼Œå®ƒå¯èƒ½ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;è“è‰²çš„ç¬¬ 10 ä¸ªç¤¾åŒºï¼ˆä½¿ç”¨ä» 10 åˆ° 19 çš„æ•°å­—ï¼‰å±äºåŒä¸€ç»„ï¼ˆåŒä¸€ IP å­ç½‘ï¼‰ï¼Œè€Œç»¿è‰²çš„ç¬¬ 20 ä¸ªç¤¾åŒºæ˜¯å¦ä¸€ç»„ã€‚åœ¨æ¯ä¸ªç¤¾åŒºä¸­ï¼Œæœ‰äº”æ ‹æˆ¿å­ï¼Œæ‰€ä»¥æœ‰ç©ºé—´è®©ç¤¾åŒºæˆé•¿ã€‚åœ¨æ¯ä¸ªç¤¾åŒºé‡Œï¼Œé—¨ç›´æ¥è¿æ¥åˆ°ä¸€ä¸ªå–·æ³‰ï¼Œä»£è¡¨ä¸€ä¸ªäº¤æ¢æœºã€‚åœ¨å–·æ³‰å¤„ï¼Œæœ‰ä¸€ä¸ªæŒ‡ç¤ºæ¯æ¡è·¯å¾„çš„æ ‡å¿—ï¼ŒæŒ‡ç¤ºä½ å¯ä»¥åˆ°è¾¾å“ªæ‰‡é—¨ã€‚æ˜¯çš„ï¼Œå–·æ³‰ä¸çŸ¥é“æˆ¿å­å·ç ï¼ŒåªçŸ¥é“é—¨çš„åºåˆ—å·ã€‚å¯¹äºäººç±»æ¥è¯´ï¼Œè¿™ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸€å¼ åœ°å›¾ï¼ˆç§°ä¸º ARP è¡¨ï¼‰ï¼Œå®ƒæä¾›äº†æˆ¿å­å·ç ä¸é—¨çš„åºåˆ—å·ä¹‹é—´çš„è½¬æ¢ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½åœ¨ 14 å·æˆ¿å­ï¼Œæƒ³æ‹œè®¿ 15 å·æˆ¿å­ï¼Œä½ ä¼šä½¿ç”¨è¿™æ¡è·¯ï¼ˆåªæœ‰ä¸€æ¡ï¼Œè€Œä¸”æ˜¯ä½ çš„ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰äº¤é€šå µå¡ï¼ï¼‰å…ˆåˆ°è¾¾å–·æ³‰ï¼Œç„¶åçœ‹çœ‹æ ‡å¿—ã€‚ä½ ä»åœ°å›¾ä¸ŠçŸ¥é“å“ªä¸ªåºåˆ—å·å¯¹åº”å“ªä¸ªæˆ¿å­ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ²¿ç€é€šå¾€ 15 å·æˆ¿å­çš„è·¯çº¿å‰å¾€ã€‚åœ¨è¿™ç§æ˜Ÿå½¢æ‹“æ‰‘ä¸­ï¼Œä½ æ€»æ˜¯å…ˆå»å–·æ³‰ï¼Œè€Œä¸æ˜¯ç›´æ¥å»ä½ æƒ³è¦æ‹œè®¿çš„æˆ¿å­ï¼Œå› ä¸ºæ²¡æœ‰ç›´æ¥çš„è·¯å¾„ã€‚ç¤¾åŒºå†…çš„è·¯å¾„ä»£è¡¨äº†ç¬¬ 2 å±‚é“¾æ¥ã€‚ä½ æ— æ³•é€šè¿‡è¿™äº›è·¯å¾„åˆ°è¾¾å¦ä¸€ä¸ªç¤¾åŒºã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ç¤¾åŒºä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨ç¤¾åŒºä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœä»ä½ çš„ 14 å·æˆ¿å­ï¼Œä½ æƒ³è¦å»æ‹œè®¿ 24 å·æˆ¿å­æ€ä¹ˆåŠï¼Ÿè¿™æ˜¯å¦ä¸€ä¸ªç¤¾åŒºï¼Œè¿™æ„å‘³ç€ 14 å·çš„ IP åœ°å€/å­ç½‘æ©ç ä¸ 24 å·ä¸åŒã€‚å®é™…ä¸Šï¼Œç¬¬ 10 å’Œç¬¬ 20 ç¤¾åŒºæ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥ä½ çŸ¥é“ç›®çš„åœ°æ˜¯å¦ä¸€ä¸ªç¤¾åŒºï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»é¦–å…ˆå»æ‰¾ä½ çš„é—¨å«ï¼ˆä½†æ€»æ˜¯é€šè¿‡å–·æ³‰ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼‰ã€‚ä»–æ˜¯ä½ ç¤¾åŒºçš„é»˜è®¤ç½‘å…³ï¼Œä»–ä½åœ¨ 11 å·æˆ¿å­ã€‚è§„åˆ™æ˜¯å»æ‰¾ä»–ï¼Œå¯¹äºä»»ä½•ç›®çš„åœ°åœ¨ä½ ç¤¾åŒºä¹‹å¤–çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;åªæœ‰ä»–æœ‰åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰èƒ½å¤Ÿåˆ°è¾¾ç¬¬ 20 å·ç¤¾åŒºï¼Œå¹¶ä¸”çŸ¥é“åº”è¯¥èµ°å“ªæ¡è·¯ï¼ˆè¿™è¢«ç§°ä¸ºç¬¬ 3 å±‚è·¯ç”±ï¼Œå› ä¸ºä½ æ­£åœ¨ç¦»å¼€ä½ çš„ç¤¾åŒºï¼‰ã€‚è¿™å¼ åœ°å›¾æ˜¾ç¤ºäº†åˆ°è¾¾ 20 å·ç¤¾åŒºçš„æ­£ç¡®é—¨ã€‚ç­‰ä¸€ä¸‹ï¼Œå¦‚æœä¸€æ‰‡é—¨æ˜¯ä¸€ä¸ªç½‘ç»œæ¥å£ï¼Œé‚£ä¹ˆé—¨å«æˆ¿å­æ˜¯ä¸æ˜¯è¿˜æœ‰å¦ä¸€æ‰‡é—¨ï¼Ÿå®Œå…¨æ­£ç¡®ï¼11 å·æˆ¿å­æœ‰å¦ä¸€æ‰‡é—¨ï¼Œé—¨ä¸Šæœ‰å¦ä¸€ä¸ªå·ç ï¼ˆ101ï¼‰ï¼Œå½“ç„¶è¿™æ‰‡é—¨ä¸Šæœ‰å¦ä¸€ä¸ªåºåˆ—å·ï¼ˆMAC åœ°å€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¿™æ‰‡é—¨å‡ºå»ï¼Œä½ ç°åœ¨å¯ä»¥æ²¿ç€è·¯å¾„åˆ°è¾¾ç¬¬ 20 å·ç¤¾åŒºï¼Œè¿™ä¸ªç¤¾åŒºæœ‰è‡ªå·±çš„é—¨å«åœ¨ 21 å·æˆ¿å­ã€‚è¿™ä¸ªé—¨å«çš„åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰æŒ‡å¯¼ä½ åˆ°è¾¾ç›®çš„åœ°çš„æ­£ç¡®é—¨ã€‚è¿™æ‰‡é—¨è®©ä½ è¿›å…¥äº†ç¬¬ 20 å·ç¤¾åŒºï¼Œå› ä¸ºä½ çš„ç›®çš„åœ° 24 å±äºå®ƒã€‚é—¨å«è¿˜ç»™äº†ä½ åœ°å›¾ï¼ˆARP è¡¨ï¼‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨å–·æ³‰ä¸Šæ‰¾åˆ°æ–¹å‘ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ²¿ç€é€šå¾€ç»¿è‰²å–·æ³‰çš„è·¯å¾„èµ°äº†ã€‚ä»é‚£é‡Œï¼Œä½ åªéœ€è·Ÿç€æ ‡å¿—å’Œè·¯å¾„åˆ°è¾¾ 24 å·æˆ¿å­ã€‚å½“ä½ æƒ³å›å®¶æ—¶ï¼Œä½ æ²¿ç€ç›¸åçš„æ–¹å‘èµ°åŒæ ·çš„è·¯å¾„å›å»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-ä¸­çš„ç½‘ç»œ&#34;&gt;Kubernetes ä¸­çš„ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä½ äº†è§£äº†ç½‘ç»œçš„åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ Kubernetes ä¸­å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ˜¯çš„ï¼Œå®ƒç¨å¾®å¤æ‚ä¸€äº›ï¼Œä½†è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œä½¿ç”¨ä¸‹é¢çš„å›¾ç‰‡æ¥æ›´å¥½åœ°ç†è§£ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨-cilium-çš„-kubernetes-ç½‘ç»œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨ Cilium çš„ Kubernetes ç½‘ç»œ&#34; srcset=&#34;
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu11103571505158891617.webp 400w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu9661544583486170647.webp 760w,
               /blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu4729721895056552182.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/kubernetes-networking-by-using-cilium-beginner-level/f2_hu11103571505158891617.webp&#34;
               width=&#34;760&#34;
               height=&#34;435&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨ Cilium çš„ Kubernetes ç½‘ç»œ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨æ²¡æœ‰æˆ¿å­ï¼Œè€Œæ˜¯å»ºç­‘ã€‚å»ºç­‘ä¹‹é—´çš„ç½‘ç»œä¸ä¼ ç»Ÿç½‘ç»œä»ç„¶ç›¸åŒï¼Œä¸­é—´æœ‰ä¸€ä¸ªäº¤æ¢æœº/å–·æ³‰ã€‚å»ºç­‘çš„å…¥å£æœ‰ä¸€æ‰‡é—¨ï¼Œä¸Šé¢æœ‰å»ºç­‘çš„å·ç ï¼ˆå®ƒçš„ IP åœ°å€ï¼‰ï¼Œå®ƒæ˜¯ 1000 ä¸ªç¤¾åŒºçš„ä¸€ä»½å­ã€‚ä¸€ä¸ªå»ºç­‘å°†ä»£è¡¨æˆ‘ä»¬ Kubernetes é›†ç¾¤çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½ çŸ¥é“ Kubernetes æ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’å™¨ã€‚ä¸€ä¸ªå®¹å™¨åŒ…è£…æˆä¸€ä¸ª podã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬å‡è®¾ä¸€ä¸ª pod åªæœ‰ä¸€ä¸ªå®¹å™¨ï¼Œå› æ­¤è¿™ä¸¤ä¸ªæœ¯è¯­åœ¨è¿™é‡Œæ˜¯ç­‰ä»·çš„ã€‚è¿™ä¸ª pod å°±åƒæˆ‘ä»¬å»ºç­‘ä¸­çš„ä¸€ä¸ªç§äººéƒ¨åˆ†ã€‚å…¬å¯“çš„å¤§å°å¯ä»¥ä¸åŒï¼Œå› ä¸ºå®ƒå¯èƒ½æœ‰ 2ã€3 æˆ– 4 ä¸ªå§å®¤ï¼Œè¿™å°†æ˜¯ä½ çš„å®¹å™¨åœ¨èŠ‚ç‚¹ä¸Šéœ€è¦çš„ CPU å’Œå†…å­˜å®¹é‡ã€‚æœ‰äº›å…¬å¯“æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å»ºç­‘ä»ç„¶æœ‰ä¸€äº›å®¹é‡ã€‚ç„¶è€Œï¼Œåœ¨ Kubernetes ä¸­ï¼Œpod æ˜¯æ ¹æ®éœ€è¦åˆ›å»ºå’Œåˆ é™¤çš„ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬çš„å»ºç­‘ä¸­ï¼Œè¿™æ„å‘³ç€æœ‰æ—¶ä¼šåˆ›å»ºä¸€ä¸ª 2 å§å®¤çš„å…¬å¯“ï¼Œå½“ä¸å†ä½¿ç”¨æ—¶ï¼Œå®ƒå¯èƒ½ä¼šè¢«ä»å»ºç­‘ç‰©ä¸­ç§»é™¤ã€‚ç„¶åï¼Œå¦‚æœå»ºç­‘æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œå¯èƒ½ä¼šåˆ›å»ºä¸€ä¸ª 5 å§å®¤çš„å…¬å¯“ã€‚ç„¶åæƒ³è±¡ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€åº§ä¹é«˜å»ºç­‘ï¼Œé‡Œé¢ä½ å¯ä»¥æ ¹æ®éœ€è¦å»ºé€ å’Œæ‹†é™¤ä¸åŒå¤§å°çš„å…¬å¯“ï¼è¿™ä¸æ˜¯å¾ˆæ£’å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æ¯ä¸ªå»ºç­‘ç‰©ä¸­ï¼Œå®¹å™¨/pod æœ‰è‡ªå·±çš„ç¤¾åŒºï¼ˆIP å­ç½‘ï¼‰ã€‚åœ¨ Kubernetes ä¸­ï¼ŒCNI çš„åŠŸèƒ½åŸºæœ¬ä¸Šæ˜¯ä¸º pod åˆ†é…å·ç ï¼ˆIP åœ°å€ï¼‰ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥å½¼æ­¤é€šä¿¡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä¸ºæ¯ä¸ªå»ºç­‘ä½¿ç”¨ä¸åŒçš„ç¤¾åŒºã€‚å½“åˆ›å»ºä¸€ä¸ªå…¬å¯“æ—¶ï¼ŒCilium ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªå·ç ã€‚å½“åˆ é™¤å¹¶é‡æ–°åˆ›å»ºä¸€ä¸ªå…¬å¯“æ—¶ï¼Œå®ƒå°†è·å¾—å¦ä¸€ä¸ªå·ç ï¼Œå› æ­¤å®ƒæ˜¯ä¸´æ—¶çš„ã€‚è¿™é‡Œè“è‰²çš„ç¤¾åŒºä½¿ç”¨ 10 å·èŒƒå›´ï¼Œç»¿è‰²çš„ç¤¾åŒºä½¿ç”¨ 20 å·ã€‚ä½ å¯ä»¥æ³¨æ„åˆ°è“è‰²å’Œç»¿è‰²ç¤¾åŒºçš„æ•°å­—èŒƒå›´ä¸å»ºç­‘ç‰©çš„èŒƒå›´ä¸åŒã€‚åªæ˜¯ä¸ºäº†è®©ä½ çŸ¥é“ï¼Œè¿™ç§è®¾è®¡è¢«ç§°ä¸ºå åŠ ç½‘ç»œã€‚è¿˜æœ‰å…¶ä»–å¯èƒ½çš„ï¼Œä½†è¿™æ˜¯å¸¸ç”¨çš„ä¸€ç§ã€‚è¿™æ˜¯ä¸€ä¸ªåœ¨èŠ‚ç‚¹ç½‘ç»œä¹‹ä¸Šçš„ pod ç½‘ç»œã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨åŒä¸€å»ºç­‘ä¸­çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨åŒä¸€å»ºç­‘ä¸­çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œä½ ä½åœ¨ 12 å·å…¬å¯“ï¼Œä½ è¦æ€ä¹ˆå»æ‹œè®¿ 14 å·å…¬å¯“ï¼Ÿå°±åƒæˆ‘ä»¬åœ¨ä¼ ç»Ÿç½‘ç»œç¤ºä¾‹ä¸­æ‰€åšçš„é‚£æ ·ï¼Œä½ æ˜¯æˆ‘ä»¬è¦è¿½è¸ªçš„æ•°æ®åŒ…ï¼å½“ç„¶ï¼Œä½ é€šè¿‡å®ƒçš„é—¨ï¼ˆå®ƒçš„ç½‘ç»œæ¥å£ï¼‰ç¦»å¼€å…¬å¯“ã€‚ä¸æˆ‘ä»¬ä¹‹å‰çš„ç¤ºä¾‹ä¸åŒä¹‹å¤„åœ¨äºï¼Œä½ ç°åœ¨ä¸æ˜¯ç¦»å¼€æˆ¿å­ï¼Œè€Œæ˜¯ç¦»å¼€äº†ä½ çš„å…¬å¯“ï¼Œä½†ä»ç„¶åœ¨å»ºç­‘ç‰©å†…éƒ¨ã€‚ç„¶åä½ èµ°è¿‡ä¸€ä¸ªç§äººèµ°å»Šï¼Œåˆ°è¾¾å¦ä¸€æ‰‡é—¨ï¼ˆè¿™æ˜¯ LXC æ¥å£ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ‰‡é—¨ç»™äº†ä½ è¿›å…¥å»ºç­‘çš„å…¬å…±ç©ºé—´çš„è®¿é—®ï¼Œè¿™é‡Œè¿›è¡Œäº†è·¯ç”±å’Œæ´¾å‘ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º Cilium å¤§å…ï¼ˆè“è‰²çŸ©å½¢ï¼‰ã€‚å½“é€‰æ‹© Cilium ä¸ºè¿™ä¸ª Kubernetes é›†ç¾¤æä¾›é€šä¿¡æ—¶ï¼Œæ¯ä¸ªå»ºç­‘ç‰©éƒ½å®‰è£…äº†è¿™ä¸ªå¤§å…çš„ Cilium ä»£ç†ã€‚å¤§å…é‡Œæœ‰ä¸€ä¸ªé—¨å«ï¼Œä»–ä¸ä½åœ¨å…¬å¯“é‡Œï¼Œè€Œæ˜¯åœ¨å¤§å…çš„ä¸€ä¸ªç”²æ¿ä¸Šç­‰å¾…ã€‚ä»–æœ‰ä¸€ä¸ªæœåŠ¡äººå‘˜å›¢é˜Ÿï¼Œåœ¨å»ºç­‘ç‰©çš„ä¸åŒé—¨å¤„ç­‰å€™æä¾›æŒ‡å¯¼ã€‚è¿™æ˜¯å› ä¸º Cilium ä½¿ç”¨ä¸€ä¸ªå«åš eBPF çš„é­”æ³•è·¯ç”±åœ°å›¾ï¼Œæœ‰æ•ˆåœ°å¸®åŠ©æ—…è¡Œè€…ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ åˆ°è¾¾èµ°å»Šå°½å¤´çš„é—¨æ—¶ï¼Œä½ å‘ç­‰åœ¨è¿™é‡Œçš„æœåŠ¡äººå‘˜è¡¨ç¤ºä½ è¦å» 14 å·ã€‚ä»–åœ¨ä»–çš„é­”æ³• eBPF åœ°å›¾ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªä¸ 14 å·ç›¸åŒ¹é…çš„é¡¹ç›®ï¼Œå¹¶ç›´æ¥å‘ä½ å±•ç¤ºäº†å³ä¸Šè§’çš„èµ°å»Šé—¨ã€‚ä½ ä¸å¿…å»å¤§å…ï¼Œä»–å‘ä½ å±•ç¤ºäº†ä¸€æ¡ç§˜å¯†é€šé“ï¼Œç›´æ¥åˆ°è¾¾é‚£é‡Œã€‚ç„¶åä½ æ‰“å¼€é‚£æ‰‡é—¨ï¼Œè·Ÿç€èµ°å»Šï¼Œåˆ°è¾¾äº† 14 å·å…¬å¯“ã€‚ä½ å›å»åˆ° 12 å·å…¬å¯“ï¼Œæ²¿ç€ç›¸åŒçš„è·¯å¾„å’Œè¿‡ç¨‹ï¼Œä½†æ˜¯æ–¹å‘ç›¸åã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œè¿™ç§è°ƒåº¦ä¸ä¼ ç»Ÿçš„äº¤æ¢æ–¹å¼ä¸åŒï¼Œå¹¶ä¸”éå¸¸å¿«é€Ÿï¼Œè¿™è¦å½’åŠŸäºé­”æ³• eBPF åœ°å›¾ï¼&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ä¸åŒå»ºç­‘ç‰©çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&#34;&gt;åœ¨ä¸åŒå»ºç­‘ç‰©çš„å…¬å¯“ä¹‹é—´æ—…è¡Œ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨ï¼Œä» 12 å·å…¬å¯“ï¼Œä½ æƒ³å»æ‹œè®¿å¦ä¸€ä¸ªå»ºç­‘ç‰©é‡Œçš„ 22 å·å…¬å¯“ã€‚ä½ çš„æ—…è¡Œå¼€å§‹å’Œä»¥å‰ä¸€æ ·ï¼Œä½ ç¦»å¼€ä½ çš„å…¬å¯“ï¼Œæ²¿ç€èµ°å»Šï¼Œè¯¢é—®ç­‰å¾…åœ¨è¿™é‡Œçš„æœåŠ¡äººå‘˜çš„æ–¹å‘ã€‚ç”±äºç›®çš„åœ°æ˜¯å¦ä¸€ä¸ªç¤¾åŒºçš„ 22 å·ï¼Œè¿™æ¬¡ä»–æŠŠä½ å¼•å¯¼åˆ°äº†å¤§å…ã€‚åœ¨è¿™é‡Œï¼Œä¸ä¼ ç»Ÿç½‘ç»œä¸€æ ·ï¼Œä½ éœ€è¦å¤§å…ä¸­çš„é—¨å«çš„å¸®åŠ©ã€‚é—¨å«æŸ¥çœ‹ä»–çš„åœ°å›¾ï¼ˆè·¯ç”±è¡¨ï¼‰ï¼ŒæŒ‡å¼•ä½ å» 22 å·çš„æ–¹å‘ï¼Œå¹¶å‘ä½ å±•ç¤ºè¦ä½¿ç”¨çš„é—¨å·ç  11ï¼ˆcilium_hostï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ æ‰“å¼€é‚£æ‰‡é—¨æ—¶ï¼Œä½ ä¼šçœ‹åˆ°åé¢æœ‰å¦ä¸€æ‰‡é—¨ï¼šé‚£å°±æ˜¯è“è‰²çš„ä¸‰è§’å½¢ï¼Œç§°ä¸º VXLAN æ¥å£ã€‚è¿™æ‰‡é—¨é€šå‘ä¸€ä¸ªæ¼‚äº®çš„é€æ˜éš§é“ï¼Œç©¿è¿‡å»ºç­‘ç‰©çš„ä¸»é—¨ã€‚ä½ å—åˆ°é›¨æ°´çš„ä¿æŠ¤ï¼Œå¯ä»¥æ¬£èµåˆ°å¦ä¸€ä¸ªå»ºç­‘ç‰©çš„æ™¯è‰²ã€‚ä½ ç”šè‡³å¯ä»¥çœ‹åˆ°å®¤å¤–çš„å–·æ³‰ï¼å½“ä½ åˆ°è¾¾ç»¿è‰²å»ºç­‘ç‰©æ—¶ï¼Œä½ ç¦»å¼€éš§é“ï¼Œå»è§åœ¨ç»¿è‰²ä¸‰è§’å½¢ï¼ˆVXLAN æ¥å£ï¼‰å¤„ç­‰å¾…ä½ çš„æœåŠ¡äººå‘˜ã€‚ä½ å‘Šè¯‰ä»–ä½ çš„ç›®çš„åœ°ï¼Œä»–åœ¨ä»–çš„é­”æ³• eBPF åœ°å›¾ä¸­æ‰¾åˆ°äº†ä¸ 22 å·ç›¸åŒ¹é…çš„é¡¹ç›®ï¼Œå¹¶å‘ä½ å±•ç¤ºäº†ä¸€æ¡é€šå¾€å·¦ä¸Šè§’èµ°å»Šé—¨çš„ç§˜å¯†é€šé“ã€‚ç„¶åä½ è·Ÿç€èµ°å»Šï¼Œåˆ°è¾¾äº†ä½ çš„ç›®çš„åœ°ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œä½ å›å»çš„è·¯çº¿å°†æ²¿ç€ç›¸åŒçš„è·¯å¾„ï¼Œä½†æ–¹å‘ç›¸åã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ç¬¬ 3 å±‚è·¯ç”±ï¼Œå› ä¸ºç›®çš„ç¤¾åŒºä¸ä½ çš„ä¸åŒã€‚ä½ å¯ä»¥çœ‹åˆ°åœ¨ Kubernetes ä¸­æ¯”ä¼ ç»Ÿè·¯ç”±ç¨å¾®å¤æ‚ä¸€äº›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å¸Œæœ›è¿™æœ‰åŠ©äºä½ ç†è§£ä¼ ç»Ÿç½‘ç»œå’Œ Kubernetes ç½‘ç»œä¹‹é—´çš„åŒºåˆ«ï¼Œä¹Ÿå¸Œæœ›åè€…ç°åœ¨å¯¹ä½ æ¥è¯´æ›´æ¸…æ™°äº†ã€‚å¦‚æœè¿™å°±æ˜¯ä½ æ‰€éœ€è¦çš„ï¼Œé‚£ä¹ˆæˆ‘å¾ˆé«˜å…´ä½ é˜…è¯»äº†è¿™ç¯‡åšæ–‡ï¼Œå¸Œæœ›ä½ å–œæ¬¢å®ƒã€‚å¦‚æœä½ ç°åœ¨æƒ³äº†è§£æ›´å¤šå…³äº Kubernetes ç½‘ç»œçš„å†…å®¹ï¼Œè¯·ä¿æŒå…³æ³¨ï¼Œå› ä¸ºæˆ‘å°†å†™ä¸€ç¯‡ &lt;a href=&#34;https://www.dbi-services.com/blog/kubernetes-networking-by-using-cilium-intermediate-level-part-1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸­çº§ç¯‡&lt;/a&gt;ï¼Œä½ å°†åœ¨å…¶ä¸­çœ‹åˆ°ä¸€ä¸ªçœŸå®é›†ç¾¤ä¸Šå»ºç­‘ç‰©çš„æ ·å­ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å’Œ BGP ä¸º Kubernetes æœåŠ¡è¿›è¡Œè´Ÿè½½å‡è¡¡</title>
      <link>https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/</link>
      <pubDate>Tue, 30 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://sue.eu/blogs/expose-loadbalanced-kubernetes-services-with-bgp-cilium/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Exposing Load-Balanced Kubernetes Services with Cilium&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Cilium æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨ä¸ºäº‘åŸç”Ÿç¯å¢ƒæä¾›ç½‘ç»œã€å®‰å…¨å’Œå¯è§‚æµ‹æ€§ï¼Œä¾‹å¦‚ Kubernetes é›†ç¾¤å’Œå…¶ä»–å®¹å™¨ç¼–æ’å¹³å°ã€‚æœ¬åšå®¢å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Cilium å’Œ BGP å°†æ‚¨çš„ Kubernetes æœåŠ¡æš´éœ²ç»™å¤–éƒ¨ä¸–ç•Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BGP&lt;/strong&gt;
è¾¹ç•Œç½‘å…³åè®®ï¼ˆBGPï¼‰æ˜¯ä¸€ç§æ ‡å‡†åŒ–çš„å¤–éƒ¨ç½‘å…³åè®®ï¼Œæ—¨åœ¨åœ¨äº’è”ç½‘ä¸Šçš„è‡ªæ²»ç³»ç»Ÿï¼ˆASï¼‰ä¹‹é—´äº¤æ¢è·¯ç”±å’Œå¯è¾¾æ€§ä¿¡æ¯ã€‚è¯¥åè®®è¢«åˆ†ç±»ä¸ºè·¯å¾„çŸ¢é‡åè®®ï¼Œå› æ­¤å®ƒæ ¹æ®ç”±ç½‘ç»œç®¡ç†å‘˜é…ç½®çš„è·¯å¾„ã€ç½‘ç»œç­–ç•¥æˆ–è§„åˆ™é›†æ¥åšå‡ºè·¯ç”±å†³ç­–ã€‚å®ƒå‚ä¸åˆ¶å®šæ ¸å¿ƒè·¯ç”±å†³ç­–ï¼Œè¿™ä½¿å¾—å®ƒå¯¹äº’è”ç½‘çš„æ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;BGP ä¸“ä¸ºå¥å£®æ€§å’Œå¯æ‰©å±•æ€§è€Œå¼€å‘ï¼Œç”¨äºåœ¨å¤§å‹ç½‘ç»œä¹‹é—´è·¯ç”±æ•°æ®ï¼ŒåŒ…æ‹¬ ISP å’Œå…¶ä»–å¤§å‹ç»„ç»‡ã€‚å®ƒç¡®ä¿äº†æ— ç¯çš„åŸŸé—´è·¯ç”±ï¼Œå¹¶æœ‰åŠ©äºç»´æŠ¤ç¨³å®šçš„ç½‘ç»œç»“æ„ã€‚BGP å¯ä»¥å¤„ç†æ•°åƒä¸ªè·¯ç”±ï¼Œå¹¶ä»¥å…¶éšç€ç½‘ç»œå¢é•¿è€Œæ‰©å±•çš„èƒ½åŠ›è€Œè„±é¢–è€Œå‡ºã€‚ç”±äºå…¶çµæ´»æ€§å’Œå¯¹è·¯ç”±ç­–ç•¥çš„æ§åˆ¶ï¼Œå®ƒè¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½¿å…¶èƒ½å¤Ÿå¿«é€Ÿå“åº”ç½‘ç»œå˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cilium å’Œ BGP&lt;/strong&gt;
åœ¨ç‰ˆæœ¬ 1.10 ä¸­ï¼ŒCilium é›†æˆäº†å¯¹ MetalLB çš„ BGP æ”¯æŒï¼Œä»è€Œä½¿å…¶èƒ½å¤Ÿå®£å¸ƒ Kubernetes æœåŠ¡çš„ IP åœ°å€ç±»å‹ä¸º&lt;a href=&#34;https://sue.eu/insights/bgp-load-balancing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ BGP çš„ LoadBalancer&lt;/a&gt;ã€‚å…¶ç»“æœæ˜¯ï¼ŒæœåŠ¡å¯ä»¥ä» Kubernetes ç½‘ç»œå¤–éƒ¨è®¿é—®ï¼Œæ— éœ€é¢å¤–çš„ç»„ä»¶ï¼Œä¾‹å¦‚ Ingress è·¯ç”±å™¨ã€‚ç‰¹åˆ«æ˜¯â€œæ— éœ€é¢å¤–ç»„ä»¶â€çš„éƒ¨åˆ†æ˜¯ä»¤äººæŒ¯å¥‹çš„æ¶ˆæ¯ï¼Œå› ä¸ºæ¯ä¸ªç»„ä»¶éƒ½ä¼šå¢åŠ å»¶è¿Ÿï¼Œå› æ­¤æ²¡æœ‰é¢å¤–ç»„ä»¶ä¼šå‡å°‘å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu17139992351346066106.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu12620491286267683060.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu12416264946635966108.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f1_hu17139992351346066106.webp&#34;
               width=&#34;760&#34;
               height=&#34;664&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ­¤ç¤ºä¾‹ä¸­æ˜¾ç¤ºçš„ç½‘ç»œé…ç½®ä»£è¡¨äº†å…·æœ‰ç”¨äºæœåŠ¡è´Ÿè½½å‡è¡¡çš„ BGP é›†æˆçš„åŸºäº Kubernetes çš„ç¯å¢ƒã€‚ä»¥ä¸‹æ˜¯é…ç½®çš„è¯¦ç»†ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®¢æˆ·ç«¯ç½‘ç»œï¼ˆLAN ç½‘ç»œï¼‰ï¼š&lt;/strong&gt; å­˜åœ¨ä¸€ä¸ªå…·æœ‰ IP èŒƒå›´ 192.168.10.0/24 çš„æœ¬åœ°åŒºåŸŸç½‘ç»œï¼ˆLANï¼‰ï¼Œè¿æ¥äº†å¤šä¸ªå®¢æˆ·ç«¯ã€‚è¯¥ç½‘ç»œåŒ…å«äº†è®¾ç½®çš„ç”¨æˆ·ç«¯ï¼Œç”¨æˆ·å’Œå…¶ä»–è®¾å¤‡å¯ä»¥åœ¨å…¶ä¸­è®¿é—®æ‰˜ç®¡åœ¨ Kubernetes é›†ç¾¤ä¸Šçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes ç½‘ç»œï¼š&lt;/strong&gt; Kubernetes é›†ç¾¤å…·æœ‰è‡ªå·±çš„ç½‘ç»œç©ºé—´ï¼Œç”±å­ç½‘ 192.168.1.0/24 æŒ‡å®šã€‚è¯¥ç½‘ç»œåŒ…æ‹¬ Kubernetes ä¸»èŠ‚ç‚¹ï¼ˆk8s-master1ï¼‰å’Œå¤šä¸ªå·¥ä½œèŠ‚ç‚¹ï¼ˆä» k8s-worker1 åˆ° k8s-worker5ï¼‰ã€‚è¿™äº›èŠ‚ç‚¹æ‰˜ç®¡äº† Kubernetes é›†ç¾¤çš„å®é™…å®¹å™¨å’Œå·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç®¡ç†ç½‘ç»œï¼š&lt;/strong&gt; ä¸€ä¸ªç‹¬ç«‹çš„ç®¡ç†ç½‘ç»œï¼Œè‡³å°‘æœ‰ä¸€ä¸ªè®¾å¤‡ï¼ˆk8s-controlï¼‰ç”¨äºæ§åˆ¶å’Œç®¡ç† Kubernetes é›†ç¾¤ã€‚è¿™ä¸ Kubernetes æ•°æ®å¹³é¢åˆ†å¼€ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§å’Œç®¡ç†æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;BGP è·¯ç”±å™¨ï¼š&lt;/strong&gt; bgp-router1 æ¡¥æ¥äº†å¤–éƒ¨ç½‘ç»œ/äº’è”ç½‘å’Œ Kubernetes ç½‘ç»œã€‚å®ƒè´Ÿè´£ä½¿ç”¨ BGP æ¥å¹¿æ’­è·¯ç”±å°†æµé‡è·¯ç”±åˆ° Kubernetes é›†ç¾¤ä¸­çš„é€‚å½“æœåŠ¡ã€‚IP èŒƒå›´ 172.16.10.0/24 ä¿ç•™ä¾› Kubernetes é›†ç¾¤å†…çš„ LoadBalancer æœåŠ¡ä½¿ç”¨ã€‚å½“å°† Kubernetes æœåŠ¡å…¬å¼€ä¸º LoadBalancer æ—¶ï¼Œå®ƒä¼šåˆ†é…ä¸€ä¸ªæ¥è‡ªæ­¤æ± çš„ IP åœ°å€ã€‚ç„¶åï¼ŒBGP è·¯ç”±å™¨å°†æ­¤ IP å¹¿æ’­åˆ°å¤–éƒ¨ç½‘ç»œï¼Œä»è€Œä½¿æµé‡è·¯ç”±åˆ° LoadBalancer æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤ç½‘ç»œé…ç½®å…è®¸é€šè¿‡åˆ©ç”¨ BGP è¿›è¡Œ IP åœ°å€ç®¡ç†å’Œè·¯ç”±æ¥å®ç°è¿è¡Œåœ¨ Kubernetes é›†ç¾¤ä¸Šçš„æœåŠ¡çš„å¯æ‰©å±•å’Œçµæ´»çš„è´Ÿè½½å‡è¡¡ã€‚å®ƒå°†å®¢æˆ·ç«¯è®¿é—®ã€é›†ç¾¤ç®¡ç†å’ŒæœåŠ¡æµé‡åˆ†åˆ«åˆ†éš”åˆ°ä¸åŒçš„ç½‘ç»œä¸­ï¼Œä»¥è¿›è¡Œç»„ç»‡å’Œå®‰å…¨æ€§ç›®çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æš´éœ²æœåŠ¡&#34;&gt;æš´éœ²æœåŠ¡&lt;/h2&gt;
&lt;p&gt;ä¸€æ—¦æ„å»ºäº†ä¸Šè¿°åŸºç¡€æ¶æ„ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªéƒ¨ç½²å¹¶ä½¿ç”¨ BGP å°†å…¶æš´éœ²ç»™ç½‘ç»œã€‚è®©æˆ‘ä»¬ä»ä¸€ä¸ªéƒ¨ç½²å¼€å§‹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç®€å•çš„ NGINX Web æœåŠ¡å™¨ï¼Œæä¾›é»˜è®¤çš„ Web é¡µé¢ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€ä¸ªç±»å‹ä¸º LoadBalancer çš„ Serviceã€‚è¿™å°†å¯¼è‡´ä½¿ç”¨ BGP å‘æˆ‘ä»¬çš„è·¯ç”±å™¨å®£å¸ƒå¤–éƒ¨ IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æ„å»ºå®Œæˆï¼Œå‘½ä»¤ &lt;code&gt;kubectl get svc&lt;/code&gt; æ˜¾ç¤ºæˆ‘ä»¬çš„æœåŠ¡å…·æœ‰å¤–éƒ¨ IP åœ°å€ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;NAME          TYPE           CLUSTER-IP       EXTERNAL-IP       PORT(S)         AGE
kubernetes    ClusterIP      10.96.0.1        &amp;lt;none&amp;gt;            443/TCP         7d3h
web1-lb       LoadBalancer   10.106.236.120   172.16.10.0       80:30256/TCP    7d2h
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;172.16.10.0 è¿™ä¸ªåœ°å€çœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†æ²¡é—®é¢˜ã€‚é€šå¸¸ä¼šè·³è¿‡.0 åœ°å€ï¼Œè€Œä½¿ç”¨.1 åœ°å€ä½œä¸ºç¬¬ä¸€ä¸ªåœ°å€ã€‚å…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯åœ¨æ—©æœŸï¼Œ.0 åœ°å€ç”¨äºå¹¿æ’­ï¼Œåæ¥æ”¹ä¸º.255ã€‚ç”±äº.0 ä»ç„¶æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„åœ°å€ï¼Œè´Ÿè´£åœ°å€æ± çš„ MetalLB ä¼šå°†å…¶åˆ†é…ä¸ºç¬¬ä¸€ä¸ªåœ°å€ã€‚åœ¨è·¯ç”±å™¨ bgp-router1 ä¸Šè¿è¡Œçš„å‘½ä»¤ &lt;code&gt;vtysh -c &#39;show bgp summary&#39;&lt;/code&gt; æ˜¾ç¤ºå®ƒå·²æ¥æ”¶åˆ°ä¸€ä¸ªå‰ç¼€ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;IPv4 Unicast Summary:
BGP router identifier 192.168.1.1, local AS number 64512 vrf-id 0
BGP table version 17
RIB entries 1, using 192 bytes of memory
Peers 6, using 128 KiB of memoryNeighbour V AS MsgRcvd MsgSent TblVer InQ OutQ Up/Down State/PfxRcd PfxSnt
192.168.1.10 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.21 4 64512 446 435 0 0 0 03:36:54 1 0
192.168.1.22 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.23 4 64512 445 435 0 0 0 03:36:56 1 0
192.168.1.24 4 64512 446 435 0 0 0 03:36:56 1 0
192.168.1.25 4 64512 445 435 0 0 0 03:36:56 1 0

Total number of neighbors 6
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è·¯ç”±è¡¨çš„ä»¥ä¸‹ç‰‡æ®µï¼ˆip routeï¼‰å‘Šè¯‰æˆ‘ä»¬ï¼Œå¯¹äºç‰¹å®šçš„ IP åœ°å€ 172.16.10.0ï¼Œå­˜åœ¨ 6 ä¸ªå¯èƒ½çš„è·¯ç”±/ç›®æ ‡ã€‚æ¢å¥è¯è¯´ï¼Œæ‰€æœ‰ Kubernetes èŠ‚ç‚¹éƒ½å®£å¸ƒå®ƒä»¬æ­£åœ¨å¤„ç†è¯¥åœ°å€çš„æµé‡ã€‚å¤ªæ£’äº†ï¼ï¼&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;172.16.10.0 proto bgp metric 20
nexthop via 192.168.1.10 dev enp7s0 weight 1
nexthop via 192.168.1.21 dev enp7s0 weight 1
nexthop via 192.168.1.22 dev enp7s0 weight 1
nexthop via 192.168.1.23 dev enp7s0 weight 1
nexthop via 192.168.1.24 dev enp7s0 weight 1
nexthop via 192.168.1.25 dev enp7s0 weight 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å®é™…ä¸Šï¼Œç°åœ¨ä»æˆ‘ä»¬çš„è·¯ç”±å™¨ä¸Šå¯ä»¥çœ‹åˆ° Web é¡µé¢ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -s -v http://172.16.10.0/ -o /dev/null

* Trying 172.16.10.0â€¦
* TCP_NODELAY set
* Connected to 172.16.10.0 (172.16.10.0) port 80 (#0)
&amp;gt; GET / HTTP/1.1
&amp;gt; Host: 172.16.10.0
&amp;gt; User-Agent: curl/7.61.1
&amp;gt; Accept: */*
&amp;lt; HTTP/1.1 200 OK
&amp;lt; Server: nginx/1.21.3
&amp;lt; Date: Sun, 31 Oct 2023 14:19:17 GMT
&amp;lt; Content-Type: text/html
&amp;lt; Content-Length: 615
&amp;lt; Last-Modified: Tue, 07 Sep 2023 15:21:03 GMT
&amp;lt; Connection: keep-alive
&amp;lt; ETag: â€œ6137835f-267â€
&amp;lt; Accept-Ranges: bytes&amp;gt;
{ [615 bytes data]}
* Connection #0 to host 172.16.10.0 left intact
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è€Œä¸”ï¼Œä½äºæˆ‘ä»¬å®¢æˆ·ç«¯ç½‘ç»œä¸­çš„å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥è®¿é—®ç›¸åŒçš„é¡µé¢ï¼Œå› ä¸ºå®ƒä½¿ç”¨ bgp-router1 ä½œä¸ºé»˜è®¤è·¯ç”±ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu12330485717108373314.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu8752192660279871172.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu16388573192024680154.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f2_hu12330485717108373314.webp&#34;
               width=&#34;598&#34;
               height=&#34;345&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¤šç»†èŠ‚&#34;&gt;æ›´å¤šç»†èŠ‚&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ä¸€åˆ‡éƒ½è¿ä½œæ­£å¸¸ï¼Œå¤§å¤šæ•°å·¥ç¨‹å¸ˆéƒ½æƒ³çœ‹åˆ°æ›´å¤šç»†èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šè®©ä½ å¤±æœ›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ping&#34;&gt;Ping&lt;/h3&gt;
&lt;p&gt;ä½ å°†æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼ŒLoadBalancer çš„ IP åœ°å€æ— æ³•é€šè¿‡ ping è®¿é—®ã€‚æ·±å…¥æŒ–æ˜ä¸€ä¸‹å¯ä»¥æ­ç¤ºåŸå› ã€‚æˆ‘ä»¬åˆ›å»ºäº†æºç«¯å£ 80 å’Œç›®æ ‡ç«¯å£ 80 ä¹‹é—´çš„æ˜ å°„ã€‚æ­¤æ˜ å°„åœ¨æ¥å£ä¸Šä½¿ç”¨ eBPF é€»è¾‘æ‰§è¡Œï¼Œå¹¶å­˜åœ¨äºæ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚æ­¤æ˜ å°„ç¡®ä¿åªæœ‰ç«¯å£ 80 çš„æµé‡è¢«å‡è¡¡ã€‚æ‰€æœ‰å…¶ä»–æµé‡ï¼ŒåŒ…æ‹¬ pingï¼Œéƒ½ä¸è¢«æ¥æ”¶ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥çœ‹åˆ° icmp æ•°æ®åŒ…åˆ°è¾¾èŠ‚ç‚¹ï¼Œä½†ä»æœªå‘é€å“åº”çš„åŸå› ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§‚å¯Ÿæµé‡&#34;&gt;è§‚å¯Ÿæµé‡&lt;/h3&gt;
&lt;p&gt;Hubble æ˜¯å»ºç«‹åœ¨ eBPF å’Œ Cilium ä¹‹ä¸Šçš„ç½‘ç»œå’Œå®‰å…¨æ€§å¯è§‚æµ‹å¹³å°ã€‚é€šè¿‡å‘½ä»¤è¡Œå’Œå›¾å½¢ Web GUIï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰å’Œå†å²æµé‡ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒHubble æ”¾ç½®åœ¨ k8s-control èŠ‚ç‚¹ä¸Šï¼Œè¯¥èŠ‚ç‚¹ç›´æ¥è®¿é—® Hubble Relay çš„ APIã€‚Hubble Relay æ˜¯ä» Cilium èŠ‚ç‚¹è·å–æ‰€éœ€ä¿¡æ¯çš„ç»„ä»¶ã€‚è¯·æ³¨æ„ï¼ŒHubble å‘½ä»¤ä¹Ÿå­˜åœ¨äºæ¯ä¸ª Cilium ä»£ç† Pod ä¸­ï¼Œä½†é‚£ä¸ªå‘½ä»¤åªä¼šæ˜¾ç¤ºç‰¹å®šä»£ç†çš„ä¿¡æ¯ï¼ä»¥ä¸‹è¾“å‡ºæ˜¾ç¤ºäº†ä»è·¯ç”±å™¨ä¸Šæ‰§è¡Œ curl http://172.16.10.0/ å‘½ä»¤åçš„è§‚å¯Ÿè€…ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ hubble observe â€“namespace default â€“follow

Oct 31 15:43:41.382: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: SYN)
Oct 31 15:43:41.384: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.384: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:43:41.385: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.385: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
Oct 31 15:43:41.386: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:43:41.386: 192.168.1.1:36946 &amp;lt;&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-overlay FORWARDED (TCP Flags: ACK)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¹‹å‰ï¼Œæˆ‘è­¦å‘Šè¿‡ä¸è¦åœ¨ Cilium ä»£ç† Pod å†…ä½¿ç”¨ hubble å‘½ä»¤ï¼Œä½†åœ¨ç‰¹å®šèŠ‚ç‚¹æµé‡ä¸­çœ‹åˆ°å…·ä½“çš„æƒ…å†µä¹Ÿå¯ä»¥éå¸¸æœ‰ä¿¡æ¯ä»·å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ª Cilium ä»£ç† Pod ä¸­éƒ½æ‰§è¡Œäº† &lt;code&gt;hubble observe â€“namespace default â€“follow&lt;/code&gt;ï¼Œå¹¶ä¸”è·¯ç”±å™¨çš„ curl æ‰§è¡Œäº†ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ‰˜ç®¡ Pod çš„èŠ‚ç‚¹ï¼ˆk8s-worker2ï¼‰ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢çš„è¾“å‡ºç›¸åŒçš„è¾“å‡ºã€‚ä½†æ˜¯ï¼Œåœ¨å¦ä¸€ä¸ª Podï¼ˆk8s-worker1ï¼‰ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;Oct 31 15:56:05.220: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: SYN)
Oct 31 15:56:05.220: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: SYN, ACK)
Oct 31 15:56:05.220: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:05.221: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:05.221: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:05.222: 10.0.3.103:48278 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:05.222: 10.0.3.103:48278 &amp;lt;- default/web1-696bfbbbc4-jnxbc:80 to-stack FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:05.222: 10.0.3.103:48278 -&amp;gt; default/web1

-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:12.739: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: SYN)
Oct 31 15:56:12.739: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: SYN, ACK)
Oct 31 15:56:12.742: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK)
Oct 31 15:56:12.742: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:12.745: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: ACK, PSH)
Oct 31 15:56:12.749: 10.0.4.105:36956 -&amp;gt; default/web1-696bfbbbc4-jnxbc:80 to-endpoint FORWARDED (TCP Flags: ACK, FIN)
Oct 31 15:56:12.749: default/web1-696bfbbbc4-jnxbc:80 &amp;lt;&amp;gt; 10.0.4.105:36956 to-overlay FORWARDED (TCP Flags: ACK, FIN)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°çš„æ˜¯ï¼Œæˆ‘ä»¬çš„è·¯ç”±å™¨å°† IP åœ°å€ 172.16.10.0 çš„æµé‡å‘é€åˆ° k8s-worker1ï¼Œä½†è¯¥å·¥ä½œèŠ‚ç‚¹ä¸æ‰˜ç®¡æˆ‘ä»¬çš„ web1 å®¹å™¨ï¼Œå› æ­¤å®ƒå°†æµé‡è½¬å‘åˆ°å¤„ç†æµé‡çš„ k8s-worker2ã€‚æ‰€æœ‰çš„è½¬å‘é€»è¾‘éƒ½ä½¿ç”¨ eBPF å¤„ç† - é™„åŠ åˆ°æ¥å£çš„ä¸€ä¸ªå°çš„ BPF ç¨‹åºå°†åœ¨éœ€è¦æ—¶å‘é€æµé‡å’Œè·¯ç”±åˆ°å¦ä¸€ä¸ªå·¥ä½œèŠ‚ç‚¹ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ k8s-worker1 ä¸Šè¿è¡Œ tcpdumpï¼Œåˆå§‹æ¥æ”¶åˆ°æµé‡çš„åœ°æ–¹ï¼Œä¸ä¼šæ˜¾ç¤ºä»»ä½•æµé‡çš„åŸå› ã€‚å®ƒå·²ç»åœ¨è¿›å…¥ k8s-worker1 çš„ IP å †æ ˆä¹‹å‰è¢«é‡å®šå‘åˆ° k8s-worker2ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„åˆä½œä¼™ä¼´ &lt;a href=&#34;https://docs.cilium.io/en/stable/network/ebpf/intro/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Isovalent&lt;/a&gt; æœ‰å¾ˆå¤šå…³äº eBPF å’Œå†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å¬è¯´è¿‡ eBPFï¼Œè€Œä¸”ä½ å¯¹ Linux å’Œ/æˆ–ç½‘ç»œæ„Ÿå…´è¶£ï¼Œè¯·åŠ¡å¿…æ¢ç´¢ä¸€ä¸‹åŸºç¡€çŸ¥è¯†ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒeBPF å°†åœ¨ä¸ä¹…çš„å°†æ¥å½»åº•æ”¹å˜ Linux çš„ç½‘ç»œï¼Œç‰¹åˆ«æ˜¯å¯¹äºäº‘åŸç”Ÿç¯å¢ƒï¼&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium.io &lt;/a&gt;ä¸Šæœ‰å¾ˆå¤šå…³äº eBPF å’Œå†…éƒ¨å·¥ä½œåŸç†çš„ä¿¡æ¯ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å¬è¯´è¿‡ eBPFï¼Œè€Œä¸”ä½ å¯¹ Linux å’Œ/æˆ–ç½‘ç»œæ„Ÿå…´è¶£ï¼Œè¯·åŠ¡å¿…äº†è§£è‡³å°‘åŸºç¡€çŸ¥è¯†ã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒeBPF å°†åœ¨ä¸ä¹…çš„å°†æ¥å½»åº•æ”¹å˜ Linux çš„ç½‘ç»œï¼Œç‰¹åˆ«æ˜¯å¯¹äºäº‘åŸç”Ÿç¯å¢ƒï¼&lt;/p&gt;
&lt;h3 id=&#34;hubble-web-gui&#34;&gt;Hubble Web GUI&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä¸€ä¸ªå·¥ä½œæ­£å¸¸çš„ BGP è®¾ç½®ï¼Œä½¿ Hubble Web GUI å¯¹å¤–ç•Œä¹Ÿå¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu1142106117073934098.webp 400w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu4509585424755433923.webp 760w,
               /blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu9447684038416519056.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/expose-loadbalanced-kubernetes-services-with-bgp-cilium/f3_hu1142106117073934098.webp&#34;
               width=&#34;760&#34;
               height=&#34;419&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„è¯&#34;&gt;æœ€åçš„è¯&lt;/h2&gt;
&lt;p&gt;é€šè¿‡ MetalLB çš„é›†æˆï¼Œä½¿ç”¨ BGP è®¾ç½® Cilium å˜å¾—éå¸¸ç®€å•ï¼Œæ¶ˆé™¤äº†æ˜‚è´µçš„ç½‘ç»œç¡¬ä»¶çš„éœ€æ±‚ã€‚Cilium/BGP çš„è¿™ç§ç»„åˆï¼Œç‰¹åˆ«æ˜¯ä¸åœç”¨ kube-proxy ç»“åˆä½¿ç”¨ï¼Œæ˜¾è‘—é™ä½äº†åˆ°äº‘ç«¯æœåŠ¡çš„å»¶è¿Ÿã€‚å®ƒè¿˜é€šè¿‡ä»…å®£å¸ƒ LoadBalancer çš„ IP åœ°å€æ¥å¢å¼ºå®‰å…¨æ€§å’Œé€æ˜æ€§ã€‚è™½ç„¶è¿™ç§è®¾ç½®ä¸éœ€è¦ Ingress Controllerï¼Œä½†å¯¹äºå¤§å¤šæ•° HTTP æœåŠ¡ä»ç„¶å»ºè®®ä½¿ç”¨ä¸€ä¸ªã€‚åƒ NGINX æˆ– Traefik è¿™æ ·çš„æ§åˆ¶å™¨ï¼Œé€šè¿‡ BGP å…¬å¼€ï¼Œæä¾›åè®®çº§åˆ«çš„é‡å†™å’Œè¯·æ±‚é€Ÿç‡é™åˆ¶ç­‰é‡å¤§ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§äº‘åŸç”Ÿå’ŒåŸºäº Linux çš„ç½‘ç»œçš„è¿›æ­¥ç¡®å®æ˜¯ä¸€ä¸ªé£è·ƒï¼Œæ ‡å¿—ç€ç½‘ç»œæŠ€æœ¯çš„æ¿€åŠ¨äººå¿ƒçš„æ—¶ä»£ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿè½¯ä»¶çš„å…³é”®ç”¨ä¾‹å®‰å…¨ä¿éšœä¹‹é“</title>
      <link>https://cloudnativecn.com/blog/securing-cloud-natives-most-important-use-cases/</link>
      <pubDate>Wed, 10 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/securing-cloud-natives-most-important-use-cases/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://www.chainguard.dev/unchained/securing-cloud-natives-most-important-use-cases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Securing cloud nativeâ€™s most important use cases&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‘˜è¦ï¼šäº‘åŸç”Ÿè½¯ä»¶å¼€å‘æ„å‘³ç€ä¸ºå…¬æœ‰äº‘å’Œç§æœ‰äº‘çš„ç‰¹æ€§ä¼˜åŒ–åº”ç”¨å’Œç¯å¢ƒã€‚Chainguard æ—¨åœ¨æä¾›ä¸å½±å“å¼€å‘è€…ä½“éªŒçš„è½¯ä»¶ä¾›åº”é“¾å®‰å…¨å·¥å…·ï¼Œé€šè¿‡æä¾›æœ€å°åŒ–ã€å¼ºåŒ–çš„å®¹å™¨é•œåƒï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå‡†ç¡®åœ°æ‰«ææ¼æ´å¹¶æ¶ˆé™¤ CVE è­¦æŠ¥ã€‚æœ¬æ–‡ä»‹ç»äº† Chainguard Images ä¸º Istio å’Œ Cilium è¿™ä¸¤ä¸ªäº‘åŸç”ŸåŸºç¡€æŠ€æœ¯æä¾›çš„å®‰å…¨å¢å¼ºæ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä»æ ¹æœ¬ä¸Šè¯´ï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€æ„å»ºé’ˆå¯¹å…¬å…±å’Œç§æœ‰äº‘ç‰¹æ€§è¿›è¡Œä¼˜åŒ–çš„åº”ç”¨ç¨‹åºå’Œç¯å¢ƒã€‚å¼€å‘äº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€ç®¡ç†ä¸€å®šç¨‹åº¦çš„æ··ä¹±ï¼Œè¿™ä¸æ˜¯æ‰€æœ‰ç±»å‹çš„è½¯ä»¶éƒ½éœ€è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åœ¨æ–°çš„ä¸€å¹´å°¤å…¶é‡è¦ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸäº§å“å°†è¶‹å‘äºä¼˜å…ˆè€ƒè™‘å¼€å‘è€…ä½“éªŒï¼Œå¹¶ä¸”å¹³å°å·¥ç¨‹çš„å´›èµ·ã€‚è‰¯å¥½çš„å·¥ç¨‹å’Œå·¥å…·ä½¿å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºæ„å»ºå’Œåˆ›æ–°ã€‚å·²ç»æ„å»ºçš„æ‰€æœ‰å†…éƒ¨å¼€å‘è€…å¹³å°å’Œå³å°†æ¨å‡ºçš„å¹³å°éƒ½éœ€è¦å°½é‡å°†åŸºç¡€è®¾æ–½ç®¡ç†ä»å¼€å‘è€…é‚£é‡ŒæŠ½è±¡å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ­£æ˜¯ Chainguard æƒ³è¦è§£å†³çš„é—®é¢˜é¢†åŸŸï¼Œç‰¹åˆ«æ˜¯åœ¨å®‰å…¨æ€§å’Œæ¼æ´ç®¡ç†æ–¹é¢ã€‚æˆ‘ä»¬è‡´åŠ›äºæä¾›ä¸å¦¨ç¢å¼€å‘è€…ä½“éªŒçš„å·¥å…·ï¼Œä»¥ç¡®ä¿è½¯ä»¶ä¾›åº”é“¾çš„å®‰å…¨ã€‚æˆ‘ä»¬é€šè¿‡æä¾›æœ€å°åŒ–ã€åŠ å›ºçš„å®¹å™¨é•œåƒæ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œè¿™ä½¿æˆ‘ä»¬çš„ç”¨æˆ·å¯ä»¥è·å¾—å‡†ç¡®çš„æ‰«æç»“æœï¼Œå¹¶å°† CVE æ”¶ä»¶ç®±è­¦æŠ¥é™è‡³é›¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨å‡ºæ–°çš„-chainguard-images-æ†ç»‘åŒ…é€‚ç”¨äº-cilium-å’Œ-istio&#34;&gt;æ¨å‡ºæ–°çš„ Chainguard Images æ†ç»‘åŒ…ï¼Œé€‚ç”¨äº Cilium å’Œ Istio&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å¯†åˆ‡å…³æ³¨æœ€å—æ¬¢è¿çš„å¼€æºé¡¹ç›®ï¼Œä½†ä¹Ÿå…³æ³¨é‚£äº›å¦‚æœç»è¿‡åŠ å›ºï¼Œå°†ä¸ºæ•´ä¸ªå¼€æºç”Ÿæ€ç³»ç»Ÿæä¾›é‡è¦çš„å®‰å…¨æ”¹è¿›çš„é¡¹ç›®ã€‚ä¸ºäº†åœ¨æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­äº§ç”Ÿæœ€å¤§çš„å½±å“ï¼Œæˆ‘ä»¬åº”è¯¥å¸®åŠ©åŠ å›ºé‚£äº›ä½œä¸ºäº‘åŸç”Ÿè½¯ä»¶åŸºçŸ³çš„æŠ€æœ¯ã€‚Istio å’Œ Cilium æ­£æ˜¯è¿™æ ·çš„æ˜æ˜¾ç¤ºä¾‹ï¼Œå®ƒä»¬æ˜¯äº‘åŸç”Ÿè½¯ä»¶ç”Ÿæ€ç³»ç»Ÿçš„åŸºç¡€æ„å»ºæ¨¡å—ä¹‹ä¸€ã€‚é€šè¿‡æä¾›æ–°çš„ Chainguard Images Istio å’Œ Cilium æ†ç»‘åŒ…ï¼Œæˆ‘ä»¬ä¸ºè¿™äº›é¡¹ç›®çš„ç”¨æˆ·æä¾›äº†ä¸€ä¸ªå®‰å…¨åœ°å°†å®ƒä»¬å¼•å…¥å…¶æ„å»ºæµç¨‹çš„ç®€ä¾¿æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»»ä½•ç»™å®šçš„ä¾›åº”é“¾ä¸­ï¼Œæœ‰äº›åŸææ–™æ¯”å…¶ä»–åŸææ–™æ›´ä¸ºåŸºç¡€ã€‚å¦‚æœè¿™äº›åŸææ–™å¾—åˆ°äº†å¦¥å–„ä¿æŠ¤ï¼Œé‚£ä¹ˆè¿™å°†å¯¹åç»­å·¥ä½œäº§ç”Ÿè¿é”æ•ˆåº”ï¼ˆæˆ–è€…å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œå¯ä»¥è¯´æ˜¯å¯¹æ•´ä¸ªå †æ ˆäº§ç”Ÿä¸Šä¸‹æ¸¸å½±å“ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Cilium å’Œ Istio æŠ€æœ¯éƒ½æ¶µç›–äº†å¯¹ Kubernetes ç¯å¢ƒå…·æœ‰åŸºç¡€ä½œç”¨çš„å„ç§ç”¨ä¾‹ã€‚Cilium å’Œ Istio æ˜¯ä¸¤ä¸ªæµè¡Œçš„å·¥å…·ï¼Œé€šè¿‡æä¾›æµé‡è·¯ç”±ã€è´Ÿè½½å¹³è¡¡ã€æœåŠ¡å‘ç°ç­‰åŠŸèƒ½æ¥å¸®åŠ©è§£å†³è¿™äº›æŒ‘æˆ˜ã€‚è¿™äº›åŠŸèƒ½å¯¹äºç¡®ä¿ Kubernetes å’Œå…¶ä»–äº‘åŸç”Ÿè½¯ä»¶éƒ¨ç½²çš„é¡ºåˆ©ã€é«˜æ•ˆå’Œå®‰å…¨è¿è¡Œè‡³å…³é‡è¦ã€‚æœ€ç»ˆï¼Œæ„å»ºäº‘åŸç”Ÿè½¯ä»¶æ„å‘³ç€åˆ›å»ºä¸“ä¸ºäº‘è®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œè€Œ Cilium å’Œ Istio åœ¨å¸®åŠ©å¼€å‘è€…å®ç°è¿™ä¸€ç›®æ ‡æ–¹é¢å‘æŒ¥äº†å…³é”®ä½œç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;istio-å’Œ-cilium-åœ¨äº‘è®¡ç®—ä¸­ä¸å¯æˆ–ç¼ºçš„ä½œç”¨&#34;&gt;Istio å’Œ Cilium åœ¨äº‘è®¡ç®—ä¸­ä¸å¯æˆ–ç¼ºçš„ä½œç”¨&lt;/h3&gt;
&lt;p&gt;æ ¹æ® 2022 å¹´çš„ &lt;a href=&#34;https://www.cncf.io/reports/cncf-annual-survey-2022/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF å¹´åº¦è°ƒæŸ¥&lt;/a&gt;ï¼ŒIstio æ˜¯å—è®¿è€…ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼ï¼Œ73% çš„å—è®¿å…¬å¸ä½¿ç”¨å®ƒã€‚è¿™ç§å¹¿æ³›çš„é‡‡ç”¨è¯æ˜äº† Istio åœ¨è§£å†³å„ç§æœåŠ¡ç®¡ç†æŒ‘æˆ˜æ–¹é¢çš„æœ‰æ•ˆæ€§ï¼Œä½¿å…¶æˆä¸ºç°ä»£ä¼ä¸šå¯»æ±‚æ„å»ºå¼ºå¤§ã€å®‰å…¨å’Œå¯æ‰©å±•çš„å¾®æœåŠ¡æ¶æ„çš„é‡è¦å·¥å…·ã€‚Istio åœ¨ GitHub ä¸Šæ‹¥æœ‰è¶…è¿‡ 34,000 é¢—æ˜Ÿæ˜Ÿï¼Œä½¿å…¶æˆä¸º CNCF ä¸­æœ€å—æ¬¢è¿çš„é¡¹ç›®ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;ä»åŒä¸€ä»½ CNCF è°ƒæŸ¥ä¸­ï¼Œæœ‰ 47% çš„å—è®¿è€…å°† Cilium ä½œä¸ºä»–ä»¬å®¹å™¨ç¼–æ’å¹³å°ï¼ˆå¦‚ Kubernetesï¼‰çš„é¦–é€‰ç½‘ç»œæ’ä»¶ã€‚å®ƒä¹Ÿå—æ¬¢è¿äºç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œæœ‰ 43% çš„å—è®¿è€…å°†å…¶ç”¨äºæ­¤ç›®çš„ã€‚eBPF çš„æœªæ¥å’ŒåŠ›é‡æ˜¯ä¸å¯æ€è®®çš„ï¼Œæ‰€æœ‰äººéƒ½åŒæ„è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæˆ‘ä»¬æ¨å‡ºäº†æˆ‘ä»¬çš„æ–°çš„ &lt;a href=&#34;https://images.chainguard.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Chainguard Images ç›®å½•&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¬å¼€å¯ç”¨çš„ç½‘ç«™ï¼Œç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸­æµè§ˆæˆ‘ä»¬åº“å­˜ä¸­çš„æ‰€æœ‰é•œåƒã€‚åœ¨æ¯ä¸ª Chainguard&lt;/p&gt;
&lt;p&gt;Image åˆ—è¡¨ä¸­ï¼Œä½ å°†æ‰¾åˆ°æœ‰å…³å®‰è£…ã€åŸºç¡€è®¾æ–½ã€ç­¾åå’Œ SBOM çš„æºæ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œä»¥åŠæ›´å¤šå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚Chainguard Images ç›®å½•è¿˜åŒ…æ‹¬ä¸€ä¸ªæ–°çš„&lt;a href=&#34;https://images.chainguard.dev/security&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰å…¨é€šæŠ¥&lt;/a&gt;é¡µé¢ï¼Œæ˜¾ç¤ºç”¨æˆ·å·²çŸ¥çš„ CVEï¼Œä¿®å¤çš„çŠ¶æ€ç­‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ›´å¤šå…³äºå¦‚ä½•åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¯åŠ¨ Chainguard Images Cilium æˆ– Istio æ†ç»‘åŒ…çš„æŠ€æœ¯æŒ‡å¯¼ï¼Œè¯·æŸ¥çœ‹ Chainguard å·¥ç¨‹å¸ˆ&lt;a href=&#34;https://www.linkedin.com/in/tcnghia/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Nghia Tran&lt;/a&gt;åœ¨ Chainguard Academy ä¸Šæä¾›çš„è¿™äº›æ–¹ä¾¿å…¥é—¨çš„æŒ‡å—ã€‚éå¸¸æ„Ÿè°¢æˆ‘ä»¬çš„æœ‹å‹&lt;a href=&#34;https://www.linkedin.com/in/feroz-salam-372a4113/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Isovalent&lt;/a&gt;çš„ Feroz Salam åœ¨ Cilium Images æ–¹é¢ç»™äº†æˆ‘ä»¬å¸®åŠ©ï¼Œä»¥åŠå¤šå¹´æ¥å¸®åŠ©æˆ‘ä»¬çš„ Istio çš„&lt;a href=&#34;https://www.linkedin.com/in/-johnhoward/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;John Howard&lt;/a&gt;ï¼ä»¥ä¸‹æ˜¯æŒ‡å—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://edu.chainguard.dev/chainguard/chainguard-images/getting-started/getting-started-istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å§‹ä½¿ç”¨ Istio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://edu.chainguard.dev/chainguard/chainguard-images/getting-started/getting-started-cilium/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€å§‹ä½¿ç”¨ Cilium&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Chainguard Developer Images æä¾›äº†å¸¦æœ‰ &lt;code&gt;:latest&lt;/code&gt; å’Œ &lt;code&gt;:latest-dev&lt;/code&gt; æ ‡ç­¾çš„å…è´¹é•œåƒï¼Œä¾›ä½ åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­ä½¿ç”¨ã€‚åœ¨æ–°çš„ç›®å½•ä¸­ï¼Œæ¯ä¸ªé•œåƒé¡µé¢è¿˜åŒ…æ‹¬é‡è¦çš„ç‰¹å®šäºé•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ç‰ˆæœ¬æ ‡ç­¾å’Œå…¶ä»–å˜ä½“ï¼Œå¦‚ FIPS å’Œé•¿æœŸæ”¯æŒï¼ˆLTSï¼‰ï¼Œè¿™äº›éƒ½é€‚ç”¨äºè´­ä¹°äº†è¿™äº›è§£å†³æ–¹æ¡ˆçš„ Chainguard Images å®¢æˆ·ã€‚å¦‚æœä½ æƒ³äº†è§£æœ‰å…³æˆ‘ä»¬çš„ Production Images ä¸­é¢å‘ä¼ä¸šçš„åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·&lt;a href=&#34;https://www.chainguard.dev/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬çš„å›¢é˜Ÿ&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Cilium 2023 å¹´åº¦æŠ¥å‘Šå‘å¸ƒ</title>
      <link>https://cloudnativecn.com/blog/cilium-2023-annual-report/</link>
      <pubDate>Tue, 09 Jan 2024 18:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-2023-annual-report/</guid>
      <description>&lt;p&gt;è¿™ä»½æŠ¥å‘Šå›é¡¾äº† Cilium é¡¹ç›®åœ¨ 2023 å¹´çš„æˆå°±å’Œè¿›å±•ï¼ŒåŒ…æ‹¬è´¡çŒ®è€…å¢é•¿ã€ç‰ˆæœ¬äº®ç‚¹ã€ç”¨æˆ·è°ƒæŸ¥ç»“æœã€ç”Ÿäº§ç¯å¢ƒæ¡ˆä¾‹ã€ç¤¾åŒºæ´»åŠ¨å’Œå¼•ç”¨ã€ä»¥åŠ 2024 å¹´çš„å‘å±•æ–¹å‘ã€‚æŠ¥å‘Šæ˜¾ç¤ºï¼ŒCilium é¡¹ç›®å·²ç»æˆä¸ºäº‘åŸç”Ÿç½‘ç»œã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨æ€§çš„é¢†å¯¼è€…ï¼Œå¾—åˆ°äº†å¹¿æ³›çš„è®¤å¯å’Œé‡‡ç”¨ã€‚æŠ¥å‘Šè¿˜å±•ç¤ºäº† Cilium é¡¹ç›®çš„å¥åº·çŠ¶å†µå’Œæ´»è·ƒåº¦ï¼Œé€šè¿‡æ•°æ®å’Œå›¾è¡¨å±•ç¤ºäº†é¡¹ç›®çš„é‡Œç¨‹ç¢‘å’Œæäº¤æƒ…å†µã€‚æŠ¥å‘Šæœ€åæ„Ÿè°¢äº†ç¤¾åŒºçš„æ”¯æŒå’Œè´¡çŒ®ï¼Œä»¥åŠæœŸå¾…æœªæ¥çš„æ›´å¤šåˆ›æ–°å’Œåä½œã€‚&lt;/p&gt;
&lt;p&gt;è¯¦æƒ…è§ï¼š&lt;a href=&#34;https://www.cncf.io/blog/2023/12/21/ciliums-2023-annual-report/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.cncf.io/blog/2023/12/21/ciliums-2023-annual-report/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½åœ°å€ï¼š&lt;a href=&#34;https://github.com/cilium/cilium.io/blob/main/Annual-Reports/Cilium%20Annual%20Report%202023.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹å†…å®¹é€‰å–è‡ªæŠ¥å‘Šä¸­çš„ release highlight éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç‰ˆæœ¬æ›´æ–°&#34;&gt;ç‰ˆæœ¬æ›´æ–°&lt;/h2&gt;
&lt;p&gt;Cilium åœ¨ 2023 å¹´è¿›è¡Œäº†ä¸¤æ¬¡é‡å¤§å‘å¸ƒã€‚Cilium 1.13 äº 2 æœˆå‘å¸ƒï¼Œé’ˆå¯¹ç½‘ç»œï¼ˆç‰¹åˆ«æ˜¯æœåŠ¡ç½‘æ ¼ï¼‰ã€æ€§èƒ½å’Œè½¯ä»¶ä¾›åº”é“¾å®‰å…¨ç­‰æ–¹é¢è¿›è¡Œäº†è®¸å¤šæ”¹è¿›ã€‚Cilium 1.14 äº 7 æœˆå‘å¸ƒï¼Œå¼•å…¥äº†ä¸€ä¸ªå¤‡å—æœŸå¾…çš„åŠŸèƒ½ï¼šä¸ä¸»è¦æ”¹è¿›ç›¸ç»“åˆçš„åŒå‘èº«ä»½éªŒè¯ï¼ŒåŒæ—¶æ‰©å±•äº† Kubernetes ä¹‹å¤–çš„ç½‘ç»œã€‚Tetragon 1.0 äº 10 æœˆå‘å¸ƒï¼Œå¸¦æ¥äº†ä¸»è¦çš„æ›´æ–°å’Œæ€§èƒ½æ”¹è¿›ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æ‰€æœ‰ç‰ˆæœ¬ä¸­åŒ…å«çš„ä¸€äº›ä¸»è¦å˜åŒ–çš„æ¦‚è¿°ï¼š&lt;/p&gt;
&lt;h2 id=&#34;cilium-113&#34;&gt;Cilium 1.13&lt;/h2&gt;
&lt;h3 id=&#34;gateway-api&#34;&gt;Gateway API&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.13 å¸¦æœ‰ Gateway API çš„å®Œå…¨å…¼å®¹å®ç°ã€‚è¿™ä¸ª API æ˜¯ç”¨äºåŒ—å‘è´Ÿè½½å‡è¡¡å’Œæµé‡è·¯ç”±åˆ° Kubernetes é›†ç¾¤çš„æ–°æ ‡å‡†ï¼Œæ˜¯ Kubernetes Ingress API çš„é•¿æœŸç»§ä»»è€…ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¸¦æ³¨é‡Šçš„-kubernetes-æœåŠ¡çš„-l7-è´Ÿè½½å‡è¡¡&#34;&gt;å¸¦æ³¨é‡Šçš„ Kubernetes æœåŠ¡çš„ L7 è´Ÿè½½å‡è¡¡&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.13 å¼•å…¥äº†ä½¿ç”¨ Cilium å†…ç½®çš„ Envoy ä»£ç†æ¥å®ç°ç°æœ‰ Kubernetes æœåŠ¡çš„ L7 è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œé€šè¿‡åº”ç”¨ä»¥ä¸‹æ³¨é‡Šï¼š&lt;code&gt;&amp;quot;service.cilium.io/lb-l7&amp;quot;: &amp;quot;enabled&amp;quot;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ•°æ®é¢ä¸Šçš„åŒå‘èº«ä»½éªŒè¯---beta&#34;&gt;æ•°æ®é¢ä¸Šçš„åŒå‘èº«ä»½éªŒè¯ - Beta&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®é¢çº§åˆ«æ·»åŠ äº†åŒå‘èº«ä»½éªŒè¯æ”¯æŒï¼Œä»¥ä¾¿ Cilium èƒ½å¤Ÿå¯¹é›†ç¾¤ä¸­å¯¹ç­‰èŠ‚ç‚¹ä¸Šçš„ç»ˆç«¯è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ ¹æ®æˆåŠŸçš„åŒå‘èº«ä»½éªŒè¯æ¥æ§åˆ¶æ•°æ®å¹³é¢è¿æ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;loadbalancer-æœåŠ¡å’Œ-bgp-æœåŠ¡å¹¿å‘Šçš„-ipam&#34;&gt;LoadBalancer æœåŠ¡å’Œ BGP æœåŠ¡å¹¿å‘Šçš„ IPAM&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;LoadBalancer IP åœ°å€ç®¡ç†ï¼ˆLB-IPAMï¼‰æ˜¯ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œå…è®¸ Cilium ä¸º Kubernetes LoadBalancer æœåŠ¡æä¾› IP åœ°å€ã€‚Cilium BGP é€šè¿‡å¼•å…¥æœåŠ¡åœ°å€å¹¿å‘Šå¾—åˆ°äº†æ”¹è¿›ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥ä¸ LB-IPAM åŠŸèƒ½æ— ç¼é…åˆä½¿ç”¨ï¼Œå¸®åŠ©ç”¨æˆ·é€šè¿‡ BGP å¹¿å‘Š Kubernetes æœåŠ¡çš„ IP åœ°å€ï¼Œä»è€Œä¸å†éœ€è¦ MetalLBï¼Œç®€åŒ–äº†ç½‘ç»œå †æ ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ”¯æŒ-kubernetes-ä¸Šçš„-sctp&#34;&gt;æ”¯æŒ Kubernetes ä¸Šçš„ SCTP&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SCTP æ˜¯ä¸€ç§åœ¨ç”µä¿¡è¡Œä¸šä¸­ç»å¸¸ç”¨äºæ”¯æŒ VoIP å’Œå…¶ä»–å®æ—¶æœåŠ¡çš„ä¼ è¾“å±‚åè®®ã€‚Cilium 1.13 å¼•å…¥äº† STCP çš„åŸºæœ¬æ”¯æŒï¼Œç”šè‡³æ”¯æŒåœ¨ Hubble ä¸­è¿›è¡Œå¯è§†åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ€§èƒ½&#34;&gt;æ€§èƒ½&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å¼•å…¥äº†æ”¯æŒ BIG TCP çš„åŠŸèƒ½ï¼Œé€šè¿‡æé«˜ååé‡å¹¶å‡å°‘èŠ‚ç‚¹çš„å»¶è¿Ÿæ¥æé«˜ç½‘ç»œæ€§èƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æ‰©å±•åˆ° 100Gbps é›†ç¾¤ç”šè‡³æ›´å¤§çš„è§„æ¨¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è½¯ä»¶ä¾›åº”é“¾å®‰å…¨&#34;&gt;è½¯ä»¶ä¾›åº”é“¾å®‰å…¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium å’Œ Tetragon å®¹å™¨é•œåƒç°åœ¨åœ¨åˆ›å»ºæ—¶ä½¿ç”¨ cosign è¿›è¡Œç­¾åã€‚åˆ©ç”¨é•œåƒç­¾åï¼Œç”¨æˆ·å¯ä»¥ç¡®ä¿¡ä»–ä»¬ä»å®¹å™¨æ³¨å†Œè¡¨è·å–çš„é•œåƒæ˜¯ç»´æŠ¤è€…æ„å»ºå’Œå‘å¸ƒçš„å—ä¿¡ä»»çš„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sboms&#34;&gt;SBOMs&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä»ç‰ˆæœ¬ 1.13 å¼€å§‹ï¼ŒCilium å’Œ Tetragon é•œåƒç°åœ¨åŒ…å«äº†è½¯ä»¶ææ–™æ¸…å•ï¼ˆSBOMï¼‰ã€‚è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥ç¡®ä¿ Cilium ä¸­ä½¿ç”¨çš„ç»„ä»¶å’Œä¾èµ–å…³ç³»æ˜¯é€æ˜å’Œå¯éªŒè¯çš„ï¼Œä»¥ä¾¿æŸ¥æ‰¾æ½œåœ¨çš„æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;cilium-114&#34;&gt;Cilium 1.14&lt;/h2&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼å’ŒåŒå‘èº«ä»½éªŒè¯&#34;&gt;æœåŠ¡ç½‘æ ¼å’ŒåŒå‘èº«ä»½éªŒè¯&lt;/h3&gt;
&lt;h4 id=&#34;åŒå‘èº«ä»½éªŒè¯---beta&#34;&gt;åŒå‘èº«ä»½éªŒè¯ - Beta&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.14 å¸¦æ¥äº†æ–°çš„åŒå‘èº«ä»½éªŒè¯æ”¯æŒï¼Œé€šè¿‡ SPIFFEï¼ˆSecure Production Identity Framework for Everyoneï¼‰å’Œ SPIREï¼ˆSPIRE æ˜¯ SPIFFE API çš„ç”Ÿäº§å°±ç»ªå®ç°ï¼‰æä¾›ã€‚æœ‰äº†è¿™ä¸ªæ–°æ”¯æŒï¼ŒCilium ç°åœ¨å¯ä»¥ä¸ SPIRE æœåŠ¡å™¨ä¸€èµ·éƒ¨ç½²ï¼Œä»¥å¯ç”¨åŒå‘èº«ä»½éªŒè¯ã€‚è¿™å…è®¸å·¥ä½œè´Ÿè½½åœ¨ SPIRE æœåŠ¡å™¨ä¸Šåˆ›å»ºå’Œç®¡ç†å…¶èº«ä»½ï¼Œè¯¥æœåŠ¡å™¨è‡ªåŠ¨ç®¡ç†å’Œæ—‹è½¬è¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;envoy-daemonset&#34;&gt;Envoy DaemonSet&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ äº† Envoy ä½œä¸º DaemonSet çš„æ”¯æŒã€‚è¿™æ„å‘³ç€ Envoy ä»£ç†ä¸å†éœ€è¦åœ¨ Cilium ä»£ç† Pod å†…ä½œä¸ºè¿›ç¨‹è¿è¡Œï¼Œä»è€Œå…è®¸ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸã€ç‹¬ç«‹çš„ç®¡ç†ä»¥åŠå°†é—®é¢˜çš„å½±å“é™åˆ¶åœ¨ Envoy ä»£ç†æˆ– Cilium ä»£ç†ä¸­çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;wireguard-èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†å’Œ-layer-7-ç­–ç•¥æ”¯æŒ&#34;&gt;WireGuard èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†å’Œ Layer 7 ç­–ç•¥æ”¯æŒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cilium çš„ä½¿ç”¨ WireGuard çš„åŠ å¯†å·²ç»å¾—åˆ°å¢å¼ºã€‚ç°åœ¨å¯ä»¥åŠ å¯† Pod ä¹‹é—´ã€ä» Pod åˆ°èŠ‚ç‚¹ä»¥åŠèŠ‚ç‚¹ä¹‹é—´çš„æµé‡ï¼Œå¹¶ä¸”è¿˜æ”¯æŒå°† L7 ç½‘ç»œç­–ç•¥åº”ç”¨äºä½¿ç”¨ WireGuard åŠ å¯†çš„æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è¶…è¶Š-kubernetes-çš„ç½‘ç»œ&#34;&gt;è¶…è¶Š Kubernetes çš„ç½‘ç»œ&lt;/h3&gt;
&lt;h4 id=&#34;l2-å…¬å‘Š&#34;&gt;L2 å…¬å‘Š&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Cilium 1.14 å¸¦æœ‰ä¸€ä¸ªåä¸º L2 Announcement policy çš„æ–°åŠŸèƒ½ï¼Œå®ƒå…è®¸ Cilium å“åº”æœ¬åœ°å®¢æˆ·ç«¯å¯¹ ExternalIPs å’Œ/æˆ– LoadBalancer IP çš„ ARP è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;bgp-å¢å¼º&#34;&gt;BGP å¢å¼º&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ä¸º Cilium çš„ BGP å®ç°æ·»åŠ äº†æ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šCilium CLI ä¸­çš„ BGP å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ Cilium CLI æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹çš„ BGP å¯¹ç­‰çŠ¶æ€ï¼›BGP Graceful Restartï¼Œå¯ä»¥åœ¨é‡æ–°å¯åŠ¨ä»£ç†æ—¶ä¿æŒå¯¹ç­‰æ–¹çš„è·¯ç”±ï¼›eBGP Multi-Hopï¼Œå…è®¸ç”¨æˆ·åœ¨æ²¡æœ‰æ˜ç¡®çš„ TTL è·³æ•°é™åˆ¶çš„æƒ…å†µä¸‹å¯ç”¨ä¸¤ä¸ª EBGP å¯¹ç­‰æ–¹ä¹‹é—´çš„é‚»å±…è¿æ¥ï¼›è‡ªå®šä¹‰ BGP å®šæ—¶å™¨ï¼Œå¯ä»¥è‡ªå®šä¹‰ Cilium å’Œå¯¹ç­‰æ–¹ä¹‹é—´çš„ BGP ä¼šè¯çš„å®šæ—¶å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é›†ç¾¤ç½‘æ ¼&#34;&gt;é›†ç¾¤ç½‘æ ¼&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ KVStoreMesh æ¨¡å¼ä¸‹ï¼ŒCilium Cluster Mesh å®ç°äº†æ”¹è¿›çš„å¯æ‰©å±•æ€§å’Œéš”ç¦»ï¼Œé¢å‘å¤§è§„æ¨¡ Cluster Mesh éƒ¨ç½²ï¼Œæ”¯æŒå¤šè¾¾ 50,000 ä¸ªèŠ‚ç‚¹å’Œ 500,000 ä¸ª Podã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;tetragon-10&#34;&gt;Tetragon 1.0&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cilium Tetragon 1.0 ä¸»è¦å…³æ³¨æé«˜æ€§èƒ½å¹¶å‡å°ç³»ç»Ÿå¼€é”€ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäº Kubernetes çš„å·¥å…·ï¼Œé€šè¿‡ eBPF åº”ç”¨ç­–ç•¥å’Œè¿‡æ»¤ï¼Œç¡®ä¿ä»¥æœ€å°çš„æ€§èƒ½å½±å“å®ç°æ·±åº¦å¯è§‚æµ‹æ€§ã€‚Tetragon è·Ÿè¸ªå„ç§æ´»åŠ¨ï¼Œå¦‚è¿›ç¨‹æ‰§è¡Œã€ç‰¹æƒå‡çº§ã€æ–‡ä»¶å’Œç½‘ç»œæ´»åŠ¨ï¼Œæä¾›ä¸€ç³»åˆ—çš„å¼€ç®±å³ç”¨çš„å®‰å…¨å¯è§‚æµ‹æ€§ç­–ç•¥ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Tetragon ä½œä¸ºä¸€ä¸ªåŸºäº Kubernetes çš„æœ¬åœ°å·¥å…·ï¼Œä¸ Kubernetes æ— ç¼é›†æˆï¼Œä»¥å¢å¼ºå®‰å…¨å¯è§‚æµ‹æ€§ï¼Œé€šè¿‡ä¸ºç²¾ç¡®çš„ç­–ç•¥åº”ç”¨ä¸°å¯Œäº‹ä»¶æä¾›å¿…è¦çš„å…ƒæ•°æ®ã€‚å®ƒä½¿ç”¨ eBPF è¿›è¡Œäº‹ä»¶è§‚å¯Ÿå’Œè¿‡æ»¤ï¼Œç¡®ä¿æœ€å°çš„å¼€é”€å’Œé«˜æ•ˆçš„æ€§èƒ½ï¼Œæ˜¾ç€å‡å°‘äº†æ•°æ®ä¼ è¾“å’Œæ‰§è¡Œæ“ä½œä¸­çš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æ€§èƒ½æµ‹è¯•ä¸­ï¼Œå…¶æœ‰æ•ˆæ€§å¾—åˆ°äº†è¯æ˜ï¼Œåœ¨è¿›ç¨‹æ‰§è¡Œè·Ÿè¸ªæ–¹é¢çš„å¼€é”€ä¸åˆ° 2%ï¼Œå³ä½¿åœ¨é«˜ I/O æ¡ä»¶ä¸‹ä¹Ÿèƒ½å¤Ÿé«˜æ•ˆåœ°ç›‘è§†æ–‡ä»¶å®Œæ•´æ€§ï¼Œå¯¹ç½‘ç»œæ€§èƒ½çš„å½±å“ä¹Ÿå¾ˆå°ï¼Œå±•ç¤ºäº†å®ƒæœ‰æ•ˆå’Œé«˜æ•ˆåœ°è§‚å¯Ÿç½‘ç»œæµé‡çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Cilium å®ç° Gateway API æŒ‡å—</title>
      <link>https://cloudnativecn.com/blog/cilium-gateway-api/</link>
      <pubDate>Thu, 04 Jan 2024 08:00:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/cilium-gateway-api/</guid>
      <description>&lt;p&gt;åœ¨ Kubernetes ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºåï¼Œé€šå¸¸çš„ä¸‹ä¸€æ­¥æ˜¯è®©ç”¨æˆ·å¯ä»¥è®¿é—®å®ƒã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;&lt;/a&gt;ï¼Œä¾‹å¦‚ Nginxã€Haproxyã€Traefik æˆ–æ¥è‡ªäº‘æä¾›å•†çš„æ§åˆ¶å™¨ï¼Œæ¥å¼•å¯¼ä¼ å…¥çš„æµé‡åˆ°åº”ç”¨ç¨‹åºï¼Œç®¡ç†è´Ÿè½½å¹³è¡¡ã€TLS ç»ˆæ­¢ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»ä»ä¼—å¤š&lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯ç”¨çš„é€‰é¡¹&lt;/a&gt; ä¸­è¿›è¡Œé€‰æ‹©ã€‚Cilium æ˜¯å…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„é€‰é¡¹ï¼Œæ—¨åœ¨å¤„ç†æ‰€æœ‰è¿™äº›ç½‘ç»œæ–¹é¢çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Cilium&lt;/strong&gt;&lt;/a&gt; æ˜¯ä¸€ä¸ªåŸºäº eBPF çš„å¼€æºç½‘ç»œå’Œå®‰å…¨è§£å†³æ–¹æ¡ˆï¼Œå…¶é‡‡ç”¨é€Ÿåº¦å¢é•¿è¿…çŒ›ã€‚å®ƒå¯èƒ½æ˜¯æä¾›æœ€å¤šåŠŸèƒ½çš„ç½‘ç»œæ’ä»¶ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ä¼šæ¶µç›–æ‰€æœ‰åŠŸèƒ½ï¼Œä½†å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½æ¶‰åŠä½¿ç”¨&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;Gateway API&lt;/strong&gt;&lt;/a&gt; (&lt;code&gt;GAPI&lt;/code&gt;) ç®¡ç†ä¼ å…¥æµé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬çš„ç›®æ ‡&#34;&gt;æˆ‘ä»¬çš„ç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å‡†ç¡®äº†è§£ &lt;strong&gt;Gateway API&lt;/strong&gt; æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒå¦‚ä½•ä»£è¡¨ä» &lt;code&gt;Ingress&lt;/code&gt; API è¿›åŒ–è€Œæ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ¼”ç¤ºä»¥ GitOps æ–¹å¼éƒ¨ç½²çš„çœŸå®åœºæ™¯ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰çš„é™åˆ¶å’Œå³å°†æ¨å‡ºçš„æ–°åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;æœ¬æ–‡ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤éƒ½æ¥è‡ªè¿™ä¸ª&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;git å­˜å‚¨åº“&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘é¼“åŠ±ä½ æ¢ç´¢å®ƒï¼Œå› ä¸ºå®ƒè¿œè¿œè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨å¯ç”¨äº† kube-proxy æ›¿ä»£å¹¶å…·æœ‰ä¸“ç”¨ Daemonset ç”¨äº &lt;code&gt;Envoy&lt;/code&gt; çš„ &lt;code&gt;Cilium&lt;/code&gt; é…ç½®çš„ &lt;strong&gt;EKS&lt;/strong&gt; é›†ç¾¤çš„å®‰è£…ã€‚&lt;/li&gt;
&lt;li&gt;æå‡ºäº†å…·æœ‰ä¾èµ–å…³ç³»ç®¡ç†å’Œæˆ‘è®¤ä¸ºéå¸¸é«˜æ•ˆçš„ DRY ä»£ç çš„ &lt;code&gt;Flux&lt;/code&gt; ç»“æ„ã€‚&lt;/li&gt;
&lt;li&gt;ç®€åŒ–äº†ç”¨äºå¹³å°ç»„ä»¶çš„ IAM æƒé™ç®¡ç†çš„ &lt;code&gt;Crossplane&lt;/code&gt; å’Œ &lt;a href=&#34;https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IRSA&lt;/a&gt; ç»„åˆã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;External-DNS&lt;/code&gt; å’Œ &lt;code&gt;Let&#39;s Encrypt&lt;/code&gt; è‡ªåŠ¨ç®¡ç†åŸŸåå’Œè¯ä¹¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ä¸ªæƒ³æ³•æ˜¯åªéœ€å‡ åˆ†é’Ÿå†…è®¾ç½®å¥½ä¸€åˆ‡ï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤è¡Œã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;ä»‹ç»-gateway-api&#34;&gt;ä»‹ç» Gateway API&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæœ‰è®¸å¤š&lt;strong&gt;Ingress æ§åˆ¶å™¨&lt;/strong&gt;é€‰é¡¹ï¼Œæ¯ä¸ªéƒ½æœ‰å…¶ç‰¹å®šæ€§å’Œç‰¹æ®ŠåŠŸèƒ½ï¼Œæœ‰æ—¶ä¼šä½¿å®ƒä»¬çš„ä½¿ç”¨å˜å¾—å¤æ‚ã€‚æ­¤å¤–ï¼ŒKubernetes ä¸­ä¼ ç»Ÿçš„ &lt;code&gt;Ingress&lt;/code&gt; API å…·æœ‰éå¸¸æœ‰é™çš„å‚æ•°ã€‚ä¸€äº›è§£å†³æ–¹æ¡ˆç”šè‡³åˆ›å»ºäº†è‡ªå·±çš„&lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRDs&lt;/a&gt;ï¼ˆKubernetes è‡ªå®šä¹‰èµ„æºï¼‰ï¼Œè€Œå…¶ä»–è§£å†³æ–¹æ¡ˆåˆ™ä½¿ç”¨ &lt;code&gt;annotations&lt;/code&gt; æ¥å…‹æœè¿™äº›é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯&lt;strong&gt;Gateway API&lt;/strong&gt;çš„ç”¨æ­¦ä¹‹åœ°ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§&lt;strong&gt;æ ‡å‡†&lt;/strong&gt;ï¼Œå…è®¸å£°æ˜é«˜çº§ç½‘ç»œåŠŸèƒ½ï¼Œè€Œæ— éœ€å¯¹åº•å±‚æ§åˆ¶å™¨è¿›è¡Œç‰¹å®šæ‰©å±•ã€‚è€Œä¸”ï¼Œç”±äºæ‰€æœ‰æ§åˆ¶å™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ APIï¼Œå› æ­¤å¯ä»¥åœ¨ä¸æ”¹å˜é…ç½®çš„æƒ…å†µä¸‹ä»ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆKubernetes æ¸…å•æè¿°äº†å¦‚ä½•è·¯ç”±ä¼ å…¥æµé‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å°†è¦æ¢è®¨çš„æ¦‚å¿µä¸­ï¼ŒGAPI å¼•å…¥äº†ä¸€ä¸ªç²¾ç»†çš„æˆæƒæ¨¡å‹ï¼Œå®šä¹‰äº†å…·æœ‰ä¸åŒæƒé™çš„&lt;strong&gt;æ˜¾å¼è§’è‰²&lt;/strong&gt;ï¼ˆæœ‰å…³ GAPI å®‰å…¨æ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/security-model/#roles-and-personas&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥é¡¹ç›®ç”±&lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sig-network-kubernetes&lt;/a&gt;å·¥ä½œç»„æ¨åŠ¨ï¼Œè¿˜æœ‰ä¸€ä¸ª Slack &lt;a href=&#34;https://kubernetes.slack.com/archives/CR0H13KGA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢‘é“&lt;/a&gt;ï¼Œä½ å¯ä»¥åœ¨éœ€è¦æ—¶è”ç³»ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹åœ¨å®è·µä¸­å¦‚ä½•ä½¿ç”¨ GAPI ä¸ Ciliumï¼&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‡è®¾å·²éƒ¨ç½²äº†ä¸€ä¸ª EKS é›†ç¾¤ã€‚å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/tree/main/terraform/eks&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“ä¸­å»ºè®®çš„æ–¹æ³•&lt;/a&gt;ä½œä¸ºæœ¬æ–‡çš„åŸºç¡€ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›&lt;strong&gt;è¦æ£€æŸ¥çš„è¦ç‚¹&lt;/strong&gt;ï¼Œä»¥ä¾¿ä½¿ç”¨ GAPIã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤„æè¿°çš„å®‰è£…æ–¹æ³•åŸºäº &lt;code&gt;Helm&lt;/code&gt;ï¼Œæ‰€æœ‰çš„ &lt;code&gt;values&lt;/code&gt; å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/terraform/eks/helm_values/cilium.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æŸ¥çœ‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/tree/main/config/crd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt;å­˜å‚¨åº“ä¸­&lt;strong&gt;å®‰è£…&lt;/strong&gt;å¯ç”¨çš„ &lt;code&gt;CRDs&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    å¦‚æœ Cilium è®¾ç½®ä¸ºæ”¯æŒ &lt;code&gt;GAPI&lt;/code&gt;ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œå¹¶ä¸”ç¼ºå°‘ CRDsï¼Œåˆ™å®ƒå°†æ— æ³•å¯åŠ¨ã€‚åœ¨&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤ºå­˜å‚¨åº“&lt;/a&gt;ä¸­ï¼Œ&lt;strong&gt;GAPI CRDs&lt;/strong&gt;åœ¨é›†ç¾¤åˆ›å»ºæœŸé—´å®‰è£…ä¸€æ¬¡ï¼Œä»¥ä¾¿ Cilium å¯ä»¥å¯åŠ¨ï¼Œç„¶åç”± Flux ç®¡ç†ã€‚
&lt;/div&gt;

&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ Cilium å’Œ &lt;code&gt;eBPF&lt;/code&gt; çš„ç½‘ç»œè½¬å‘åŠŸèƒ½&lt;strong&gt;æ›¿æ¢&lt;/strong&gt; &lt;code&gt;kube-proxy&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;kubeProxyReplacement&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;å¯ç”¨&lt;/strong&gt; Gateway API æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;gatewayAPI&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ£€æŸ¥&lt;/strong&gt;å®‰è£…ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å®‰è£…åä¸º &lt;code&gt;cilium&lt;/code&gt; çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æˆ‘ä¸ªäººä½¿ç”¨ &lt;a href=&#34;https://blog.ogenki.io/post/asdf/asdf/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;asdf&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf plugin-add cilium-cli
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf install cilium-cli 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;asdf global cilium 0.15.7
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å…è®¸ç¡®ä¿æ‰€æœ‰ç»„ä»¶éƒ½æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status --wait
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;/Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;\__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;   \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;Deployment             cilium-operator    Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium             Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;DaemonSet              cilium-envoy       Desired: 2, Ready: 2/2, Available: 2/2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Containers:            cilium             Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       Running: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Cluster Pods:          33/33 managed by Cilium
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Helm chart version:    1.14.2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;Image versions         cilium             quay.io/cilium/cilium:v1.14.2@sha256:6263f3a3d5d63b267b538298dbeb5ae87da3efacf09a2c620446c873ba807d35: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-operator    quay.io/cilium/operator-aws:v1.14.2@sha256:8d514a9eaa06b7a704d1ccead8c7e663334975e6584a815efe2b8c15244493f1: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;                      cilium-envoy       quay.io/cilium/cilium-envoy:v1.25.9-e198a2824d309024cb91fb6a984445e73033291d@sha256:52541e1726041b050c5d475b3c527ca4b8da487a0bbb0309f72247e8127af0ec: 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ˜¯å¦å¯ç”¨äº† Gateway API æ”¯æŒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium config view | grep -w &amp;#34;enable-gateway-api&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api                                true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;enable-gateway-api-secrets-sync                   true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜å¯ä»¥è¿è¡Œä»¥ä¸‹ç«¯åˆ°ç«¯æµ‹è¯•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium connectivity test
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œæ­¤å‘½ä»¤ï¼ˆ&lt;code&gt;connectivity test&lt;/code&gt;ï¼‰å½“å‰åœ¨å¯ç”¨ Envoy ä½œä¸º DaemonSet æ—¶ä¼šæŠ›å‡ºé”™è¯¯ã€‚(&lt;a href=&#34;https://github.com/cilium/cilium/issues/28057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Envoy ä½œä¸º DaemonSet&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒCilium ä»£ç†è¿˜åœ¨åŒä¸€ Pod ä¸­è¿è¡Œ &lt;code&gt;Envoy&lt;/code&gt;ï¼Œå¹¶å§”æ‰˜ç»™å®ƒçº§åˆ« 7 çš„ç½‘ç»œæ“ä½œã€‚ä»ç‰ˆæœ¬ &lt;code&gt;v1.14&lt;/code&gt; å¼€å§‹ï¼Œå¯ä»¥å°† Envoy å•ç‹¬éƒ¨ç½²ï¼Œè¿™å¸¦æ¥äº†ä¸€äº›å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœä¿®æ”¹/é‡æ–°å¯åŠ¨ä¸€ä¸ªç»„ä»¶ï¼ˆæ— è®ºæ˜¯ Cilium è¿˜æ˜¯ Envoyï¼‰ï¼Œéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ›´å¥½åœ°åˆ†é…èµ„æºç»™æ¯ä¸ªç»„ä»¶ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æŸä¸ª Pod è¢«æ”»å‡»çš„æƒ…å†µä¸‹é™åˆ¶æ”»å‡»é¢ã€‚&lt;/li&gt;
&lt;li&gt;Envoy æ—¥å¿—å’Œ Cilium ä»£ç†æ—¥å¿—ä¸ä¼šæ··åˆåœ¨ä¸€èµ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥æ­¤åŠŸèƒ½æ˜¯å¦å·²å¯ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium status
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    /Â¯Â¯\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Cilium:             OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Operator:           OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; /Â¯Â¯\__/Â¯Â¯\    Envoy DaemonSet:    OK
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt; \__/Â¯Â¯\__/    Hubble Relay:       disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;    \__/       ClusterMesh:        disabled
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-release-114/#h-envoy-daemonset&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id=&#34;å…¥å£ç‚¹gatewayclass-å’Œ-gateway&#34;&gt;å…¥å£ç‚¹ï¼šGatewayClass å’Œ Gateway&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/gateway_hu17558978471811997564.webp 400w,
               /blog/cilium-gateway-api/gateway_hu14519843841572081622.webp 760w,
               /blog/cilium-gateway-api/gateway_hu456268660095928782.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/gateway_hu17558978471811997564.webp&#34;
               width=&#34;760&#34;
               height=&#34;557&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦æ»¡è¶³å…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¤šä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Gateway API CRDs å®šä¹‰çš„è‡ªå®šä¹‰èµ„æºã€‚è€Œä¸”ï¼Œåœ¨å®‰è£… Cilium åï¼Œä¸€ä¸ª &lt;code&gt;GatewayClass&lt;/code&gt; ç«‹å³å¯ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gatewayclasses.gateway.networking.k8s.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME     CONTROLLER                     ACCEPTED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium   io.cilium/gateway-controller   True       7m59s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ Kubernetes é›†ç¾¤ä¸Šï¼Œä½ å¯ä»¥é…ç½®å¤šä¸ª &lt;code&gt;GatewayClasses&lt;/code&gt;ï¼Œä»è€Œèƒ½å¤Ÿä½¿ç”¨ä¸åŒçš„å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;Gateway&lt;/code&gt; é…ç½®ä¸­å¼•ç”¨ GatewayClass æ¥ä½¿ç”¨ &lt;code&gt;Linkerd&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Gateway&lt;/code&gt; æ˜¯å…è®¸è§¦å‘åœ¨äº‘æä¾›å•†ä¸­åˆ›å»ºè´Ÿè½½å‡è¡¡ç»„ä»¶çš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ AWSï¼ˆEKSï¼‰ä¸Šï¼Œé…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ—¶ï¼ŒCilium ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º &lt;code&gt;LoadBalancer&lt;/code&gt; çš„ &lt;code&gt;Service&lt;/code&gt;ã€‚ç„¶åï¼Œå¦ä¸€ä¸ªæ§åˆ¶å™¨ï¼ˆ&lt;a href=&#34;https://kubernetes-sigs.github.io/aws-load-balancer-controller&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Load Balancer Controller&lt;/a&gt;ï¼‰å¤„ç†äº‘è´Ÿè½½å‡è¡¡å™¨ï¼ˆ&lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NLB&lt;/a&gt;ï¼‰çš„åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get svc -n echo cilium-gateway-echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME                  TYPE           CLUSTER-IP     EXTERNAL-IP                                                                 PORT(S)        AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;cilium-gateway-echo   LoadBalancer   172.20.19.82   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   80:30395/TCP   2m58s
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè´Ÿè½½å‡è¡¡å™¨åœ°å€ä¹Ÿä¸ &lt;code&gt;Gateway&lt;/code&gt; ç›¸å…³è”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get gateway -n echo echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME   CLASS    ADDRESS                                                                     PROGRAMMED   AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo   cilium   k8s-echo-ciliumga-64708ec85c-fcb7661f1ae4e4a4.elb.eu-west-3.amazonaws.com   True         16m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è·¯ç”±è§„åˆ™httproute&#34;&gt;è·¯ç”±è§„åˆ™ï¼šHTTPRoute&lt;/h2&gt;
&lt;h3 id=&#34;åŸºæœ¬è§„åˆ™&#34;&gt;åŸºæœ¬è§„åˆ™&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-httproute&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;httproute.jpg&#34; alt=&#34;HTTPRoute&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      HTTPRoute
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä¸Šé¢çš„å›¾è¡¨å¯æ€»ç»“ä¸ºå‡ å¥è¯ï¼š&lt;code&gt;HTTPRoute&lt;/code&gt; å…è®¸é€šè¿‡å¼•ç”¨ Gateway å¹¶å®šä¹‰æ‰€éœ€çš„è·¯ç”±å‚æ•°æ¥é…ç½®åˆ°æœåŠ¡çš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&lt;strong&gt;Kyverno&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆªæ­¢ç›®å‰ï¼Œæ— æ³•é…ç½®ç”± &lt;code&gt;Gateways&lt;/code&gt; ç”Ÿæˆçš„æœåŠ¡çš„æ³¨é‡Šï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚å·²æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œå³åœ¨åˆ›å»º &lt;code&gt;Gateway&lt;/code&gt; åç«‹å³ä¿®æ”¹ç”± &lt;code&gt;Gateway&lt;/code&gt; åˆ›å»ºçš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;Kyverno æ˜¯ä¸€ç§ç¡®ä¿é…ç½®ç¬¦åˆæœ€ä½³å®è·µå’Œå®‰å…¨è¦æ±‚çš„å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä»…ä½¿ç”¨å®ƒæ¥è½»æ¾æè¿°&lt;a href=&#34;https://kyverno.io/docs/writing-policies/mutate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çªå˜&lt;/a&gt;è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/mycluster-0/echo-gw-clusterpolicy.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;security/mycluster-0/echo-gw-clusterpolicy.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mutate-svc-annotations&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kinds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;Service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium-gateway-echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mutate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patchStrategicMerge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;external-dns.alpha.kubernetes.io/hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo.${domain_name}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;internet-facing&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;service.beta.kubernetes.io/aws-load-balancer-backend-protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tcp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;loadBalancerClass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service.k8s.aws/nlb&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼ŒæœåŠ¡ &lt;code&gt;cilium-gateway-echo&lt;/code&gt; å°†æ·»åŠ  AWS æ§åˆ¶å™¨çš„æ³¨é‡Šï¼Œä»¥åŠä¸€ä¸ªå…è®¸è‡ªåŠ¨ DNS è®°å½•é…ç½®çš„æ³¨é‡Šã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šé¢ä½¿ç”¨çš„ç¤ºä¾‹éå¸¸ç®€å•ï¼šæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° &lt;code&gt;echo-1-echo-server&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;parentRefs&lt;/code&gt; æŒ‡ç¤ºä½¿ç”¨å“ªä¸ª &lt;code&gt;Gateway&lt;/code&gt;ï¼Œç„¶ååœ¨ &lt;code&gt;rules&lt;/code&gt; éƒ¨åˆ†å®šä¹‰äº†è·¯ç”±è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;è·¯ç”±è§„åˆ™è¿˜å¯ä»¥åŸºäº &lt;code&gt;path&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;foo.bar.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/login&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ–è€…åŸºäº HTTP æ ‡å¤´&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯è®¿é—®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s http://echo.cloud.ogenki.io | jq -rc &amp;#39;.environment.HOSTNAME&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1-echo-server-fd88497d-w6sgn
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¯¥æœåŠ¡ä»¥ HTTP æ–¹å¼æš´éœ²ï¼Œæ²¡æœ‰è¯ä¹¦ã€‚è®©æˆ‘ä»¬å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®-tls-è¯ä¹¦&#34;&gt;é…ç½® TLS è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;æœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ GAPI é…ç½® TLSã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¸¸è§çš„æƒ…å†µï¼šHTTPS åè®®å’Œåœ¨ Gateway ä¸Šç»ˆæ­¢ TLSã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³è¦é…ç½®ä¹‹å‰ä½¿ç”¨çš„åŸŸå &lt;code&gt;echo.cloud.ogenki.io&lt;/code&gt;ã€‚é…ç½®ä¸»è¦é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; æ¥å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/tls-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/tls-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cert-manager.io/cluster-issuer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;letsencrypt-prod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gatewayClassName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;cilium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Same&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯å¼•ç”¨ä¸€ä¸ªåŒ…å«åç§°ä¸º &lt;code&gt;echo-tls&lt;/code&gt; çš„è¯ä¹¦çš„å¯†é’¥ã€‚è¿™ä¸ªè¯ä¹¦å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä½†æ˜¯ä¸ºäº†æœ¬æ–‡ï¼Œæˆ‘é€‰æ‹©ä½¿ç”¨ &lt;strong&gt;Let&amp;rsquo;s Encrypt&lt;/strong&gt; å’Œ &lt;code&gt;cert-manager&lt;/code&gt; æ¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;}
&lt;strong&gt;cert-manager&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;cert-manager&lt;/code&gt;ï¼Œè‡ªåŠ¨åˆ›å»ºå’Œæ›´æ–°ç”± &lt;code&gt;Gateway&lt;/code&gt; æš´éœ²çš„è¯ä¹¦éå¸¸ç®€å•ã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦å…è®¸æ§åˆ¶å™¨è®¿é—® &lt;a href=&#34;https://aws.amazon.com/route53/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;route53&lt;/a&gt;ï¼Œä»¥è§£å†³ DNS01 æŒ‘æˆ˜ï¼ˆè¿™æ˜¯ä¸€ç§ç¡®ä¿å®¢æˆ·ç«¯åªèƒ½ä¸ºè‡ªå·±æ‹¥æœ‰çš„åŸŸè¯·æ±‚è¯ä¹¦çš„æœºåˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/security/base/cert-manager/cluster-issuer-staging.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ClusterIssuer&lt;/a&gt; èµ„æºæè¿°äº†ä½¿ç”¨ cert-manager ç”Ÿæˆè¯ä¹¦æ‰€éœ€çš„é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ³¨é‡Š &lt;code&gt;cert-manager.io/cluster-issuer&lt;/code&gt; å¹¶è®¾ç½®å­˜å‚¨è¯ä¹¦çš„ Kubernetes å¯†é’¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cert-manager.io/docs/usage/gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ›´å¤šä¿¡æ¯&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¼”ç¤ºå­˜å‚¨åº“ä¸­ï¼Œæƒé™æ˜¯ä½¿ç”¨ &lt;code&gt;Crossplane&lt;/code&gt; åˆ†é…çš„ï¼Œå®ƒè´Ÿè´£åœ¨ AWS ä¸­é…ç½®è¿™äº› IAM æƒé™ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä½¿è·¯ç”±æ­£å¸¸å·¥ä½œï¼Œä½ è¿˜éœ€è¦å°† &lt;code&gt;HTTPRoute&lt;/code&gt; é™„åŠ åˆ°æ­£ç¡®çš„ &lt;code&gt;Gateway&lt;/code&gt; å¹¶æŒ‡å®šåŸŸåã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡ ç§’é’Ÿåï¼Œè¯ä¹¦å°†è¢«åˆ›å»ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;kubectl get cert -n echo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NAME       READY   SECRET     AGE
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-tls   True    echo-tls   43m
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥è¯ä¹¦ç¡®å®æ¥è‡ª Let&amp;rsquo;s Encryptï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl https://echo.cloud.ogenki.io -v 2&amp;gt;&amp;amp;1 | grep -A 6 &amp;#39;Server certificate&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;* Server certificate:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subject: CN=echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  start date: Sep 15 14:43:00 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  expire date: Dec 14 14:42:59 2023 GMT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  subjectAltName: host &amp;#34;echo.cloud.ogenki.io&amp;#34; matched cert&amp;#39;s &amp;#34;echo.cloud.ogenki.io&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  issuer: C=US; O=Let&amp;#39;s Encrypt; CN=R3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;*  SSL certificate verify ok.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æç¤º&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    GAPI è¿˜å…è®¸ä½ é…ç½® &lt;strong&gt;ç«¯åˆ°ç«¯çš„ TLS&lt;/strong&gt;ï¼Œä¸€ç›´åˆ°å®¹å™¨ã€‚è¿™æ˜¯é€šè¿‡é…ç½® &lt;code&gt;Gateway&lt;/code&gt; ä¸º &lt;code&gt;Passthrough&lt;/code&gt; æ¨¡å¼å¹¶ä½¿ç”¨ &lt;code&gt;TLSRoute&lt;/code&gt; èµ„æºæ¥å®Œæˆçš„ã€‚è¯ä¹¦ä¹Ÿå¿…é¡»ç”±æ‰§è¡Œ TLS ç»ˆæ­¢çš„ pod æºå¸¦ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº«-gateway&#34;&gt;åœ¨å¤šä¸ªå‘½åç©ºé—´ä¸­å…±äº« Gateway&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å…±äº«ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å…±äº«ç½‘å…³&#34; srcset=&#34;
               /blog/cilium-gateway-api/shared-gateway_hu6695365609335332407.webp 400w,
               /blog/cilium-gateway-api/shared-gateway_hu14010442251536033886.webp 760w,
               /blog/cilium-gateway-api/shared-gateway_hu1081411389784665565.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/shared-gateway_hu6695365609335332407.webp&#34;
               width=&#34;760&#34;
               height=&#34;507&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å…±äº«ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;GAPI&lt;/code&gt;ï¼Œä½ å¯ä»¥åœ¨ &lt;code&gt;å‘½åç©ºé—´&lt;/code&gt; ä¹‹é—´è·¯ç”±æµé‡ã€‚è¿™å¾—ç›Šäºæ¯ä¸ªåŠŸèƒ½çš„ä¸åŒèµ„æºï¼šä¸€ä¸ª &lt;code&gt;Gateway&lt;/code&gt; å…è®¸é…ç½®åŸºç¡€è®¾æ–½ï¼Œä»¥åŠ &lt;code&gt;*Routes&lt;/code&gt;ã€‚è¿™äº›è·¯ç”±å¯ä»¥é™„åŠ åˆ°ä½äºå¦ä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ Gatewayã€‚å› æ­¤ï¼Œä¸åŒçš„å›¢é˜Ÿ/é¡¹ç›®å¯ä»¥å…±äº«ç›¸åŒçš„åŸºç¡€è®¾æ–½ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™éœ€è¦æŒ‡å®šå“ªä¸ªè·¯ç”±å…è®¸å¼•ç”¨è¯¥ Gatewayã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºå†…éƒ¨å·¥å…·çš„ Gatewayï¼Œåä¸º &lt;code&gt;platform&lt;/code&gt;ã€‚é€šè¿‡ä½¿ç”¨ &lt;code&gt;allowedRoutes&lt;/code&gt; å‚æ•°ï¼Œæˆ‘ä»¬æ˜ç¡®æŒ‡å®šäº†å“ªäº›å‘½åç©ºé—´å…è®¸é™„åŠ åˆ°æ­¤ Gatewayã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/infrastructure/base/gapi/platform-gateway.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;infrastructure/base/gapi/platform-gateway.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;allowedRoutes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Selector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchExpressions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/metadata.name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operator&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;In&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;observability&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;flux-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Terminate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;certificateRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å‘½åç©ºé—´ &lt;code&gt;observability&lt;/code&gt; å’Œ &lt;code&gt;flux-system&lt;/code&gt; ä¸­é…ç½®çš„ &lt;code&gt;HTTPRoutes&lt;/code&gt; é™„åŠ åˆ°æ­¤å”¯ä¸€çš„ &lt;code&gt;Gateway&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;parentRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;platform&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;infrastructure&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› æ­¤ï¼Œä½¿ç”¨æ¥è‡ªäº‘æä¾›å•†çš„ç›¸åŒè´Ÿè½½å‡è¡¡å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;NLB_DOMAIN=$(kubectl get svc -n infrastructure cilium-gateway-platform -o jsonpath={.status.loadBalancer.ingress[0].hostname})
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short ${NLB_DOMAIN}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short grafana-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;dig +short gitops-mycluster-0.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;13.36.89.108
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    è¿™äº›å†…éƒ¨å·¥å…·ä¸åº”è¯¥æš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œä½†æ˜¯ä½ çŸ¥é“ï¼šè¿™åªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…éƒ¨ Gatewayï¼ˆç§æœ‰ IPï¼‰é€šè¿‡è°ƒæ•´æ³¨é‡Šå¹¶ä½¿ç”¨ç§æœ‰è¿æ¥ç³»ç»Ÿï¼ˆVPNã€éš§é“ç­‰ï¼‰æ¥å®ç°ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;æµé‡åˆ†æµ&#34;&gt;æµé‡åˆ†æµ&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åˆ†æµ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åˆ†æµ&#34; srcset=&#34;
               /blog/cilium-gateway-api/split_hu2573309448358756362.webp 400w,
               /blog/cilium-gateway-api/split_hu15210160146444151996.webp 760w,
               /blog/cilium-gateway-api/split_hu15384968705509180727.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/cilium-gateway-api/split_hu2573309448358756362.webp&#34;
               width=&#34;760&#34;
               height=&#34;517&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åˆ†æµ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç”±æœåŠ¡ç½‘æ ¼å¸¸å¸¸æä¾›çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯åœ¨æœ‰æ–°ç‰ˆæœ¬å¯ç”¨æ—¶ï¼ˆA/B æµ‹è¯•æˆ–é‡‘ä¸é›€éƒ¨ç½²ï¼‰å¯¹éƒ¨åˆ†æµé‡æµ‹è¯•åº”ç”¨ç¨‹åºçš„èƒ½åŠ›ã€‚&lt;code&gt;GAPI&lt;/code&gt;é€šè¿‡ä½¿ç”¨æƒé‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿å…¶å˜å¾—éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä¸ªå°† 5% çš„æµé‡è½¬å‘åˆ°æœåŠ¡ &lt;code&gt;echo-2-echo-server&lt;/code&gt; çš„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/apps/base/echo/httproute-split.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;apps/base/echo/httproute-split.yaml&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostnames&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;split-echo.${domain_name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;95&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-2-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬æ£€æŸ¥åˆ†å‘æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/Smana/cilium-gateway-api/blob/main/scripts/check-split.sh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scripts/check-split.sh&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;./scripts/check-split.sh https://split-echo.cloud.ogenki.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-1 çš„è¯·æ±‚æ¬¡æ•°ï¼š95
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;echo-2 çš„è¯·æ±‚æ¬¡æ•°ï¼š5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¿®æ”¹æ ‡å¤´&#34;&gt;ä¿®æ”¹æ ‡å¤´&lt;/h3&gt;
&lt;p&gt;è¿˜å¯ä»¥æ›´æ”¹ HTTP &lt;strong&gt;æ ‡å¤´&lt;/strong&gt;ï¼šæ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤å®ƒä»¬ã€‚è¿™äº›ä¿®æ”¹å¯ä»¥é€šè¿‡åœ¨ &lt;code&gt;HTTPRoute&lt;/code&gt; æ¸…å•ä¸­ä½¿ç”¨ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/api-types/httproute#filters-optional&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;filters&lt;/a&gt; åº”ç”¨äºè¯·æ±‚æ ‡å¤´æˆ–å“åº”æ ‡å¤´ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;strong&gt;è¯·æ±‚&lt;/strong&gt; ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¤´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.networking.k8s.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPRoute&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;PathPrefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/req-header-add&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RequestHeaderModifier&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requestHeaderModifier&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;backendRefs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo-1-echo-server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤å…è®¸æŸ¥çœ‹æ ‡å¤´æ˜¯å¦ç¡®å®å·²æ·»åŠ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-console&#34; data-lang=&#34;console&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;curl -s https://echo.cloud.ogenki.io/req-header-add | jq &amp;#39;.request.headers&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;host&amp;#34;: &amp;#34;echo.cloud.ogenki.io&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;user-agent&amp;#34;: &amp;#34;curl/8.2.1&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;accept&amp;#34;: &amp;#34;*/*&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-for&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-forwarded-proto&amp;#34;: &amp;#34;https&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-envoy-external-address&amp;#34;: &amp;#34;81.220.234.254&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;x-request-id&amp;#34;: &amp;#34;320ba4d2-3bd6-4c2f-8a97-74296a9f3f26&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;  &amp;#34;foo&amp;#34;: &amp;#34;bar&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;go&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åˆ†é…é€‚å½“çš„æƒé™&#34;&gt;åˆ†é…é€‚å½“çš„æƒé™&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;GAPI&lt;/code&gt; æä¾›äº†ä¸€ç§æ¸…æ™°çš„æƒé™å…±äº«æ¨¡å‹ï¼Œç”¨äºç®¡ç†æµé‡è·¯ç”±åŸºç¡€è®¾æ–½ï¼ˆç”±é›†ç¾¤ç®¡ç†å‘˜ç®¡ç†ï¼‰å’Œåº”ç”¨ç¨‹åºï¼ˆç”±å¼€å‘äººå‘˜ç®¡ç†ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;å¤šä¸ªè‡ªå®šä¹‰èµ„æºçš„å¯ç”¨æ€§å…è®¸ä½¿ç”¨ Kubernetes çš„ &lt;strong&gt;RBAC&lt;/strong&gt; é…ç½®ä»¥å£°æ˜æ€§æ–¹å¼åˆ†é…æƒé™ã€‚æˆ‘å·²ç»æ·»åŠ äº†ä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„æ¼”ç¤ºé›†ç¾¤ä¸­æ²¡æœ‰æ•ˆæœï¼Œä½†å¯èƒ½ä¼šç»™ä½ ä¸€ä¸ªæƒ³æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„é…ç½®æˆäºˆ &lt;code&gt;developers&lt;/code&gt; ç»„çš„æˆå‘˜åœ¨ echo å‘½åç©ºé—´å†…ç®¡ç† &lt;code&gt;HTTPRoutes&lt;/code&gt; çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä»…æä¾›å¯¹ &lt;code&gt;Gateways&lt;/code&gt; çš„è¯»å–æƒé™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;httproutes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiGroups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateway.networking.k8s.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gateways&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;verbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;get&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;list&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;RoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;echo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Group&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;developers&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gapi-developer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&#34;&gt;ä¹ä¸€çœ‹æœ‰ç‚¹æ¨¡ç³Š&lt;/h2&gt;
&lt;p&gt;äººä»¬å¯èƒ½ä¼šå¯¹é€šå¸¸ç§°ä¸º &lt;code&gt;API ç½‘å…³&lt;/code&gt; çš„ä¸œè¥¿æ„Ÿåˆ°å›°æƒ‘ã€‚å·²ç»åˆ›å»ºäº† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/faq/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FAQ&lt;/a&gt; çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä»¥æ¾„æ¸…å®ƒä¸ &lt;code&gt;Gateway API&lt;/code&gt; çš„ä¸åŒä¹‹å¤„ã€‚å°½ç®¡ GAPI æä¾›äº†é€šå¸¸åœ¨ API ç½‘å…³ä¸­æ‰¾åˆ°çš„åŠŸèƒ½ï¼Œä½†å®ƒä¸»è¦æ˜¯ Kubernetes çš„ä¸€ä¸ªç‰¹å®šå®ç°ã€‚ç„¶è€Œï¼Œé€‰æ‹©è¿™ä¸ªåç§°ç¡®å®å¯èƒ½å¼•èµ· &lt;strong&gt;æ··æ·†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ–‡ä»…å…³æ³¨å…¥ç«™æµé‡ï¼Œé€šå¸¸ç”± &lt;em&gt;Ingress Controllers&lt;/em&gt; ç®¡ç†ï¼Œç§°ä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#northsouth-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å—åŒ—&lt;/a&gt;ï¼Œè¿™å®é™…ä¸Šæ˜¯ GAPI çš„åˆå§‹èŒƒå›´ã€‚æœ€è¿‘çš„ä¸€ä¸ªåä¸º &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/gamma/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;GAMMA&lt;/strong&gt;&lt;/a&gt; çš„å€¡è®®æ—¨åœ¨å¤„ç† &lt;a href=&#34;https://gateway-api.sigs.k8s.io/concepts/glossary/#eastwest-traffic&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸œè¥¿æµé‡&lt;/a&gt; è·¯ç”±ï¼Œè¿™å°†åœ¨å°†æ¥æ ‡å‡†åŒ–æŸäº›å¸¸è§çš„åŠŸèƒ½ï¼Œé€šå¸¸ç”± &lt;code&gt;Service Meshes&lt;/code&gt; è§£å†³æ–¹æ¡ˆæä¾›ã€‚ï¼ˆæœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… &lt;a href=&#34;https://kubernetes.io/blog/2023/08/29/gateway-api-v0-8/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤æ–‡ç« &lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„æƒ³æ³•&#34;&gt;æœ€åçš„æƒ³æ³•&lt;/h2&gt;
&lt;p&gt;è€å®è¯´ï¼Œæˆ‘å·²ç»çŸ¥é“ &lt;strong&gt;Gateway API&lt;/strong&gt; æœ‰ä¸€æ®µæ—¶é—´äº†ã€‚å°½ç®¡æˆ‘è¯»äº†ä¸€äº›æ–‡ç« ï¼Œä½†æˆ‘å¹¶æ²¡æœ‰çœŸæ­£æ·±å…¥ç ”ç©¶è¿‡ã€‚æˆ‘ä¼šæƒ³ï¼šâ€œä¸ºä»€ä¹ˆè¦éº»çƒ¦å‘¢ï¼Ÿæˆ‘çš„ &lt;em&gt;Ingress Controller&lt;/em&gt; å¯ä»¥å·¥ä½œï¼Œè€Œä¸”è¿™éœ€è¦å­¦ä¹ æ›²çº¿ã€‚â€&lt;/p&gt;
&lt;p&gt;GAPI æ­£åœ¨å´­éœ²å¤´è§’ï¼Œå³å°†å‘å¸ƒ GA ç‰ˆæœ¬ã€‚å¤šä¸ª &lt;a href=&#34;https://gateway-api.sigs.k8s.io/implementations/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¡¹ç›®&lt;/a&gt; å·²ç»æ‹¥æŠ±å®ƒï¼Œè¿™ä¸ªç”¨äºç®¡ç† Kubernetes å†…æµé‡çš„ API å°†è¿…é€Ÿæˆä¸ºæ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¿…é¡»è¯´ï¼Œé…ç½® GAPI æ„Ÿè§‰ç›´è§‚è€Œæ˜ç¡®ã€‚å®ƒçš„å®‰å…¨æ¨¡å‹å–å¾—äº†å¹³è¡¡ï¼Œèµ‹äºˆå¼€å‘äººå‘˜æƒåŠ›è€Œä¸ä¼šæŸå®³å®‰å…¨æ€§ã€‚è€Œä¸”æ— ç¼çš„åŸºç¡€è®¾æ–½ç®¡ç†ï¼Ÿä½ å¯ä»¥åœ¨ä¸è§¦åŠ &lt;code&gt;*Routes&lt;/code&gt; çš„æƒ…å†µä¸‹åœ¨ä¸åŒçš„å®ç°ä¹‹é—´åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±ç”¨ &lt;code&gt;Cilium&lt;/code&gt; äº¤æ¢æˆ‘çš„ Ingress Controller å—ï¼Ÿ&lt;strong&gt;è¿˜æ²¡æœ‰ï¼Œä½†å®ƒå³å°†åˆ°æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—å¼ºè°ƒçš„æ˜¯ï¼ŒCilium çš„åŠŸèƒ½éå¸¸å¹¿æ³›ï¼šåœ¨ Kubernetes å‘¨å›´æœ‰å¤§é‡çš„å·¥å…·ï¼ŒCilium è„±é¢–è€Œå‡ºï¼Œæ‰¿è¯ºæä¾›æŒ‡æ ‡ã€è·Ÿè¸ªã€æœåŠ¡ç½‘æ ¼ã€å®‰å…¨æ€§ï¼Œä»¥åŠ &lt;em&gt;Ingress Controller&lt;/em&gt; ä¸ GAPIã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŒ‘æˆ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21929&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP å’Œ UDP æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cilium/cilium/issues/21928&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GRPC æ”¯æŒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦ä½¿ç”¨å˜å¼‚è§„åˆ™æ¥é…ç½®äº‘ç»„ä»¶ï¼ˆ&lt;a href=&#34;https://github.com/cilium/cilium/issues/25357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github Issue&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æœ¬æ–‡è®¨è®ºçš„è®¸å¤šåŠŸèƒ½ä»å¤„äºå®éªŒé˜¶æ®µã€‚ä¾‹å¦‚ï¼Œæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ‘å†™ä½œæ—¶çš„ &lt;code&gt;v1.14.2&lt;/code&gt;ï¼‰æ”¯æŒçš„ &lt;a href=&#34;https://github.com/cilium/cilium/pull/27472&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‰©å±•åŠŸèƒ½&lt;/a&gt;ã€‚æˆ‘å°è¯•è®¾ç½®ä¸€ä¸ªç®€å•çš„ HTTP&amp;gt;HTTPS é‡å®šå‘ï¼Œä½†é‡åˆ°äº† &lt;a href=&#34;https://github.com/kubernetes-sigs/gateway-api/issues/1185&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ªé—®é¢˜&lt;/a&gt;ã€‚å› æ­¤ï¼Œæˆ‘é¢„è®¡ API å°†æ¥ä¼šæœ‰ä¸€äº›ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶æˆ‘åªæ˜¯æ¶‰åŠäº† Cilium çš„ GAPI èƒ½å¤Ÿæä¾›çš„ä¸€å°éƒ¨åˆ†å†…å®¹ï¼ˆè€å®è¯´ï¼Œè¿™ç¯‡æ–‡ç« å·²ç»ç›¸å½“é•¿äº†ï¼‰ï¼Œä½†æˆ‘å¸Œæœ›æˆ‘ä»¬å¯ä»¥å¾ˆå¿«åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨å®ƒã€‚ä½†è€ƒè™‘åˆ°å‰é¢æåˆ°çš„å‡ ç‚¹ï¼Œæˆ‘å»ºè®®ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æƒ³ä¸ºæœªæ¥åšå‡†å¤‡ï¼Œé‚£ä¹ˆç°åœ¨æ˜¯æ—¶å€™äº†ï¼&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://gateway-api.sigs.k8s.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.cilium.io/en/latest/network/servicemesh/gateway-api/gateway-api/#gs-gateway-api&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://isovalent.com/blog/post/tutorial-getting-started-with-the-cilium-gateway-api/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Isovalent çš„ &lt;a href=&#34;https://isovalent.com/resource-library/labs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;labs&lt;/a&gt; æ˜¯å¼€å§‹ä½¿ç”¨ Gateway API å¹¶ä¸”ä½ å°†è·å¾—æ–°çš„å¾½ç« ä»¥æ·»åŠ åˆ°ä½ çš„æ”¶è—ä¸­çš„å¥½æ–¹æ³•&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Ciilium çš„ç›¸äº’è®¤è¯å¦‚ä½•å±åŠå®‰å…¨</title>
      <link>https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/</link>
      <pubDate>Fri, 01 Dec 2023 10:33:00 +0800</pubDate>
      <guid>https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://thenewstack.io/how-ciliums-mutual-authentication-can-compromise-security/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://thenewstack.io/how-ciliums-mutual-authentication-can-compromise-security/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‘˜è¦ï¼šè¿™ç¯‡æ–‡ç« æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨ Cilium æ¥å®ç° äº’ç›¸è®¤è¯ (mTLS) çš„ï¼Œä»¥åŠè¿™ç§æ–¹æ³•å¯èƒ½å¸¦æ¥çš„å®‰å…¨é—®é¢˜ã€‚æ–‡ç« ä»‹ç»äº† Cilium çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Cilium CLI æˆ– Hubble UI æ¥åˆ›å»ºå’Œç®¡ç†è¯ä¹¦å’Œç­–ç•¥ã€‚æ–‡ç« è¿˜åˆ†æäº† Cilium çš„äº’ç›¸è®¤è¯çš„å±€é™å’Œé£é™©ï¼Œä¾‹å¦‚è¯ä¹¦è¿‡æœŸï¼Œæ’¤é”€ï¼Œæ³„éœ²å’Œä¼ªé€ ç­‰ã€‚æ–‡ç« çš„ç›®çš„æ˜¯å¸®åŠ©ç”¨æˆ·äº†è§£å’Œä½¿ç”¨ Cilium æ¥æé«˜æœåŠ¡é—´çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æœ€è¿‘ï¼ŒCilium é¡¹ç›®å®£å¸ƒæ”¯æŒä¸€ç§&lt;a href=&#34;https://docs.cilium.io/en/latest/network/servicemesh/mutual-authentication/mutual-authentication/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–°çš„åŒå‘è®¤è¯æœºåˆ¶&lt;/a&gt;ï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®æ ‡å¿—é€æ˜åœ°éƒ¨ç½²åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ä»è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ Cilium ä¸º Kubernetes å·¥ä½œè´Ÿè½½å®ç°æœåŠ¡ä¹‹é—´çš„åŒå‘è®¤è¯ã€‚ç„¶è€Œï¼Œè¿™ç§è®¾è®¡å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„ç¼ºé™·ï¼Œä¸å®¹å¿½è§†ï¼š&lt;/p&gt;
&lt;p&gt;Cilium ä¸­çš„åŒå‘è®¤è¯çš„æ•´ä¸ªåŸºç¡€æ˜¯&lt;em&gt;æœ€ç»ˆä¸€è‡´æ€§&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®‰å…¨å®ç°çš„æ•°æ®è·¯å¾„ä¸­ï¼Œæœ€ç»ˆä¸€è‡´æ€§å¯èƒ½å¯¼è‡´æ„å›¾ä¸­çš„å®‰å…¨å±æ€§å¤±è´¥ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´åœ¨ä¸åº”è¯¥å…è®¸çš„æƒ…å†µä¸‹æœåŠ¡ä¹‹é—´çš„æµé‡ç»§ç»­ä¼ é€’ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cilium-åŒå‘è®¤è¯çš„å·¥ä½œåŸç†&#34;&gt;Cilium åŒå‘è®¤è¯çš„å·¥ä½œåŸç†&lt;/h2&gt;
&lt;p&gt;Cilium çš„è‡ªå®šä¹‰åŒå‘è®¤è¯æœºåˆ¶ä¼šé€æ˜åœ°å¯¹æœåŠ¡ä¹‹é—´çš„æµè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ„å»ºåœ¨ Cilium çš„ç°æœ‰æ‰©å±•ä¼¯å…‹åˆ©æ•°æ®åŒ…è¿‡æ»¤å™¨ï¼ˆ&lt;a href=&#34;https://thenewstack.io/ebpf-offers-a-new-way-to-secure-cloud-native-systems/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt;ï¼‰æ•°æ®å¹³é¢ä¹‹ä¸Šã€‚Cilium ä½¿ç”¨ eBPF æ¥å®ç°è¯¸å¦‚æœåŠ¡ç½‘ç»œã€ç½‘ç»œç­–ç•¥å’Œè¿æ¥å¤„ç†ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;Cilium ä½¿ç”¨â€œæ— åŒå‘ä¼ è¾“å±‚å®‰å…¨ï¼ˆmTLS-lessï¼‰â€ï¼ˆæˆ– mTLessï¼‰æ¥å¯¹æœåŠ¡è¿›è¡Œèº«ä»½éªŒè¯ã€‚æˆ‘ç§°ä¹‹ä¸ºâ€œlessâ€ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ mTLS æ¥å®Œæˆ mTLS è®¾è®¡çš„ä»»åŠ¡ï¼šéªŒè¯ã€åŠ å¯†å’Œæ£€æŸ¥åœ¨ä¸¤ä¸ªå¯¹ç­‰æ–¹ä¹‹é—´ä¼ è¾“çš„æ•°æ®çš„å®Œæ•´æ€§ã€‚Cilium çš„åŒå‘è®¤è¯å®ç°&lt;em&gt;ä¸æ˜¯ mTLS&lt;/em&gt;ï¼Œæˆ‘å°†åœ¨ä¸‹é¢è§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;å½“æœåŠ¡ï¼ˆæˆ– Podï¼‰A æƒ³è¦ä¸æœåŠ¡ï¼ˆæˆ– Podï¼‰B é€šä¿¡æ—¶ï¼ŒCilium ä¼šå°è¯•å¯¹è¿™ä¸¤ä¸ªå¯¹ç­‰æ–¹è¿›è¡Œèº«ä»½éªŒè¯ï¼Œç„¶åæ ‡è®°ä¸€ä¸ªç‰¹æ®Šçš„æœ¬åœ°èŠ‚ç‚¹â€œèº«ä»½éªŒè¯ç¼“å­˜â€ï¼ŒæŒ‡ç¤ºæ˜¯å¦å…è®¸ç‰¹å®šæµã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1ç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu9728721819287716679.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu8515282394999911504.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu15339383418986846698.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f1_hu9728721819287716679.webp&#34;
               width=&#34;760&#34;
               height=&#34;293&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šç”±äºæœªç»èº«ä»½éªŒè¯è€Œä¸¢å¼ƒçš„åˆå§‹è¿æ¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“ Pod A æƒ³è¦ä¸ Pod B é€šä¿¡æ—¶ï¼Œå®ƒä¼šé€šè¿‡æ­£å¸¸çš„ Cilium eBPF æ•°æ®å¹³é¢æµåŠ¨ï¼Œä½† eBPF ä»£ç ä¼šæ£€æŸ¥è¯¥è¿æ¥æ˜¯å¦å·²é€šè¿‡æ£€æŸ¥æœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜è¿›è¡Œèº«ä»½éªŒè¯ã€‚åœ¨ç¬¬ä¸€æ¬¡å°è¯•æ—¶ï¼Œè¯¥è°ƒç”¨å°†ä¸ä¼šå¾—åˆ°èº«ä»½éªŒè¯ï¼Œå› æ­¤&lt;a href=&#34;https://github.com/cilium/cilium/issues/23808&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å°†ä¸¢å¼ƒæ•°æ®åŒ…&lt;/a&gt;ã€‚ä½†è¿™å°†è§¦å‘ä¸€ä¸ªåœ¨å¹•åè¿›è¡Œçš„æœºåˆ¶ï¼Œå°è¯•å¯¹ Pod A å’Œ Pod B ä¹‹é—´çš„æµè¿›è¡Œèº«ä»½éªŒè¯ã€‚å¦‚æœæˆåŠŸï¼Œå®ƒå°†æ›´æ–°æœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;æœŸæœ›çš„æ˜¯ï¼Œåœ¨å¹•åçš„æœºåˆ¶èƒ½å¤Ÿå¿«é€Ÿè¿›è¡Œ Pod A å‘¼å« Pod B çš„èº«ä»½éªŒè¯ï¼Œä»¥ä¾¿æœ€åˆä¸¢å¼ƒçš„æ•°æ®åŒ…å°†è¢«é‡è¯•ï¼Œä¸ä¼šå¯¼è‡´å¤ªå¤šå»¶è¿Ÿã€‚åœ¨å¹•åä½¿ç”¨çš„æœºåˆ¶æ˜¯ä»è¿è¡Œåœ¨ Pod B æ‰€åœ¨èŠ‚ç‚¹ä¸Šçš„ cilium-agentï¼ˆä½¿ç”¨&lt;a href=&#34;https://roadmap.sh/golang&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Go&lt;/a&gt;ç¼–å†™ï¼‰åˆ°å¦ä¸€ä¸ª cilium-agent çš„â€œmTLessâ€è¿æ¥ã€‚æ‰€æœ‰è¿™äº›éƒ½ä¸ä¼šåœ¨ eBPF æ•°æ®å¹³é¢ä¸­å‘ç”Ÿï¼Œè€Œæ˜¯åœ¨ç”¨æˆ·ç©ºé—´çš„ Cilium ä»£ç†ä¸­è¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2å¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„-cilium-agent-ä¹‹é—´çš„-mtls-è¿æ¥æˆåŠŸåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šå¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ cilium-agent ä¹‹é—´çš„ mTLS è¿æ¥æˆåŠŸï¼Œåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu10070661624759929293.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu16286326383952627814.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu17409430451658380993.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f2_hu10070661624759929293.webp&#34;
               width=&#34;760&#34;
               height=&#34;380&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šå¦‚æœä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ cilium-agent ä¹‹é—´çš„ mTLS è¿æ¥æˆåŠŸï¼Œåˆ™è®¤ä¸ºæµæ˜¯ç»è¿‡èº«ä»½éªŒè¯çš„ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘å°†è¿™ä¸ªè¿æ¥ç§°ä¸ºâ€œmTLessâ€ï¼Œå› ä¸ºå®ƒç”¨äºæµ‹è¯•èº«ä»½éªŒè¯å¹¶ç«‹å³å…³é—­ï¼Œå¹¶ä¸”æ‰€æœ‰ç”¨äºåŠ å¯†å’Œå®Œæ•´æ€§çš„åå•†çš„ä¼šè¯å¯†é’¥éƒ½ä¼šè¢«ä¸¢å¼ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCilium ä¸ä¼šåœ¨è¿æ¥çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿ç•™ mTLS å®‰å…¨å±æ€§ï¼›å®ƒåªä½¿ç”¨æ¡æ‰‹çš„èº«ä»½éªŒè¯éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3åœ¨æ¡æ‰‹åcilium-ç»ˆæ­¢-mtless-è¿æ¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3ï¼šåœ¨æ¡æ‰‹åï¼ŒCilium ç»ˆæ­¢ mTLess è¿æ¥ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu5450890929644243593.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu5078158644050773506.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu1911652993401268773.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f3_hu5450890929644243593.webp&#34;
               width=&#34;760&#34;
               height=&#34;284&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3ï¼šåœ¨æ¡æ‰‹åï¼ŒCilium ç»ˆæ­¢ mTLess è¿æ¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚æœæ­¤ mTLess è¿æ¥æˆåŠŸï¼ˆå³æ¡æ‰‹æˆåŠŸï¼‰ï¼ŒCilium å°†è€ƒè™‘å°†æ¥è‡ª Pod A åˆ° Pod B çš„æµç¨‹è§†ä¸ºâ€œå·²éªŒè¯â€ã€‚æ­¤æ—¶ï¼Œæœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ä¸­çš„æ¡ç›®å°†è¢«æ›´æ–°ï¼Œä»¥æŒ‡ç¤ºåº”å…è®¸æ¥è‡ª Pod A åˆ° Pod B çš„æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4cilium-æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜æŒ‡ç¤º-pod-a-å…·æœ‰å‘¼å«-pod-b-çš„èº«ä»½éªŒè¯&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4ï¼šCilium æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜ï¼ŒæŒ‡ç¤º Pod A å…·æœ‰å‘¼å« Pod B çš„èº«ä»½éªŒè¯ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu10284544887028446734.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu8173082787676185549.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu3459960760797016323.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f4_hu10284544887028446734.webp&#34;
               width=&#34;760&#34;
               height=&#34;329&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4ï¼šCilium æ›´æ–°èº«ä»½éªŒè¯ç¼“å­˜ï¼ŒæŒ‡ç¤º Pod A å…·æœ‰å‘¼å« Pod B çš„èº«ä»½éªŒè¯ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œå½“å®ƒé‡è¯•è¿æ¥æ•°æ®åŒ…æ—¶ï¼Œèº«ä»½éªŒè¯ç¼“å­˜å°†æŒ‡ç¤ºæµç¨‹å·²ç»é€šè¿‡èº«ä»½éªŒè¯ï¼Œåº”å…è®¸è¿æ¥å¹¶ç»§ç»­ eBPF æ•°æ®å¹³é¢çš„å…¶ä½™éƒ¨åˆ†ï¼ˆè¯¥éƒ¨åˆ†å¼ºåˆ¶æ‰§è¡Œç½‘ç»œå’Œå…¶ä»–ç­–ç•¥ï¼‰ã€‚è¿™ä¸ªæœ¬åœ°èŠ‚ç‚¹èº«ä»½éªŒè¯ç¼“å­˜ç¡®å®è¡¨ç°å‡ºæœ€ç»ˆä¸€è‡´æ€§çš„è¿¹è±¡ï¼Œå¯èƒ½ä¼šå¤±å»åŒæ­¥ï¼Œä½†è¿™å¹¶ä¸æ˜¯æœ€ä»¤äººæ‹…å¿§çš„æœ€ç»ˆä¸€è‡´æ€§å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5ä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…è¿æ¥å°†ä¼šæµåŠ¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5ï¼šä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…ï¼Œè¿æ¥å°†ä¼šæµåŠ¨ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu8875700578379452926.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu16400022754917321780.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu8750530588956005851.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f5_hu8875700578379452926.webp&#34;
               width=&#34;760&#34;
               height=&#34;267&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5ï¼šä¸€æ—¦ç¼“å­˜å·²æ›´æ–°å¹¶é‡è¯•æ•°æ®åŒ…ï¼Œè¿æ¥å°†ä¼šæµåŠ¨ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;cilium-æ–¹æ³•çš„ä¸»è¦é—®é¢˜&#34;&gt;Cilium æ–¹æ³•çš„ä¸»è¦é—®é¢˜&lt;/h2&gt;
&lt;p&gt;å¯¹äºçœŸæ­£çš„ mTLS è¿æ¥ï¼Œåœ¨æˆåŠŸæ¡æ‰‹ä¹‹åï¼Œæ‚¨å¸Œæœ›ä½¿ç”¨åœ¨å‚ä¸å„æ–¹ä¹‹é—´åå•†çš„å¯†é’¥æ¥åŠ å¯†å‰©ä½™çš„æ•°æ®ã€‚Cilium ä¸­æµçš„æˆåŠŸè®¤è¯å¹¶ä¸æ„å‘³ç€å®ƒæ˜¯åŠ å¯†çš„ï¼ˆå®ƒå°†æ˜¯çº¯æ–‡æœ¬ï¼‰ï¼Œä¹Ÿä¸ä¿è¯æµé‡ä»¥ä¸€ç§ä»…å¯¹ç›¸å…³æ–¹å¯è§çš„æ–¹å¼è¿›è¡ŒåŠ å¯†ã€‚å¦‚æœæ‚¨éœ€è¦åŠ å¯†ï¼Œå¯ä»¥ä½¿ç”¨åŸºäº WireGuardï¼ˆæˆ– IPSecï¼‰çš„ Cilium åŠ å¯†é€‰é¡¹ï¼Œä½†è¿™åªæ˜¯ä¸¤ä¸ª Kubernetes èŠ‚ç‚¹ä¹‹é—´çš„åŠ å¯†ï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„å·²è®¤è¯çš„å·¥ä½œè´Ÿè½½ã€‚åœ¨â€œmTLessâ€è¿æ¥æ£€æŸ¥å’Œå°†å®é™…ï¼ˆæ•æ„Ÿï¼‰æ•°æ®æ”¾å…¥çº¿è·¯ä¹‹é—´ï¼Œå¯èƒ½ä¼šå‘ç”Ÿå¾ˆå¤šäº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;éšç€ä¸€äº› Cilium å¼€å‘äººå‘˜ç»§ç»­è¿­ä»£è¿™ä¸ªå®ç°ï¼Œæœ‰å…³å°† mTLS è¿æ¥ä¸­åå•†çš„æŸäº›å¯†é’¥è½¬ç§»åˆ°åº•å±‚èŠ‚ç‚¹åˆ°èŠ‚ç‚¹åŠ å¯†æ–¹æ³•ï¼ˆä¾‹å¦‚ IPSecï¼‰çš„è°ˆè®ºã€‚è¿™ä¸ªå®ç°è¿˜æœ‰å¾…è§‚å¯Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6å…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6ï¼šå…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu1596331468209483764.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu12770787854073781734.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu7902297478813327711.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f6_hu1596331468209483764.webp&#34;
               width=&#34;760&#34;
               height=&#34;427&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6ï¼šå…·æœ‰ä¸åŒä¼šè¯å¯†é’¥çš„æµé‡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-7åŸºäº-wireguard-çš„åŠ å¯†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 7ï¼šåŸºäº WireGuard çš„åŠ å¯†ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu18406516341919106284.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu17375687142356433346.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu16409185980720703418.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f7_hu18406516341919106284.webp&#34;
               width=&#34;760&#34;
               height=&#34;423&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 7ï¼šåŸºäº WireGuard çš„åŠ å¯†ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Cilium æœ€ç»ˆä¸€è‡´æ€§åŒå‘è®¤è¯å®ç°çš„çœŸæ­£é—®é¢˜å‡ºç°åœ¨ Cilium çš„æ ¸å¿ƒèº«ä»½æ¨¡å‹å‘¨å›´ã€‚æˆ‘åœ¨ä¸Šé¢ç®€è¦ä»‹ç»äº† TLS æ¡æ‰‹ï¼Œä½†å¦‚æœæ‚¨é˜…è¯» Cilium æ–‡æ¡£ï¼Œæ‚¨ä¼šçœ‹åˆ°ç”¨äºâ€œmTLessâ€çš„ X509 è¯ä¹¦å…·æœ‰å¯é€‰åŸºäº&lt;a href=&#34;https://thenewstack.io/the-rise-of-workload-identity-in-cloud-native-with-spiffe-spire/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt;ï¼ˆSecure Production Identity Framework For Everyoneï¼‰çš„èº«ä»½æ¨¡å‹ã€‚å®é™…ä¸Šï¼Œåœ¨éƒ¨ç½²å®ç° Cilium åŒå‘è®¤è¯æ‰€éœ€çš„ç»„ä»¶æ—¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©éƒ¨ç½² SPIFFE Runtime Environmentï¼ˆSPIREï¼‰ï¼Œè¿™æ˜¯ SPIFFE çš„ä¸€ä¸ªå®ç°ï¼ŒCilium ä½¿ç”¨å®ƒæ¥ç”Ÿæˆä»£è¡¨å·¥ä½œè´Ÿè½½åŠå…¶èº«ä»½çš„è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª SPIFFE èº«ä»½ç”¨äºæ¡æ‰‹æ‰€ä½¿ç”¨çš„è¯ä¹¦ï¼Œ&lt;em&gt;ä½† SPIFFE ä¸æ˜¯ Cilium ä¸­ä½¿ç”¨çš„åŸºç¡€é€šç”¨å·¥ä½œè´Ÿè½½èº«ä»½&lt;/em&gt;ã€‚SPIFFE ç”¨ä½œç‹¬ç«‹çš„èº«ä»½å±‚ï¼Œæ˜ å°„åˆ° Cilium ç°æœ‰èº«ä»½å®ç°ã€‚Cilium åœ¨å…¶&lt;a href=&#34;https://doc.crds.dev/github.com/cilium/cilium/cilium.io/CiliumIdentity/v2@1.9.3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ¸å¿ƒèº«ä»½&lt;/a&gt;æ¦‚å¿µå‘¨å›´æ„å»ºäº†æ‰€æœ‰çš„ç½‘ç»œç­–ç•¥ã€‚CiliumIdentity å®ç°å°†ä¸€ä¸ªæ•´æ•°æ˜ å°„åˆ°ä¸€ç»„ IP åœ°å€ï¼ˆä¸ä¸€ç»„ Pod å…³è”çš„ Pod IPï¼‰ã€‚è¿™ä¸ªâ€œæ•´æ•°â€åŠå…¶æ˜ å°„åˆ° Pod IP åœ°å€çš„æ–¹å¼ä»£è¡¨äº†&lt;em&gt;Cilium ä¸­çš„æ ¸å¿ƒèº«ä»½åŸè¯­&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-8cilium-çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ°-ip-åœ°å€çš„æ•´æ•°&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 8ï¼šCilium çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ° IP åœ°å€çš„æ•´æ•°ã€‚&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu3533446481480882885.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu1062786511443162722.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu6217334345361474889.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f8_hu3533446481480882885.webp&#34;
               width=&#34;760&#34;
               height=&#34;371&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 8ï¼šCilium çš„æ ¸å¿ƒèº«ä»½åŸè¯­åŸºäºåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­æ˜ å°„åˆ° IP åœ°å€çš„æ•´æ•°ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨åšå®¢æ–‡ç« â€œ&lt;a href=&#34;https://www.solo.io/blog/could-network-cache-based-identity-be-mistaken/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œåŸºäºç¼“å­˜çš„èº«ä»½å¯èƒ½ä¼šè¢«è¯¯è§£å—ï¼Ÿ&lt;/a&gt;â€ä¸­è¯¦ç»†è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ã€‚ç”±äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å»ºè®®åœ¨è€ƒè™‘ä½¿ç”¨ä¾èµ–èº«ä»½åˆ° IP åœ°å€æ˜ å°„çš„å®¹å™¨ç½‘ç»œæ¥å£ï¼ˆCNIï¼‰å’Œ&lt;a href=&#34;https://thenewstack.io/secure-your-service-mesh-a-13-item-checklist/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;è¿›è¡Œç½‘ç»œå®‰å…¨æ—¶é‡‡å–æ·±åº¦é˜²å¾¡å§¿æ€ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜çš„å…³é”®åœ¨äºï¼š&lt;/p&gt;
&lt;p&gt;ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªèº«ä»½çš„æ‰€æœ‰ IP æ˜ å°„&lt;em&gt;éƒ½å­˜åœ¨äºé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-9æ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„-ip-çš„å›¾è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 9ï¼šæ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„ IP çš„å›¾è¡¨&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu286766633997356943.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu16074494618080885932.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu8608529016465095533.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f9_hu286766633997356943.webp&#34;
               width=&#34;760&#34;
               height=&#34;461&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 9ï¼šæ˜¾ç¤ºæ¯ä¸ªèº«ä»½çš„ IP çš„å›¾è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-10æœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 10ï¼šæœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨&#34; srcset=&#34;
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu10907965185694279089.webp 400w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu14619749360156476499.webp 760w,
               /blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu8374157354846843875.webp 1200w&#34;
               src=&#34;https://cloudnativecn.com/blog/how-ciliums-mutual-authentication-can-compromise-security/f10_hu10907965185694279089.webp&#34;
               width=&#34;760&#34;
               height=&#34;452&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 10ï¼šæœ€ç»ˆä¸€è‡´æ€§é—®é¢˜çš„å›¾è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿ Cilium çš„åŒå‘è®¤è¯å’Œç­–ç•¥æ‰§è¡Œæ­£å¸¸å·¥ä½œï¼Œå¿…é¡»ä½¿ç”¨æ­£ç¡®çš„ IP åˆ°èº«ä»½æ˜ å°„æ›´æ–°è¿™äº›ç¼“å­˜ã€‚ç„¶è€Œï¼Œåœ¨é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ›´æ–°å•ç‹¬çš„ç¼“å­˜&lt;em&gt;æ˜¯ä¸€ç§æœ€ç»ˆä¸€è‡´æ€§æ“ä½œ&lt;/em&gt;ã€‚å½“ Cilium çš„ eBPF æ•°æ®å¹³é¢å°è¯•æ¨ç†è¿æ¥ç­–ç•¥æ—¶ï¼Œå®ƒå°†å‚è€ƒå…¶èŠ‚ç‚¹æœ¬åœ°ç¼“å­˜ä¸­çš„ IP åˆ°èº«ä»½æ˜ å°„ã€‚&lt;em&gt;å¦‚æœè¯¥ç¼“å­˜è¿‡æœŸæˆ–å»¶è¿Ÿ&lt;/em&gt;ï¼Œå°†å¯¼è‡´ä¸æ­£ç¡®çš„ç½‘ç»œç­–ç•¥ï¼ˆå¯èƒ½ä¸ç¬¦åˆè¦æ±‚ï¼Œå…è®¸æ¶æ„æ´»åŠ¨ï¼Œå¨èƒæ•°æ®ç­‰ï¼‰ã€‚æ— è®ºæ‚¨æ˜¯å¦ä½¿ç”¨ WireGuard æˆ– IPSec æ¥åŠ å¯†èŠ‚ç‚¹ä¹‹é—´çš„æµé‡ï¼Œè¿™éƒ½ä¸ä¼šå½±å“æ­¤èº«ä»½æ··æ·†åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¼”ç¤ºè¯´æ˜äº†åœ¨ä½¿ç”¨ Cilium çš„åŒå‘è®¤è¯æ—¶å¯èƒ½å¯¼è‡´è¿åç½‘ç»œç­–ç•¥çš„èº«ä»½æ··æ·†ï¼š&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å› æ­¤ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cilium é¡¹ç›®å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„ Kubernetes å·¥ä½œè´Ÿè½½çš„åŒå‘è®¤è¯æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä¸­çš„åŒå‘è®¤è¯å»ºç«‹åœ¨æœ€ç»ˆä¸€è‡´æ€§ä¹‹ä¸Šï¼Œå¯èƒ½ä¼šå±åŠå®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;Cilium ä½¿ç”¨â€œmTLessâ€è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä½†ä¸ä¼šç»´æŠ¤æ•´ä¸ªè¿æ¥çš„åŠ å¯†ã€‚&lt;/li&gt;
&lt;li&gt;Cilium çš„èº«ä»½æ¨¡å‹åŒ…æ‹¬ SPIFFEï¼Œä½†å…¶æ ¸å¿ƒèº«ä»½æ˜¯ä¸€ä¸ªåŸºäºæ•´æ•°çš„å•ç‹¬èº«ä»½å±‚ã€‚&lt;/li&gt;
&lt;li&gt;æ ¸å¿ƒé—®é¢˜åœ¨äºï¼ŒIP åˆ°èº«ä»½çš„æ˜ å°„å­˜å‚¨åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æœ¬åœ°ç¼“å­˜ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´æœ€ç»ˆä¸€è‡´æ€§çš„æ›´æ–°ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ Cilium çš„åŒå‘è®¤è¯ä¸­çš„æœ€ç»ˆä¸€è‡´æ€§å¯èƒ½å¯¼è‡´ä¸æ­£ç¡®çš„ç½‘ç»œç­–ç•¥å’Œå®‰å…¨æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦æ­£ç¡®ä½¿ç”¨ä¾èµ–èº«ä»½åˆ° IP åœ°å€æ˜ å°„çš„ CNIï¼Œè¯·è€ƒè™‘é‡‡ç”¨æ·±åº¦é˜²å¾¡å§¿æ€ï¼Œå°†ä¸€ä¸ªæœåŠ¡ç½‘æ ¼ï¼ˆå¦‚ Istio Ambientï¼‰å åŠ åœ¨å…¶ä¸Šã€‚Istio Ambient å®ç°äº†ä¸€ç§æ—  sidecar çš„æœåŠ¡ç½‘æ ¼ï¼Œåœ¨æœåŠ¡ä¹‹é—´çš„æ•°æ®è·¯å¾„ä¸Šä½¿ç”¨ mTLSï¼ˆæ— è®ºå…¶ IP åœ°å€å¦‚ä½•ï¼‰ã€‚åœ¨&lt;a href=&#34;https://thenewstack.io/solo-io-istio-is-winning-the-service-mesh-war/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åƒ Istio è¿™æ ·çš„æœåŠ¡ç½‘æ ¼&lt;/a&gt;ä¸­ï¼Œèº«ä»½æ¨¡å‹æ˜¯ç”± SPIFFE å®šä¹‰çš„ï¼Œå¹¶æ ¹æ®è´Ÿè´£ç­¾ç½²ç”¨äºèº«ä»½éªŒè¯æµé‡çš„è¯ä¹¦çš„è¯ä¹¦é¢å‘æœºæ„å»ºç«‹çš„ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
